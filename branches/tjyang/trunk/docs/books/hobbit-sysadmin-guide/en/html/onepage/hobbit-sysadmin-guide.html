<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head>
   <title>Hobbit System Administration Guide</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- html4-uni,html,xhtml --> 
<meta name="src" content="hobbit-sysadmin-guide.tex" /> 
<meta name="date" content="2008-04-26 19:37:00" /> 
<link rel="stylesheet" type="text/css" href="hobbit-sysadmin-guide.css" /> 
</head><body 
>
   <div class="maketitle">
                                                                                         
                                                                                         
                                                                                         
                                                                                         

<h2 class="titleHead">Hobbit System Administration Guide</h2>
<div class="author" ><span 
class="ptmr7t-x-x-120">T.J. Yang</span></div>
<br />
<div class="date" ><span 
class="ptmr7t-x-x-120">Copyright </span><span 
class="zpzccmry-x-x-120">&#x00A9;</span><span 
class="ptmr7t-x-x-120">&#x00A0;2008 Tyng-Jing Yang.</span><br />
<span 
class="ptmr7t-x-x-120">This material may be distributed only subject to the terms and conditions set forth in version 1.0</span>
<span 
class="ptmr7t-x-x-120">of the Open Publication License. Please refer to Appendix</span><span 
class="ptmr7t-x-x-120">&#x00A0;</span><a 
href="#x1-374000D"><span 
class="ptmr7t-x-x-120">D</span><!--tex4ht:ref: cha:opl --></a> <span 
class="ptmr7t-x-x-120">for the license text.</span><br />
<span 
class="ptmr7t-x-x-120">This book was prepared from </span><a 
href="http://hg.serpentine.com/mercurial/book/" ><span 
class="ptmr7t-x-x-120">rev</span><span 
class="ptmr7t-x-x-120">&#x00A0;c9202b05c4f5, dated 2008-01-29 17:34 -0600, </span></a> <span 
class="ptmr7t-x-x-120">using</span>
<a 
href="http://www.selenic.com/hg/" ><span 
class="ptmr7t-x-x-120">rev</span><span 
class="ptmr7t-x-x-120">&#x00A0;Mercurial Distributed SCM (version 0.9.3) </span></a> <span 
class="ptmr7t-x-x-120">of Mercurial.</span></div>
                                                                                         
                                                                                         
   </div>
<a 
 id="Q1-1-1"></a>
                                                                                         
                                                                                         
   <h2 class="likechapterHead"><a 
 id="x1-1000"></a>Contents</h2> <div class="tableofcontents">
   <span class="chapterToc"> <a 
href="#Q1-1-1">Contents</a></span>
<br />   <span class="chapterToc"> <a 
href="#Q1-1-5">Preface</a></span>
<br />   &#x00A0;<span class="sectionToc">0.1 <a 
href="#x1-40000.1" id="QQ2-1-6">This book is a work in progress</a></span>
<br />   &#x00A0;<span class="sectionToc">0.2 <a 
href="#x1-50000.2" id="QQ2-1-7">About the examples in this book</a></span>
<br />   &#x00A0;<span class="sectionToc">0.3 <a 
href="#x1-60000.3" id="QQ2-1-8">Colophon&#x2014;this book is Free</a></span>
<br />   <span class="chapterToc">1 <a 
href="#x1-70001" id="QQ2-1-9">Introduction</a></span>
<br />   &#x00A0;<span class="sectionToc">1.1 <a 
href="#x1-80001.1" id="QQ2-1-10">About revision control</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">1.1.1 <a 
href="#x1-90001.1.1" id="QQ2-1-11">Why use revision control?</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">1.1.2 <a 
href="#x1-100001.1.2" id="QQ2-1-12">The many names of revision control</a></span>
<br />   &#x00A0;<span class="sectionToc">1.2 <a 
href="#x1-110001.2" id="QQ2-1-13">A short history of revision control</a></span>
<br />   &#x00A0;<span class="sectionToc">1.3 <a 
href="#x1-120001.3" id="QQ2-1-14">Trends in revision control</a></span>
<br />   &#x00A0;<span class="sectionToc">1.4 <a 
href="#x1-130001.4" id="QQ2-1-15">A few of the advantages of distributed revision control</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">1.4.1 <a 
href="#x1-140001.4.1" id="QQ2-1-16">Advantages for open source projects</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">1.4.2 <a 
href="#x1-160001.4.2" id="QQ2-1-18">Advantages for commercial projects</a></span>
<br />   &#x00A0;<span class="sectionToc">1.5 <a 
href="#x1-170001.5" id="QQ2-1-19">Why choose Mercurial?</a></span>
<br />   &#x00A0;<span class="sectionToc">1.6 <a 
href="#x1-180001.6" id="QQ2-1-20">Mercurial compared with other tools</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">1.6.1 <a 
href="#x1-190001.6.1" id="QQ2-1-21">Subversion</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">1.6.2 <a 
href="#x1-200001.6.2" id="QQ2-1-22">Git</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">1.6.3 <a 
href="#x1-210001.6.3" id="QQ2-1-23">CVS</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">1.6.4 <a 
href="#x1-220001.6.4" id="QQ2-1-24">Commercial tools</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">1.6.5 <a 
href="#x1-230001.6.5" id="QQ2-1-25">Choosing a revision control tool</a></span>
<br />   &#x00A0;<span class="sectionToc">1.7 <a 
href="#x1-240001.7" id="QQ2-1-26">Switching from another tool to Mercurial</a></span>
<br />   <span class="chapterToc">2 <a 
href="#x1-250002" id="QQ2-1-27">Hobbit Client</a></span>
<br />   &#x00A0;<span class="sectionToc">2.1 <a 
href="#x1-260002.1" id="QQ2-1-28">Hobbit Client installation</a></span>
<br />   &#x00A0;<span class="sectionToc">2.2 <a 
href="#x1-270002.2" id="QQ2-1-29">Hobbit Client Architecture</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.2.1 <a 
href="#x1-280002.2.1" id="QQ2-1-30">Factors to keep in mind</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.2.2 <a 
href="#x1-290002.2.2" id="QQ2-1-31">Informal anarchy</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.2.3 <a 
href="#x1-300002.2.3" id="QQ2-1-32">A single central repository</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.2.4 <a 
href="#x1-310002.2.4" id="QQ2-1-33">Working with multiple branches</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.2.5 <a 
href="#x1-320002.2.5" id="QQ2-1-34">Feature branches</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.2.6 <a 
href="#x1-330002.2.6" id="QQ2-1-36">The release train</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.2.7 <a 
href="#x1-340002.2.7" id="QQ2-1-37">The Linux kernel model</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.2.8 <a 
href="#x1-350002.2.8" id="QQ2-1-38">Pull-only versus shared-push collaboration</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.2.9 <a 
href="#x1-360002.2.9" id="QQ2-1-39">Where collaboration meets branch management</a></span>
<br />   &#x00A0;<span class="sectionToc">2.3 <a 
href="#x1-370002.3" id="QQ2-1-40">The technical side of sharing</a></span>
<br />   &#x00A0;<span class="sectionToc">2.4 <a 
href="#x1-380002.4" id="QQ2-1-41">Informal sharing with &#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D;</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.4.1 <a 
href="#x1-390002.4.1" id="QQ2-1-42">A few things to keep in mind</a></span>
<br />   &#x00A0;<span class="sectionToc">2.5 <a 
href="#x1-400002.5" id="QQ2-1-43">Using the Secure Shell (ssh) protocol</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.5.1 <a 
href="#x1-410002.5.1" id="QQ2-1-44">How to read and write ssh URLs</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.5.2 <a 
href="#x1-420002.5.2" id="QQ2-1-45">Finding an ssh client for your system</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.5.3 <a 
href="#x1-430002.5.3" id="QQ2-1-46">Generating a key pair</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.5.4 <a 
href="#x1-440002.5.4" id="QQ2-1-47">Using an authentication agent</a></span>
                                                                                         
                                                                                         
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.5.5 <a 
href="#x1-450002.5.5" id="QQ2-1-48">Configuring the server side properly</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.5.6 <a 
href="#x1-460002.5.6" id="QQ2-1-49">Using compression with ssh</a></span>
<br />   &#x00A0;<span class="sectionToc">2.6 <a 
href="#x1-470002.6" id="QQ2-1-50">Serving over HTTP using CGI</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.6.1 <a 
href="#x1-480002.6.1" id="QQ2-1-51">Web server configuration checklist</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.6.2 <a 
href="#x1-490002.6.2" id="QQ2-1-52">Basic CGI configuration</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.6.3 <a 
href="#x1-520002.6.3" id="QQ2-1-55">Sharing multiple repositories with one CGI script</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.6.4 <a 
href="#x1-540002.6.4" id="QQ2-1-57">Downloading source archives</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">2.6.5 <a 
href="#x1-550002.6.5" id="QQ2-1-58">Web configuration options</a></span>
<br />   <span class="chapterToc">3 <a 
href="#x1-590003" id="QQ2-1-62">System Monitoring Requirements</a></span>
<br />   &#x00A0;<span class="sectionToc">3.1 <a 
href="#x1-600003.1" id="QQ2-1-63">Web GUI of Hobbit</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.1.1 <a 
href="#x1-610003.1.1" id="QQ2-1-64">Linux</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.1.2 <a 
href="#x1-620003.1.2" id="QQ2-1-65">Solaris</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.1.3 <a 
href="#x1-630003.1.3" id="QQ2-1-66">Mac OS X</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.1.4 <a 
href="#x1-640003.1.4" id="QQ2-1-67">Windows</a></span>
<br />   &#x00A0;<span class="sectionToc">3.2 <a 
href="#x1-650003.2" id="QQ2-1-68">Getting started</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.2.1 <a 
href="#x1-660003.2.1" id="QQ2-1-69">Built-in help</a></span>
<br />   &#x00A0;<span class="sectionToc">3.3 <a 
href="#x1-670003.3" id="QQ2-1-70">Working with a repository</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.3.1 <a 
href="#x1-680003.3.1" id="QQ2-1-71">Making a local copy of a repository</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.3.2 <a 
href="#x1-690003.3.2" id="QQ2-1-72">What&#x2019;s in a repository?</a></span>
<br />   &#x00A0;<span class="sectionToc">3.4 <a 
href="#x1-700003.4" id="QQ2-1-73">A tour through history</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.4.1 <a 
href="#x1-710003.4.1" id="QQ2-1-75">Changesets, revisions, and talking to other people</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.4.2 <a 
href="#x1-720003.4.2" id="QQ2-1-76">Viewing specific revisions</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.4.3 <a 
href="#x1-730003.4.3" id="QQ2-1-77">More detailed information</a></span>
<br />   &#x00A0;<span class="sectionToc">3.5 <a 
href="#x1-740003.5" id="QQ2-1-78">All about command options</a></span>
<br />   &#x00A0;<span class="sectionToc">3.6 <a 
href="#x1-750003.6" id="QQ2-1-79">Making and reviewing changes</a></span>
<br />   &#x00A0;<span class="sectionToc">3.7 <a 
href="#x1-760003.7" id="QQ2-1-80">Recording changes in a new changeset</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.7.1 <a 
href="#x1-770003.7.1" id="QQ2-1-81">Setting up a username</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.7.2 <a 
href="#x1-800003.7.2" id="QQ2-1-84">Writing a commit message</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.7.3 <a 
href="#x1-810003.7.3" id="QQ2-1-85">Writing a good commit message</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.7.4 <a 
href="#x1-820003.7.4" id="QQ2-1-86">Aborting a commit</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.7.5 <a 
href="#x1-830003.7.5" id="QQ2-1-87">Admiring our new handiwork</a></span>
<br />   &#x00A0;<span class="sectionToc">3.8 <a 
href="#x1-840003.8" id="QQ2-1-88">Sharing changes</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.8.1 <a 
href="#x1-850003.8.1" id="QQ2-1-89">Pulling changes from another repository</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.8.2 <a 
href="#x1-860003.8.2" id="QQ2-1-90">Updating the working directory</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.8.3 <a 
href="#x1-870003.8.3" id="QQ2-1-91">Pushing changes to another repository</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">3.8.4 <a 
href="#x1-880003.8.4" id="QQ2-1-92">Sharing changes over a network</a></span>
<br />   <span class="chapterToc">4 <a 
href="#x1-890004" id="QQ2-1-93">A tour of Mercurial: merging work</a></span>
<br />   &#x00A0;<span class="sectionToc">4.1 <a 
href="#x1-900004.1" id="QQ2-1-94">Merging streams of work</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">4.1.1 <a 
href="#x1-910004.1.1" id="QQ2-1-96">Head changesets</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">4.1.2 <a 
href="#x1-920004.1.2" id="QQ2-1-98">Performing the merge</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">4.1.3 <a 
href="#x1-930004.1.3" id="QQ2-1-100">Committing the results of the merge</a></span>
<br />   &#x00A0;<span class="sectionToc">4.2 <a 
href="#x1-940004.2" id="QQ2-1-101">Merging conflicting changes</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">4.2.1 <a 
href="#x1-950004.2.1" id="QQ2-1-103">Using a graphical merge tool</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">4.2.2 <a 
href="#x1-960004.2.2" id="QQ2-1-105">A worked example</a></span>
<br />   &#x00A0;<span class="sectionToc">4.3 <a 
href="#x1-970004.3" id="QQ2-1-106">Simplifying the pull-merge-commit sequence</a></span>
<br />   <span class="chapterToc">5 <a 
href="#x1-980005" id="QQ2-1-107">Behind the scenes</a></span>
<br />   &#x00A0;<span class="sectionToc">5.1 <a 
href="#x1-990005.1" id="QQ2-1-108">Mercurial&#x2019;s historical record</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.1.1 <a 
href="#x1-1000005.1.1" id="QQ2-1-109">Tracking the history of a single file</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.1.2 <a 
href="#x1-1010005.1.2" id="QQ2-1-111">Managing tracked files</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.1.3 <a 
href="#x1-1020005.1.3" id="QQ2-1-112">Recording changeset information</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.1.4 <a 
href="#x1-1030005.1.4" id="QQ2-1-113">Relationships between revisions</a></span>
<br />   &#x00A0;<span class="sectionToc">5.2 <a 
href="#x1-1040005.2" id="QQ2-1-115">Safe, efficient storage</a></span>
                                                                                         
                                                                                         
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.2.1 <a 
href="#x1-1050005.2.1" id="QQ2-1-116">Efficient storage</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.2.2 <a 
href="#x1-1060005.2.2" id="QQ2-1-117">Safe operation</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.2.3 <a 
href="#x1-1070005.2.3" id="QQ2-1-118">Fast retrieval</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.2.4 <a 
href="#x1-1090005.2.4" id="QQ2-1-121">Identification and strong integrity</a></span>
<br />   &#x00A0;<span class="sectionToc">5.3 <a 
href="#x1-1100005.3" id="QQ2-1-122">Revision history, branching, and merging</a></span>
<br />   &#x00A0;<span class="sectionToc">5.4 <a 
href="#x1-1110005.4" id="QQ2-1-124">The working directory</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.4.1 <a 
href="#x1-1120005.4.1" id="QQ2-1-125">What happens when you commit</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.4.2 <a 
href="#x1-1130005.4.2" id="QQ2-1-128">Creating a new head</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.4.3 <a 
href="#x1-1140005.4.3" id="QQ2-1-131">Merging heads</a></span>
<br />   &#x00A0;<span class="sectionToc">5.5 <a 
href="#x1-1150005.5" id="QQ2-1-133">Other interesting design features</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.5.1 <a 
href="#x1-1160005.5.1" id="QQ2-1-134">Clever compression</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.5.2 <a 
href="#x1-1180005.5.2" id="QQ2-1-136">Read/write ordering and atomicity</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.5.3 <a 
href="#x1-1190005.5.3" id="QQ2-1-137">Concurrent access</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.5.4 <a 
href="#x1-1210005.5.4" id="QQ2-1-139">Avoiding seeks</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">5.5.5 <a 
href="#x1-1220005.5.5" id="QQ2-1-140">Other contents of the dirstate</a></span>
<br />   <span class="chapterToc">6 <a 
href="#x1-1230006" id="QQ2-1-141">Hobbit Administration Guide</a></span>
<br />   &#x00A0;<span class="sectionToc">6.1 <a 
href="#x1-1240006.1" id="QQ2-1-142">Telling Mercurial which files to track</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.1.1 <a 
href="#x1-1250006.1.1" id="QQ2-1-143">Explicit versus implicit file naming</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.1.2 <a 
href="#x1-1260006.1.2" id="QQ2-1-144">Aside: Mercurial tracks files, not directories</a></span>
<br />   &#x00A0;<span class="sectionToc">6.2 <a 
href="#x1-1270006.2" id="QQ2-1-146">How to stop tracking a file</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.2.1 <a 
href="#x1-1280006.2.1" id="QQ2-1-147">Removing a file does not affect its history</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.2.2 <a 
href="#x1-1290006.2.2" id="QQ2-1-148">Missing files</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.2.3 <a 
href="#x1-1300006.2.3" id="QQ2-1-149">Aside: why tell Mercurial explicitly to remove a file?</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.2.4 <a 
href="#x1-1310006.2.4" id="QQ2-1-150">Useful shorthand&#x2014;adding and removing files in one step</a></span>
<br />   &#x00A0;<span class="sectionToc">6.3 <a 
href="#x1-1320006.3" id="QQ2-1-151">Copying files</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.3.1 <a 
href="#x1-1330006.3.1" id="QQ2-1-152">The results of copying during a merge</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.3.2 <a 
href="#x1-1340006.3.2" id="QQ2-1-153">Why should changes follow copies?</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.3.3 <a 
href="#x1-1350006.3.3" id="QQ2-1-154">How to make changes <span 
class="ptmri7t-">not </span>follow a copy</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.3.4 <a 
href="#x1-1360006.3.4" id="QQ2-1-155">Behaviour of the &#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D; command</a></span>
<br />   &#x00A0;<span class="sectionToc">6.4 <a 
href="#x1-1370006.4" id="QQ2-1-156">Renaming files</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.4.1 <a 
href="#x1-1380006.4.1" id="QQ2-1-157">Renaming files and merging changes</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.4.2 <a 
href="#x1-1390006.4.2" id="QQ2-1-158">Divergent renames and merging</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.4.3 <a 
href="#x1-1400006.4.3" id="QQ2-1-159">Convergent renames and merging</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">6.4.4 <a 
href="#x1-1410006.4.4" id="QQ2-1-160">Other name-related corner cases</a></span>
<br />   &#x00A0;<span class="sectionToc">6.5 <a 
href="#x1-1420006.5" id="QQ2-1-161">Recovering from mistakes</a></span>
<br />   <span class="chapterToc">7 <a 
href="#x1-1430007" id="QQ2-1-162">File names and pattern matching</a></span>
<br />   &#x00A0;<span class="sectionToc">7.1 <a 
href="#x1-1440007.1" id="QQ2-1-163">Simple file naming</a></span>
<br />   &#x00A0;<span class="sectionToc">7.2 <a 
href="#x1-1450007.2" id="QQ2-1-164">Running commands without any file names</a></span>
<br />   &#x00A0;<span class="sectionToc">7.3 <a 
href="#x1-1460007.3" id="QQ2-1-165">Telling you what&#x2019;s going on</a></span>
<br />   &#x00A0;<span class="sectionToc">7.4 <a 
href="#x1-1470007.4" id="QQ2-1-166">Using patterns to identify files</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">7.4.1 <a 
href="#x1-1480007.4.1" id="QQ2-1-167">Shell-style <span 
class="pcrr7tn-">glob </span>patterns</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">7.4.2 <a 
href="#x1-1500007.4.2" id="QQ2-1-169">Regular expression matching with <span 
class="pcrr7tn-">re </span>patterns</a></span>
<br />   &#x00A0;<span class="sectionToc">7.5 <a 
href="#x1-1510007.5" id="QQ2-1-170">Filtering files</a></span>
<br />   &#x00A0;<span class="sectionToc">7.6 <a 
href="#x1-1520007.6" id="QQ2-1-171">Ignoring unwanted files and directories</a></span>
<br />   &#x00A0;<span class="sectionToc">7.7 <a 
href="#x1-1530007.7" id="QQ2-1-172">Case sensitivity</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">7.7.1 <a 
href="#x1-1540007.7.1" id="QQ2-1-173">Safe, portable repository storage</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">7.7.2 <a 
href="#x1-1550007.7.2" id="QQ2-1-174">Detecting case conflicts</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">7.7.3 <a 
href="#x1-1560007.7.3" id="QQ2-1-175">Fixing a case conflict</a></span>
<br />   <span class="chapterToc">8 <a 
href="#x1-1570008" id="QQ2-1-176">Managing releases and branchy development</a></span>
<br />   &#x00A0;<span class="sectionToc">8.1 <a 
href="#x1-1580008.1" id="QQ2-1-177">Giving a persistent name to a revision</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">8.1.1 <a 
href="#x1-1590008.1.1" id="QQ2-1-178">Handling tag conflicts during a merge</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">8.1.2 <a 
href="#x1-1600008.1.2" id="QQ2-1-179">Tags and cloning</a></span>
                                                                                         
                                                                                         
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">8.1.3 <a 
href="#x1-1610008.1.3" id="QQ2-1-180">When permanent tags are too much</a></span>
<br />   &#x00A0;<span class="sectionToc">8.2 <a 
href="#x1-1620008.2" id="QQ2-1-181">The flow of changes&#x2014;big picture vs. little</a></span>
<br />   &#x00A0;<span class="sectionToc">8.3 <a 
href="#x1-1630008.3" id="QQ2-1-182">Managing big-picture branches in repositories</a></span>
<br />   &#x00A0;<span class="sectionToc">8.4 <a 
href="#x1-1640008.4" id="QQ2-1-183">Don&#x2019;t repeat yourself: merging across branches</a></span>
<br />   &#x00A0;<span class="sectionToc">8.5 <a 
href="#x1-1650008.5" id="QQ2-1-184">Naming branches within one repository</a></span>
<br />   &#x00A0;<span class="sectionToc">8.6 <a 
href="#x1-1660008.6" id="QQ2-1-185">Dealing with multiple named branches in a repository</a></span>
<br />   &#x00A0;<span class="sectionToc">8.7 <a 
href="#x1-1670008.7" id="QQ2-1-186">Branch names and merging</a></span>
<br />   &#x00A0;<span class="sectionToc">8.8 <a 
href="#x1-1680008.8" id="QQ2-1-187">Branch naming is generally useful</a></span>
<br />   <span class="chapterToc">9 <a 
href="#x1-1690009" id="QQ2-1-188">Finding and fixing your mistakes</a></span>
<br />   &#x00A0;<span class="sectionToc">9.1 <a 
href="#x1-1700009.1" id="QQ2-1-189">Erasing local history</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.1.1 <a 
href="#x1-1710009.1.1" id="QQ2-1-190">The accidental commit</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.1.2 <a 
href="#x1-1720009.1.2" id="QQ2-1-191">Rolling back a transaction</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.1.3 <a 
href="#x1-1730009.1.3" id="QQ2-1-192">The erroneous pull</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.1.4 <a 
href="#x1-1740009.1.4" id="QQ2-1-193">Rolling back is useless once you&#x2019;ve pushed</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.1.5 <a 
href="#x1-1750009.1.5" id="QQ2-1-194">You can only roll back once</a></span>
<br />   &#x00A0;<span class="sectionToc">9.2 <a 
href="#x1-1760009.2" id="QQ2-1-195">Reverting the mistaken change</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.2.1 <a 
href="#x1-1770009.2.1" id="QQ2-1-196">File management errors</a></span>
<br />   &#x00A0;<span class="sectionToc">9.3 <a 
href="#x1-1790009.3" id="QQ2-1-198">Dealing with committed changes</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.3.1 <a 
href="#x1-1800009.3.1" id="QQ2-1-199">Backing out a changeset</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.3.2 <a 
href="#x1-1810009.3.2" id="QQ2-1-200">Backing out the tip changeset</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.3.3 <a 
href="#x1-1820009.3.3" id="QQ2-1-202">Backing out a non-tip change</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.3.4 <a 
href="#x1-1840009.3.4" id="QQ2-1-205">Gaining more control of the backout process</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.3.5 <a 
href="#x1-1850009.3.5" id="QQ2-1-208">Why &#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; works as it does</a></span>
<br />   &#x00A0;<span class="sectionToc">9.4 <a 
href="#x1-1860009.4" id="QQ2-1-209">Changes that should never have been</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.4.1 <a 
href="#x1-1870009.4.1" id="QQ2-1-210">Protect yourself from &#x201C;escaped&#x201D; changes</a></span>
<br />   &#x00A0;<span class="sectionToc">9.5 <a 
href="#x1-1880009.5" id="QQ2-1-211">Finding the source of a bug</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.5.1 <a 
href="#x1-1890009.5.1" id="QQ2-1-212">Using the &#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.5.2 <a 
href="#x1-1900009.5.2" id="QQ2-1-213">Cleaning up after your search</a></span>
<br />   &#x00A0;<span class="sectionToc">9.6 <a 
href="#x1-1910009.6" id="QQ2-1-214">Tips for finding bugs effectively</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.6.1 <a 
href="#x1-1920009.6.1" id="QQ2-1-215">Give consistent input</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.6.2 <a 
href="#x1-1930009.6.2" id="QQ2-1-216">Automate as much as possible</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.6.3 <a 
href="#x1-1940009.6.3" id="QQ2-1-217">Check your results</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.6.4 <a 
href="#x1-1950009.6.4" id="QQ2-1-218">Beware interference between bugs</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">9.6.5 <a 
href="#x1-1960009.6.5" id="QQ2-1-219">Bracket your search lazily</a></span>
<br />   <span class="chapterToc">10 <a 
href="#x1-19700010" id="QQ2-1-220">Handling repository events with hooks</a></span>
<br />   &#x00A0;<span class="sectionToc">10.1 <a 
href="#x1-19800010.1" id="QQ2-1-221">An overview of hooks in Mercurial</a></span>
<br />   &#x00A0;<span class="sectionToc">10.2 <a 
href="#x1-19900010.2" id="QQ2-1-222">Hooks and security</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.2.1 <a 
href="#x1-20000010.2.1" id="QQ2-1-223">Hooks are run with your privileges</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.2.2 <a 
href="#x1-20100010.2.2" id="QQ2-1-224">Hooks do not propagate</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.2.3 <a 
href="#x1-20200010.2.3" id="QQ2-1-225">Hooks can be overridden</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.2.4 <a 
href="#x1-20300010.2.4" id="QQ2-1-226">Ensuring that critical hooks are run</a></span>
<br />   &#x00A0;<span class="sectionToc">10.3 <a 
href="#x1-20400010.3" id="QQ2-1-227">Care with <span 
class="pcrr7tn-">pretxn </span>hooks in a shared-access repository</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.3.1 <a 
href="#x1-20500010.3.1" id="QQ2-1-228">The problem illustrated</a></span>
<br />   &#x00A0;<span class="sectionToc">10.4 <a 
href="#x1-20600010.4" id="QQ2-1-229">A short tutorial on using hooks</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.4.1 <a 
href="#x1-20700010.4.1" id="QQ2-1-231">Performing multiple actions per event</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.4.2 <a 
href="#x1-20800010.4.2" id="QQ2-1-233">Controlling whether an activity can proceed</a></span>
<br />   &#x00A0;<span class="sectionToc">10.5 <a 
href="#x1-20900010.5" id="QQ2-1-235">Writing your own hooks</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.5.1 <a 
href="#x1-21000010.5.1" id="QQ2-1-236">Choosing how your hook should run</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.5.2 <a 
href="#x1-21100010.5.2" id="QQ2-1-237">Hook parameters</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.5.3 <a 
href="#x1-21200010.5.3" id="QQ2-1-238">Hook return values and activity control</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.5.4 <a 
href="#x1-21300010.5.4" id="QQ2-1-239">Writing an external hook</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.5.5 <a 
href="#x1-21400010.5.5" id="QQ2-1-240">Telling Mercurial to use an in-process hook</a></span>
                                                                                         
                                                                                         
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.5.6 <a 
href="#x1-21500010.5.6" id="QQ2-1-241">Writing an in-process hook</a></span>
<br />   &#x00A0;<span class="sectionToc">10.6 <a 
href="#x1-21600010.6" id="QQ2-1-242">Some hook examples</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.6.1 <a 
href="#x1-21700010.6.1" id="QQ2-1-243">Writing meaningful commit messages</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.6.2 <a 
href="#x1-21800010.6.2" id="QQ2-1-245">Checking for trailing whitespace</a></span>
<br />   &#x00A0;<span class="sectionToc">10.7 <a 
href="#x1-21900010.7" id="QQ2-1-248">Bundled hooks</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.7.1 <a 
href="#x1-22000010.7.1" id="QQ2-1-249"><span 
class="pcrr7tn-">acl</span>&#x2014;access control for parts of a repository</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.7.2 <a 
href="#x1-22300010.7.2" id="QQ2-1-252"><span 
class="pcrr7tn-">bugzilla</span>&#x2014;integration with Bugzilla</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.7.3 <a 
href="#x1-22800010.7.3" id="QQ2-1-257"><span 
class="pcrr7tn-">notify</span>&#x2014;send email notifications</a></span>
<br />   &#x00A0;<span class="sectionToc">10.8 <a 
href="#x1-23100010.8" id="QQ2-1-260">Information for writers of hooks</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.8.1 <a 
href="#x1-23200010.8.1" id="QQ2-1-261">In-process hook execution</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.8.2 <a 
href="#x1-23300010.8.2" id="QQ2-1-262">External hook execution</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.8.3 <a 
href="#x1-23400010.8.3" id="QQ2-1-263">Finding out where changesets come from</a></span>
<br />   &#x00A0;<span class="sectionToc">10.9 <a 
href="#x1-23700010.9" id="QQ2-1-266">Hook reference</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.1 <a 
href="#x1-23800010.9.1" id="QQ2-1-267"><span 
class="pcrr7tn-">changegroup</span>&#x2014;after remote changesets added</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.2 <a 
href="#x1-23900010.9.2" id="QQ2-1-268"><span 
class="pcrr7tn-">commit</span>&#x2014;after a new changeset is created</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.3 <a 
href="#x1-24000010.9.3" id="QQ2-1-269"><span 
class="pcrr7tn-">incoming</span>&#x2014;after one remote changeset is added</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.4 <a 
href="#x1-24100010.9.4" id="QQ2-1-270"><span 
class="pcrr7tn-">outgoing</span>&#x2014;after changesets are propagated</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.5 <a 
href="#x1-24200010.9.5" id="QQ2-1-271"><span 
class="pcrr7tn-">prechangegroup</span>&#x2014;before starting to add remote changesets</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.6 <a 
href="#x1-24300010.9.6" id="QQ2-1-272"><span 
class="pcrr7tn-">precommit</span>&#x2014;before starting to commit a changeset</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.7 <a 
href="#x1-24400010.9.7" id="QQ2-1-273"><span 
class="pcrr7tn-">preoutgoing</span>&#x2014;before starting to propagate changesets</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.8 <a 
href="#x1-24500010.9.8" id="QQ2-1-274"><span 
class="pcrr7tn-">pretag</span>&#x2014;before tagging a changeset</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.9 <a 
href="#x1-24600010.9.9" id="QQ2-1-275"><span 
class="pcrr7tn-">pretxnchangegroup</span>&#x2014;before completing addition of remote changesets</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.10 <a 
href="#x1-24700010.9.10" id="QQ2-1-276"><span 
class="pcrr7tn-">pretxncommit</span>&#x2014;before completing commit of new changeset</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.11 <a 
href="#x1-24800010.9.11" id="QQ2-1-277"><span 
class="pcrr7tn-">preupdate</span>&#x2014;before updating or merging working directory</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.12 <a 
href="#x1-24900010.9.12" id="QQ2-1-278"><span 
class="pcrr7tn-">tag</span>&#x2014;after tagging a changeset</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">10.9.13 <a 
href="#x1-25000010.9.13" id="QQ2-1-279"><span 
class="pcrr7tn-">update</span>&#x2014;after updating or merging working directory</a></span>
<br />   <span class="chapterToc">11 <a 
href="#x1-25100011" id="QQ2-1-280">Customising the output of Mercurial</a></span>
<br />   &#x00A0;<span class="sectionToc">11.1 <a 
href="#x1-25200011.1" id="QQ2-1-281">Using precanned output styles</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">11.1.1 <a 
href="#x1-25300011.1.1" id="QQ2-1-282">Setting a default style</a></span>
<br />   &#x00A0;<span class="sectionToc">11.2 <a 
href="#x1-25400011.2" id="QQ2-1-283">Commands that support styles and templates</a></span>
<br />   &#x00A0;<span class="sectionToc">11.3 <a 
href="#x1-25500011.3" id="QQ2-1-284">The basics of templating</a></span>
<br />   &#x00A0;<span class="sectionToc">11.4 <a 
href="#x1-25600011.4" id="QQ2-1-285">Common template keywords</a></span>
<br />   &#x00A0;<span class="sectionToc">11.5 <a 
href="#x1-25700011.5" id="QQ2-1-287">Escape sequences</a></span>
<br />   &#x00A0;<span class="sectionToc">11.6 <a 
href="#x1-25800011.6" id="QQ2-1-288">Filtering keywords to change their results</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">11.6.1 <a 
href="#x1-25900011.6.1" id="QQ2-1-290">Combining filters</a></span>
<br />   &#x00A0;<span class="sectionToc">11.7 <a 
href="#x1-26000011.7" id="QQ2-1-291">From templates to styles</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">11.7.1 <a 
href="#x1-26100011.7.1" id="QQ2-1-292">The simplest of style files</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">11.7.2 <a 
href="#x1-26200011.7.2" id="QQ2-1-293">Style file syntax</a></span>
<br />   &#x00A0;<span class="sectionToc">11.8 <a 
href="#x1-26300011.8" id="QQ2-1-294">Style files by example</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">11.8.1 <a 
href="#x1-26400011.8.1" id="QQ2-1-295">Identifying mistakes in style files</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">11.8.2 <a 
href="#x1-26500011.8.2" id="QQ2-1-296">Uniquely identifying a repository</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">11.8.3 <a 
href="#x1-26600011.8.3" id="QQ2-1-297">Mimicking Subversion&#x2019;s output</a></span>
<br />   <span class="chapterToc">12 <a 
href="#x1-26700012" id="QQ2-1-298">Managing change with Mercurial Queues</a></span>
<br />   &#x00A0;<span class="sectionToc">12.1 <a 
href="#x1-26800012.1" id="QQ2-1-299">The patch management problem</a></span>
<br />   &#x00A0;<span class="sectionToc">12.2 <a 
href="#x1-26900012.2" id="QQ2-1-300">The prehistory of Mercurial Queues</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.2.1 <a 
href="#x1-27000012.2.1" id="QQ2-1-301">A patchwork quilt</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.2.2 <a 
href="#x1-27100012.2.2" id="QQ2-1-302">From patchwork quilt to Mercurial Queues</a></span>
<br />   &#x00A0;<span class="sectionToc">12.3 <a 
href="#x1-27200012.3" id="QQ2-1-303">The huge advantage of MQ</a></span>
<br />   &#x00A0;<span class="sectionToc">12.4 <a 
href="#x1-27300012.4" id="QQ2-1-304">Understanding patches</a></span>
<br />   &#x00A0;<span class="sectionToc">12.5 <a 
href="#x1-27400012.5" id="QQ2-1-306">Getting started with Mercurial Queues</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.5.1 <a 
href="#x1-27500012.5.1" id="QQ2-1-311">Creating a new patch</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.5.2 <a 
href="#x1-27600012.5.2" id="QQ2-1-312">Refreshing a patch</a></span>
                                                                                         
                                                                                         
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.5.3 <a 
href="#x1-27700012.5.3" id="QQ2-1-315">Stacking and tracking patches</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.5.4 <a 
href="#x1-27800012.5.4" id="QQ2-1-318">Manipulating the patch stack</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.5.5 <a 
href="#x1-27900012.5.5" id="QQ2-1-321">Pushing and popping many patches</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.5.6 <a 
href="#x1-28000012.5.6" id="QQ2-1-323">Safety checks, and overriding them</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.5.7 <a 
href="#x1-28100012.5.7" id="QQ2-1-325">Working on several patches at once</a></span>
<br />   &#x00A0;<span class="sectionToc">12.6 <a 
href="#x1-28200012.6" id="QQ2-1-326">More about patches</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.6.1 <a 
href="#x1-28300012.6.1" id="QQ2-1-327">The strip count</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.6.2 <a 
href="#x1-28400012.6.2" id="QQ2-1-328">Strategies for applying a patch</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.6.3 <a 
href="#x1-28500012.6.3" id="QQ2-1-329">Some quirks of patch representation</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.6.4 <a 
href="#x1-28600012.6.4" id="QQ2-1-330">Beware the fuzz</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.6.5 <a 
href="#x1-28700012.6.5" id="QQ2-1-331">Handling rejection</a></span>
<br />   &#x00A0;<span class="sectionToc">12.7 <a 
href="#x1-28800012.7" id="QQ2-1-332">Getting the best performance out of MQ</a></span>
<br />   &#x00A0;<span class="sectionToc">12.8 <a 
href="#x1-28900012.8" id="QQ2-1-333">Updating your patches when the underlying code changes</a></span>
<br />   &#x00A0;<span class="sectionToc">12.9 <a 
href="#x1-29000012.9" id="QQ2-1-334">Identifying patches</a></span>
<br />   &#x00A0;<span class="sectionToc">12.10 <a 
href="#x1-29100012.10" id="QQ2-1-336">Useful things to know about</a></span>
<br />   &#x00A0;<span class="sectionToc">12.11 <a 
href="#x1-29200012.11" id="QQ2-1-337">Managing patches in a repository</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.11.1 <a 
href="#x1-29300012.11.1" id="QQ2-1-338">MQ support for patch repositories</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.11.2 <a 
href="#x1-29400012.11.2" id="QQ2-1-339">A few things to watch out for</a></span>
<br />   &#x00A0;<span class="sectionToc">12.12 <a 
href="#x1-29500012.12" id="QQ2-1-340">Third party tools for working with patches</a></span>
<br />   &#x00A0;<span class="sectionToc">12.13 <a 
href="#x1-29600012.13" id="QQ2-1-342">Good ways to work with patches</a></span>
<br />   &#x00A0;<span class="sectionToc">12.14 <a 
href="#x1-29700012.14" id="QQ2-1-343">MQ cookbook</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.14.1 <a 
href="#x1-29800012.14.1" id="QQ2-1-344">Manage &#x201C;trivial&#x201D; patches</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.14.2 <a 
href="#x1-29900012.14.2" id="QQ2-1-345">Combining entire patches</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">12.14.3 <a 
href="#x1-30000012.14.3" id="QQ2-1-346">Merging part of one patch into another</a></span>
<br />   &#x00A0;<span class="sectionToc">12.15 <a 
href="#x1-30100012.15" id="QQ2-1-347">Differences between quilt and MQ</a></span>
<br />   <span class="chapterToc">13 <a 
href="#x1-30200013" id="QQ2-1-348">Advanced uses of Mercurial Queues</a></span>
<br />   &#x00A0;<span class="sectionToc">13.1 <a 
href="#x1-30300013.1" id="QQ2-1-349">The problem of many targets</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">13.1.1 <a 
href="#x1-30400013.1.1" id="QQ2-1-350">Tempting approaches that don&#x2019;t work well</a></span>
<br />   &#x00A0;<span class="sectionToc">13.2 <a 
href="#x1-30500013.2" id="QQ2-1-351">Conditionally applying patches with guards</a></span>
<br />   &#x00A0;<span class="sectionToc">13.3 <a 
href="#x1-30600013.3" id="QQ2-1-352">Controlling the guards on a patch</a></span>
<br />   &#x00A0;<span class="sectionToc">13.4 <a 
href="#x1-30700013.4" id="QQ2-1-353">Selecting the guards to use</a></span>
<br />   &#x00A0;<span class="sectionToc">13.5 <a 
href="#x1-30800013.5" id="QQ2-1-354">MQ&#x2019;s rules for applying patches</a></span>
<br />   &#x00A0;<span class="sectionToc">13.6 <a 
href="#x1-30900013.6" id="QQ2-1-355">Trimming the work environment</a></span>
<br />   &#x00A0;<span class="sectionToc">13.7 <a 
href="#x1-31000013.7" id="QQ2-1-356">Dividing up the <span 
class="pcrr7tn-">series </span>file</a></span>
<br />   &#x00A0;<span class="sectionToc">13.8 <a 
href="#x1-31100013.8" id="QQ2-1-357">Maintaining the patch series</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">13.8.1 <a 
href="#x1-31200013.8.1" id="QQ2-1-358">The art of writing backport patches</a></span>
<br />   &#x00A0;<span class="sectionToc">13.9 <a 
href="#x1-31300013.9" id="QQ2-1-359">Useful tips for developing with MQ</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">13.9.1 <a 
href="#x1-31400013.9.1" id="QQ2-1-360">Organising patches in directories</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">13.9.2 <a 
href="#x1-31500013.9.2" id="QQ2-1-361">Viewing the history of a patch</a></span>
<br />   <span class="chapterToc">14 <a 
href="#x1-31600014" id="QQ2-1-362">Adding functionality with extensions</a></span>
<br />   &#x00A0;<span class="sectionToc">14.1 <a 
href="#x1-31700014.1" id="QQ2-1-363">Improve performance with the <span 
class="pcrr7tn-">inotify </span>extension</a></span>
<br />   &#x00A0;<span class="sectionToc">14.2 <a 
href="#x1-31800014.2" id="QQ2-1-364">Flexible diff support with the <span 
class="pcrr7tn-">extdiff </span>extension</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">14.2.1 <a 
href="#x1-31900014.2.1" id="QQ2-1-365">Defining command aliases</a></span>
<br />   &#x00A0;<span class="sectionToc">14.3 <a 
href="#x1-32000014.3" id="QQ2-1-366">Cherrypicking changes with the <span 
class="pcrr7tn-">transplant </span>extension</a></span>
<br />   &#x00A0;<span class="sectionToc">14.4 <a 
href="#x1-32100014.4" id="QQ2-1-367">Send changes via email with the <span 
class="pcrr7tn-">patchbomb </span>extension</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">14.4.1 <a 
href="#x1-32200014.4.1" id="QQ2-1-368">Changing the behaviour of patchbombs</a></span>
<br />   <span class="appendixToc">A <a 
href="#x1-323000A" id="QQ2-1-369">Command reference</a></span>
<br />   &#x00A0;<span class="sectionToc">A.1 <a 
href="#x1-324000A.1" id="QQ2-1-370">&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D;&#x2014;add files at the next commit</a></span>
<br />   &#x00A0;<span class="sectionToc">A.2 <a 
href="#x1-328000A.2" id="QQ2-1-374">&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D;&#x2014;print changes in history or working directory</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">A.2.1 <a 
href="#x1-329000A.2.1" id="QQ2-1-375">Options</a></span>
<br />   &#x00A0;<span class="sectionToc">A.3 <a 
href="#x1-340000A.3" id="QQ2-1-386">&#x201C;<span 
class="pcrr7tn-">hg version</span>&#x201D;&#x2014;print version and copyright information</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">A.3.1 <a 
href="#x1-341000A.3.1" id="QQ2-1-387">Tips and tricks</a></span>
                                                                                         
                                                                                         
<br />   <span class="appendixToc">B <a 
href="#x1-344000B" id="QQ2-1-390">Mercurial Queues reference</a></span>
<br />   &#x00A0;<span class="sectionToc">B.1 <a 
href="#x1-345000B.1" id="QQ2-1-391">MQ command reference</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.1 <a 
href="#x1-346000B.1.1" id="QQ2-1-392">&#x201C;<span 
class="pcrr7tn-">hg qapplied</span>&#x201D;&#x2014;print applied patches</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.2 <a 
href="#x1-347000B.1.2" id="QQ2-1-393">&#x201C;<span 
class="pcrr7tn-">hg qcommit</span>&#x201D;&#x2014;commit changes in the queue repository</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.3 <a 
href="#x1-348000B.1.3" id="QQ2-1-394">&#x201C;<span 
class="pcrr7tn-">hg qdelete</span>&#x201D;&#x2014;delete a patch from the <span 
class="pcrr7tn-">series </span>file</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.4 <a 
href="#x1-349000B.1.4" id="QQ2-1-395">&#x201C;<span 
class="pcrr7tn-">hg qdiff</span>&#x201D;&#x2014;print a diff of the topmost applied patch</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.5 <a 
href="#x1-350000B.1.5" id="QQ2-1-396">&#x201C;<span 
class="pcrr7tn-">hg qfold</span>&#x201D;&#x2014;merge (&#x201C;fold&#x201D;) several patches into one</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.6 <a 
href="#x1-351000B.1.6" id="QQ2-1-397">&#x201C;<span 
class="pcrr7tn-">hg qheader</span>&#x201D;&#x2014;display the header/description of a patch</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.7 <a 
href="#x1-352000B.1.7" id="QQ2-1-398">&#x201C;<span 
class="pcrr7tn-">hg qimport</span>&#x201D;&#x2014;import a third-party patch into the queue</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.8 <a 
href="#x1-353000B.1.8" id="QQ2-1-399">&#x201C;<span 
class="pcrr7tn-">hg qinit</span>&#x201D;&#x2014;prepare a repository to work with MQ</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.9 <a 
href="#x1-354000B.1.9" id="QQ2-1-400">&#x201C;<span 
class="pcrr7tn-">hg qnew</span>&#x201D;&#x2014;create a new patch</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.10 <a 
href="#x1-355000B.1.10" id="QQ2-1-401">&#x201C;<span 
class="pcrr7tn-">hg qnext</span>&#x201D;&#x2014;print the name of the next patch</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.11 <a 
href="#x1-356000B.1.11" id="QQ2-1-402">&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D;&#x2014;pop patches off the stack</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.12 <a 
href="#x1-357000B.1.12" id="QQ2-1-403">&#x201C;<span 
class="pcrr7tn-">hg qprev</span>&#x201D;&#x2014;print the name of the previous patch</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.13 <a 
href="#x1-358000B.1.13" id="QQ2-1-404">&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D;&#x2014;push patches onto the stack</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.14 <a 
href="#x1-359000B.1.14" id="QQ2-1-405">&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D;&#x2014;update the topmost applied patch</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.15 <a 
href="#x1-360000B.1.15" id="QQ2-1-406">&#x201C;<span 
class="pcrr7tn-">hg qrename</span>&#x201D;&#x2014;rename a patch</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.16 <a 
href="#x1-361000B.1.16" id="QQ2-1-407">&#x201C;<span 
class="pcrr7tn-">hg qrestore</span>&#x201D;&#x2014;restore saved queue state</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.17 <a 
href="#x1-362000B.1.17" id="QQ2-1-408">&#x201C;<span 
class="pcrr7tn-">hg qsave</span>&#x201D;&#x2014;save current queue state</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.18 <a 
href="#x1-363000B.1.18" id="QQ2-1-409">&#x201C;<span 
class="pcrr7tn-">hg qseries</span>&#x201D;&#x2014;print the entire patch series</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.19 <a 
href="#x1-364000B.1.19" id="QQ2-1-410">&#x201C;<span 
class="pcrr7tn-">hg qtop</span>&#x201D;&#x2014;print the name of the current patch</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.20 <a 
href="#x1-365000B.1.20" id="QQ2-1-411">&#x201C;<span 
class="pcrr7tn-">hg qunapplied</span>&#x201D;&#x2014;print patches not yet applied</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.21 <a 
href="#x1-366000B.1.21" id="QQ2-1-412">&#x201C;<span 
class="pcrr7tn-">hg qversion</span>&#x201D;</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.1.22 <a 
href="#x1-367000B.1.22" id="QQ2-1-413">&#x201C;<span 
class="pcrr7tn-">hg strip</span>&#x201D;&#x2014;remove a revision and descendants</a></span>
<br />   &#x00A0;<span class="sectionToc">B.2 <a 
href="#x1-368000B.2" id="QQ2-1-414">MQ file reference</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.2.1 <a 
href="#x1-369000B.2.1" id="QQ2-1-415">The <span 
class="pcrr7tn-">series </span>file</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc">B.2.2 <a 
href="#x1-370000B.2.2" id="QQ2-1-416">The <span 
class="pcrr7tn-">status </span>file</a></span>
<br />   <span class="appendixToc">C <a 
href="#x1-371000C" id="QQ2-1-417">Making of this book</a></span>
<br />   &#x00A0;<span class="sectionToc">C.1 <a 
href="#x1-372000C.1" id="QQ2-1-418">Where to download the book source</a></span>
<br />   &#x00A0;<span class="sectionToc">C.2 <a 
href="#x1-373000C.2" id="QQ2-1-419">On Windows</a></span>
<br />   <span class="appendixToc">D <a 
href="#x1-374000D" id="QQ2-1-420">Open Publication License</a></span>
<br />   &#x00A0;<span class="sectionToc">D.1 <a 
href="#x1-375000D.1" id="QQ2-1-421">Requirements on both unmodified and modified versions</a></span>
<br />   &#x00A0;<span class="sectionToc">D.2 <a 
href="#x1-376000D.2" id="QQ2-1-422">Copyright</a></span>
<br />   &#x00A0;<span class="sectionToc">D.3 <a 
href="#x1-377000D.3" id="QQ2-1-423">Scope of license</a></span>
<br />   &#x00A0;<span class="sectionToc">D.4 <a 
href="#x1-378000D.4" id="QQ2-1-424">Requirements on modified works</a></span>
<br />   &#x00A0;<span class="sectionToc">D.5 <a 
href="#x1-379000D.5" id="QQ2-1-425">Good-practice recommendations</a></span>
<br />   &#x00A0;<span class="sectionToc">D.6 <a 
href="#x1-380000D.6" id="QQ2-1-426">License options</a></span>
<br />   <span class="chapterToc"> <a 
href="#Q1-1-427">Bibliography</a></span>
<br />   <span class="chapterToc"> <a 
href="#Q1-1-428">Index</a></span>
   </div>
                                                                                         
                                                                                         
   <h2 class="likechapterHead"><a 
 id="x1-2000"></a>List of Figures</h2><div class="tableofcontents"><span class="lofToc">2.1&#x00A0;<a 
href="#x1-320011">Feature branches</a></span><br /><span class="lofToc">3.1&#x00A0;<a 
href="#x1-700581">Graphical history of the <span 
class="pcrr7tn-">hello </span>repository</a></span><br /><span class="lofToc">4.1&#x00A0;<a 
href="#x1-900691">Divergent
recent histories of the <span 
class="pcrr7tn-">my-hello </span>and <span 
class="pcrr7tn-">my-new-hello </span>repositories</a></span><br /><span class="lofToc">4.2&#x00A0;<a 
href="#x1-910012">Repository contents
after pulling from <span 
class="pcrr7tn-">my-hello </span>into <span 
class="pcrr7tn-">my-new-hello</span></a></span><br /><span class="lofToc">4.3&#x00A0;<a 
href="#x1-920163">Working directory and repository during
merge, and following commit</a></span><br /><span class="lofToc">4.4&#x00A0;<a 
href="#x1-940014">Conflicting changes to a document</a></span><br /><span class="lofToc">4.5&#x00A0;<a 
href="#x1-950035">Using <span 
class="pcrr7tn-">kdiff3 </span>to
merge versions of a file</a></span><br /><span class="lofToc">5.1&#x00A0;<a 
href="#x1-1000021">Relationships between files in working directory and filelogs in
repository</a></span><br /><span class="lofToc">5.2&#x00A0;<a 
href="#x1-1030012">Metadata relationships</a></span><br /><span class="lofToc">5.3&#x00A0;<a 
href="#x1-1070013">Snapshot of a revlog, with incremental deltas</a></span><br /><span class="lofToc">5.4&#x00A0;<a 
href="#x1-1100014"></a></span><br /><span class="lofToc">5.5&#x00A0;<a 
href="#x1-1120015">The
working directory can have two parents</a></span><br /><span class="lofToc">5.6&#x00A0;<a 
href="#x1-1120026">The working directory gains new parents after a
commit</a></span><br /><span class="lofToc">5.7&#x00A0;<a 
href="#x1-1130017">The working directory, updated to an older changeset</a></span><br /><span class="lofToc">5.8&#x00A0;<a 
href="#x1-1130028">After a commit made
while synced to an older changeset</a></span><br /><span class="lofToc">5.9&#x00A0;<a 
href="#x1-1140029">Merging two heads</a></span><br /><span class="lofToc">6.1&#x00A0;<a 
href="#x1-1260281">Simulating an empty directory
using a hidden file</a></span><br /><span class="lofToc">9.1&#x00A0;<a 
href="#x1-1810341">Backing out a change using the &#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command</a></span><br /><span class="lofToc">9.2&#x00A0;<a 
href="#x1-1820452">Automated
backout of a non-tip change using the &#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command</a></span><br /><span class="lofToc">9.3&#x00A0;<a 
href="#x1-1840643">Backing out a change
using the &#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command</a></span><br /><span class="lofToc">9.4&#x00A0;<a 
href="#x1-1841294">Manually merging a backout change</a></span><br /><span class="lofToc">10.1&#x00A0;<a 
href="#x1-2060261">A simple
hook that runs when a changeset is committed</a></span><br /><span class="lofToc">10.2&#x00A0;<a 
href="#x1-2070112">Defining a second <span 
class="pcrr7tn-">commit </span>hook</a></span><br /><span class="lofToc">10.3&#x00A0;<a 
href="#x1-2080413">Using
the <span 
class="pcrr7tn-">pretxncommit </span>hook to control commits</a></span><br /><span class="lofToc">10.4&#x00A0;<a 
href="#x1-2170234">A hook that forbids overly short commit
messages</a></span><br /><span class="lofToc">10.5&#x00A0;<a 
href="#x1-2180345">A simple hook that checks for trailing whitespace</a></span><br /><span class="lofToc">10.6&#x00A0;<a 
href="#x1-2180716">A better trailing
whitespace hook</a></span><br /><span class="lofToc">11.1&#x00A0;<a 
href="#x1-2560651">Template keywords in use</a></span><br /><span class="lofToc">11.2&#x00A0;<a 
href="#x1-2582092">Template filters in action</a></span><br /><span class="lofToc">12.1&#x00A0;<a 
href="#x1-2730291">Simple
uses of the <span 
class="pcrr7tn-">diff </span>and <span 
class="pcrr7tn-">patch </span>commands</a></span><br /><span class="lofToc">12.2&#x00A0;<a 
href="#x1-2740052">Contents to add to <span 
class="pcrr7tn-">~/.hgrc </span>to enable the MQ
extension</a></span><br /><span class="lofToc">12.3&#x00A0;<a 
href="#x1-2740353">How to verify that MQ is enabled</a></span><br /><span class="lofToc">12.4&#x00A0;<a 
href="#x1-2740554">Preparing a repository for use with
MQ</a></span><br /><span class="lofToc">12.5&#x00A0;<a 
href="#x1-2740965">Creating a new patch</a></span><br /><span class="lofToc">12.6&#x00A0;<a 
href="#x1-2760456">Refreshing a patch</a></span><br /><span class="lofToc">12.7&#x00A0;<a 
href="#x1-2760817">Refresh a patch many times
to accumulate changes</a></span><br /><span class="lofToc">12.8&#x00A0;<a 
href="#x1-2770608">Stacking a second patch on top of the first</a></span><br /><span class="lofToc">12.9&#x00A0;<a 
href="#x1-2770819">Understanding
the patch stack with &#x201C;<span 
class="pcrr7tn-">hg qseries</span>&#x201D; and &#x201C;<span 
class="pcrr7tn-">hg qapplied</span>&#x201D;</a></span><br /><span class="lofToc">12.10&#x00A0;<a 
href="#x1-27800310">Applied and unapplied
patches in the MQ patch stack</a></span><br /><span class="lofToc">12.11&#x00A0;<a 
href="#x1-27804211">Modifying the stack of applied patches</a></span><br /><span class="lofToc">12.12&#x00A0;<a 
href="#x1-27902912">Pushing
all unapplied patches</a></span><br /><span class="lofToc">12.13&#x00A0;<a 
href="#x1-28001213">Forcibly creating a patch</a></span><br /><span class="lofToc">12.14&#x00A0;<a 
href="#x1-29007514">Using MQ&#x2019;s tag features
to work with patches</a></span><br /><span class="lofToc">12.15&#x00A0;<a 
href="#x1-29505015">The <span 
class="pcrr7tn-">diffstat</span>, <span 
class="pcrr7tn-">filterdiff</span>, and <span 
class="pcrr7tn-">lsdiff </span>commands</a></span><br />
   </div>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
   <h2 class="likechapterHead"><a 
 id="x1-3000"></a>Preface</h2> <a 
 id="Q1-1-5"></a> <a 
 id="x1-3000doc"></a>
<!--l. 5--><p class="noindent">Distributed revision control is a relatively new territory, and has thus far grown due to people&#x2019;s willingness to strike out into
ill-charted territory.
</p><!--l. 9--><p class="indent">   I am writing a book about distributed revision control because I believe that it is an important subject that deserves a field
guide. I chose to write about Mercurial because it is the easiest tool to learn the terrain with, and yet it scales to the demands of
real, challenging environments where many other revision control tools fail.
</p>
   <h3 class="sectionHead"><span class="titlemark">0.1    </span> <a 
 id="x1-40000.1"></a>This book is a work in progress</h3>
<!--l. 17--><p class="noindent">I am releasing this book while I am still writing it, in the hope that it will prove useful to others. I also hope that readers will
contribute as they see fit.
</p><!--l. 21--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">0.2    </span> <a 
 id="x1-50000.2"></a>About the examples in this book</h3>
<!--l. 23--><p class="noindent">This book takes an unusual approach to code samples. Every example is &#x201C;live&#x201D;&#x2014;each one is actually the result of a
shell script that executes the Mercurial commands you see. Every time an image of the book is built from its
sources, all the example scripts are automatically run, and their current results compared against their expected
results.
</p><!--l. 30--><p class="indent">   The advantage of this approach is that the examples are always accurate; they describe <span 
class="ptmri7t-">exactly </span>the behaviour of the version
of Mercurial that&#x2019;s mentioned at the front of the book. If I update the version of Mercurial that I&#x2019;m documenting, and the output
of some command changes, the build fails.
</p><!--l. 36--><p class="indent">   There is a small disadvantage to this approach, which is that the dates and times you&#x2019;ll see in examples tend to be
&#x201C;squashed&#x201D; together in a way that they wouldn&#x2019;t be if the same commands were being typed by a human. Where a human can
issue no more than one command every few seconds, with any resulting timestamps correspondingly spread out, my automated
example scripts run many commands in one second.
</p><!--l. 44--><p class="indent">   As an instance of this, several consecutive commits in an example can show up as having occurred during the same second.
You can see this occur in the <a 
 id="dx1-5001"></a><span 
class="pcrr7tn-">bisect </span>example in section&#x00A0;<a 
href="#x1-1880009.5">9.5<!--tex4ht:ref: sec:undo:bisect --></a>, for instance.
</p><!--l. 49--><p class="indent">   So when you&#x2019;re reading examples, don&#x2019;t place too much weight on the dates or times you see in the output of commands.
But <span 
class="ptmri7t-">do </span>be confident that the behaviour you&#x2019;re seeing is consistent and reproducible.
</p><!--l. 54--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">0.3    </span> <a 
 id="x1-60000.3"></a>Colophon&#x2014;this book is Free</h3>
<!--l. 56--><p class="noindent">This book is licensed under the Open Publication License, and is produced entirely using Free Software tools. It is typeset with
<span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span>; illustrations are drawn and rendered with <a 
href="http://www.inkscape.org/" >Inkscape</a>.
</p><!--l. 61--><p class="indent">   The complete source code for this book is published as a Mercurial repository, at   <a 
href="http://hg.serpentine.com/mercurial/book" class="url" ><span 
class="pcrr7tn-">http://hg.serpentine.com/mercurial/book</span></a>.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
</p>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;1</span><br /><a 
 id="x1-70001"></a>Introduction</h2>
   <h3 class="sectionHead"><span class="titlemark">1.1    </span> <a 
 id="x1-80001.1"></a>About revision control</h3>
<!--l. 6--><p class="noindent">Revision control is the process of managing multiple versions of a piece of information. In its simplest form, this is something
that many people do by hand: every time you modify a file, save it under a new name that contains a number, each one higher
than the number of the preceding version.
</p><!--l. 12--><p class="indent">   Manually managing multiple versions of even a single file is an error-prone task, though, so software tools to help automate
this process have long been available. The earliest automated revision control tools were intended to help a single user to
manage revisions of a single file. Over the past few decades, the scope of revision control tools has expanded greatly; they now
manage multiple files, and help multiple people to work together. The best modern revision control tools have no
problem coping with thousands of people working together on projects that consist of hundreds of thousands of
files.
</p><!--l. 22--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.1.1    </span> <a 
 id="x1-90001.1.1"></a>Why use revision control?</h4>
<!--l. 24--><p class="noindent">There are a number of reasons why you or your team might want to use an automated revision control tool for a project.
</p>
     <ul><li><span class="dt">
     </span><span class="dd">It will track the history and evolution of your project, so you don&#x2019;t have to. For every change, you&#x2019;ll have a log
     of <span 
class="ptmri7t-">who </span>made it; <span 
class="ptmri7t-">why </span>they made it; <span 
class="ptmri7t-">when </span>they made it; and <span 
class="ptmri7t-">what </span>the change was.
     </span><li><span class="dt">
     </span><span class="dd">When you&#x2019;re working with other people, revision control software makes it easier for you to collaborate. For
     example, when people more or less simultaneously make potentially incompatible changes, the software will
     help you to identify and resolve those conflicts.
     </span><li><span class="dt">
     </span><span class="dd">It can help you to recover from mistakes. If you make a change that later turns out to be in error, you can revert to
     an earlier version of one or more files. In fact, a <span 
class="ptmri7t-">really </span>good revision control tool will even help you to efficiently
     figure out exactly when a problem was introduced (see section&#x00A0;<a 
href="#x1-1880009.5">9.5<!--tex4ht:ref: sec:undo:bisect --></a> for details).
     </span><li><span class="dt">
     </span><span class="dd">It will help you to work simultaneously on, and manage the drift between, multiple versions of your project.</li></ul>
<!--l. 44--><p class="noindent">Most of these reasons are equally valid&#x2014;at least in theory&#x2014;whether you&#x2019;re working on a project by yourself, or with a hundred
other people.
</p><!--l. 48--><p class="indent">   A key question about the practicality of revision control at these two different scales (&#x201C;lone hacker&#x201D; and &#x201C;huge team&#x201D;) is
how its <span 
class="ptmri7t-">benefits </span>compare to its <span 
class="ptmri7t-">costs</span>. A revision control tool that&#x2019;s difficult to understand or use is going to impose a high
cost.
</p><!--l. 53--><p class="indent">   A five-hundred-person project is likely to collapse under its own weight almost immediately without a revision control tool
and process. In this case, the cost of using revision control might hardly seem worth considering, since <span 
class="ptmri7t-">without </span>it, failure is
almost guaranteed.
</p><!--l. 59--><p class="indent">   On the other hand, a one-person &#x201C;quick hack&#x201D; might seem like a poor place to use a revision control tool, because surely the
cost of using one must be close to the overall cost of the project. Right?
</p><!--l. 63--><p class="indent">   Mercurial uniquely supports <span 
class="ptmri7t-">both </span>of these scales of development. You can learn the basics in just a few minutes, and due to
its low overhead, you can apply revision control to the smallest of projects with ease. Its simplicity means you won&#x2019;t have a lot
of abstruse concepts or command sequences competing for mental space with whatever you&#x2019;re <span 
class="ptmri7t-">really </span>trying to do. At
the same time, Mercurial&#x2019;s high performance and peer-to-peer nature let you scale painlessly to handle large
projects.
                                                                                         
                                                                                         
</p><!--l. 72--><p class="indent">   No revision control tool can rescue a poorly run project, but a good choice of tools can make a huge difference to the
fluidity with which you can work on a project.
</p><!--l. 76--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.1.2    </span> <a 
 id="x1-100001.1.2"></a>The many names of revision control</h4>
<!--l. 78--><p class="noindent">Revision control is a diverse field, so much so that it doesn&#x2019;t actually have a single name or acronym. Here are a few of the
more common names and acronyms you&#x2019;ll encounter: </p>
     <ul><li><span class="dt">
     </span><span class="dd">Revision control (RCS)
     </span><li><span class="dt">
     </span><span class="dd">Software configuration management (SCM), or configuration management
     </span><li><span class="dt">
     </span><span class="dd">Source code management
     </span><li><span class="dt">
     </span><span class="dd">Source code control, or source control
     </span><li><span class="dt">
     </span><span class="dd">Version control (VCS)</li></ul>
<!--l. 88--><p class="noindent">Some people claim that these terms actually have different meanings, but in practice they overlap so much that there&#x2019;s no agreed or
even useful way to tease them apart.
</p><!--l. 92--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">1.2    </span> <a 
 id="x1-110001.2"></a>A short history of revision control</h3>
<!--l. 94--><p class="noindent">The best known of the old-time revision control tools is SCCS (Source Code Control System), which Marc Rochkind wrote at
Bell Labs, in the early 1970s. SCCS operated on individual files, and required every person working on a project to have access
to a shared workspace on a single system. Only one person could modify a file at any time; arbitration for access to files was via
locks. It was common for people to lock files, and later forget to unlock them, preventing anyone else from modifying those
files without the help of an administrator.
</p><!--l. 104--><p class="indent">   Walter Tichy developed a free alternative to SCCS in the early 1980s; he called his program RCS (Revison Control
System). Like SCCS, RCS required developers to work in a single shared workspace, and to lock files to prevent multiple
people from modifying them simultaneously.
</p><!--l. 109--><p class="indent">   Later in the 1980s, Dick Grune used RCS as a building block for a set of shell scripts he initially called cmt, but then
renamed to CVS (Concurrent Versions System). The big innovation of CVS was that it let developers work simultaneously and
somewhat independently in their own personal workspaces. The personal workspaces prevented developers from stepping on
each other&#x2019;s toes all the time, as was common with SCCS and RCS. Each developer had a copy of every project file, and could
modify their copies independently. They had to merge their edits prior to committing changes to the central
repository.
</p><!--l. 119--><p class="indent">   Brian Berliner took Grune&#x2019;s original scripts and rewrote them in&#x00A0;C, releasing in 1989 the code that has since developed into
the modern version of CVS. CVS subsequently acquired the ability to operate over a network connection, giving it a
client/server architecture. CVS&#x2019;s architecture is centralised; only the server has a copy of the history of the project. Client
workspaces just contain copies of recent versions of the project&#x2019;s files, and a little metadata to tell them where the
server is. CVS has been enormously successful; it is probably the world&#x2019;s most widely used revision control
system.
                                                                                         
                                                                                         
</p><!--l. 129--><p class="indent">   In the early 1990s, Sun Microsystems developed an early distributed revision control system, called TeamWare. A
TeamWare workspace contains a complete copy of the project&#x2019;s history. TeamWare has no notion of a central repository. (CVS
relied upon RCS for its history storage; TeamWare used SCCS.)
</p><!--l. 135--><p class="indent">   As the 1990s progressed, awareness grew of a number of problems with CVS. It records simultaneous changes to multiple
files individually, instead of grouping them together as a single logically atomic operation. It does not manage
its file hierarchy well; it is easy to make a mess of a repository by renaming files and directories. Worse, its
source code is difficult to read and maintain, which made the &#x201C;pain level&#x201D; of fixing these architectural problems
prohibitive.
</p><!--l. 143--><p class="indent">   In 2001, Jim Blandy and Karl Fogel, two developers who had worked on CVS, started a project to replace it with a tool that
would have a better architecture and cleaner code. The result, Subversion, does not stray from CVS&#x2019;s centralised
client/server model, but it adds multi-file atomic commits, better namespace management, and a number of
other features that make it a generally better tool than CVS. Since its initial release, it has rapidly grown in
popularity.
</p><!--l. 151--><p class="indent">   More or less simultaneously, Graydon Hoare began working on an ambitious distributed revision control system that he
named Monotone. While Monotone addresses many of CVS&#x2019;s design flaws and has a peer-to-peer architecture, it goes beyond
earlier (and subsequent) revision control tools in a number of innovative ways. It uses cryptographic hashes as identifiers, and
has an integral notion of &#x201C;trust&#x201D; for code from different sources.
</p><!--l. 159--><p class="indent">   Mercurial began life in 2005. While a few aspects of its design are influenced by Monotone, Mercurial focuses on ease of
use, high performance, and scalability to very large projects.
</p><!--l. 163--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">1.3    </span> <a 
 id="x1-120001.3"></a>Trends in revision control</h3>
<!--l. 165--><p class="noindent">There has been an unmistakable trend in the development and use of revision control tools over the past four decades, as people
have become familiar with the capabilities of their tools and constrained by their limitations.
</p><!--l. 170--><p class="indent">   The first generation began by managing single files on individual computers. Although these tools represented a huge
advance over ad-hoc manual revision control, their locking model and reliance on a single computer limited them to small,
tightly-knit teams.
</p><!--l. 175--><p class="indent">   The second generation loosened these constraints by moving to network-centered architectures, and managing entire
projects at a time. As projects grew larger, they ran into new problems. With clients needing to talk to servers very frequently,
server scaling became an issue for large projects. An unreliable network connection could prevent remote users from being able
to talk to the server at all. As open source projects started making read-only access available anonymously to anyone, people
without commit privileges found that they could not use the tools to interact with a project in a natural way, as they could not
record their changes.
</p><!--l. 186--><p class="indent">   The current generation of revision control tools is peer-to-peer in nature. All of these systems have dropped the dependency
on a single central server, and allow people to distribute their revision control data to where it&#x2019;s actually needed. Collaboration
over the Internet has moved from constrained by technology to a matter of choice and consensus. Modern tools can operate
offline indefinitely and autonomously, with a network connection only needed when syncing changes with another
repository.
</p><!--l. 195--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">1.4    </span> <a 
 id="x1-130001.4"></a>A few of the advantages of distributed revision control</h3>
<!--l. 197--><p class="noindent">Even though distributed revision control tools have for several years been as robust and usable as their previous-generation
counterparts, people using older tools have not yet necessarily woken up to their advantages. There are a number of ways in
which distributed tools shine relative to centralised ones.
</p><!--l. 203--><p class="indent">   For an individual developer, distributed tools are almost always much faster than centralised tools. This is for a simple
reason: a centralised tool needs to talk over the network for many common operations, because most metadata is stored in a
                                                                                         
                                                                                         
single copy on the central server. A distributed tool stores all of its metadata locally. All else being equal, talking over the
network adds overhead to a centralised tool. Don&#x2019;t underestimate the value of a snappy, responsive tool: you&#x2019;re going to spend a
lot of time interacting with your revision control software.
</p><!--l. 213--><p class="indent">   Distributed tools are indifferent to the vagaries of your server infrastructure, again because they replicate metadata to so
many locations. If you use a centralised system and your server catches fire, you&#x2019;d better hope that your backup media are
reliable, and that your last backup was recent and actually worked. With a distributed tool, you have many backups available on
every contributor&#x2019;s computer.
</p><!--l. 220--><p class="indent">   The reliability of your network will affect distributed tools far less than it will centralised tools. You can&#x2019;t even use a
centralised tool without a network connection, except for a few highly constrained commands. With a distributed tool, if your
network connection goes down while you&#x2019;re working, you may not even notice. The only thing you won&#x2019;t be able to do is talk
to repositories on other computers, something that is relatively rare compared with local operations. If you have a far-flung
team of collaborators, this may be significant.
</p><!--l. 229--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.4.1    </span> <a 
 id="x1-140001.4.1"></a>Advantages for open source projects</h4>
<!--l. 231--><p class="noindent">If you take a shine to an open source project and decide that you would like to start hacking on it, and that project uses a
distributed revision control tool, you are at once a peer with the people who consider themselves the &#x201C;core&#x201D; of that project. If
they publish their repositories, you can immediately copy their project history, start making changes, and record your work,
using the same tools in the same ways as insiders. By contrast, with a centralised tool, you must use the software in a &#x201C;read
only&#x201D; mode unless someone grants you permission to commit changes to their central server. Until then, you won&#x2019;t be able to
record changes, and your local modifications will be at risk of corruption any time you try to update your client&#x2019;s view of the
repository.
</p><!--l. 244--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-150001.4.1"></a>The forking non-problem</h5>
<!--l. 246--><p class="noindent">It has been suggested that distributed revision control tools pose some sort of risk to open source projects because they make it
easy to &#x201C;fork&#x201D; the development of a project. A fork happens when there are differences in opinion or attitude between groups of
developers that cause them to decide that they can&#x2019;t work together any longer. Each side takes a more or less complete copy of
the project&#x2019;s source code, and goes off in its own direction.
</p><!--l. 254--><p class="indent">   Sometimes the camps in a fork decide to reconcile their differences. With a centralised revision control system, the
<span 
class="ptmri7t-">technical </span>process of reconciliation is painful, and has to be performed largely by hand. You have to decide whose revision
history is going to &#x201C;win&#x201D;, and graft the other team&#x2019;s changes into the tree somehow. This usually loses some or all of one side&#x2019;s
revision history.
</p><!--l. 261--><p class="indent">   What distributed tools do with respect to forking is they make forking the <span 
class="ptmri7t-">only </span>way to develop a project. Every single
change that you make is potentially a fork point. The great strength of this approach is that a distributed revision
control tool has to be really good at <span 
class="ptmri7t-">merging </span>forks, because forks are absolutely fundamental: they happen all the
time.
</p><!--l. 268--><p class="indent">   If every piece of work that everybody does, all the time, is framed in terms of forking and merging, then what the open
source world refers to as a &#x201C;fork&#x201D; becomes <span 
class="ptmri7t-">purely </span>a social issue. If anything, distributed tools <span 
class="ptmri7t-">lower </span>the likelihood of a fork:
</p>
     <ul><li><span class="dt">
     </span><span class="dd">They eliminate the social distinction that centralised tools impose: that between insiders (people with commit
     access) and outsiders (people without).
     </span><li><span class="dt">
     </span><span class="dd">They make it easier to reconcile after a social fork, because all that&#x2019;s involved from the perspective of the revision
     control software is just another merge.</li></ul>
                                                                                         
                                                                                         
<!--l. 281--><p class="indent">   Some people resist distributed tools because they want to retain tight control over their projects, and they believe
that centralised tools give them this control. However, if you&#x2019;re of this belief, and you publish your CVS or
Subversion repositories publically, there are plenty of tools available that can pull out your entire project&#x2019;s history
(albeit slowly) and recreate it somewhere that you don&#x2019;t control. So while your control in this case is illusory,
you are forgoing the ability to fluidly collaborate with whatever people feel compelled to mirror and fork your
history.
</p><!--l. 291--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.4.2    </span> <a 
 id="x1-160001.4.2"></a>Advantages for commercial projects</h4>
<!--l. 293--><p class="noindent">Many commercial projects are undertaken by teams that are scattered across the globe. Contributors who are far from a central
server will see slower command execution and perhaps less reliability. Commercial revision control systems attempt to
ameliorate these problems with remote-site replication add-ons that are typically expensive to buy and cantankerous to
administer. A distributed system doesn&#x2019;t suffer from these problems in the first place. Better yet, you can easily set up multiple
authoritative servers, say one per site, so that there&#x2019;s no redundant communication between repositories over expensive
long-haul network links.
</p><!--l. 304--><p class="indent">   Centralised revision control systems tend to have relatively low scalability. It&#x2019;s not unusual for an expensive centralised
system to fall over under the combined load of just a few dozen concurrent users. Once again, the typical response
tends to be an expensive and clunky replication facility. Since the load on a central server&#x2014;if you have one at
all&#x2014;is many times lower with a distributed tool (because all of the data is replicated everywhere), a single cheap
server can handle the needs of a much larger team, and replication to balance load becomes a simple matter of
scripting.
</p><!--l. 314--><p class="indent">   If you have an employee in the field, troubleshooting a problem at a customer&#x2019;s site, they&#x2019;ll benefit from distributed revision
control. The tool will let them generate custom builds, try different fixes in isolation from each other, and search efficiently
through history for the sources of bugs and regressions in the customer&#x2019;s environment, all without needing to connect to your
company&#x2019;s network.
</p><!--l. 321--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">1.5    </span> <a 
 id="x1-170001.5"></a>Why choose Mercurial?</h3>
<!--l. 323--><p class="noindent">Mercurial has a unique set of properties that make it a particularly good choice as a revision control system.
</p>
     <ul><li><span class="dt">
     </span><span class="dd">It is easy to learn and use.
     </span><li><span class="dt">
     </span><span class="dd">It is lightweight.
     </span><li><span class="dt">
     </span><span class="dd">It scales excellently.
     </span><li><span class="dt">
     </span><span class="dd">It is easy to customise.</li></ul>
<!--l. 332--><p class="indent">   If you are at all familiar with revision control systems, you should be able to get up and running with Mercurial in
less than five minutes. Even if not, it will take no more than a few minutes longer. Mercurial&#x2019;s command and
feature sets are generally uniform and consistent, so you can keep track of a few general rules instead of a host of
exceptions.
                                                                                         
                                                                                         
</p><!--l. 339--><p class="indent">   On a small project, you can start working with Mercurial in moments. Creating new changes and branches; transferring
changes around (whether locally or over a network); and history and status operations are all fast. Mercurial
attempts to stay nimble and largely out of your way by combining low cognitive overhead with blazingly fast
operations.
</p><!--l. 346--><p class="indent">   The usefulness of Mercurial is not limited to small projects: it is used by projects with hundreds to thousands of
contributors, each containing tens of thousands of files and hundreds of megabytes of source code.
</p><!--l. 351--><p class="indent">   If the core functionality of Mercurial is not enough for you, it&#x2019;s easy to build on. Mercurial is well suited to scripting tasks,
and its clean internals and implementation in Python make it easy to add features in the form of extensions. There are a
number of popular and useful extensions already available, ranging from helping to identify bugs to improving
performance.
</p><!--l. 358--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">1.6    </span> <a 
 id="x1-180001.6"></a>Mercurial compared with other tools</h3>
<!--l. 360--><p class="noindent">Before you read on, please understand that this section necessarily reflects my own experiences, interests, and (dare I say
it) biases. I have used every one of the revision control tools listed below, in most cases for several years at a
time.
</p><!--l. 366--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.6.1    </span> <a 
 id="x1-190001.6.1"></a>Subversion</h4>
<!--l. 368--><p class="noindent">Subversion is a popular revision control tool, developed to replace CVS. It has a centralised client/server architecture.
</p><!--l. 371--><p class="indent">   Subversion and Mercurial have similarly named commands for performing the same operations, so if you&#x2019;re familiar with
one, it is easy to learn to use the other. Both tools are portable to all popular operating systems.
</p><!--l. 376--><p class="indent">   Subversion lacks a history-aware merge capability, forcing its users to manually track exactly which revisions have been
merged between branches. If users fail to do this, or make mistakes, they face the prospect of manually resolving merges with
unnecessary conflicts. Subversion also fails to merge changes when files or directories are renamed. Subversion&#x2019;s poor merge
support is its single biggest weakness.
</p><!--l. 384--><p class="indent">   Mercurial has a substantial performance advantage over Subversion on every revision control operation I have
benchmarked. I have measured its advantage as ranging from a factor of two to a factor of six when compared with
Subversion&#x00A0;1.4.3&#x2019;s <span 
class="ptmri7t-">ra</span><span 
class="ptmri7t-">_local </span>file store, which is the fastest access method available). In more realistic deployments involving a
network-based store, Subversion will be at a substantially larger disadvantage. Because many Subversion commands must talk
to the server and Subversion does not have useful replication facilities, server capacity and network bandwidth become
bottlenecks for modestly large projects.
</p><!--l. 395--><p class="indent">   Additionally, Subversion incurs substantial storage overhead to avoid network transactions for a few common operations,
such as finding modified files (<span 
class="pcrr7tn-">status</span>) and displaying modifications against the current revision (<span 
class="pcrr7tn-">diff</span>). As a result, a
Subversion working copy is often the same size as, or larger than, a Mercurial repository and working directory, even though
the Mercurial repository contains a complete history of the project.
</p><!--l. 403--><p class="indent">   Subversion is widely supported by third party tools. Mercurial currently lags considerably in this area. This gap is closing,
however, and indeed some of Mercurial&#x2019;s GUI tools now outshine their Subversion equivalents. Like Mercurial, Subversion has
an excellent user manual.
</p><!--l. 409--><p class="indent">   Because Subversion doesn&#x2019;t store revision history on the client, it is well suited to managing projects that deal with lots of
large, opaque binary files. If you check in fifty revisions to an incompressible 10MB file, Subversion&#x2019;s client-side space usage
stays constant The space used by any distributed SCM will grow rapidly in proportion to the number of revisions, because the
differences between each revision are large.
</p><!--l. 417--><p class="indent">   In addition, it&#x2019;s often difficult or, more usually, impossible to merge different versions of a binary file. Subversion&#x2019;s ability
to let a user lock a file, so that they temporarily have the exclusive right to commit changes to it, can be a significant advantage
to a project where binary files are widely used.
                                                                                         
                                                                                         
</p><!--l. 423--><p class="indent">   Mercurial can import revision history from a Subversion repository. It can also export revision history to a Subversion
repository. This makes it easy to &#x201C;test the waters&#x201D; and use Mercurial and Subversion in parallel before deciding to switch.
History conversion is incremental, so you can perform an initial conversion, then small additional conversions afterwards to
bring in new changes.
</p><!--l. 431--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.6.2    </span> <a 
 id="x1-200001.6.2"></a>Git</h4>
<!--l. 433--><p class="noindent">Git is a distributed revision control tool that was developed for managing the Linux kernel source tree. Like Mercurial, its early
design was somewhat influenced by Monotone.
</p><!--l. 437--><p class="indent">   Git has a very large command set, with version&#x00A0;1.5.0 providing&#x00A0;139 individual commands. It has something of a reputation
for being difficult to learn. Compared to Git, Mercurial has a strong focus on simplicity.
</p><!--l. 442--><p class="indent">   In terms of performance, Git is extremely fast. In several cases, it is faster than Mercurial, at least on Linux, while
Mercurial performs better on other operations. However, on Windows, the performance and general level of support that Git
provides is, at the time of writing, far behind that of Mercurial.
</p><!--l. 448--><p class="indent">   While a Mercurial repository needs no maintenance, a Git repository requires frequent manual &#x201C;repacks&#x201D; of its
metadata. Without these, performance degrades, while space usage grows rapidly. A server that contains many Git
repositories that are not rigorously and frequently repacked will become heavily disk-bound during backups, and
there have been instances of daily backups taking far longer than&#x00A0;24 hours as a result. A freshly packed Git
repository is slightly smaller than a Mercurial repository, but an unpacked repository is several orders of magnitude
larger.
</p><!--l. 458--><p class="indent">   The core of Git is written in C. Many Git commands are implemented as shell or Perl scripts, and the quality of these scripts
varies widely. I have encountered several instances where scripts charged along blindly in the presence of errors that should
have been fatal.
</p><!--l. 463--><p class="indent">   Mercurial can import revision history from a Git repository.
</p><!--l. 466--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.6.3    </span> <a 
 id="x1-210001.6.3"></a>CVS</h4>
<!--l. 468--><p class="noindent">CVS is probably the most widely used revision control tool in the world. Due to its age and internal untidiness, it has been only
lightly maintained for many years.
</p><!--l. 472--><p class="indent">   It has a centralised client/server architecture. It does not group related file changes into atomic commits, making it easy for
people to &#x201C;break the build&#x201D;: one person can successfully commit part of a change and then be blocked by the need for a merge,
causing other people to see only a portion of the work they intended to do. This also affects how you work with project history.
If you want to see all of the modifications someone made as part of a task, you will need to manually inspect
the descriptions and timestamps of the changes made to each file involved (if you even know what those files
were).
</p><!--l. 482--><p class="indent">   CVS has a muddled notion of tags and branches that I will not attempt to even describe. It does not support renaming of
files or directories well, making it easy to corrupt a repository. It has almost no internal consistency checking capabilities, so it
is usually not even possible to tell whether or how a repository is corrupt. I would not recommend CVS for any project, existing
or new.
</p><!--l. 489--><p class="indent">   Mercurial can import CVS revision history. However, there are a few caveats that apply; these are true of every other
revision control tool&#x2019;s CVS importer, too. Due to CVS&#x2019;s lack of atomic changes and unversioned filesystem hierarchy, it is not
possible to reconstruct CVS history completely accurately; some guesswork is involved, and renames will usually not show up.
Because a lot of advanced CVS administration has to be done by hand and is hence error-prone, it&#x2019;s common for CVS importers
to run into multiple problems with corrupted repositories (completely bogus revision timestamps and files that
have remained locked for over a decade are just two of the less interesting problems I can recall from personal
experience).
</p><!--l. 501--><p class="indent">   Mercurial can import revision history from a CVS repository.
                                                                                         
                                                                                         
</p><!--l. 504--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.6.4    </span> <a 
 id="x1-220001.6.4"></a>Commercial tools</h4>
<!--l. 506--><p class="noindent">Perforce has a centralised client/server architecture, with no client-side caching of any data. Unlike modern revision
control tools, Perforce requires that a user run a command to inform the server about every file they intend to
edit.
</p><!--l. 511--><p class="indent">   The performance of Perforce is quite good for small teams, but it falls off rapidly as the number of users grows beyond a
few dozen. Modestly large Perforce installations require the deployment of proxies to cope with the load their users
generate.
</p><!--l. 517--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.6.5    </span> <a 
 id="x1-230001.6.5"></a>Choosing a revision control tool</h4>
<!--l. 519--><p class="noindent">With the exception of CVS, all of the tools listed above have unique strengths that suit them to particular styles of work. There
is no single revision control tool that is best in all situations.
</p><!--l. 523--><p class="indent">   As an example, Subversion is a good choice for working with frequently edited binary files, due to its centralised nature and
support for file locking. If you&#x2019;re averse to the command line, it currently has better GUI support than other free
revision control tools. However, its poor merging is a substantial liability for busy projects with overlapping
development.
</p><!--l. 530--><p class="indent">   I personally find Mercurial&#x2019;s properties of simplicity, performance, and good merge support to be a compelling combination
that has served me well for several years.
</p><!--l. 535--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">1.7    </span> <a 
 id="x1-240001.7"></a>Switching from another tool to Mercurial</h3>
<!--l. 537--><p class="noindent">Mercurial is bundled with an extension named <a 
 id="dx1-24001"></a><span 
class="pcrr7tn-">convert</span>, which can incrementally import revision history from several other
revision control tools. By &#x201C;incremental&#x201D;, I mean that you can convert all of a project&#x2019;s history to date in one go, then rerun the
conversion later to obtain new changes that happened after the initial conversion.
</p><!--l. 543--><p class="indent">   The revision control tools supported by <a 
 id="dx1-24002"></a><span 
class="pcrr7tn-">convert </span>are as follows: </p>
     <ul><li><span class="dt">
     </span><span class="dd">Subversion
     </span><li><span class="dt">
     </span><span class="dd">CVS
     </span><li><span class="dt">
     </span><span class="dd">Git
     </span><li><span class="dt">
     </span><span class="dd">Darcs</li></ul>
<!--l. 552--><p class="indent">   In addition, <a 
 id="dx1-24003"></a><span 
class="pcrr7tn-">convert </span>can export changes from Mercurial to Subversion. This makes it possible to try Subversion and
Mercurial in parallel before committing to a switchover, without risking the loss of any work.
</p><!--l. 557--><p class="indent">   The <a 
 id="dx1-24004"></a><a 
 id="dx1-24005"></a>&#x201C;<span 
class="pcrr7tn-">hg convert</span>&#x201D; command is easy to use. Simply point it at the path or URL of the source repository, optionally give it
the name of the destination repository, and it will start working. After the initial conversion, just run the same command again
to import new changes.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
</p>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;2</span><br /><a 
 id="x1-250002"></a>Hobbit Client</h2>
   <h3 class="sectionHead"><span class="titlemark">2.1    </span> <a 
 id="x1-260002.1"></a>Hobbit Client installation</h3>
<!--l. 7--><p class="noindent">Mercurial has a powerful web interface that provides several useful capabilities.
</p><!--l. 10--><p class="indent">   For interactive use, the web interface lets you browse a single repository or a collection of repositories. You can view the
history of a repository, examine each change (comments and diffs), and view the contents of each directory and
file.
</p><!--l. 15--><p class="indent">   Also for human consumption, the web interface provides an RSS feed of the changes in a repository. This lets you
&#x201C;subscribe&#x201D; to a repository using your favourite feed reader, and be automatically notified of activity in that repository as soon
as it happens. I find this capability much more convenient than the model of subscribing to a mailing list to
which notifications are sent, as it requires no additional configuration on the part of whoever is serving the
repository.
</p><!--l. 24--><p class="indent">   The web interface also lets remote users clone a repository, pull changes from it, and (when the server is configured to
permit it) push changes back to it. Mercurial&#x2019;s HTTP tunneling protocol aggressively compresses data, so that it works
efficiently even over low-bandwidth network connections.
</p><!--l. 30--><p class="indent">   The easiest way to get started with the web interface is to use your web browser to visit an existing repository, such as the
master Mercurial repository at   <a 
href="http://www.selenic.com/repo/hg?style=gitweb" class="url" ><span 
class="pcrr7tn-">http://www.selenic.com/repo/hg?style=gitweb</span></a>.
</p><!--l. 35--><p class="indent">   If you&#x2019;re interested in providing a web interface to your own repositories, Mercurial provides two ways to do this. The first
is using the <a 
 id="dx1-26001"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; command, which is best suited to short-term &#x201C;lightweight&#x201D; serving. See section&#x00A0;<a 
href="#x1-380002.4">2.4<!--tex4ht:ref: sec:collab:serve --></a> below for details
of how to use this command. If you have a long-lived repository that you&#x2019;d like to make permanently available, Mercurial has
built-in support for the CGI (Common Gateway Interface) standard, which all common web servers support. See section&#x00A0;<a 
href="#x1-470002.6">2.6<!--tex4ht:ref: sec:collab:cgi --></a>
for details of CGI configuration.
</p><!--l. 45--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">2.2    </span> <a 
 id="x1-270002.2"></a>Hobbit Client Architecture</h3>
<!--l. 47--><p class="noindent">With a suitably flexible tool, making decisions about workflow is much more of a social engineering challenge than a technical
one. Mercurial imposes few limitations on how you can structure the flow of work in a project, so it&#x2019;s up to you and your group
to set up and live with a model that matches your own particular needs.
</p><!--l. 53--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2.1    </span> <a 
 id="x1-280002.2.1"></a>Factors to keep in mind</h4>
<!--l. 55--><p class="noindent">The most important aspect of any model that you must keep in mind is how well it matches the needs and capabilities of
the people who will be using it. This might seem self-evident; even so, you still can&#x2019;t afford to forget it for a
moment.
</p><!--l. 60--><p class="indent">   I once put together a workflow model that seemed to make perfect sense to me, but that caused a considerable amount of
consternation and strife within my development team. In spite of my attempts to explain why we needed a complex set of
branches, and how changes ought to flow between them, a few team members revolted. Even though they were smart people,
they didn&#x2019;t want to pay attention to the constraints we were operating under, or face the consequences of those constraints in the
details of the model that I was advocating.
</p><!--l. 69--><p class="indent">   Don&#x2019;t sweep foreseeable social or technical problems under the rug. Whatever scheme you put into effect, you should plan
for mistakes and problem scenarios. Consider adding automated machinery to prevent, or quickly recover from, trouble that
you can anticipate. As an example, if you intend to have a branch with not-for-release changes in it, you&#x2019;d do well to think early
about the possibility that someone might accidentally merge those changes into a release branch. You could
avoid this particular problem by writing a hook that prevents changes from being merged from an inappropriate
branch.
                                                                                         
                                                                                         
</p><!--l. 79--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2.2    </span> <a 
 id="x1-290002.2.2"></a>Informal anarchy</h4>
<!--l. 81--><p class="noindent">I wouldn&#x2019;t suggest an &#x201C;anything goes&#x201D; approach as something sustainable, but it&#x2019;s a model that&#x2019;s easy to grasp, and it works
perfectly well in a few unusual situations.
</p><!--l. 85--><p class="indent">   As one example, many projects have a loose-knit group of collaborators who rarely physically meet each other.
Some groups like to overcome the isolation of working at a distance by organising occasional &#x201C;sprints&#x201D;. In a
sprint, a number of people get together in a single location (a company&#x2019;s conference room, a hotel meeting
room, that kind of place) and spend several days more or less locked in there, hacking intensely on a handful of
projects.
</p><!--l. 93--><p class="indent">   A sprint is the perfect place to use the <a 
 id="dx1-29001"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; command, since <a 
 id="dx1-29002"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; does not requires any fancy server
infrastructure. You can get started with <a 
 id="dx1-29003"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; in moments, by reading section&#x00A0;<a 
href="#x1-380002.4">2.4<!--tex4ht:ref: sec:collab:serve --></a> below. Then simply tell the person
next to you that you&#x2019;re running a server, send the URL to them in an instant message, and you immediately have a
quick-turnaround way to work together. They can type your URL into their web browser and quickly review your changes; or
they can pull a bugfix from you and verify it; or they can clone a branch containing a new feature and try it
out.
</p><!--l. 104--><p class="indent">   The charm, and the problem, with doing things in an ad hoc fashion like this is that only people who know about your
changes, and where they are, can see them. Such an informal approach simply doesn&#x2019;t scale beyond a handful people, because
each individual needs to know about <span 
class="zptmcmrm-">n </span>different repositories to pull from.
</p><!--l. 110--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2.3    </span> <a 
 id="x1-300002.2.3"></a>A single central repository</h4>
<!--l. 112--><p class="noindent">For smaller projects migrating from a centralised revision control tool, perhaps the easiest way to get started is to have changes
flow through a single shared central repository. This is also the most common &#x201C;building block&#x201D; for more ambitious workflow
schemes.
</p><!--l. 117--><p class="indent">   Contributors start by cloning a copy of this repository. They can pull changes from it whenever they need to, and
some (perhaps all) developers have permission to push a change back when they&#x2019;re ready for other people to see
it.
</p><!--l. 122--><p class="indent">   Under this model, it can still often make sense for people to pull changes directly from each other, without going through
the central repository. Consider a case in which I have a tentative bug fix, but I am worried that if I were to publish it to the
central repository, it might subsequently break everyone else&#x2019;s trees as they pull it. To reduce the potential for damage, I can ask
you to clone my repository into a temporary repository of your own and test it. This lets us put off publishing the potentially
unsafe change until it has had a little testing.
</p><!--l. 132--><p class="indent">   In this kind of scenario, people usually use the <a 
 id="dx1-30001"></a><span 
class="pcrr7tn-">ssh </span>protocol to securely push changes to the central repository, as
documented in section&#x00A0;<a 
href="#x1-400002.5">2.5<!--tex4ht:ref: sec:collab:ssh --></a>. It&#x2019;s also usual to publish a read-only copy of the repository over HTTP using CGI, as in
section&#x00A0;<a 
href="#x1-470002.6">2.6<!--tex4ht:ref: sec:collab:cgi --></a>. Publishing over HTTP satisfies the needs of people who don&#x2019;t have push access, and those who want to use web
browsers to browse the repository&#x2019;s history.
</p><!--l. 140--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2.4    </span> <a 
 id="x1-310002.2.4"></a>Working with multiple branches</h4>
<!--l. 142--><p class="noindent">Projects of any significant size naturally tend to make progress on several fronts simultaneously. In the case of software, it&#x2019;s
common for a project to go through periodic official releases. A release might then go into &#x201C;maintenance mode&#x201D;
for a while after its first publication; maintenance releases tend to contain only bug fixes, not new features.
In parallel with these maintenance releases, one or more future releases may be under development. People
normally use the word &#x201C;branch&#x201D; to refer to one of these many slightly different directions in which development is
                                                                                         
                                                                                         
proceeding.
</p><!--l. 152--><p class="indent">   Mercurial is particularly well suited to managing a number of simultaneous, but not identical, branches. Each &#x201C;development
direction&#x201D; can live in its own central repository, and you can merge changes from one to another as the need arises. Because
repositories are independent of each other, unstable changes in a development branch will never affect a stable branch unless
someone explicitly merges those changes in.
</p><!--l. 160--><p class="indent">   Here&#x2019;s an example of how this can work in practice. Let&#x2019;s say you have one &#x201C;main branch&#x201D; on a central
server.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-31002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;main</span>
<br class="fancyvrb" /><a 
 id="x1-31004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;main</span>
<br class="fancyvrb" /><a 
 id="x1-31006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'This</span><span 
class="pcrb7t-">&#x00A0;is</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;boring</span><span 
class="pcrb7t-">&#x00A0;feature.'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-31008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'We</span><span 
class="pcrb7t-">&#x00A0;have</span><span 
class="pcrb7t-">&#x00A0;reached</span><span 
class="pcrb7t-">&#x00A0;an</span><span 
class="pcrb7t-">&#x00A0;important</span><span 
class="pcrb7t-">&#x00A0;milestone!'</span>
<br class="fancyvrb" /><a 
 id="x1-31010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;myfile</span>
   </div>
<!--l. 163--><p class="noindent">People clone it, make changes locally, test them, and push them back.
</p><!--l. 165--><p class="indent">   Once the main branch reaches a release milestone, you can use the <a 
 id="dx1-31011"></a>&#x201C;<span 
class="pcrr7tn-">hg tag</span>&#x201D; command to give a permanent name to the
milestone revision.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-31013r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tag</span><span 
class="pcrb7t-">&#x00A0;v1.0</span>
<br class="fancyvrb" /><a 
 id="x1-31015r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-31017r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:1938d56d8cf8</span>
<br class="fancyvrb" /><a 
 id="x1-31019r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-31021r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-31023r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:08</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-31025r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;v1.0</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;7c36e134f91d</span>
<br class="fancyvrb" /><a 
 id="x1-31027r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-31029r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tags</span>
<br class="fancyvrb" /><a 
 id="x1-31031r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:1938d56d8cf8</span>
<br class="fancyvrb" /><a 
 id="x1-31033r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;v1.0</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:7c36e134f91d</span>
   </div>
<!--l. 169--><p class="noindent">Let&#x2019;s say some ongoing development occurs on the main branch.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-31035r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;../main</span>
<br class="fancyvrb" /><a 
 id="x1-31037r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'This</span><span 
class="pcrb7t-">&#x00A0;is</span><span 
class="pcrb7t-">&#x00A0;exciting</span><span 
class="pcrb7t-">&#x00A0;and</span><span 
class="pcrb7t-">&#x00A0;new!'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-31039r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Add</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;new</span><span 
class="pcrb7t-">&#x00A0;feature'</span>
<br class="fancyvrb" /><a 
 id="x1-31041r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-31043r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;This</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;boring</span><span 
class="pcrr7tn-">&#x00A0;feature.</span>
<br class="fancyvrb" /><a 
 id="x1-31045r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;This</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;exciting</span><span 
class="pcrr7tn-">&#x00A0;and</span><span 
class="pcrr7tn-">&#x00A0;new!</span>
   </div>
<!--l. 171--><p class="noindent">Using the tag that was recorded at the milestone, people who clone that repository at any time in the future can use <a 
 id="dx1-31046"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; to
get a copy of the working directory exactly as it was when that tagged revision was committed.
</p>
   <div class="fancyvrb" id="fancyvrb">
                                                                                         
                                                                                         
<a 
 id="x1-31048r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-31050r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;-U</span><span 
class="pcrb7t-">&#x00A0;main</span><span 
class="pcrb7t-">&#x00A0;main-old</span>
<br class="fancyvrb" /><a 
 id="x1-31052r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;main-old</span>
<br class="fancyvrb" /><a 
 id="x1-31054r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;update</span><span 
class="pcrb7t-">&#x00A0;v1.0</span>
<br class="fancyvrb" /><a 
 id="x1-31056r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-31058r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-31060r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;This</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;boring</span><span 
class="pcrr7tn-">&#x00A0;feature.</span>
   </div>
<!--l. 177--><p class="indent">   In addition, immediately after the main branch is tagged, someone can then clone the main branch on the server to a new
&#x201C;stable&#x201D; branch, also on the server.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-31062r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-31064r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;-rv1.0</span><span 
class="pcrb7t-">&#x00A0;main</span><span 
class="pcrb7t-">&#x00A0;stable</span>
<br class="fancyvrb" /><a 
 id="x1-31066r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;requesting</span><span 
class="pcrr7tn-">&#x00A0;all</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-31068r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-31070r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-31072r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-31074r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span>
<br class="fancyvrb" /><a 
 id="x1-31076r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
   </div>
<!--l. 182--><p class="indent">   Someone who needs to make a change to the stable branch can then clone <span 
class="ptmri7t-">that </span>repository, make their changes, commit, and
push their changes back there.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-31078r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;stable</span><span 
class="pcrb7t-">&#x00A0;stable-fix</span>
<br class="fancyvrb" /><a 
 id="x1-31080r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-31082r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;stable-fix</span>
<br class="fancyvrb" /><a 
 id="x1-31084r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'This</span><span 
class="pcrb7t-">&#x00A0;is</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;fix</span><span 
class="pcrb7t-">&#x00A0;to</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;boring</span><span 
class="pcrb7t-">&#x00A0;feature.'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-31086r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Fix</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;bug'</span>
<br class="fancyvrb" /><a 
 id="x1-31088r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;push</span>
<br class="fancyvrb" /><a 
 id="x1-31090r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pushing</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;/tmp/branchingu2SsLn/stable</span>
<br class="fancyvrb" /><a 
 id="x1-31092r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-31094r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-31096r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-31098r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-31100r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span>
   </div>
<!--l. 186--><p class="noindent">Because Mercurial repositories are independent, and Mercurial doesn&#x2019;t move changes around automatically, the stable and main
branches are <span 
class="ptmri7t-">isolated </span>from each other. The changes that you made on the main branch don&#x2019;t &#x201C;leak&#x201D; to the stable branch, and
vice versa.
</p><!--l. 191--><p class="indent">   You&#x2019;ll often want all of your bugfixes on the stable branch to show up on the main branch, too. Rather than rewrite a bugfix
on the main branch, you can simply pull and merge changes from the stable to the main branch, and Mercurial will bring those
bugfixes in for you.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-31102r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;../main</span>
<br class="fancyvrb" /><a 
 id="x1-31104r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;pull</span><span 
class="pcrb7t-">&#x00A0;../stable</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-31106r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pulling</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;../stable</span>
<br class="fancyvrb" /><a 
 id="x1-31108r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-31110r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-31112r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-31114r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-31116r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;(+1</span><span 
class="pcrr7tn-">&#x00A0;heads)</span>
<br class="fancyvrb" /><a 
 id="x1-31118r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(run</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;heads'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;heads,</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;merge'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;merge)</span>
<br class="fancyvrb" /><a 
 id="x1-31120r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;merge</span>
<br class="fancyvrb" /><a 
 id="x1-31122r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;merging</span><span 
class="pcrr7tn-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-31124r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-31126r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(branch</span><span 
class="pcrr7tn-">&#x00A0;merge,</span><span 
class="pcrr7tn-">&#x00A0;don't</span><span 
class="pcrr7tn-">&#x00A0;forget</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;commit)</span>
<br class="fancyvrb" /><a 
 id="x1-31128r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Bring</span><span 
class="pcrb7t-">&#x00A0;in</span><span 
class="pcrb7t-">&#x00A0;bugfix</span><span 
class="pcrb7t-">&#x00A0;from</span><span 
class="pcrb7t-">&#x00A0;stable</span><span 
class="pcrb7t-">&#x00A0;branch'</span>
<br class="fancyvrb" /><a 
 id="x1-31130r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-31132r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;This</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;fix</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;boring</span><span 
class="pcrr7tn-">&#x00A0;feature.</span>
<br class="fancyvrb" /><a 
 id="x1-31134r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;This</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;exciting</span><span 
class="pcrr7tn-">&#x00A0;and</span><span 
class="pcrr7tn-">&#x00A0;new!</span>
   </div>
<!--l. 196--><p class="noindent">The main branch will still contain changes that are not on the stable branch, but it will also contain all of the bugfixes from the
stable branch. The stable branch remains unaffected by these changes.
</p><!--l. 200--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2.5    </span> <a 
 id="x1-320002.2.5"></a>Feature branches</h4>
<!--l. 202--><p class="noindent">For larger projects, an effective way to manage change is to break up a team into smaller groups. Each group has a shared
branch of its own, cloned from a single &#x201C;master&#x201D; branch used by the entire project. People working on an individual branch are
typically quite isolated from developments on other branches.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-320011"></a>
                                                                                         
                                                                                         
<!--l. 210--><p class="noindent"><img 
src="feature-branches.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;2.1: </td><td  
class="content">Feature branches</td></tr></table><!--tex4ht:label?: x1-320011 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 215--><p class="indent">   When a particular feature is deemed to be in suitable shape, someone on that feature team pulls and merges from the master
branch into the feature branch, then pushes back up to the master branch.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2.6    </span> <a 
 id="x1-330002.2.6"></a>The release train</h4>
<!--l. 221--><p class="noindent">Some projects are organised on a &#x201C;train&#x201D; basis: a release is scheduled to happen every few months, and whatever features are
ready when the &#x201C;train&#x201D; is ready to leave are allowed in.
</p><!--l. 225--><p class="indent">   This model resembles working with feature branches. The difference is that when a feature branch misses a
train, someone on the feature team pulls and merges the changes that went out on that train release into the
feature branch, and the team continues its work on top of that release so that their feature can make the next
release.
</p><!--l. 231--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2.7    </span> <a 
 id="x1-340002.2.7"></a>The Linux kernel model</h4>
<!--l. 233--><p class="noindent">The development of the Linux kernel has a shallow hierarchical structure, surrounded by a cloud of apparent chaos. Because
most Linux developers use <a 
 id="dx1-34001"></a><span 
class="pcrr7tn-">git</span>, a distributed revision control tool with capabilities similar to Mercurial, it&#x2019;s useful
to describe the way work flows in that environment; if you like the ideas, the approach translates well across
tools.
</p><!--l. 240--><p class="indent">   At the center of the community sits Linus Torvalds, the creator of Linux. He publishes a single source repository that is
considered the &#x201C;authoritative&#x201D; current tree by the entire developer community. Anyone can clone Linus&#x2019;s tree, but he is very
choosy about whose trees he pulls from.
</p><!--l. 246--><p class="indent">   Linus has a number of &#x201C;trusted lieutenants&#x201D;. As a general rule, he pulls whatever changes they publish, in most cases
without even reviewing those changes. Some of those lieutenants are generally agreed to be &#x201C;maintainers&#x201D;, responsible for
specific subsystems within the kernel. If a random kernel hacker wants to make a change to a subsystem that they want to end
up in Linus&#x2019;s tree, they must find out who the subsystem&#x2019;s maintainer is, and ask that maintainer to take their
change. If the maintainer reviews their changes and agrees to take them, they&#x2019;ll pass them along to Linus in due
course.
</p><!--l. 256--><p class="indent">   Individual lieutenants have their own approaches to reviewing, accepting, and publishing changes; and for deciding when to
feed them to Linus. In addition, there are several well known branches that people use for different purposes. For example, a
few people maintain &#x201C;stable&#x201D; repositories of older versions of the kernel, to which they apply critical fixes as needed. Some
maintainers publish multiple trees: one for experimental changes; one for changes that they are about to feed upstream; and so
on. Others just publish a single tree.
</p><!--l. 266--><p class="indent">   This model has two notable features. The first is that it&#x2019;s &#x201C;pull only&#x201D;. You have to ask, convince, or beg another developer to
take a change from you, because there are almost no trees to which more than one person can push, and there&#x2019;s no way to push
changes into a tree that someone else controls.
</p><!--l. 272--><p class="indent">   The second is that it&#x2019;s based on reputation and acclaim. If you&#x2019;re an unknown, Linus will probably ignore changes from you
without even responding. But a subsystem maintainer will probably review them, and will likely take them if they pass their
criteria for suitability. The more &#x201C;good&#x201D; changes you contribute to a maintainer, the more likely they are to trust
your judgment and accept your changes. If you&#x2019;re well-known and maintain a long-lived branch for something
Linus hasn&#x2019;t yet accepted, people with similar interests may pull your changes regularly to keep up with your
work.
</p><!--l. 282--><p class="indent">   Reputation and acclaim don&#x2019;t necessarily cross subsystem or &#x201C;people&#x201D; boundaries. If you&#x2019;re a respected but specialised
storage hacker, and you try to fix a networking bug, that change will receive a level of scrutiny from a network maintainer
comparable to a change from a complete stranger.
</p><!--l. 288--><p class="indent">   To people who come from more orderly project backgrounds, the comparatively chaotic Linux kernel development process
often seems completely insane. It&#x2019;s subject to the whims of individuals; people make sweeping changes whenever they deem it
appropriate; and the pace of development is astounding. And yet Linux is a highly successful, well-regarded piece of
                                                                                         
                                                                                         
software.
</p><!--l. 295--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2.8    </span> <a 
 id="x1-350002.2.8"></a>Pull-only versus shared-push collaboration</h4>
<!--l. 297--><p class="noindent">A perpetual source of heat in the open source community is whether a development model in which people
only ever pull changes from others is &#x201C;better than&#x201D; one in which multiple people can push changes to a shared
repository.
</p><!--l. 302--><p class="indent">   Typically, the backers of the shared-push model use tools that actively enforce this approach. If you&#x2019;re using a centralised
revision control tool such as Subversion, there&#x2019;s no way to make a choice over which model you&#x2019;ll use: the tool gives you
shared-push, and if you want to do anything else, you&#x2019;ll have to roll your own approach on top (such as applying a patch by
hand).
</p><!--l. 309--><p class="indent">   A good distributed revision control tool, such as Mercurial, will support both models. You and your collaborators can then
structure how you work together based on your own needs and preferences, not on what contortions your tools force you
into.
</p><!--l. 314--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2.9    </span> <a 
 id="x1-360002.2.9"></a>Where collaboration meets branch management</h4>
<!--l. 316--><p class="noindent">Once you and your team set up some shared repositories and start propagating changes back and forth between local and shared
repos, you begin to face a related, but slightly different challenge: that of managing the multiple directions in which your team
may be moving at once. Even though this subject is intimately related to how your team collaborates, it&#x2019;s dense enough to merit
treatment of its own, in chapter&#x00A0;<a 
href="#x1-1570008">8<!--tex4ht:ref: chap:branch --></a>.
</p><!--l. 324--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">2.3    </span> <a 
 id="x1-370002.3"></a>The technical side of sharing</h3>
<!--l. 326--><p class="noindent">The remainder of this chapter is devoted to the question of serving data to your collaborators.
</p><!--l. 329--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">2.4    </span> <a 
 id="x1-380002.4"></a>Informal sharing with &#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D;</h3>
<!--l. 332--><p class="noindent">Mercurial&#x2019;s <a 
 id="dx1-38001"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; command is wonderfully suited to small, tight-knit, and fast-paced group environments. It also
provides a great way to get a feel for using Mercurial commands over a network.
</p><!--l. 336--><p class="indent">   Run <a 
 id="dx1-38002"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; inside a repository, and in under a second it will bring up a specialised HTTP server; this will accept
connections from any client, and serve up data for that repository until you terminate it. Anyone who knows the URL of the
server you just started, and can talk to your computer over the network, can then use a web browser or Mercurial to read data
from that repository. A URL for a <a 
 id="dx1-38003"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; instance running on a laptop is likely to look something like
<span class="verb"><span 
class="pcrr7tn-">http://my-laptop.local:8000/</span></span>.
</p><!--l. 345--><p class="indent">   The <a 
 id="dx1-38004"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; command is <span 
class="ptmri7t-">not </span>a general-purpose web server. It can do only two things: </p>
     <ul><li><span class="dt">
     </span><span class="dd">Allow people to browse the history of the repository it&#x2019;s serving, from their normal web browsers.
     </span><li><span class="dt">
     </span><span class="dd">Speak Mercurial&#x2019;s wire protocol, so that people can <a 
 id="dx1-38005"></a>&#x201C;<span 
class="pcrr7tn-">hg clone</span>&#x201D; or <a 
 id="dx1-38006"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; changes from that repository.</li></ul>
                                                                                         
                                                                                         
<!--l. 353--><p class="noindent">In particular, <a 
 id="dx1-38007"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; won&#x2019;t allow remote users to <span 
class="ptmri7t-">modify </span>your repository. It&#x2019;s intended for read-only use.
</p><!--l. 356--><p class="indent">   If you&#x2019;re getting started with Mercurial, there&#x2019;s nothing to prevent you from using <a 
 id="dx1-38008"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; to serve up a repository on
your own computer, then use commands like <a 
 id="dx1-38009"></a>&#x201C;<span 
class="pcrr7tn-">hg clone</span>&#x201D;, <a 
 id="dx1-38010"></a>&#x201C;<span 
class="pcrr7tn-">hg incoming</span>&#x201D;, and so on to talk to that server as if the repository
was hosted remotely. This can help you to quickly get acquainted with using commands on network-hosted
repositories.
</p><!--l. 363--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.4.1    </span> <a 
 id="x1-390002.4.1"></a>A few things to keep in mind</h4>
<!--l. 365--><p class="noindent">Because it provides unauthenticated read access to all clients, you should only use <a 
 id="dx1-39001"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; in an environment where
you either don&#x2019;t care, or have complete control over, who can access your network and pull data from your
repository.
</p><!--l. 370--><p class="indent">   The <a 
 id="dx1-39002"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; command knows nothing about any firewall software you might have installed on your system or network.
It cannot detect or control your firewall software. If other people are unable to talk to a running <a 
 id="dx1-39003"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; instance, the
second thing you should do (<span 
class="ptmri7t-">after </span>you make sure that they&#x2019;re using the correct URL) is check your firewall
configuration.
</p><!--l. 377--><p class="indent">   By default, <a 
 id="dx1-39004"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; listens for incoming connections on port&#x00A0;8000. If another process is already listening on the port
you want to use, you can specify a different port to listen on using the <a 
 id="dx1-39005"></a><span 
class="pcrr7tn-">-p </span>option.
</p><!--l. 382--><p class="indent">   Normally, when <a 
 id="dx1-39006"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; starts, it prints no output, which can be a bit unnerving. If you&#x2019;d like to confirm that it is
indeed running correctly, and find out what URL you should send to your collaborators, start it with the <a 
 id="dx1-39007"></a><span 
class="pcrr7tn-">-v</span>
option.
</p><!--l. 387--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">2.5    </span> <a 
 id="x1-400002.5"></a>Using the Secure Shell (ssh) protocol</h3>
<!--l. 390--><p class="noindent">You can pull and push changes securely over a network connection using the Secure Shell (<span 
class="pcrr7tn-">ssh</span>) protocol. To use this
successfully, you may have to do a little bit of configuration on the client or server sides.
</p><!--l. 395--><p class="indent">   If you&#x2019;re not familiar with ssh, it&#x2019;s a network protocol that lets you securely communicate with another computer. To use it
with Mercurial, you&#x2019;ll be setting up one or more user accounts on a server so that remote users can log in and execute
commands.
</p><!--l. 400--><p class="indent">   (If you <span 
class="ptmri7t-">are </span>familiar with ssh, you&#x2019;ll probably find some of the material that follows to be elementary in
nature.)
</p><!--l. 403--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.5.1    </span> <a 
 id="x1-410002.5.1"></a>How to read and write ssh URLs</h4>
<!--l. 405--><p class="noindent">An ssh URL tends to look like this:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-41002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;ssh://bos@hg.serpentine.com:22/hg/hgbook</span>
   </div>
<!--l. 410--><p class="noindent">
     </p><ol  class="enumerate1" >
     <li class="enumerate"><a 
 id="x1-41004x1"></a>The &#x201C;<span 
class="pcrr7tn-">ssh://</span>&#x201D; part tells Mercurial to use the ssh protocol.
                                                                                         
                                                                                         
     </li>
     <li class="enumerate"><a 
 id="x1-41006x2"></a>The &#x201C;<span 
class="pcrr7tn-">bos@</span>&#x201D; component indicates what username to log into the server as. You can leave this out if the remote
     username is the same as your local username.
     </li>
     <li class="enumerate"><a 
 id="x1-41008x3"></a>The &#x201C;<span 
class="pcrr7tn-">hg.serpentine.com</span>&#x201D; gives the hostname of the server to log into.
     </li>
     <li class="enumerate"><a 
 id="x1-41010x4"></a>The &#x201C;:22&#x201D; identifies the port number to connect to the server on. The default port is&#x00A0;22, so you only need to
     specify this part if you&#x2019;re <span 
class="ptmri7t-">not </span>using port&#x00A0;22.
     </li>
     <li class="enumerate"><a 
 id="x1-41012x5"></a>The remainder of the URL is the local path to the repository on the server.</li></ol>
<!--l. 424--><p class="indent">   There&#x2019;s plenty of scope for confusion with the path component of ssh URLs, as there is no standard way for tools to
interpret it. Some programs behave differently than others when dealing with these paths. This isn&#x2019;t an ideal situation, but it&#x2019;s
unlikely to change. Please read the following paragraphs carefully.
</p><!--l. 430--><p class="indent">   Mercurial treats the path to a repository on the server as relative to the remote user&#x2019;s home directory. For example, if user
<span 
class="pcrr7tn-">foo </span>on the server has a home directory of <span 
class="pcrr7tn-">/home/foo</span>, then an ssh URL that contains a path component of <span 
class="pcrr7tn-">bar </span><span 
class="ptmri7t-">really </span>refers to
the directory <span 
class="pcrr7tn-">/home/foo/bar</span>.
</p><!--l. 436--><p class="indent">   If you want to specify a path relative to another user&#x2019;s home directory, you can use a path that starts with a tilde character
followed by the user&#x2019;s name (let&#x2019;s call them <span 
class="pcrr7tn-">otheruser</span>), like this.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-41014r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;ssh://server/~otheruser/hg/repo</span>
   </div>
<!--l. 444--><p class="indent">   And if you really want to specify an <span 
class="ptmri7t-">absolute </span>path on the server, begin the path component with two slashes, as in this
example.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-41016r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;ssh://server//absolute/path</span>
   </div>
<!--l. 450--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.5.2    </span> <a 
 id="x1-420002.5.2"></a>Finding an ssh client for your system</h4>
<!--l. 452--><p class="noindent">Almost every Unix-like system comes with OpenSSH preinstalled. If you&#x2019;re using such a system, run <span class="verb"><span 
class="pcrr7tn-">which</span><span 
class="pcrr7tn-">&#x00A0;ssh</span></span> to find out if
the <a 
 id="dx1-42001"></a><span 
class="pcrr7tn-">ssh </span>command is installed (it&#x2019;s usually in <span 
class="pcrr7tn-">/usr/bin</span>). In the unlikely event that it isn&#x2019;t present, take a look at your system
documentation to figure out how to install it.
</p><!--l. 459--><p class="indent">   On Windows, you&#x2019;ll first need to choose download a suitable ssh client. There are two alternatives. </p>
     <ul><li><span class="dt">
     </span><span class="dd">Simon Tatham&#x2019;s excellent PuTTY package&#x00A0;<span class="cite">[<span 
class="ptmb7t-">?</span>]</span> provides a complete suite of ssh client commands.
     </span><li><span class="dt">
     </span><span class="dd">If you have a high tolerance for pain, you can use the Cygwin port of OpenSSH.</li></ul>
<!--l. 467--><p class="noindent">In either case, you&#x2019;ll need to edit your <a 
 id="dx1-42002"></a><a 
 id="dx1-42003"></a><span 
class="pcrr7tn-">Mercurial.ini</span>&#x00A0;file to tell Mercurial where to find the actual client command. For example,
if you&#x2019;re using PuTTY, you&#x2019;ll need to use the <a 
 id="dx1-42004"></a><span 
class="pcrr7tn-">plink </span>command as a command-line ssh client.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-42006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[ui]</span>
<br class="fancyvrb" /><a 
 id="x1-42008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;ssh</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;C:/path/to/plink.exe</span><span 
class="pcrr7tn-">&#x00A0;-ssh</span><span 
class="pcrr7tn-">&#x00A0;-i</span><span 
class="pcrr7tn-">&#x00A0;"C:/path/to/my/private/key"</span>
   </div>
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:  </span>The path to <span 
class="pcrr7tn-">plink </span>shouldn&#x2019;t contain any whitespace characters, or Mercurial
may not be able to run it correctly (so putting it in <span 
class="pcrr7tn-">C:</span>
<span 
class="pcrr7tn-">Program Files </span>is probably not a good idea).                                                          </div>
<!--l. 483--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.5.3    </span> <a 
 id="x1-430002.5.3"></a>Generating a key pair</h4>
<!--l. 485--><p class="noindent">To avoid the need to repetitively type a password every time you need to use your ssh client, I recommend generating a key pair.
On a Unix-like system, the <a 
 id="dx1-43001"></a><span 
class="pcrr7tn-">ssh-keygen </span>command will do the trick. On Windows, if you&#x2019;re using PuTTY, the <a 
 id="dx1-43002"></a><span 
class="pcrr7tn-">puttygen</span>
command is what you&#x2019;ll need.
</p><!--l. 491--><p class="indent">   When you generate a key pair, it&#x2019;s usually <span 
class="ptmri7t-">highly </span>advisable to protect it with a passphrase. (The only time that you might
not want to do this id when you&#x2019;re using the ssh protocol for automated tasks on a secure network.)
</p><!--l. 496--><p class="indent">   Simply generating a key pair isn&#x2019;t enough, however. You&#x2019;ll need to add the public key to the set of authorised keys for
whatever user you&#x2019;re logging in remotely as. For servers using OpenSSH (the vast majority), this will mean adding the public
key to a list in a file called <a 
 id="dx1-43003"></a><span 
class="pcrr7tn-">authorized</span><span 
class="pcrr7tn-">_keys </span>in their <a 
 id="dx1-43004"></a><span 
class="pcrr7tn-">.ssh </span>directory.
</p><!--l. 503--><p class="indent">   On a Unix-like system, your public key will have a <span 
class="pcrr7tn-">.pub </span>extension. If you&#x2019;re using <a 
 id="dx1-43005"></a><span 
class="pcrr7tn-">puttygen </span>on Windows, you can save
the public key to a file of your choosing, or paste it from the window it&#x2019;s displayed in straight into the <a 
 id="dx1-43006"></a><span 
class="pcrr7tn-">authorized</span><span 
class="pcrr7tn-">_keys</span>
file.
</p><!--l. 509--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.5.4    </span> <a 
 id="x1-440002.5.4"></a>Using an authentication agent</h4>
<!--l. 511--><p class="noindent">An authentication agent is a daemon that stores passphrases in memory (so it will forget passphrases if you
log out and log back in again). An ssh client will notice if it&#x2019;s running, and query it for a passphrase. If there&#x2019;s
no authentication agent running, or the agent doesn&#x2019;t store the necessary passphrase, you&#x2019;ll have to type your
passphrase every time Mercurial tries to communicate with a server on your behalf (e.g.&#x00A0;whenever you pull or push
changes).
</p><!--l. 519--><p class="indent">   The downside of storing passphrases in an agent is that it&#x2019;s possible for a well-prepared attacker to recover the plain text of
your passphrases, in some cases even if your system has been power-cycled. You should make your own judgment as to
whether this is an acceptable risk. It certainly saves a lot of repeated typing.
</p><!--l. 525--><p class="indent">   On Unix-like systems, the agent is called <a 
 id="dx1-44001"></a><span 
class="pcrr7tn-">ssh-agent</span>, and it&#x2019;s often run automatically for you when you log in. You&#x2019;ll need
to use the <a 
 id="dx1-44002"></a><span 
class="pcrr7tn-">ssh-add </span>command to add passphrases to the agent&#x2019;s store. On Windows, if you&#x2019;re using PuTTY,
the <a 
 id="dx1-44003"></a><span 
class="pcrr7tn-">pageant </span>command acts as the agent. It adds an icon to your system tray that will let you manage stored
passphrases.
</p><!--l. 532--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.5.5    </span> <a 
 id="x1-450002.5.5"></a>Configuring the server side properly</h4>
<!--l. 534--><p class="noindent">Because ssh can be fiddly to set up if you&#x2019;re new to it, there&#x2019;s a variety of things that can go wrong. Add Mercurial on top, and
there&#x2019;s plenty more scope for head-scratching. Most of these potential problems occur on the server side, not the
client side. The good news is that once you&#x2019;ve gotten a configuration working, it will usually continue to work
indefinitely.
                                                                                         
                                                                                         
</p><!--l. 541--><p class="indent">   Before you try using Mercurial to talk to an ssh server, it&#x2019;s best to make sure that you can use the normal <a 
 id="dx1-45001"></a><span 
class="pcrr7tn-">ssh </span>or <a 
 id="dx1-45002"></a><span 
class="pcrr7tn-">putty</span>
command to talk to the server first. If you run into problems with using these commands directly, Mercurial surely won&#x2019;t work.
Worse, it will obscure the underlying problem. Any time you want to debug ssh-related Mercurial problems, you should drop
back to making sure that plain ssh client commands work first, <span 
class="ptmri7t-">before </span>you worry about whether there&#x2019;s a problem with
Mercurial.
</p><!--l. 550--><p class="indent">   The first thing to be sure of on the server side is that you can actually log in from another machine at all. If you can&#x2019;t use
<a 
 id="dx1-45003"></a><span 
class="pcrr7tn-">ssh </span>or <a 
 id="dx1-45004"></a><span 
class="pcrr7tn-">putty </span>to log in, the error message you get may give you a few hints as to what&#x2019;s wrong. The most common problems are
as follows. </p>
     <ul><li><span class="dt">
     </span><span class="dd">If you get a &#x201C;connection refused&#x201D; error, either there isn&#x2019;t an SSH daemon running on the server at all, or it&#x2019;s
     inaccessible due to firewall configuration.
     </span><li><span class="dt">
     </span><span class="dd">If you get a &#x201C;no route to host&#x201D; error, you either have an incorrect address for the server or a seriously locked
     down firewall that won&#x2019;t admit its existence at all.
     </span><li><span class="dt">
     </span><span class="dd">If you get a &#x201C;permission denied&#x201D; error, you may have mistyped the username on the server, or you could have
     mistyped your key&#x2019;s passphrase or the remote user&#x2019;s password.</li></ul>
<!--l. 566--><p class="noindent">In summary, if you&#x2019;re having trouble talking to the server&#x2019;s ssh daemon, first make sure that one is running at all. On many
systems it will be installed, but disabled, by default. Once you&#x2019;re done with this step, you should then check that
the server&#x2019;s firewall is configured to allow incoming connections on the port the ssh daemon is listening on
(usually&#x00A0;22). Don&#x2019;t worry about more exotic possibilities for misconfiguration until you&#x2019;ve checked these two
first.
</p><!--l. 575--><p class="indent">   If you&#x2019;re using an authentication agent on the client side to store passphrases for your keys, you ought to be able to log into
the server without being prompted for a passphrase or a password. If you&#x2019;re prompted for a passphrase, there are a few possible
culprits. </p>
     <ul><li><span class="dt">
     </span><span class="dd">You might have forgotten to use <a 
 id="dx1-45005"></a><span 
class="pcrr7tn-">ssh-add </span>or <a 
 id="dx1-45006"></a><span 
class="pcrr7tn-">pageant </span>to store the passphrase.
     </span><li><span class="dt">
     </span><span class="dd">You might have stored the passphrase for the wrong key.</li></ul>
<!--l. 584--><p class="noindent">If you&#x2019;re being prompted for the remote user&#x2019;s password, there are another few possible problems to check. </p>
     <ul><li><span class="dt">
     </span><span class="dd">Either the user&#x2019;s home directory or their <a 
 id="dx1-45007"></a><span 
class="pcrr7tn-">.ssh </span>directory might have excessively liberal permissions. As a result,
     the ssh daemon will not trust or read their <a 
 id="dx1-45008"></a><span 
class="pcrr7tn-">authorized</span><span 
class="pcrr7tn-">_keys </span>file. For example, a group-writable home or <a 
 id="dx1-45009"></a><span 
class="pcrr7tn-">.ssh</span>
     directory will often cause this symptom.
     </span><li><span class="dt">
     </span><span class="dd">The user&#x2019;s <a 
 id="dx1-45010"></a><span 
class="pcrr7tn-">authorized</span><span 
class="pcrr7tn-">_keys </span>file may have a problem. If anyone other than the user owns or can write to that
     file, the ssh daemon will not trust or read it.</li></ul>
<!--l. 597--><p class="indent">   In the ideal world, you should be able to run the following command successfully, and it should print exactly one line of
output, the current date and time.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-45012r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;ssh</span><span 
class="pcrr7tn-">&#x00A0;myserver</span><span 
class="pcrr7tn-">&#x00A0;date</span>
   </div>
                                                                                         
                                                                                         
<!--l. 604--><p class="indent">   If, on your server, you have login scripts that print banners or other junk even when running non-interactive commands like
this, you should fix them before you continue, so that they only print output if they&#x2019;re run interactively. Otherwise these banners
will at least clutter up Mercurial&#x2019;s output. Worse, they could potentially cause problems with running Mercurial commands
remotely. Mercurial makes tries to detect and ignore banners in non-interactive <a 
 id="dx1-45013"></a><span 
class="pcrr7tn-">ssh </span>sessions, but it is not foolproof. (If you&#x2019;re
editing your login scripts on your server, the usual way to see if a login script is running in an interactive shell is to check the
return code from the command <span class="verb"><span 
class="pcrr7tn-">tty</span><span 
class="pcrr7tn-">&#x00A0;-s</span></span>.)
</p><!--l. 616--><p class="indent">   Once you&#x2019;ve verified that plain old ssh is working with your server, the next step is to ensure that Mercurial runs on the
server. The following command should run successfully:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-45015r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;ssh</span><span 
class="pcrr7tn-">&#x00A0;myserver</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;version</span>
   </div>
<!--l. 622--><p class="noindent">If you see an error message instead of normal <a 
 id="dx1-45016"></a>&#x201C;<span 
class="pcrr7tn-">hg version</span>&#x201D; output, this is usually because you haven&#x2019;t installed Mercurial to
<span 
class="pcrr7tn-">/usr/bin</span>. Don&#x2019;t worry if this is the case; you don&#x2019;t need to do that. But you should check for a few possible problems.
</p>
     <ul><li><span class="dt">
     </span><span class="dd">Is Mercurial really installed on the server at all? I know this sounds trivial, but it&#x2019;s worth checking!
     </span><li><span class="dt">
     </span><span class="dd">Maybe your shell&#x2019;s search path (usually set via the <a 
 id="dx1-45017"></a><a 
 id="dx1-45018"></a><span 
class="pcrr7tn-">PATH </span>environment variable) is simply misconfigured.
     </span><li><span class="dt">
     </span><span class="dd">Perhaps your <a 
 id="dx1-45019"></a><a 
 id="dx1-45020"></a><span 
class="pcrr7tn-">PATH </span>environment variable is only being set to point to the location of the <a 
 id="dx1-45021"></a><span 
class="pcrr7tn-">hg </span>executable if the
     login session is interactive. This can happen if you&#x2019;re setting the path in the wrong shell login script. See your
     shell&#x2019;s documentation for details.
     </span><li><span class="dt">
     </span><span class="dd">The <a 
 id="dx1-45022"></a><a 
 id="dx1-45023"></a><span 
class="pcrr7tn-">PYTHONPATH </span>environment variable may need to contain the path to the Mercurial Python modules. It might
     not be set at all; it could be incorrect; or it may be set only if the login is interactive.</li></ul>
<!--l. 642--><p class="indent">   If you can run <a 
 id="dx1-45024"></a>&#x201C;<span 
class="pcrr7tn-">hg version</span>&#x201D; over an ssh connection, well done! You&#x2019;ve got the server and client sorted out. You
should now be able to use Mercurial to access repositories hosted by that username on that server. If you run into
problems with Mercurial and ssh at this point, try using the <a 
 id="dx1-45025"></a><span 
class="pcrr7tn-">--debug </span>option to get a clearer picture of what&#x2019;s going
on.
</p><!--l. 649--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.5.6    </span> <a 
 id="x1-460002.5.6"></a>Using compression with ssh</h4>
<!--l. 651--><p class="noindent">Mercurial does not compress data when it uses the ssh protocol, because the ssh protocol can transparently compress data.
However, the default behaviour of ssh clients is <span 
class="ptmri7t-">not </span>to request compression.
</p><!--l. 656--><p class="indent">   Over any network other than a fast LAN (even a wireless network), using compression is likely to significantly speed up
Mercurial&#x2019;s network operations. For example, over a WAN, someone measured compression as reducing the amount of time
required to clone a particularly large repository from&#x00A0;51 minutes to&#x00A0;17 minutes.
</p><!--l. 662--><p class="indent">   Both <a 
 id="dx1-46001"></a><span 
class="pcrr7tn-">ssh </span>and <a 
 id="dx1-46002"></a><span 
class="pcrr7tn-">plink </span>accept a <a 
 id="dx1-46003"></a><span 
class="pcrr7tn-">-C </span>option which turns on compression. You can easily edit your <a 
 id="dx1-46004"></a><a 
 id="dx1-46005"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;to enable compression
for all of Mercurial&#x2019;s uses of the ssh protocol.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-46007r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[ui]</span>
<br class="fancyvrb" /><a 
 id="x1-46009r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;ssh</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;ssh</span><span 
class="pcrr7tn-">&#x00A0;-C</span>
   </div>
                                                                                         
                                                                                         
<!--l. 670--><p class="indent">   If you use <a 
 id="dx1-46010"></a><span 
class="pcrr7tn-">ssh</span>, you can configure it to always use compression when talking to your server. To do this, edit your
<a 
 id="dx1-46011"></a><span 
class="pcrr7tn-">.ssh/config </span>file (which may not yet exist), as follows.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-46013r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Host</span><span 
class="pcrr7tn-">&#x00A0;hg</span>
<br class="fancyvrb" /><a 
 id="x1-46015r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Compression</span><span 
class="pcrr7tn-">&#x00A0;yes</span>
<br class="fancyvrb" /><a 
 id="x1-46017r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;HostName</span><span 
class="pcrr7tn-">&#x00A0;hg.example.com</span>
   </div>
<!--l. 678--><p class="noindent">This defines an alias, <span 
class="pcrr7tn-">hg</span>. When you use it on the <a 
 id="dx1-46018"></a><span 
class="pcrr7tn-">ssh </span>command line or in a Mercurial <span 
class="pcrr7tn-">ssh</span>-protocol URL, it will cause <a 
 id="dx1-46019"></a><span 
class="pcrr7tn-">ssh </span>to
connect to <span 
class="pcrr7tn-">hg.example.com </span>and use compression. This gives you both a shorter name to type and compression, each of which
is a good thing in its own right.
</p><!--l. 684--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">2.6    </span> <a 
 id="x1-470002.6"></a>Serving over HTTP using CGI</h3>
<!--l. 687--><p class="noindent">Depending on how ambitious you are, configuring Mercurial&#x2019;s CGI interface can take anything from a few moments to several
hours.
</p><!--l. 690--><p class="indent">   We&#x2019;ll begin with the simplest of examples, and work our way towards a more complex configuration. Even for the most
basic case, you&#x2019;re almost certainly going to need to read and modify your web server&#x2019;s configuration.
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:  </span>Configuring a web server is a complex, fiddly, and highly system-dependent
activity. I can&#x2019;t possibly give you instructions that will cover anything like all of
the cases you will encounter. Please use your discretion and judgment in following
the sections below. Be prepared to make plenty of mistakes, and to spend a lot of
time reading your server&#x2019;s error logs.                                                                        </div>
<!--l. 704--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.6.1    </span> <a 
 id="x1-480002.6.1"></a>Web server configuration checklist</h4>
<!--l. 706--><p class="noindent">Before you continue, do take a few moments to check a few aspects of your system&#x2019;s setup.
</p><!--l. 710--><p class="indent">
     </p><ol  class="enumerate1" >
     <li class="enumerate"><a 
 id="x1-48002x1"></a>Do you have a web server installed at all? Mac OS X ships with Apache, but many other systems may not have
     a web server installed.
     </li>
     <li class="enumerate"><a 
 id="x1-48004x2"></a>If you have a web server installed, is it actually running? On most systems, even if one is present, it will be
     disabled by default.
     </li>
     <li class="enumerate"><a 
 id="x1-48006x3"></a>Is your server configured to allow you to run CGI programs in the directory where you plan to do so? Most
     servers default to explicitly disabling the ability to run CGI programs.</li></ol>
<!--l. 720--><p class="indent">   If you don&#x2019;t have a web server installed, and don&#x2019;t have substantial experience configuring Apache, you should consider
using the <span 
class="pcrr7tn-">lighttpd </span>web server instead of Apache. Apache has a well-deserved reputation for baroque and confusing
configuration. While <span 
class="pcrr7tn-">lighttpd </span>is less capable in some ways than Apache, most of these capabilities are not
relevant to serving Mercurial repositories. And <span 
class="pcrr7tn-">lighttpd </span>is undeniably <span 
class="ptmri7t-">much </span>easier to get started with than
Apache.
                                                                                         
                                                                                         
</p><!--l. 729--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.6.2    </span> <a 
 id="x1-490002.6.2"></a>Basic CGI configuration</h4>
<!--l. 731--><p class="noindent">On Unix-like systems, it&#x2019;s common for users to have a subdirectory named something like <span 
class="pcrr7tn-">public</span><span 
class="pcrr7tn-">_html </span>in their home
directory, from which they can serve up web pages. A file named <span 
class="pcrr7tn-">foo </span>in this directory will be accessible at a URL of the form
<span 
class="pcrr7tn-">http://www.example.com/</span><span 
class="pcrr7tn-">&#x0169;sername/foo</span>.
</p><!--l. 737--><p class="indent">   To get started, find the <a 
 id="dx1-49001"></a><span 
class="pcrr7tn-">hgweb.cgi </span>script that should be present in your Mercurial installation. If you can&#x2019;t
quickly find a local copy on your system, simply download one from the master Mercurial repository at
<a 
href="http://www.selenic.com/repo/hg/raw-file/tip/hgweb.cgi" class="url" ><span 
class="pcrr7tn-">http://www.selenic.com/repo/hg/raw-file/tip/hgweb.cgi</span></a>.
</p><!--l. 743--><p class="indent">   You&#x2019;ll need to copy this script into your <span 
class="pcrr7tn-">public</span><span 
class="pcrr7tn-">_html </span>directory, and ensure that it&#x2019;s executable.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-49003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cp</span><span 
class="pcrr7tn-">&#x00A0;.../hgweb.cgi</span><span 
class="pcrr7tn-">&#x00A0;~/public_html</span>
<br class="fancyvrb" /><a 
 id="x1-49005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;chmod</span><span 
class="pcrr7tn-">&#x00A0;755</span><span 
class="pcrr7tn-">&#x00A0;~/public_html/hgweb.cgi</span>
   </div>
<!--l. 749--><p class="noindent">The <span 
class="pcrr7tn-">755 </span>argument to <a 
 id="dx1-49006"></a><span 
class="pcrr7tn-">chmod </span>is a little more general than just making the script executable: it ensures that the script is executable by
anyone, and that &#x201C;group&#x201D; and &#x201C;other&#x201D; write permissions are <span 
class="ptmri7t-">not </span>set. If you were to leave those write permissions enabled,
Apache&#x2019;s <span 
class="pcrr7tn-">suexec </span>subsystem would likely refuse to execute the script. In fact, <span 
class="pcrr7tn-">suexec </span>also insists that the <span 
class="ptmri7t-">directory </span>in which the
script resides must not be writable by others.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-49008r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;chmod</span><span 
class="pcrr7tn-">&#x00A0;755</span><span 
class="pcrr7tn-">&#x00A0;~/public_html</span>
   </div>
<!--l. 761--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-500002.6.2"></a>What could <span 
class="ptmri7t-">possibly </span>go wrong?</h5>
<!--l. 764--><p class="noindent">Once you&#x2019;ve copied the CGI script into place, go into a web browser, and try to open the URL
<a 
href="http://myhostname/~myuser/hgweb.cgi" class="url" ><span 
class="pcrr7tn-">http://myhostname/~myuser/hgweb.cgi</span></a>, <span 
class="ptmri7t-">but </span>brace yourself for instant failure. There&#x2019;s a high probability that trying to visit
this URL will fail, and there are many possible reasons for this. In fact, you&#x2019;re likely to stumble over almost every one of the
possible errors below, so please read carefully. The following are all of the problems I ran into on a system
running Fedora&#x00A0;7, with a fresh installation of Apache, and a user account that I created specially to perform this
exercise.
</p><!--l. 774--><p class="indent">   Your web server may have per-user directories disabled. If you&#x2019;re using Apache, search your config file for a <span 
class="pcrr7tn-">UserDir</span>
directive. If there&#x2019;s none present, per-user directories will be disabled. If one exists, but its value is <span 
class="pcrr7tn-">disabled</span>, then per-user
directories will be disabled. Otherwise, the string after <span 
class="pcrr7tn-">UserDir </span>gives the name of the subdirectory that Apache will look in
under your home directory, for example <span 
class="pcrr7tn-">public</span><span 
class="pcrr7tn-">_html</span>.
</p><!--l. 782--><p class="indent">   Your file access permissions may be too restrictive. The web server must be able to traverse your home directory and
directories under your <span 
class="pcrr7tn-">public</span><span 
class="pcrr7tn-">_html </span>directory, and read files under the latter too. Here&#x2019;s a quick recipe to help you to make
your permissions more appropriate.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-50002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;chmod</span><span 
class="pcrr7tn-">&#x00A0;755</span><span 
class="pcrr7tn-">&#x00A0;~</span>
<br class="fancyvrb" /><a 
 id="x1-50004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;find</span><span 
class="pcrr7tn-">&#x00A0;~/public_html</span><span 
class="pcrr7tn-">&#x00A0;-type</span><span 
class="pcrr7tn-">&#x00A0;d</span><span 
class="pcrr7tn-">&#x00A0;-print0</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;xargs</span><span 
class="pcrr7tn-">&#x00A0;-0r</span><span 
class="pcrr7tn-">&#x00A0;chmod</span><span 
class="pcrr7tn-">&#x00A0;755</span>
<br class="fancyvrb" /><a 
 id="x1-50006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;find</span><span 
class="pcrr7tn-">&#x00A0;~/public_html</span><span 
class="pcrr7tn-">&#x00A0;-type</span><span 
class="pcrr7tn-">&#x00A0;f</span><span 
class="pcrr7tn-">&#x00A0;-print0</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;xargs</span><span 
class="pcrr7tn-">&#x00A0;-0r</span><span 
class="pcrr7tn-">&#x00A0;chmod</span><span 
class="pcrr7tn-">&#x00A0;644</span>
   </div>
                                                                                         
                                                                                         
<!--l. 793--><p class="indent">   The other possibility with permissions is that you might get a completely empty window when you try to load the script. In
this case, it&#x2019;s likely that your access permissions are <span 
class="ptmri7t-">too permissive</span>. Apache&#x2019;s <span 
class="pcrr7tn-">suexec </span>subsystem won&#x2019;t execute a script that&#x2019;s
group-&#x00A0;or world-writable, for example.
</p><!--l. 799--><p class="indent">   Your web server may be configured to disallow execution of CGI programs in your per-user web directory. Here&#x2019;s Apache&#x2019;s
default per-user configuration from my Fedora system.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-50008r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;Directory</span><span 
class="pcrr7tn-">&#x00A0;/home/&#x22C6;/public_html&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-50010r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;AllowOverride</span><span 
class="pcrr7tn-">&#x00A0;FileInfo</span><span 
class="pcrr7tn-">&#x00A0;AuthConfig</span><span 
class="pcrr7tn-">&#x00A0;Limit</span>
<br class="fancyvrb" /><a 
 id="x1-50012r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Options</span><span 
class="pcrr7tn-">&#x00A0;MultiViews</span><span 
class="pcrr7tn-">&#x00A0;Indexes</span><span 
class="pcrr7tn-">&#x00A0;SymLinksIfOwnerMatch</span><span 
class="pcrr7tn-">&#x00A0;IncludesNoExec</span>
<br class="fancyvrb" /><a 
 id="x1-50014r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;Limit</span><span 
class="pcrr7tn-">&#x00A0;GET</span><span 
class="pcrr7tn-">&#x00A0;POST</span><span 
class="pcrr7tn-">&#x00A0;OPTIONS&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-50016r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Order</span><span 
class="pcrr7tn-">&#x00A0;allow,deny</span>
<br class="fancyvrb" /><a 
 id="x1-50018r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Allow</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;all</span>
<br class="fancyvrb" /><a 
 id="x1-50020r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;/Limit&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-50022r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;LimitExcept</span><span 
class="pcrr7tn-">&#x00A0;GET</span><span 
class="pcrr7tn-">&#x00A0;POST</span><span 
class="pcrr7tn-">&#x00A0;OPTIONS&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-50024r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Order</span><span 
class="pcrr7tn-">&#x00A0;deny,allow</span>
<br class="fancyvrb" /><a 
 id="x1-50026r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Deny</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;all</span>
<br class="fancyvrb" /><a 
 id="x1-50028r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;/LimitExcept&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-50030r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;/Directory&#x003e;</span>
   </div>
<!--l. 816--><p class="noindent">If you find a similar-looking <span 
class="pcrr7tn-">Directory </span>group in your Apache configuration, the directive to look at inside it is <span 
class="pcrr7tn-">Options</span>. Add
<span 
class="pcrr7tn-">ExecCGI </span>to the end of this list if it&#x2019;s missing, and restart the web server.
</p><!--l. 821--><p class="indent">   If you find that Apache serves you the text of the CGI script instead of executing it, you may need to either uncomment (if
already present) or add a directive like this.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-50032r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;AddHandler</span><span 
class="pcrr7tn-">&#x00A0;cgi-script</span><span 
class="pcrr7tn-">&#x00A0;.cgi</span>
   </div>
<!--l. 828--><p class="indent">   The next possibility is that you might be served with a colourful Python backtrace claiming that it can&#x2019;t import a
<span 
class="pcrr7tn-">mercurial</span>-related module. This is actually progress! The server is now capable of executing your CGI script. This error is
only likely to occur if you&#x2019;re running a private installation of Mercurial, instead of a system-wide version. Remember that the
web server runs the CGI program without any of the environment variables that you take for granted in an interactive session. If
this error happens to you, edit your copy of <a 
 id="dx1-50033"></a><span 
class="pcrr7tn-">hgweb.cgi </span>and follow the directions inside it to correctly set your <a 
 id="dx1-50034"></a><a 
 id="dx1-50035"></a><span 
class="pcrr7tn-">PYTHONPATH</span>
environment variable.
</p><!--l. 840--><p class="indent">   Finally, you are <span 
class="ptmri7t-">certain </span>to by served with another colourful Python backtrace: this one will complain that it can&#x2019;t find
<span 
class="pcrr7tn-">/path/to/repository</span>. Edit your <a 
 id="dx1-50036"></a><span 
class="pcrr7tn-">hgweb.cgi </span>script and replace the <span 
class="pcrr7tn-">/path/to/repository </span>string with the complete path to
the repository you want to serve up.
</p><!--l. 846--><p class="indent">   At this point, when you try to reload the page, you should be presented with a nice HTML view of your repository&#x2019;s history.
Whew!
</p><!--l. 849--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-510002.6.2"></a>Configuring lighttpd</h5>
<!--l. 851--><p class="noindent">To be exhaustive in my experiments, I tried configuring the increasingly popular <span 
class="pcrr7tn-">lighttpd </span>web server to serve the same
repository as I described with Apache above. I had already overcome all of the problems I outlined with Apache, many of
which are not server-specific. As a result, I was fairly sure that my file and directory permissions were good, and that my
<a 
 id="dx1-51001"></a><span 
class="pcrr7tn-">hgweb.cgi </span>script was properly edited.
                                                                                         
                                                                                         
</p><!--l. 859--><p class="indent">   Once I had Apache running, getting <span 
class="pcrr7tn-">lighttpd </span>to serve the repository was a snap (in other words, even if you&#x2019;re trying to
use <span 
class="pcrr7tn-">lighttpd</span>, you should read the Apache section). I first had to edit the <span 
class="pcrr7tn-">mod</span><span 
class="pcrr7tn-">_access </span>section of its config file to enable
<span 
class="pcrr7tn-">mod</span><span 
class="pcrr7tn-">_cgi </span>and <span 
class="pcrr7tn-">mod</span><span 
class="pcrr7tn-">_userdir</span>, both of which were disabled by default on my system. I then added a few lines to the end of the
config file, to configure these modules.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-51003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;userdir.path</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;"public_html"</span>
<br class="fancyvrb" /><a 
 id="x1-51005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cgi.assign</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;(</span><span 
class="pcrr7tn-">&#x00A0;".cgi"</span><span 
class="pcrr7tn-">&#x00A0;=&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;""</span><span 
class="pcrr7tn-">&#x00A0;)</span>
   </div>
<!--l. 870--><p class="noindent">With this done, <span 
class="pcrr7tn-">lighttpd </span>ran immediately for me. If I had configured <span 
class="pcrr7tn-">lighttpd </span>before Apache, I&#x2019;d almost certainly have run into
many of the same system-level configuration problems as I did with Apache. However, I found <span 
class="pcrr7tn-">lighttpd </span>to be noticeably
easier to configure than Apache, even though I&#x2019;ve used Apache for over a decade, and this was my first exposure to
<span 
class="pcrr7tn-">lighttpd</span>.
</p><!--l. 877--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.6.3    </span> <a 
 id="x1-520002.6.3"></a>Sharing multiple repositories with one CGI script</h4>
<!--l. 879--><p class="noindent">The <a 
 id="dx1-52001"></a><span 
class="pcrr7tn-">hgweb.cgi </span>script only lets you publish a single repository, which is an annoying restriction. If you want to publish more
than one without wracking yourself with multiple copies of the same script, each with different names, a better choice is to use
the <a 
 id="dx1-52002"></a><span 
class="pcrr7tn-">hgwebdir.cgi </span>script.
</p><!--l. 885--><p class="indent">   The procedure to configure <a 
 id="dx1-52003"></a><span 
class="pcrr7tn-">hgwebdir.cgi </span>is only a little more involved than for <a 
 id="dx1-52004"></a><span 
class="pcrr7tn-">hgweb.cgi</span>. First, you must obtain a copy
of the script. If you don&#x2019;t have one handy, you can download a copy from the master Mercurial repository at
<a 
href="http://www.selenic.com/repo/hg/raw-file/tip/hgwebdir.cgi" class="url" ><span 
class="pcrr7tn-">http://www.selenic.com/repo/hg/raw-file/tip/hgwebdir.cgi</span></a>.
</p><!--l. 891--><p class="indent">   You&#x2019;ll need to copy this script into your <span 
class="pcrr7tn-">public</span><span 
class="pcrr7tn-">_html </span>directory, and ensure that it&#x2019;s executable.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-52006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cp</span><span 
class="pcrr7tn-">&#x00A0;.../hgwebdir.cgi</span><span 
class="pcrr7tn-">&#x00A0;~/public_html</span>
<br class="fancyvrb" /><a 
 id="x1-52008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;chmod</span><span 
class="pcrr7tn-">&#x00A0;755</span><span 
class="pcrr7tn-">&#x00A0;~/public_html</span><span 
class="pcrr7tn-">&#x00A0;~/public_html/hgwebdir.cgi</span>
   </div>
<!--l. 897--><p class="noindent">With basic configuration out of the way, try to visit   <a 
href="http://myhostname/~myuser/hgwebdir.cgi" class="url" ><span 
class="pcrr7tn-">http://myhostname/~myuser/hgwebdir.cgi</span></a> in your browser. It should
display an empty list of repositories. If you get a blank window or error message, try walking through the list of potential
problems in section&#x00A0;<a 
href="#x1-500002.6.2">2.6.2<!--tex4ht:ref: sec:collab:wtf --></a>.
</p><!--l. 903--><p class="indent">   The <a 
 id="dx1-52009"></a><span 
class="pcrr7tn-">hgwebdir.cgi </span>script relies on an external configuration file. By default, it searches for a file named <a 
 id="dx1-52010"></a><span 
class="pcrr7tn-">hgweb.config </span>in
the same directory as itself. You&#x2019;ll need to create this file, and make it world-readable. The format of the file is similar to a
Windows &#x201C;ini&#x201D; file, as understood by Python&#x2019;s <span 
class="pcrr7tn-">ConfigParser</span>&#x00A0;<span class="cite">[<span 
class="ptmb7t-">?</span>]</span> module.
</p><!--l. 910--><p class="indent">   The easiest way to configure <a 
 id="dx1-52011"></a><span 
class="pcrr7tn-">hgwebdir.cgi </span>is with a section named <span 
class="pcrr7tn-">collections</span>. This will automatically publish <span 
class="ptmri7t-">every</span>
repository under the directories you name. The section should look like this:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-52013r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[collections]</span>
<br class="fancyvrb" /><a 
 id="x1-52015r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;/my/root</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;/my/root</span>
   </div>
<!--l. 918--><p class="noindent">Mercurial interprets this by looking at the directory name on the <span 
class="ptmri7t-">right </span>hand side of the &#x201C;<span 
class="pcrr7tn-">=</span>&#x201D; sign; finding repositories in that
directory hierarchy; and using the text on the <span 
class="ptmri7t-">left </span>to strip off matching text from the names it will actually list
in the web interface. The remaining component of a path after this stripping has occurred is called a &#x201C;virtual
path&#x201D;.
                                                                                         
                                                                                         
</p><!--l. 925--><p class="indent">   Given the example above, if we have a repository whose local path is <span 
class="pcrr7tn-">/my/root/this/repo</span>, the CGI script will strip the
leading <span 
class="pcrr7tn-">/my/root </span>from the name, and publish the repository with a virtual path of <span 
class="pcrr7tn-">this/repo</span>. If the base URL for our
CGI script is   <a 
href="http://myhostname/~myuser/hgwebdir.cgi" class="url" ><span 
class="pcrr7tn-">http://myhostname/~myuser/hgwebdir.cgi</span></a>, the complete URL for that repository will be
<a 
href="http://myhostname/~myuser/hgwebdir.cgi/this/repo" class="url" ><span 
class="pcrr7tn-">http://myhostname/~myuser/hgwebdir.cgi/this/repo</span></a>.
</p><!--l. 933--><p class="indent">   If we replace <span 
class="pcrr7tn-">/my/root </span>on the left hand side of this example with <span 
class="pcrr7tn-">/my</span>, then <a 
 id="dx1-52016"></a><span 
class="pcrr7tn-">hgwebdir.cgi </span>will only strip off <span 
class="pcrr7tn-">/my </span>from the
repository name, and will give us a virtual path of <span 
class="pcrr7tn-">root/this/repo </span>instead of <span 
class="pcrr7tn-">this/repo</span>.
</p><!--l. 938--><p class="indent">   The <a 
 id="dx1-52017"></a><span 
class="pcrr7tn-">hgwebdir.cgi </span>script will recursively search each directory listed in the <span 
class="pcrr7tn-">collections </span>section of its configuration file,
but it will <span 
class="pcrr7tn-">not </span>recurse into the repositories it finds.
</p><!--l. 943--><p class="indent">   The <span 
class="pcrr7tn-">collections </span>mechanism makes it easy to publish many repositories in a &#x201C;fire and forget&#x201D; manner. You only need to
set up the CGI script and configuration file one time. Afterwards, you can publish or unpublish a repository at any
time by simply moving it into, or out of, the directory hierarchy in which you&#x2019;ve configured <a 
 id="dx1-52018"></a><span 
class="pcrr7tn-">hgwebdir.cgi </span>to
look.
</p><!--l. 950--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-530002.6.3"></a>Explicitly specifying which repositories to publish</h5>
<!--l. 952--><p class="noindent">In addition to the <span 
class="pcrr7tn-">collections </span>mechanism, the <a 
 id="dx1-53001"></a><span 
class="pcrr7tn-">hgwebdir.cgi </span>script allows you to publish a specific list of repositories. To do
so, create a <span 
class="pcrr7tn-">paths </span>section, with contents of the following form.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-53003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[paths]</span>
<br class="fancyvrb" /><a 
 id="x1-53005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;repo1</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;/my/path/to/some/repo</span>
<br class="fancyvrb" /><a 
 id="x1-53007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;repo2</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;/some/path/to/another</span>
   </div>
<!--l. 961--><p class="noindent">In this case, the virtual path (the component that will appear in a URL) is on the left hand side of each definition, while the path to
the repository is on the right. Notice that there does not need to be any relationship between the virtual path you choose and the
location of a repository in your filesystem.
</p><!--l. 967--><p class="indent">   If you wish, you can use both the <span 
class="pcrr7tn-">collections </span>and <span 
class="pcrr7tn-">paths </span>mechanisms simultaneously in a single configuration
file.
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:  </span>If multiple repositories have the same virtual path, <span 
class="pcrr7tn-">hgwebdir.cgi </span>will not
report an error. Instead, it will behave unpredictably.                                                </div>
<!--l. 977--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.6.4    </span> <a 
 id="x1-540002.6.4"></a>Downloading source archives</h4>
<!--l. 979--><p class="noindent">Mercurial&#x2019;s web interface lets users download an archive of any revision. This archive will contain a snapshot of the working
directory as of that revision, but it will not contain a copy of the repository data.
</p><!--l. 984--><p class="indent">   By default, this feature is not enabled. To enable it, you&#x2019;ll need to add an <a 
 id="dx1-54001"></a><span 
class="pcrr7tn-">allow</span><span 
class="pcrr7tn-">_archive </span>item to the <a 
 id="dx1-54002"></a><span 
class="pcrr7tn-">[web] </span>section of your
<a 
 id="dx1-54003"></a><a 
 id="dx1-54004"></a><span 
class="pcrr7tn-">hgrc</span>.
</p><!--l. 988--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.6.5    </span> <a 
 id="x1-550002.6.5"></a>Web configuration options</h4>
<!--l. 990--><p class="noindent">Mercurial&#x2019;s web interfaces (the <a 
 id="dx1-55001"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; command, and the <a 
 id="dx1-55002"></a><span 
class="pcrr7tn-">hgweb.cgi </span>and <a 
 id="dx1-55003"></a><span 
class="pcrr7tn-">hgwebdir.cgi </span>scripts) have a number of
configuration options that you can set. These belong in a section named <a 
 id="dx1-55004"></a><span 
class="pcrr7tn-">[web]</span>. </p>
                                                                                         
                                                                                         
     <ul><li><span class="dt">
<a 
 id="dx1-55005"></a><span 
class="pcrr7tn-">allow</span><span 
class="pcrr7tn-">_archive</span> </span><span class="dd">Determines which (if any) archive download mechanisms Mercurial supports. If you enable this feature, users of the
     web interface will be able to download an archive of whatever revision of a repository they are viewing.
     To enable the archive feature, this item must take the form of a sequence of words drawn from the list
     below.
         <ul><li><span class="dt">
     <span 
class="pcrr7tn-">bz2</span> </span><span class="dd">A <a 
 id="dx1-55006"></a><span 
class="pcrr7tn-">tar </span>archive, compressed using <span 
class="pcrr7tn-">bzip2 </span>compression. This has the best compression ratio, but uses the
         most CPU time on the server.
         </span><li><span class="dt">
      <span 
class="pcrr7tn-">gz</span> </span><span class="dd">A <a 
 id="dx1-55007"></a><span 
class="pcrr7tn-">tar </span>archive, compressed using <span 
class="pcrr7tn-">gzip </span>compression.
         </span><li><span class="dt">
     <span 
class="pcrr7tn-">zip</span> </span><span class="dd">A <a 
 id="dx1-55008"></a><span 
class="pcrr7tn-">zip </span>archive, compressed using LZW compression. This format has the worst compression ratio, but is
         widely used in the Windows world.</li></ul>
     <!--l. 1011--><p class="noindent">If you provide an empty list, or don&#x2019;t have an <a 
 id="dx1-55009"></a><span 
class="pcrr7tn-">allow</span><span 
class="pcrr7tn-">_archive </span>entry at all, this feature will be disabled. Here is an
     example of how to enable all three supported formats.
</p>
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-55011r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[web]</span>
<br class="fancyvrb" /><a 
 id="x1-55013r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;allow_archive</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;bz2</span><span 
class="pcrr7tn-">&#x00A0;gz</span><span 
class="pcrr7tn-">&#x00A0;zip</span>
</div>
     </span><li><span class="dt">
<a 
 id="dx1-55014"></a><span 
class="pcrr7tn-">allowpull</span> </span><span class="dd">Boolean. Determines whether the web interface allows remote users to <a 
 id="dx1-55015"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; and <a 
 id="dx1-55016"></a>&#x201C;<span 
class="pcrr7tn-">hg clone</span>&#x201D; this
     repository over&#x00A0;HTTP. If set to <span 
class="pcrr7tn-">no </span>or <span 
class="pcrr7tn-">false</span>, only the &#x201C;human-oriented&#x201D; portion of the web interface is
     available.
     </span><li><span class="dt">
<a 
 id="dx1-55017"></a><span 
class="pcrr7tn-">contact</span> </span><span class="dd">String. A free-form (but preferably brief) string identifying the person or group in charge of the repository. This often
     contains the name and email address of a person or mailing list. It often makes sense to place this entry in a
     repository&#x2019;s own <a 
 id="dx1-55018"></a><span 
class="pcrr7tn-">.hg/hgrc </span>file, but it can make sense to use in a global <a 
 id="dx1-55019"></a><a 
 id="dx1-55020"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;if every repository has a single
     maintainer.
     </span><li><span class="dt">
<a 
 id="dx1-55021"></a><span 
class="pcrr7tn-">maxchanges</span> </span><span class="dd">Integer. The default maximum number of changesets to display in a single page of output.
     </span><li><span class="dt">
<a 
 id="dx1-55022"></a><span 
class="pcrr7tn-">maxfiles</span> </span><span class="dd">Integer. The default maximum number of modified files to display in a single page of output.
     </span><li><span class="dt">
<a 
 id="dx1-55023"></a><span 
class="pcrr7tn-">stripes</span> </span><span class="dd">Integer. If the web interface displays alternating &#x201C;stripes&#x201D; to make it easier to visually align rows when you are looking at
     a table, this number controls the number of rows in each stripe.
     </span><li><span class="dt">
<a 
 id="dx1-55024"></a><span 
class="pcrr7tn-">style</span> </span><span class="dd">Controls the template Mercurial uses to display the web interface. Mercurial ships with two web templates, named
     <span 
class="pcrr7tn-">default </span>and <span 
class="pcrr7tn-">gitweb </span>(the latter is much more visually attractive). You can also specify a custom template of your own;
     see chapter&#x00A0;<a 
href="#x1-25100011">11<!--tex4ht:ref: chap:template --></a> for details. Here, you can see how to enable the <span 
class="pcrr7tn-">gitweb </span>style.
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-55026r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[web]</span>
<br class="fancyvrb" /><a 
 id="x1-55028r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;style</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;gitweb</span>
</div>
                                                                                         
                                                                                         
     </span><li><span class="dt">
<a 
 id="dx1-55029"></a><span 
class="pcrr7tn-">templates</span> </span><span class="dd">Path. The directory in which to search for template files. By default, Mercurial searches in the directory in which it was
     installed.</li></ul>
<!--l. 1052--><p class="noindent">If you are using <a 
 id="dx1-55030"></a><span 
class="pcrr7tn-">hgwebdir.cgi</span>, you can place a few configuration items in a <a 
 id="dx1-55031"></a><span 
class="pcrr7tn-">[web] </span>section of the <a 
 id="dx1-55032"></a><span 
class="pcrr7tn-">hgweb.config </span>file instead of a
<a 
 id="dx1-55033"></a><a 
 id="dx1-55034"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file, for convenience. These items are <a 
 id="dx1-55035"></a><span 
class="pcrr7tn-">motd </span>and <a 
 id="dx1-55036"></a><span 
class="pcrr7tn-">style</span>.
</p><!--l. 1058--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-560002.6.5"></a>Options specific to an individual repository</h5>
<!--l. 1060--><p class="noindent">A few <a 
 id="dx1-56001"></a><span 
class="pcrr7tn-">[web] </span>configuration items ought to be placed in a repository&#x2019;s local <a 
 id="dx1-56002"></a><span 
class="pcrr7tn-">.hg/hgrc</span>, rather than a user&#x2019;s or global <a 
 id="dx1-56003"></a><a 
 id="dx1-56004"></a><span 
class="pcrr7tn-">hgrc</span>.
</p>
     <ul><li><span class="dt">
<a 
 id="dx1-56005"></a><span 
class="pcrr7tn-">description</span> </span><span class="dd">String. A free-form (but preferably brief) string that describes the contents or purpose of the repository.
     </span><li><span class="dt">
<a 
 id="dx1-56006"></a><span 
class="pcrr7tn-">name</span> </span><span class="dd">String. The name to use for the repository in the web interface. This overrides the default name, which is the
     last component of the repository&#x2019;s path.</li></ul>
<!--l. 1072--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-570002.6.5"></a>Options specific to the &#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; command</h5>
<!--l. 1074--><p class="noindent">Some of the items in the <a 
 id="dx1-57001"></a><span 
class="pcrr7tn-">[web] </span>section of a <a 
 id="dx1-57002"></a><a 
 id="dx1-57003"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file are only for use with the <a 
 id="dx1-57004"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; command. </p>
     <ul><li><span class="dt">
<a 
 id="dx1-57005"></a><span 
class="pcrr7tn-">accesslog</span> </span><span class="dd">Path. The name of a file into which to write an access log. By default, the <a 
 id="dx1-57006"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; command writes this
     information to standard output, not to a file. Log entries are written in the standard &#x201C;combined&#x201D; file format used
     by almost all web servers.
     </span><li><span class="dt">
<a 
 id="dx1-57007"></a><span 
class="pcrr7tn-">address</span> </span><span class="dd">String. The local address on which the server should listen for incoming connections. By default, the server
     listens on all addresses.
     </span><li><span class="dt">
<a 
 id="dx1-57008"></a><span 
class="pcrr7tn-">errorlog</span> </span><span class="dd">Path. The name of a file into which to write an error log. By default, the <a 
 id="dx1-57009"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; command writes this
     information to standard error, not to a file.
     </span><li><span class="dt">
<a 
 id="dx1-57010"></a><span 
class="pcrr7tn-">ipv6</span> </span><span class="dd">Boolean. Whether to use the IPv6 protocol. By default, IPv6 is not used.
     </span><li><span class="dt">
<a 
 id="dx1-57011"></a><span 
class="pcrr7tn-">port</span> </span><span class="dd">Integer. The TCP&#x00A0;port number on which the server should listen. The default port number used is&#x00A0;8000.</li></ul>
<!--l. 1095--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-580002.6.5"></a>Choosing the right <span 
class="pcrr7tn-">hgrc</span>&#x00A0;file to add <span 
class="pcrr7tn-">[web] </span>items to</h5>
<!--l. 1097--><p class="noindent">It is important to remember that a web server like Apache or <span 
class="pcrr7tn-">lighttpd </span>will run under a user&#x00A0;ID that is different to yours. CGI
scripts run by your server, such as <a 
 id="dx1-58001"></a><span 
class="pcrr7tn-">hgweb.cgi</span>, will usually also run under that user&#x00A0;ID.
                                                                                         
                                                                                         
</p><!--l. 1102--><p class="indent">   If you add <a 
 id="dx1-58002"></a><span 
class="pcrr7tn-">[web] </span>items to your own personal <a 
 id="dx1-58003"></a><a 
 id="dx1-58004"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file, CGI scripts won&#x2019;t read that <a 
 id="dx1-58005"></a><a 
 id="dx1-58006"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file. Those settings will thus only
affect the behaviour of the <a 
 id="dx1-58007"></a>&#x201C;<span 
class="pcrr7tn-">hg serve</span>&#x201D; command when you run it. To cause CGI scripts to see your settings, either create a
<a 
 id="dx1-58008"></a><a 
 id="dx1-58009"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file in the home directory of the user ID that runs your web server, or add those settings to a system-wide
<a 
 id="dx1-58010"></a><a 
 id="dx1-58011"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
</p>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;3</span><br /><a 
 id="x1-590003"></a>System Monitoring Requirements</h2>
   <h3 class="sectionHead"><span class="titlemark">3.1    </span> <a 
 id="x1-600003.1"></a>Web GUI of Hobbit</h3>
<!--l. 7--><p class="noindent">Prebuilt binary packages of Mercurial are available for every popular operating system. These make it easy to start using
Mercurial on your computer immediately.
</p><!--l. 11--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1.1    </span> <a 
 id="x1-610003.1.1"></a>Linux</h4>
<!--l. 13--><p class="noindent">Because each Linux distribution has its own packaging tools, policies, and rate of development, it&#x2019;s difficult to give a
comprehensive set of instructions on how to install Mercurial binaries. The version of Mercurial that you will end up with can
vary depending on how active the person is who maintains the package for your distribution.
</p><!--l. 19--><p class="indent">   To keep things simple, I will focus on installing Mercurial from the command line under the most popular Linux
distributions. Most of these distributions provide graphical package managers that will let you install Mercurial with a single
click; the package name to look for is <span 
class="pcrr7tn-">mercurial</span>.
</p>
     <ul><li><span class="dt">
Debian </span><span class="dd">
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-61002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;apt-get</span><span 
class="pcrr7tn-">&#x00A0;install</span><span 
class="pcrr7tn-">&#x00A0;mercurial</span>
</div>
     </span><li><span class="dt">
Fedora Core </span><span class="dd">
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-61004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;yum</span><span 
class="pcrr7tn-">&#x00A0;install</span><span 
class="pcrr7tn-">&#x00A0;mercurial</span>
</div>
     </span><li><span class="dt">
Gentoo </span><span class="dd">
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-61006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;emerge</span><span 
class="pcrr7tn-">&#x00A0;mercurial</span>
</div>
     </span><li><span class="dt">
OpenSUSE </span><span class="dd">
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-61008r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;yum</span><span 
class="pcrr7tn-">&#x00A0;install</span><span 
class="pcrr7tn-">&#x00A0;mercurial</span>
</div>
     </span><li><span class="dt">
Ubuntu </span><span class="dd">Ubuntu&#x2019;s Mercurial package is based on Debian&#x2019;s. To install it, run the following command.
                                                                                         
                                                                                         
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-61010r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;apt-get</span><span 
class="pcrr7tn-">&#x00A0;install</span><span 
class="pcrr7tn-">&#x00A0;mercurial</span>
</div>
     <!--l. 51--><p class="noindent">The Ubuntu package for Mercurial tends to lag behind the Debian version by a considerable time margin (at the time of
     writing, seven months), which in some cases will mean that on Ubuntu, you may run into problems that have since been
     fixed in the Debian package.</p></li></ul>
<!--l. 57--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1.2    </span> <a 
 id="x1-620003.1.2"></a>Solaris</h4>
<!--l. 59--><p class="noindent">XXX.
</p><!--l. 61--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1.3    </span> <a 
 id="x1-630003.1.3"></a>Mac OS X</h4>
<!--l. 63--><p class="noindent">Lee Cantey publishes an installer of Mercurial for Mac OS&#x00A0;X at   <a 
href="http://mercurial.berkwood.com" class="url" ><span 
class="pcrr7tn-">http://mercurial.berkwood.com</span></a>. This package works on
both Intel-&#x00A0;and Power-based Macs. Before you can use it, you must install a compatible version of Universal MacPython&#x00A0;<span class="cite">[<span 
class="ptmb7t-">?</span>]</span>.
This is easy to do; simply follow the instructions on Lee&#x2019;s site.
</p><!--l. 69--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1.4    </span> <a 
 id="x1-640003.1.4"></a>Windows</h4>
<!--l. 71--><p class="noindent">Lee Cantey also publishes an installer of Mercurial for Windows at   <a 
href="http://mercurial.berkwood.com" class="url" ><span 
class="pcrr7tn-">http://mercurial.berkwood.com</span></a>. This package has no
external dependencies; it &#x201C;just works&#x201D;.
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:   </span>The  Windows  version  of  Mercurial  does  not  automatically  convert  line
endings between Windows and Unix styles. If you want to share work with Unix
users, you must do a little additional configuration work. XXX Flesh this out.        </div>
<!--l. 82--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">3.2    </span> <a 
 id="x1-650003.2"></a>Getting started</h3>
<!--l. 84--><p class="noindent">To begin, we&#x2019;ll use the <a 
 id="dx1-65001"></a>&#x201C;<span 
class="pcrr7tn-">hg version</span>&#x201D; command to find out whether Mercurial is actually installed properly. The
actual version information that it prints isn&#x2019;t so important; it&#x2019;s whether it prints anything at all that we care
about.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-65003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;version</span>
<br class="fancyvrb" /><a 
 id="x1-65005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Mercurial</span><span 
class="pcrr7tn-">&#x00A0;Distributed</span><span 
class="pcrr7tn-">&#x00A0;SCM</span><span 
class="pcrr7tn-">&#x00A0;(version</span><span 
class="pcrr7tn-">&#x00A0;0.9.3)</span>
<br class="fancyvrb" /><a 
 id="x1-65007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-65009r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Copyright</span><span 
class="pcrr7tn-">&#x00A0;(C)</span><span 
class="pcrr7tn-">&#x00A0;2005,</span><span 
class="pcrr7tn-">&#x00A0;2006</span><span 
class="pcrr7tn-">&#x00A0;Matt</span><span 
class="pcrr7tn-">&#x00A0;Mackall</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;mpm@selenic.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-65011r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;This</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;free</span><span 
class="pcrr7tn-">&#x00A0;software;</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;source</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;copying</span><span 
class="pcrr7tn-">&#x00A0;conditions.</span><span 
class="pcrr7tn-">&#x00A0;There</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;NO</span>
<br class="fancyvrb" /><a 
 id="x1-65013r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;warranty;</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;even</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;MERCHANTABILITY</span><span 
class="pcrr7tn-">&#x00A0;or</span><span 
class="pcrr7tn-">&#x00A0;FITNESS</span><span 
class="pcrr7tn-">&#x00A0;FOR</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;PARTICULAR</span><span 
class="pcrr7tn-">&#x00A0;PURPOSE.</span>
   </div>
                                                                                         
                                                                                         
<!--l. 90--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2.1    </span> <a 
 id="x1-660003.2.1"></a>Built-in help</h4>
<!--l. 92--><p class="noindent">Mercurial provides a built-in help system. This is invaluable for those times when you find yourself stuck trying to remember
how to run a command. If you are completely stuck, simply run <a 
 id="dx1-66001"></a>&#x201C;<span 
class="pcrr7tn-">hg help</span>&#x201D;; it will print a brief list of commands, along with a
description of what each does. If you ask for help on a specific command (as below), it prints more detailed
information.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-66003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;help</span><span 
class="pcrb7t-">&#x00A0;init</span>
<br class="fancyvrb" /><a 
 id="x1-66005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;init</span><span 
class="pcrr7tn-">&#x00A0;[-e</span><span 
class="pcrr7tn-">&#x00A0;CMD]</span><span 
class="pcrr7tn-">&#x00A0;[--remotecmd</span><span 
class="pcrr7tn-">&#x00A0;CMD]</span><span 
class="pcrr7tn-">&#x00A0;[DEST]</span>
<br class="fancyvrb" /><a 
 id="x1-66007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-66009r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;create</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;new</span><span 
class="pcrr7tn-">&#x00A0;repository</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;given</span><span 
class="pcrr7tn-">&#x00A0;directory</span>
<br class="fancyvrb" /><a 
 id="x1-66011r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-66013r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Initialize</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;new</span><span 
class="pcrr7tn-">&#x00A0;repository</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;given</span><span 
class="pcrr7tn-">&#x00A0;directory.</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;If</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;given</span>
<br class="fancyvrb" /><a 
 id="x1-66015r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;directory</span><span 
class="pcrr7tn-">&#x00A0;does</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;exist,</span><span 
class="pcrr7tn-">&#x00A0;it</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;created.</span>
<br class="fancyvrb" /><a 
 id="x1-66017r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-66019r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;If</span><span 
class="pcrr7tn-">&#x00A0;no</span><span 
class="pcrr7tn-">&#x00A0;directory</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;given,</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;current</span><span 
class="pcrr7tn-">&#x00A0;directory</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;used.</span>
<br class="fancyvrb" /><a 
 id="x1-66021r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-66023r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;It</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;possible</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;specify</span><span 
class="pcrr7tn-">&#x00A0;an</span><span 
class="pcrr7tn-">&#x00A0;ssh://</span><span 
class="pcrr7tn-">&#x00A0;URL</span><span 
class="pcrr7tn-">&#x00A0;as</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;destination.</span>
<br class="fancyvrb" /><a 
 id="x1-66025r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Look</span><span 
class="pcrr7tn-">&#x00A0;at</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;help</span><span 
class="pcrr7tn-">&#x00A0;text</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;pull</span><span 
class="pcrr7tn-">&#x00A0;command</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;important</span><span 
class="pcrr7tn-">&#x00A0;details</span>
<br class="fancyvrb" /><a 
 id="x1-66027r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;about</span><span 
class="pcrr7tn-">&#x00A0;ssh://</span><span 
class="pcrr7tn-">&#x00A0;URLs.</span>
<br class="fancyvrb" /><a 
 id="x1-66029r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-66031r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;options:</span>
<br class="fancyvrb" /><a 
 id="x1-66033r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-66035r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-e</span><span 
class="pcrr7tn-">&#x00A0;--ssh</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;specify</span><span 
class="pcrr7tn-">&#x00A0;ssh</span><span 
class="pcrr7tn-">&#x00A0;command</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;use</span>
<br class="fancyvrb" /><a 
 id="x1-66037r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;--remotecmd</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;specify</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;command</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;run</span><span 
class="pcrr7tn-">&#x00A0;on</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;remote</span><span 
class="pcrr7tn-">&#x00A0;side</span>
   </div>
<!--l. 99--><p class="noindent">For a more impressive level of detail (which you won&#x2019;t usually need) run <a 
 id="dx1-66038"></a>&#x201C;<span 
class="pcrr7tn-">hg help</span> <a 
 id="dx1-66039"></a><span 
class="pcrr7tn-">-v</span>&#x201D;. The <a 
 id="dx1-66040"></a><span 
class="pcrr7tn-">-v </span>option is short for <a 
 id="dx1-66041"></a><span 
class="pcrr7tn-">--verbose</span>,
and tells Mercurial to print more information than it usually would.
</p><!--l. 104--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">3.3    </span> <a 
 id="x1-670003.3"></a>Working with a repository</h3>
<!--l. 106--><p class="noindent">In Mercurial, everything happens inside a <span 
class="ptmri7t-">repository</span>. The repository for a project contains all of the files that &#x201C;belong to&#x201D; that
project, along with a historical record of the project&#x2019;s files.
</p><!--l. 110--><p class="indent">   There&#x2019;s nothing particularly magical about a repository; it is simply a directory tree in your filesystem that Mercurial treats
as special. You can rename or delete a repository any time you like, using either the command line or your file
browser.
</p><!--l. 115--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3.1    </span> <a 
 id="x1-680003.3.1"></a>Making a local copy of a repository</h4>
<!--l. 117--><p class="noindent"><span 
class="ptmri7t-">Copying </span>a repository is just a little bit special. While you could use a normal file copying command to make a copy of a
repository, it&#x2019;s best to use a built-in command that Mercurial provides. This command is called <a 
 id="dx1-68001"></a>&#x201C;<span 
class="pcrr7tn-">hg clone</span>&#x201D;, because it creates
an identical copy of an existing repository.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-68003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;http://hg.serpentine.com/tutorial/hello</span>
<br class="fancyvrb" /><a 
 id="x1-68005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;destination</span><span 
class="pcrr7tn-">&#x00A0;directory:</span><span 
class="pcrr7tn-">&#x00A0;hello</span>
<br class="fancyvrb" /><a 
 id="x1-68007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;requesting</span><span 
class="pcrr7tn-">&#x00A0;all</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-68009r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-68011r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-68013r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-68015r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;5</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;5</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;files</span>
<br class="fancyvrb" /><a 
 id="x1-68017r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
   </div>
<!--l. 123--><p class="noindent">If our clone succeeded, we should now have a local directory called <span 
class="pcrr7tn-">hello</span>. This directory will contain some files.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-68019r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span><span 
class="pcrb7t-">&#x00A0;-l</span>
<br class="fancyvrb" /><a 
 id="x1-68021r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;total</span><span 
class="pcrr7tn-">&#x00A0;4</span>
<br class="fancyvrb" /><a 
 id="x1-68023r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;drwxr-xr-x</span><span 
class="pcrr7tn-">&#x00A0;3</span><span 
class="pcrr7tn-">&#x00A0;root</span><span 
class="pcrr7tn-">&#x00A0;root</span><span 
class="pcrr7tn-">&#x00A0;4096</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;hello</span>
<br class="fancyvrb" /><a 
 id="x1-68025r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span><span 
class="pcrb7t-">&#x00A0;hello</span>
<br class="fancyvrb" /><a 
 id="x1-68027r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Makefile</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hello.c</span>
   </div>
<!--l. 126--><p class="noindent">These files have the same contents and history in our repository as they do in the repository we cloned.
</p><!--l. 129--><p class="indent">   Every Mercurial repository is complete, self-contained, and independent. It contains its own private copy of a project&#x2019;s files
and history. A cloned repository remembers the location of the repository it was cloned from, but it does not communicate with
that repository, or any other, unless you tell it to.
</p><!--l. 135--><p class="indent">   What this means for now is that we&#x2019;re free to experiment with our repository, safe in the knowledge that it&#x2019;s a private
&#x201C;sandbox&#x201D; that won&#x2019;t affect anyone else.
</p><!--l. 139--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3.2    </span> <a 
 id="x1-690003.3.2"></a>What&#x2019;s in a repository?</h4>
<!--l. 141--><p class="noindent">When we take a more detailed look inside a repository, we can see that it contains a directory named <span 
class="pcrr7tn-">.hg</span>. This is where
Mercurial keeps all of its metadata for the repository.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-69002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;hello</span>
<br class="fancyvrb" /><a 
 id="x1-69004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span><span 
class="pcrb7t-">&#x00A0;-a</span>
<br class="fancyvrb" /><a 
 id="x1-69006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;.</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;..</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;.hg</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Makefile</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hello.c</span>
   </div>
<!--l. 146--><p class="indent">   The contents of the <span 
class="pcrr7tn-">.hg </span>directory and its subdirectories are private to Mercurial. Every other file and directory in the
repository is yours to do with as you please.
</p><!--l. 150--><p class="indent">   To introduce a little terminology, the <span 
class="pcrr7tn-">.hg </span>directory is the &#x201C;real&#x201D; repository, and all of the files and directories that coexist
with it are said to live in the <span 
class="ptmri7t-">working directory</span>. An easy way to remember the distinction is that the <span 
class="ptmri7t-">repository </span>contains the
<span 
class="ptmri7t-">history </span>of your project, while the <span 
class="ptmri7t-">working directory </span>contains a <span 
class="ptmri7t-">snapshot </span>of your project at a particular point in
history.
                                                                                         
                                                                                         
</p><!--l. 158--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">3.4    </span> <a 
 id="x1-700003.4"></a>A tour through history</h3>
<!--l. 160--><p class="noindent">One of the first things we might want to do with a new, unfamiliar repository is understand its history. The <a 
 id="dx1-70001"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; command
gives us a view of history.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-70003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span>
<br class="fancyvrb" /><a 
 id="x1-70005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;4:b57f9a090b62</span>
<br class="fancyvrb" /><a 
 id="x1-70007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-70009r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-70011r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;15:43:07</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-70013r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Trim</span><span 
class="pcrr7tn-">&#x00A0;comments.</span>
<br class="fancyvrb" /><a 
 id="x1-70015r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-70017r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3:ff5d7b70a2a9</span>
<br class="fancyvrb" /><a 
 id="x1-70019r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-70021r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;13:15:58</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-70023r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Get</span><span 
class="pcrr7tn-">&#x00A0;make</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;generate</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;final</span><span 
class="pcrr7tn-">&#x00A0;binary</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;.o</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-70025r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-70027r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:057d3c2d823c</span>
<br class="fancyvrb" /><a 
 id="x1-70029r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-70031r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;13:15:43</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-70033r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Introduce</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;typo</span><span 
class="pcrr7tn-">&#x00A0;into</span><span 
class="pcrr7tn-">&#x00A0;hello.c.</span>
<br class="fancyvrb" /><a 
 id="x1-70035r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-70037r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:82e55d328c8c</span>
<br class="fancyvrb" /><a 
 id="x1-70039r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;mpm@selenic.com</span>
<br class="fancyvrb" /><a 
 id="x1-70041r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Fri</span><span 
class="pcrr7tn-">&#x00A0;Aug</span><span 
class="pcrr7tn-">&#x00A0;26</span><span 
class="pcrr7tn-">&#x00A0;01:21:28</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-70043r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Create</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;makefile</span>
<br class="fancyvrb" /><a 
 id="x1-70045r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-70047r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:0a04b987be5a</span>
<br class="fancyvrb" /><a 
 id="x1-70049r24"></a><span 
class="ptmr7t-x-x-50">24</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;mpm@selenic.com</span>
<br class="fancyvrb" /><a 
 id="x1-70051r25"></a><span 
class="ptmr7t-x-x-50">25</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Fri</span><span 
class="pcrr7tn-">&#x00A0;Aug</span><span 
class="pcrr7tn-">&#x00A0;26</span><span 
class="pcrr7tn-">&#x00A0;01:20:50</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-70053r26"></a><span 
class="ptmr7t-x-x-50">26</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Create</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;standard</span><span 
class="pcrr7tn-">&#x00A0;"hello,</span><span 
class="pcrr7tn-">&#x00A0;world"</span><span 
class="pcrr7tn-">&#x00A0;program</span>
<br class="fancyvrb" /><a 
 id="x1-70055r27"></a><span 
class="ptmr7t-x-x-50">27</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 164--><p class="noindent">By default, this command prints a brief paragraph of output for each change to the project that was recorded. In Mercurial
terminology, we call each of these recorded events a <span 
class="ptmri7t-">changeset</span>, because it can contain a record of changes to several
files.
</p><!--l. 169--><p class="indent">   The fields in a record of output from <a 
 id="dx1-70056"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; are as follows. </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">changeset</span> </span><span class="dd">This  field  has  the  format  of  a  number,  followed  by  a  colon,  followed  by  a  hexadecimal  string.  These  are
     <span 
class="ptmri7t-">identifiers </span>for the changeset. There are two identifiers because the number is shorter and easier to type than the
     hex string.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">user</span> </span><span class="dd">The identity of the person who created the changeset. This is a free-form field, but it most often contains a
     person&#x2019;s name and email address.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">date</span> </span><span class="dd">The date and time on which the changeset was created, and the timezone in which it was created. (The date and
     time are local to that timezone; they display what time and date it was for the person who created the changeset.)
                                                                                         
                                                                                         
     </span><li><span class="dt">
<span 
class="pcrr7tn-">summary</span> </span><span class="dd">The first line of the text message that the creator of the changeset entered to describe the changeset.</li></ul>
<!--l. 186--><p class="noindent">The default output printed by <a 
 id="dx1-70057"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; is purely a summary; it is missing a lot of detail.
</p><!--l. 189--><p class="indent">   Figure&#x00A0;<a 
href="#x1-700581">3.1<!--tex4ht:ref: fig:tour-basic:history --></a> provides a graphical representation of the history of the <span 
class="pcrr7tn-">hello </span>repository, to make it a little easier to see which
direction history is &#x201C;flowing&#x201D; in. We&#x2019;ll be returning to this figure several times in this chapter and the chapter that
follows.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-700581"></a>
                                                                                         
                                                                                         
<!--l. 197--><p class="noindent"><img 
src="tour-history.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;3.1: </td><td  
class="content">Graphical history of the <span 
class="pcrr7tn-">hello </span>repository</td></tr></table><!--tex4ht:label?: x1-700581 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">3.4.1    </span> <a 
 id="x1-710003.4.1"></a>Changesets, revisions, and talking to other people</h4>
<!--l. 205--><p class="noindent">As English is a notoriously sloppy language, and computer science has a hallowed history of terminological confusion (why
use one term when four will do?), revision control has a variety of words and phrases that mean the same thing.
If you are talking about Mercurial history with other people, you will find that the word &#x201C;changeset&#x201D; is often
compressed to &#x201C;change&#x201D; or (when written) &#x201C;cset&#x201D;, and sometimes a changeset is referred to as a &#x201C;revision&#x201D; or a
&#x201C;rev&#x201D;.
</p><!--l. 213--><p class="indent">   While it doesn&#x2019;t matter what <span 
class="ptmri7t-">word </span>you use to refer to the concept of &#x201C;a&#x00A0;changeset&#x201D;, the <span 
class="ptmri7t-">identifier </span>that you use to refer to
&#x201C;a&#x00A0;<span 
class="ptmri7t-">specific </span>changeset&#x201D; is of great importance. Recall that the <span 
class="pcrr7tn-">changeset </span>field in the output from <a 
 id="dx1-71001"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; identifies a
changeset using both a number and a hexadecimal string. </p>
     <ul><li><span class="dt">
     </span><span class="dd">The revision number is <span 
class="ptmri7t-">only valid in that repository</span>,
     </span><li><span class="dt">
     </span><span class="dd">while the hex string is the <span 
class="ptmri7t-">permanent, unchanging identifier </span>that will always identify that exact changeset in
     <span 
class="ptmri7t-">every </span>copy of the repository.</li></ul>
<!--l. 225--><p class="noindent">This distinction is important. If you send someone an email talking about &#x201C;revision&#x00A0;33&#x201D;, there&#x2019;s a high likelihood that their
revision&#x00A0;33 will <span 
class="ptmri7t-">not be the same </span>as yours. The reason for this is that a revision number depends on the order in which
changes arrived in a repository, and there is no guarantee that the same changes will happen in the same order in
different repositories. Three changes <span 
class="zptmcmrm-">a,b,c </span>can easily appear in one repository as <span 
class="zptmcmr-">0</span><span 
class="zptmcmrm-">,</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">,</span><span 
class="zptmcmr-">2</span>, while in another as
<span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">,</span><span 
class="zptmcmr-">0</span><span 
class="zptmcmrm-">,</span><span 
class="zptmcmr-">2</span>.
</p><!--l. 234--><p class="indent">   Mercurial uses revision numbers purely as a convenient shorthand. If you need to discuss a changeset with
someone, or make a record of a changeset for some other reason (for example, in a bug report), use the hexadecimal
identifier.
</p><!--l. 239--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.4.2    </span> <a 
 id="x1-720003.4.2"></a>Viewing specific revisions</h4>
<!--l. 241--><p class="noindent">To narrow the output of <a 
 id="dx1-72001"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; down to a single revision, use the <a 
 id="dx1-72002"></a><span 
class="pcrr7tn-">-r </span>(or <a 
 id="dx1-72003"></a><span 
class="pcrr7tn-">--rev</span>) option. You can use either a revision number
or a long-form changeset identifier, and you can provide as many revisions as you want.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-72005r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r</span><span 
class="pcrb7t-">&#x00A0;3</span>
<br class="fancyvrb" /><a 
 id="x1-72007r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3:ff5d7b70a2a9</span>
<br class="fancyvrb" /><a 
 id="x1-72009r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-72011r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;13:15:58</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-72013r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Get</span><span 
class="pcrr7tn-">&#x00A0;make</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;generate</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;final</span><span 
class="pcrr7tn-">&#x00A0;binary</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;.o</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-72015r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-72017r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r</span><span 
class="pcrb7t-">&#x00A0;ff5d7b70a2a9</span>
<br class="fancyvrb" /><a 
 id="x1-72019r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3:ff5d7b70a2a9</span>
<br class="fancyvrb" /><a 
 id="x1-72021r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-72023r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;13:15:58</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-72025r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Get</span><span 
class="pcrr7tn-">&#x00A0;make</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;generate</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;final</span><span 
class="pcrr7tn-">&#x00A0;binary</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;.o</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-72027r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-72029r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r</span><span 
class="pcrb7t-">&#x00A0;1</span><span 
class="pcrb7t-">&#x00A0;-r</span><span 
class="pcrb7t-">&#x00A0;4</span>
<br class="fancyvrb" /><a 
 id="x1-72031r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:82e55d328c8c</span>
<br class="fancyvrb" /><a 
 id="x1-72033r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;mpm@selenic.com</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-72035r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Fri</span><span 
class="pcrr7tn-">&#x00A0;Aug</span><span 
class="pcrr7tn-">&#x00A0;26</span><span 
class="pcrr7tn-">&#x00A0;01:21:28</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-72037r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Create</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;makefile</span>
<br class="fancyvrb" /><a 
 id="x1-72039r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-72041r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;4:b57f9a090b62</span>
<br class="fancyvrb" /><a 
 id="x1-72043r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-72045r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-72047r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;15:43:07</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-72049r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Trim</span><span 
class="pcrr7tn-">&#x00A0;comments.</span>
<br class="fancyvrb" /><a 
 id="x1-72051r24"></a><span 
class="ptmr7t-x-x-50">24</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 246--><p class="indent">   If you want to see the history of several revisions without having to list each one, you can use <span 
class="ptmri7t-">range notation</span>; this lets you
express the idea &#x201C;I want all revisions between <span 
class="zptmcmrm-">a </span>and <span 
class="zptmcmrm-">b</span>, inclusive&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-72053r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r</span><span 
class="pcrb7t-">&#x00A0;2:4</span>
<br class="fancyvrb" /><a 
 id="x1-72055r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:057d3c2d823c</span>
<br class="fancyvrb" /><a 
 id="x1-72057r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-72059r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;13:15:43</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-72061r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Introduce</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;typo</span><span 
class="pcrr7tn-">&#x00A0;into</span><span 
class="pcrr7tn-">&#x00A0;hello.c.</span>
<br class="fancyvrb" /><a 
 id="x1-72063r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-72065r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3:ff5d7b70a2a9</span>
<br class="fancyvrb" /><a 
 id="x1-72067r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-72069r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;13:15:58</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-72071r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Get</span><span 
class="pcrr7tn-">&#x00A0;make</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;generate</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;final</span><span 
class="pcrr7tn-">&#x00A0;binary</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;.o</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-72073r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-72075r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;4:b57f9a090b62</span>
<br class="fancyvrb" /><a 
 id="x1-72077r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-72079r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-72081r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;15:43:07</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-72083r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Trim</span><span 
class="pcrr7tn-">&#x00A0;comments.</span>
<br class="fancyvrb" /><a 
 id="x1-72085r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 251--><p class="noindent">Mercurial also honours the order in which you specify revisions, so <a 
 id="dx1-72086"></a>&#x201C;<span 
class="pcrr7tn-">hg log -r 2:4</span>&#x201D; prints <span 
class="zptmcmr-">2</span><span 
class="zptmcmrm-">,</span><span 
class="zptmcmr-">3</span><span 
class="zptmcmrm-">,</span><span 
class="zptmcmr-">4 </span>while <a 
 id="dx1-72087"></a>&#x201C;<span 
class="pcrr7tn-">hg log -r 4:2</span>&#x201D; prints
<span 
class="zptmcmr-">4</span><span 
class="zptmcmrm-">,</span><span 
class="zptmcmr-">3</span><span 
class="zptmcmrm-">,</span><span 
class="zptmcmr-">2</span>.
</p><!--l. 255--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.4.3    </span> <a 
 id="x1-730003.4.3"></a>More detailed information</h4>
<!--l. 257--><p class="noindent">While the summary information printed by <a 
 id="dx1-73001"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; is useful if you already know what you&#x2019;re looking for, you may need
to see a complete description of the change, or a list of the files changed, if you&#x2019;re trying to decide whether a
changeset is the one you&#x2019;re looking for. The <a 
 id="dx1-73002"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; command&#x2019;s <a 
 id="dx1-73003"></a><span 
class="pcrr7tn-">-v </span>(or <a 
 id="dx1-73004"></a><span 
class="pcrr7tn-">--verbose</span>) option gives you this extra
detail.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-73006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-v</span><span 
class="pcrb7t-">&#x00A0;-r</span><span 
class="pcrb7t-">&#x00A0;3</span>
<br class="fancyvrb" /><a 
 id="x1-73008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3:ff5d7b70a2a9</span>
<br class="fancyvrb" /><a 
 id="x1-73010r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-73012r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;13:15:58</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-73014r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;files:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Makefile</span>
<br class="fancyvrb" /><a 
 id="x1-73016r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;description:</span>
<br class="fancyvrb" /><a 
 id="x1-73018r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Get</span><span 
class="pcrr7tn-">&#x00A0;make</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;generate</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;final</span><span 
class="pcrr7tn-">&#x00A0;binary</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;.o</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-73020r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-73022r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 265--><p class="indent">   If you want to see both the description and content of a change, add the <a 
 id="dx1-73023"></a><span 
class="pcrr7tn-">-p </span>(or <a 
 id="dx1-73024"></a><span 
class="pcrr7tn-">--patch</span>) option. This displays the content of
a change as a <span 
class="ptmri7t-">unified diff  </span>(if you&#x2019;ve never seen a unified diff before, see section&#x00A0;<a 
href="#x1-27300012.4">12.4<!--tex4ht:ref: sec:mq:patch --></a> for an overview).
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-73026r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-v</span><span 
class="pcrb7t-">&#x00A0;-p</span><span 
class="pcrb7t-">&#x00A0;-r</span><span 
class="pcrb7t-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-73028r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:057d3c2d823c</span>
<br class="fancyvrb" /><a 
 id="x1-73030r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-73032r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;13:15:43</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-73034r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;files:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-73036r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;description:</span>
<br class="fancyvrb" /><a 
 id="x1-73038r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Introduce</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;typo</span><span 
class="pcrr7tn-">&#x00A0;into</span><span 
class="pcrr7tn-">&#x00A0;hello.c.</span>
<br class="fancyvrb" /><a 
 id="x1-73040r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-73042r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-73044r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;82e55d328c8c</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;057d3c2d823c</span><span 
class="pcrr7tn-">&#x00A0;hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-73046r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/hello.c        Fri</span><span 
class="pcrr7tn-">&#x00A0;Aug</span><span 
class="pcrr7tn-">&#x00A0;26</span><span 
class="pcrr7tn-">&#x00A0;01:21:28</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-73048r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/hello.c        Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;13:15:43</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-73050r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-11,6</span><span 
class="pcrr7tn-">&#x00A0;+11,6</span><span 
class="pcrr7tn-">&#x00A0;@@</span>
<br class="fancyvrb" /><a 
 id="x1-73052r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-73054r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;main(int</span><span 
class="pcrr7tn-">&#x00A0;argc,</span><span 
class="pcrr7tn-">&#x00A0;char</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;argv)</span>
<br class="fancyvrb" /><a 
 id="x1-73056r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span>
<br class="fancyvrb" /><a 
 id="x1-73058r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-        printf("hello,</span><span 
class="pcrr7tn-">&#x00A0;world!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">n");</span>
<br class="fancyvrb" /><a 
 id="x1-73060r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+        printf("hello,</span><span 
class="pcrr7tn-">&#x00A0;world!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">");</span>
<br class="fancyvrb" /><a 
 id="x1-73062r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        return</span><span 
class="pcrr7tn-">&#x00A0;0;</span>
<br class="fancyvrb" /><a 
 id="x1-73064r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-73066r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 271--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">3.5    </span> <a 
 id="x1-740003.5"></a>All about command options</h3>
<!--l. 273--><p class="noindent">Let&#x2019;s take a brief break from exploring Mercurial commands to discuss a pattern in the way that they work; you may find this
useful to keep in mind as we continue our tour.
</p><!--l. 277--><p class="indent">   Mercurial has a consistent and straightforward approach to dealing with the options that you can pass to commands. It
follows the conventions for options that are common to modern Linux and Unix systems. </p>
     <ul><li><span class="dt">
     </span><span class="dd">Every option has a long name. For example, as we&#x2019;ve already seen, the <a 
 id="dx1-74001"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; command accepts a <a 
 id="dx1-74002"></a><span 
class="pcrr7tn-">--rev</span>
     option.
     </span><li><span class="dt">
     </span><span class="dd">Most options have short names, too. Instead of <a 
 id="dx1-74003"></a><span 
class="pcrr7tn-">--rev</span>, we can use <a 
 id="dx1-74004"></a><span 
class="pcrr7tn-">-r</span>. (The reason that some options don&#x2019;t have
     short names is that the options in question are rarely used.)
                                                                                         
                                                                                         
     </span><li><span class="dt">
     </span><span class="dd">Long options start with two dashes (e.g.&#x00A0;<a 
 id="dx1-74005"></a><span 
class="pcrr7tn-">--rev</span>), while short options start with one (e.g.&#x00A0;<a 
 id="dx1-74006"></a><span 
class="pcrr7tn-">-r</span>).
     </span><li><span class="dt">
     </span><span class="dd">Option naming and usage is consistent across commands. For example, every command that lets you specify a
     changeset&#x00A0;ID or revision number accepts both <a 
 id="dx1-74007"></a><span 
class="pcrr7tn-">-r </span>and <a 
 id="dx1-74008"></a><span 
class="pcrr7tn-">--rev </span>arguments.</li></ul>
<!--l. 295--><p class="noindent">In the examples throughout this book, I use short options instead of long. This just reflects my own preference, so don&#x2019;t read
anything significant into it.
</p><!--l. 299--><p class="indent">   Most commands that print output of some kind will print more output when passed a <a 
 id="dx1-74009"></a><span 
class="pcrr7tn-">-v </span>(or <a 
 id="dx1-74010"></a><span 
class="pcrr7tn-">--verbose</span>) option, and less
when passed <a 
 id="dx1-74011"></a><span 
class="pcrr7tn-">-q </span>(or <a 
 id="dx1-74012"></a><span 
class="pcrr7tn-">--quiet</span>).
</p><!--l. 303--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">3.6    </span> <a 
 id="x1-750003.6"></a>Making and reviewing changes</h3>
<!--l. 305--><p class="noindent">Now that we have a grasp of viewing history in Mercurial, let&#x2019;s take a look at making some changes and examining
them.
</p><!--l. 308--><p class="indent">   The first thing we&#x2019;ll do is isolate our experiment in a repository of its own. We use the <a 
 id="dx1-75001"></a>&#x201C;<span 
class="pcrr7tn-">hg clone</span>&#x201D; command, but we don&#x2019;t
need to clone a copy of the remote repository. Since we already have a copy of it locally, we can just clone that instead. This is
much faster than cloning over the network, and cloning a local repository uses less disk space in most cases,
too.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-75003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-75005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;hello</span><span 
class="pcrb7t-">&#x00A0;my-hello</span>
<br class="fancyvrb" /><a 
 id="x1-75007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-75009r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;my-hello</span>
   </div>
<!--l. 315--><p class="noindent">As an aside, it&#x2019;s often good practice to keep a &#x201C;pristine&#x201D; copy of a remote repository around, which you can then
make temporary clones of to create sandboxes for each task you want to wshelork on. This lets you work on
multiple tasks in parallel, each isolated from the others until it&#x2019;s complete and you&#x2019;re ready to integrate it back.
Because local clones are so cheap, there&#x2019;s almost no overhead to cloning and destroying repositories whenever you
want.
</p><!--l. 323--><p class="indent">   In our <span 
class="pcrr7tn-">my-hello </span>repository, we have a file <span 
class="pcrr7tn-">hello.c </span>that contains the classic &#x201C;hello, world&#x201D; program. Let&#x2019;s use the ancient
and venerable <a 
 id="dx1-75010"></a><span 
class="pcrr7tn-">bb </span>command to edit this file so that it prints a second line of output. (I&#x2019;m only using <a 
 id="dx1-75011"></a><span 
class="pcrr7tn-">sed </span>to do this because it&#x2019;s
easy to write a scripted example this way. Since you&#x2019;re not under the same constraint, you probably won&#x2019;t want to use <a 
 id="dx1-75012"></a><span 
class="pcrr7tn-">sed</span>;
simply use your preferred text editor to do the same thing.)
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-75014r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">sed</span><span 
class="pcrb7t-">&#x00A0;-i</span><span 
class="pcrb7t-">&#x00A0;'/printf/a</span><span 
class="cmsy-10">&#x2216;&#x2216;</span><span 
class="pcrb7t-">tprintf("hello</span><span 
class="pcrb7t-">&#x00A0;again!</span><span 
class="cmsy-10">&#x2216;&#x2216;</span><span 
class="pcrb7t-">n");'</span><span 
class="pcrb7t-">&#x00A0;hello.c</span>
   </div>
<!--l. 333--><p class="indent">   Mercurial&#x2019;s <a 
 id="dx1-75015"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; command will tell us what Mercurial knows about the files in the repository.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-75017r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span>
<br class="fancyvrb" /><a 
 id="x1-75019r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Makefile</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-75021r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-75023r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;M</span><span 
class="pcrr7tn-">&#x00A0;hello.c</span>
   </div>
                                                                                         
                                                                                         
<!--l. 336--><p class="noindent">The <a 
 id="dx1-75024"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; command prints no output for some files, but a line starting with &#x201C;<span 
class="pcrr7tn-">M</span>&#x201D; for <span 
class="pcrr7tn-">hello.c</span>. Unless you tell it to, <a 
 id="dx1-75025"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">status</span>&#x201D; will not print any output for files that have not been modified.
</p><!--l. 341--><p class="indent">   The &#x201C;<span 
class="pcrr7tn-">M</span>&#x201D; indicates that Mercurial has noticed that we modified <span 
class="pcrr7tn-">hello.c</span>. We didn&#x2019;t need to <span 
class="ptmri7t-">inform </span>Mercurial that we were
going to modify the file before we started, or that we had modified the file after we were done; it was able to figure this out
itself.
</p><!--l. 347--><p class="indent">   It&#x2019;s a little bit helpful to know that we&#x2019;ve modified <span 
class="pcrr7tn-">hello.c</span>, but we might prefer to know exactly <span 
class="ptmri7t-">what </span>changes we&#x2019;ve made
to it. To do this, we use the <a 
 id="dx1-75026"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; command.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-75028r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;diff</span>
<br class="fancyvrb" /><a 
 id="x1-75030r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;b57f9a090b62</span><span 
class="pcrr7tn-">&#x00A0;hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-75032r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/hello.c        Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;15:43:07</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-75034r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/hello.c        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:35</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-75036r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-8,5</span><span 
class="pcrr7tn-">&#x00A0;+8,6</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;main(int</span><span 
class="pcrr7tn-">&#x00A0;argc,</span><span 
class="pcrr7tn-">&#x00A0;char</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;argv)</span>
<br class="fancyvrb" /><a 
 id="x1-75038r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;main(int</span><span 
class="pcrr7tn-">&#x00A0;argc,</span><span 
class="pcrr7tn-">&#x00A0;char</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;argv)</span>
<br class="fancyvrb" /><a 
 id="x1-75040r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span>
<br class="fancyvrb" /><a 
 id="x1-75042r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        printf("hello,</span><span 
class="pcrr7tn-">&#x00A0;world!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">");</span>
<br class="fancyvrb" /><a 
 id="x1-75044r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+        printf("hello</span><span 
class="pcrr7tn-">&#x00A0;again!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">n");</span>
<br class="fancyvrb" /><a 
 id="x1-75046r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        return</span><span 
class="pcrr7tn-">&#x00A0;0;</span>
<br class="fancyvrb" /><a 
 id="x1-75048r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">}</span>
   </div>
<!--l. 353--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">3.7    </span> <a 
 id="x1-760003.7"></a>Recording changes in a new changeset</h3>
<!--l. 355--><p class="noindent">We can modify files, build and test our changes, and use <a 
 id="dx1-76001"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; and <a 
 id="dx1-76002"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; to review our changes, until we&#x2019;re
satisfied with what we&#x2019;ve done and arrive at a natural stopping point where we want to record our work in a new
changeset.
</p><!--l. 360--><p class="indent">   The <a 
 id="dx1-76003"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; command lets us create a new changeset; we&#x2019;ll usually refer to this as &#x201C;making a commit&#x201D; or
&#x201C;committing&#x201D;.
</p><!--l. 363--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.7.1    </span> <a 
 id="x1-770003.7.1"></a>Setting up a username</h4>
<!--l. 365--><p class="noindent">When you try to run <a 
 id="dx1-77001"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; for the first time, it is not guaranteed to succeed. Mercurial records your name and address
with each change that you commit, so that you and others will later be able to tell who made each change. Mercurial tries to
automatically figure out a sensible username to commit the change with. It will attempt each of the following methods, in
order:
     </p><ol  class="enumerate1" >
     <li class="enumerate"><a 
 id="x1-77003x1"></a>If you specify a <a 
 id="dx1-77004"></a><span 
class="pcrr7tn-">-u </span>option to the <a 
 id="dx1-77005"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; command on the command line, followed by a username, this is
     always given the highest precedence.
     </li>
     <li class="enumerate"><a 
 id="x1-77007x2"></a>If you have set the <a 
 id="dx1-77008"></a><a 
 id="dx1-77009"></a><span 
class="pcrr7tn-">HGUSER </span>environment variable, this is checked next.
     </li>
     <li class="enumerate"><a 
 id="x1-77011x3"></a>If you create a file in your home directory called <a 
 id="dx1-77012"></a><span 
class="pcrr7tn-">.hgrc</span>, with a <a 
 id="dx1-77013"></a><span 
class="pcrr7tn-">username </span>entry, that will be used next. To see
     what the contents of this file should look like, refer to section&#x00A0;<a 
href="#x1-780003.7.1">3.7.1<!--tex4ht:ref: sec:tour-basic:username --></a> below.
                                                                                         
                                                                                         
     </li>
     <li class="enumerate"><a 
 id="x1-77015x4"></a>If you have set the <a 
 id="dx1-77016"></a><a 
 id="dx1-77017"></a><span 
class="pcrr7tn-">EMAIL </span>environment variable, this will be used next.
     </li>
     <li class="enumerate"><a 
 id="x1-77019x5"></a>Mercurial will query your system to find out your local user name and host name, and construct a username
     from these components. Since this often results in a username that is not very useful, it will print a warning if it
     has to do this.</li></ol>
<!--l. 388--><p class="noindent">If all of these mechanisms fail, Mercurial will fail, printing an error message. In this case, it will not let you commit until you set up
a username.
</p><!--l. 392--><p class="indent">   You should think of the <a 
 id="dx1-77020"></a><a 
 id="dx1-77021"></a><span 
class="pcrr7tn-">HGUSER </span>environment variable and the <a 
 id="dx1-77022"></a><span 
class="pcrr7tn-">-u </span>option to the <a 
 id="dx1-77023"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; command as ways to <span 
class="ptmri7t-">override</span>
Mercurial&#x2019;s default selection of username. For normal use, the simplest and most robust way to set a username for yourself is
by creating a <a 
 id="dx1-77024"></a><span 
class="pcrr7tn-">.hgrc </span>file; see below for details.
</p><!--l. 398--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-780003.7.1"></a>Creating a Mercurial configuration file</h5>
<!--l. 401--><p class="noindent">To set a user name, use your favourite editor to create a file called <a 
 id="dx1-78001"></a><span 
class="pcrr7tn-">.hgrc </span>in your home directory. Mercurial will use this
file to look up your personalised configuration settings. The initial contents of your <a 
 id="dx1-78002"></a><span 
class="pcrr7tn-">.hgrc </span>should look like
this.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-78004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;This</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;Mercurial</span><span 
class="pcrr7tn-">&#x00A0;configuration</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-78006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[ui]</span>
<br class="fancyvrb" /><a 
 id="x1-78008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;username</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;Firstname</span><span 
class="pcrr7tn-">&#x00A0;Lastname</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;email.address@domain.net&#x003e;</span>
   </div>
<!--l. 410--><p class="noindent">The &#x201C;<span 
class="pcrr7tn-">[ui]</span>&#x201D; line begins a <span 
class="ptmri7t-">section </span>of the config file, so you can read the &#x201C;<span 
class="pcrr7tn-">username = ...</span>&#x201D; line as meaning &#x201C;set the value of the
<span 
class="pcrr7tn-">username </span>item in the <span 
class="pcrr7tn-">ui </span>section&#x201D;. A section continues until a new section begins, or the end of the file. Mercurial ignores
empty lines and treats any text from &#x201C;<span 
class="pcrr7tn-">#</span>&#x201D; to the end of a line as a comment.
</p><!--l. 417--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-790003.7.1"></a>Choosing a user name</h5>
<!--l. 419--><p class="noindent">You can use any text you like as the value of the <span 
class="pcrr7tn-">username </span>config item, since this information is for reading by other people,
but for interpreting by Mercurial. The convention that most people follow is to use their name and email address, as in the
example above.
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:    </span>Mercurial&#x2019;s  built-in  web  server  obfuscates  email  addresses,  to  make  it
more difficult for the email harvesting tools that spammers use. This reduces the
likelihood that you&#x2019;ll start receiving more junk email if you publish a Mercurial
repository on the web.                                                                                                </div>
<!--l. 432--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.7.2    </span> <a 
 id="x1-800003.7.2"></a>Writing a commit message</h4>
<!--l. 434--><p class="noindent">When we commit a change, Mercurial drops us into a text editor, to enter a message that will describe the modifications we&#x2019;ve
made in this changeset. This is called the <span 
class="ptmri7t-">commit message</span>. It will be a record for readers of what we did and why, and it will be
printed by <a 
 id="dx1-80001"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; after we&#x2019;ve finished committing.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-80003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span>
   </div>
<!--l. 441--><p class="indent">   The editor that the <a 
 id="dx1-80004"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; command drops us into will contain an empty line, followed by a number of lines starting
with &#x201C;<span 
class="pcrr7tn-">HG:</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-80006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrro7t-">empty</span><span 
class="pcrro7t-">&#x00A0;line</span>
<br class="fancyvrb" /><a 
 id="x1-80008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;HG:</span><span 
class="pcrr7tn-">&#x00A0;changed</span><span 
class="pcrr7tn-">&#x00A0;hello.c</span>
   </div>
<!--l. 448--><p class="noindent">Mercurial ignores the lines that start with &#x201C;<span 
class="pcrr7tn-">HG:</span>&#x201D;; it uses them only to tell us which files it&#x2019;s recording changes to. Modifying or
deleting these lines has no effect.
</p><!--l. 452--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.7.3    </span> <a 
 id="x1-810003.7.3"></a>Writing a good commit message</h4>
<!--l. 454--><p class="noindent">Since <a 
 id="dx1-81001"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; only prints the first line of a commit message by default, it&#x2019;s best to write a commit message whose first line
stands alone. Here&#x2019;s a real example of a commit message that <span 
class="ptmri7t-">doesn&#x2019;t </span>follow this guideline, and hence has a summary that is not
readable.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-81003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;73:584af0e231be</span>
<br class="fancyvrb" /><a 
 id="x1-81005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Censored</span><span 
class="pcrr7tn-">&#x00A0;Person</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;censored.person@example.org&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-81007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;26</span><span 
class="pcrr7tn-">&#x00A0;21:37:07</span><span 
class="pcrr7tn-">&#x00A0;2006</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-81009r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;include</span><span 
class="pcrr7tn-">&#x00A0;buildmeister/commondefs.</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Add</span><span 
class="pcrr7tn-">&#x00A0;an</span><span 
class="pcrr7tn-">&#x00A0;exports</span><span 
class="pcrr7tn-">&#x00A0;and</span><span 
class="pcrr7tn-">&#x00A0;install</span>
   </div>
<!--l. 465--><p class="indent">   As far as the remainder of the contents of the commit message are concerned, there are no hard-and-fast rules. Mercurial
itself doesn&#x2019;t interpret or care about the contents of the commit message, though your project may have policies that dictate a
certain kind of formatting.
</p><!--l. 471--><p class="indent">   My personal preference is for short, but informative, commit messages that tell me something that I can&#x2019;t figure out with a
quick glance at the output of <a 
 id="dx1-81010"></a>&#x201C;<span 
class="pcrr7tn-">hg log --patch</span>&#x201D;.
</p><!--l. 475--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.7.4    </span> <a 
 id="x1-820003.7.4"></a>Aborting a commit</h4>
<!--l. 477--><p class="noindent">If you decide that you don&#x2019;t want to commit while in the middle of editing a commit message, simply exit from your editor
without saving the file that it&#x2019;s editing. This will cause nothing to happen to either the repository or the working
directory.
</p><!--l. 482--><p class="indent">   If we run the <a 
 id="dx1-82001"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; command without any arguments, it records all of the changes we&#x2019;ve made, as reported by <a 
 id="dx1-82002"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">status</span>&#x201D; and <a 
 id="dx1-82003"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D;.
                                                                                         
                                                                                         
</p><!--l. 486--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.7.5    </span> <a 
 id="x1-830003.7.5"></a>Admiring our new handiwork</h4>
<!--l. 488--><p class="noindent">Once we&#x2019;ve finished the commit, we can use the <a 
 id="dx1-83001"></a>&#x201C;<span 
class="pcrr7tn-">hg tip</span>&#x201D; command to display the changeset we just created.
This command produces output that is identical to <a 
 id="dx1-83002"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D;, but it only displays the newest revision in the
repository.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-83004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span><span 
class="pcrb7t-">&#x00A0;-vp</span>
<br class="fancyvrb" /><a 
 id="x1-83006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;5:c943cfd31ca5</span>
<br class="fancyvrb" /><a 
 id="x1-83008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-83010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-83012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:35</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-83014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;files:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-83016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;description:</span>
<br class="fancyvrb" /><a 
 id="x1-83018r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;an</span><span 
class="pcrr7tn-">&#x00A0;extra</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;output</span>
<br class="fancyvrb" /><a 
 id="x1-83020r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-83022r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-83024r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;b57f9a090b62</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;c943cfd31ca5</span><span 
class="pcrr7tn-">&#x00A0;hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-83026r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/hello.c        Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;15:43:07</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-83028r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/hello.c        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:35</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-83030r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-8,5</span><span 
class="pcrr7tn-">&#x00A0;+8,6</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;main(int</span><span 
class="pcrr7tn-">&#x00A0;argc,</span><span 
class="pcrr7tn-">&#x00A0;char</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;argv)</span>
<br class="fancyvrb" /><a 
 id="x1-83032r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;main(int</span><span 
class="pcrr7tn-">&#x00A0;argc,</span><span 
class="pcrr7tn-">&#x00A0;char</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;argv)</span>
<br class="fancyvrb" /><a 
 id="x1-83034r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span>
<br class="fancyvrb" /><a 
 id="x1-83036r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        printf("hello,</span><span 
class="pcrr7tn-">&#x00A0;world!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">");</span>
<br class="fancyvrb" /><a 
 id="x1-83038r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+        printf("hello</span><span 
class="pcrr7tn-">&#x00A0;again!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">n");</span>
<br class="fancyvrb" /><a 
 id="x1-83040r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        return</span><span 
class="pcrr7tn-">&#x00A0;0;</span>
<br class="fancyvrb" /><a 
 id="x1-83042r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-83044r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 493--><p class="noindent">We refer to the newest revision in the repository as the tip revision, or simply the tip.
</p><!--l. 496--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">3.8    </span> <a 
 id="x1-840003.8"></a>Sharing changes</h3>
<!--l. 498--><p class="noindent">We mentioned earlier that repositories in Mercurial are self-contained. This means that the changeset we just created
exists only in our <span 
class="pcrr7tn-">my-hello </span>repository. Let&#x2019;s look at a few ways that we can propagate this change into other
repositories.
</p><!--l. 503--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.8.1    </span> <a 
 id="x1-850003.8.1"></a>Pulling changes from another repository</h4>
<!--l. 506--><p class="noindent">To get started, let&#x2019;s clone our original <span 
class="pcrr7tn-">hello </span>repository, which does not contain the change we just committed. We&#x2019;ll call our
temporary repository <span 
class="pcrr7tn-">hello-pull</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
                                                                                         
                                                                                         
<a 
 id="x1-85002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-85004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;hello</span><span 
class="pcrb7t-">&#x00A0;hello-pull</span>
<br class="fancyvrb" /><a 
 id="x1-85006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
   </div>
<!--l. 511--><p class="indent">   We&#x2019;ll use the <a 
 id="dx1-85007"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; command to bring changes from <span 
class="pcrr7tn-">my-hello </span>into <span 
class="pcrr7tn-">hello-pull</span>. However, blindly pulling unknown
changes into a repository is a somewhat scary prospect. Mercurial provides the <a 
 id="dx1-85008"></a>&#x201C;<span 
class="pcrr7tn-">hg incoming</span>&#x201D; command to tell us
what changes the <a 
 id="dx1-85009"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; command <span 
class="ptmri7t-">would </span>pull into the repository, without actually pulling the changes
in.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-85011r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;hello-pull</span>
<br class="fancyvrb" /><a 
 id="x1-85013r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;incoming</span><span 
class="pcrb7t-">&#x00A0;../my-hello</span>
<br class="fancyvrb" /><a 
 id="x1-85015r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-85017r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;5:c943cfd31ca5</span>
<br class="fancyvrb" /><a 
 id="x1-85019r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-85021r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-85023r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:35</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-85025r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;an</span><span 
class="pcrr7tn-">&#x00A0;extra</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;output</span>
<br class="fancyvrb" /><a 
 id="x1-85027r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 518--><p class="noindent">(Of course, someone could cause more changesets to appear in the repository that we ran <a 
 id="dx1-85028"></a>&#x201C;<span 
class="pcrr7tn-">hg incoming</span>&#x201D; in, before we get a
chance to <a 
 id="dx1-85029"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; the changes, so that we could end up pulling changes that we didn&#x2019;t expect.)
</p><!--l. 523--><p class="indent">   Bringing changes into a repository is a simple matter of running the <a 
 id="dx1-85030"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; command, and telling it which repository to
pull from.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-85032r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-85034r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;4:b57f9a090b62</span>
<br class="fancyvrb" /><a 
 id="x1-85036r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-85038r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-85040r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;15:43:07</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-85042r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Trim</span><span 
class="pcrr7tn-">&#x00A0;comments.</span>
<br class="fancyvrb" /><a 
 id="x1-85044r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-85046r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;pull</span><span 
class="pcrb7t-">&#x00A0;../my-hello</span>
<br class="fancyvrb" /><a 
 id="x1-85048r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pulling</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;../my-hello</span>
<br class="fancyvrb" /><a 
 id="x1-85050r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-85052r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-85054r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-85056r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-85058r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span>
<br class="fancyvrb" /><a 
 id="x1-85060r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(run</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;update'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;get</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;working</span><span 
class="pcrr7tn-">&#x00A0;copy)</span>
<br class="fancyvrb" /><a 
 id="x1-85062r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-85064r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;5:c943cfd31ca5</span>
<br class="fancyvrb" /><a 
 id="x1-85066r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-85068r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-85070r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:35</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-85072r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;an</span><span 
class="pcrr7tn-">&#x00A0;extra</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;output</span>
<br class="fancyvrb" /><a 
 id="x1-85074r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
                                                                                         
                                                                                         
<!--l. 526--><p class="noindent">As you can see from the before-and-after output of <a 
 id="dx1-85075"></a>&#x201C;<span 
class="pcrr7tn-">hg tip</span>&#x201D;, we have successfully pulled changes into our repository. There
remains one step before we can see these changes in the working directory.
</p><!--l. 530--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.8.2    </span> <a 
 id="x1-860003.8.2"></a>Updating the working directory</h4>
<!--l. 532--><p class="noindent">We have so far glossed over the relationship between a repository and its working directory. The <a 
 id="dx1-86001"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; command that we
ran in section&#x00A0;<a 
href="#x1-850003.8.1">3.8.1<!--tex4ht:ref: sec:tour:pull --></a> brought changes into the repository, but if we check, there&#x2019;s no sign of those changes in the working
directory. This is because <a 
 id="dx1-86002"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; does not (by default) touch the working directory. Instead, we use the <a 
 id="dx1-86003"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D;
command to do this.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-86005r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">grep</span><span 
class="pcrb7t-">&#x00A0;printf</span><span 
class="pcrb7t-">&#x00A0;hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-86007r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        printf("hello,</span><span 
class="pcrr7tn-">&#x00A0;world!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">");</span>
<br class="fancyvrb" /><a 
 id="x1-86009r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;update</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-86011r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-86013r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">grep</span><span 
class="pcrb7t-">&#x00A0;printf</span><span 
class="pcrb7t-">&#x00A0;hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-86015r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        printf("hello,</span><span 
class="pcrr7tn-">&#x00A0;world!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">");</span>
<br class="fancyvrb" /><a 
 id="x1-86017r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        printf("hello</span><span 
class="pcrr7tn-">&#x00A0;again!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">n");</span>
   </div>
<!--l. 541--><p class="indent">   It might seem a bit strange that <a 
 id="dx1-86018"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; doesn&#x2019;t update the working directory automatically. There&#x2019;s actually a good
reason for this: you can use <a 
 id="dx1-86019"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; to update the working directory to the state it was in at <span 
class="ptmri7t-">any revision </span>in the history of
the repository. If you had the working directory updated to an old revision&#x2014;to hunt down the origin of a bug, say&#x2014;and ran a
<a 
 id="dx1-86020"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; which automatically updated the working directory to a new revision, you might not be terribly
happy.
</p><!--l. 550--><p class="indent">   However, since pull-then-update is such a common thing to do, Mercurial lets you combine the two by passing the <a 
 id="dx1-86021"></a><span 
class="pcrr7tn-">-u</span>
option to <a 
 id="dx1-86022"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-86024r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;pull</span><span 
class="pcrr7tn-">&#x00A0;-u</span>
   </div>
<!--l. 556--><p class="noindent">If you look back at the output of <a 
 id="dx1-86025"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; in section&#x00A0;<a 
href="#x1-850003.8.1">3.8.1<!--tex4ht:ref: sec:tour:pull --></a> when we ran it without <a 
 id="dx1-86026"></a><span 
class="pcrr7tn-">-u</span>, you can see that it printed a helpful
reminder that we&#x2019;d have to take an explicit step to update the working directory:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-86028r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(run</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;update'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;get</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;working</span><span 
class="pcrr7tn-">&#x00A0;copy)</span>
   </div>
<!--l. 564--><p class="indent">   To find out what revision the working directory is at, use the <a 
 id="dx1-86029"></a>&#x201C;<span 
class="pcrr7tn-">hg parents</span>&#x201D; command.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-86031r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;parents</span>
<br class="fancyvrb" /><a 
 id="x1-86033r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;5:c943cfd31ca5</span>
<br class="fancyvrb" /><a 
 id="x1-86035r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-86037r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-86039r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:35</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-86041r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;an</span><span 
class="pcrr7tn-">&#x00A0;extra</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;output</span>
<br class="fancyvrb" /><a 
 id="x1-86043r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
                                                                                         
                                                                                         
<!--l. 567--><p class="noindent">If you look back at figure&#x00A0;<a 
href="#x1-700581">3.1<!--tex4ht:ref: fig:tour-basic:history --></a>, you&#x2019;ll see arrows connecting each changeset. The node that the arrow leads <span 
class="ptmri7t-">from </span>in each case is a
parent, and the node that the arrow leads <span 
class="ptmri7t-">to </span>is its child. The working directory has a parent in just the same way; this is the
changeset that the working directory currently contains.
</p><!--l. 574--><p class="indent">   To update the working directory to a particular revision, give a revision number or changeset&#x00A0;ID to the <a 
 id="dx1-86044"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D;
command.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-86046r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;update</span><span 
class="pcrb7t-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-86048r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-86050r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;parents</span>
<br class="fancyvrb" /><a 
 id="x1-86052r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:057d3c2d823c</span>
<br class="fancyvrb" /><a 
 id="x1-86054r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-86056r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tue</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;06</span><span 
class="pcrr7tn-">&#x00A0;13:15:43</span><span 
class="pcrr7tn-">&#x00A0;2005</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-86058r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Introduce</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;typo</span><span 
class="pcrr7tn-">&#x00A0;into</span><span 
class="pcrr7tn-">&#x00A0;hello.c.</span>
<br class="fancyvrb" /><a 
 id="x1-86060r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-86062r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;update</span>
<br class="fancyvrb" /><a 
 id="x1-86064r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
   </div>
<!--l. 577--><p class="noindent">If you omit an explicit revision, <a 
 id="dx1-86065"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; will update to the tip revision, as shown by the second call to <a 
 id="dx1-86066"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; in the
example above.
</p><!--l. 581--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.8.3    </span> <a 
 id="x1-870003.8.3"></a>Pushing changes to another repository</h4>
<!--l. 583--><p class="noindent">Mercurial lets us push changes to another repository, from the repository we&#x2019;re currently visiting. As with the example of <a 
 id="dx1-87001"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">pull</span>&#x201D; above, we&#x2019;ll create a temporary repository to push our changes into.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-87003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-87005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;hello</span><span 
class="pcrb7t-">&#x00A0;hello-push</span>
<br class="fancyvrb" /><a 
 id="x1-87007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
   </div>
<!--l. 588--><p class="noindent">The <a 
 id="dx1-87008"></a>&#x201C;<span 
class="pcrr7tn-">hg outgoing</span>&#x201D; command tells us what changes would be pushed into another repository.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-87010r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;my-hello</span>
<br class="fancyvrb" /><a 
 id="x1-87012r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;outgoing</span><span 
class="pcrb7t-">&#x00A0;../hello-push</span>
<br class="fancyvrb" /><a 
 id="x1-87014r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-87016r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;5:c943cfd31ca5</span>
<br class="fancyvrb" /><a 
 id="x1-87018r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-87020r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-87022r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:35</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-87024r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;an</span><span 
class="pcrr7tn-">&#x00A0;extra</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;output</span>
<br class="fancyvrb" /><a 
 id="x1-87026r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 591--><p class="noindent">And the <a 
 id="dx1-87027"></a>&#x201C;<span 
class="pcrr7tn-">hg push</span>&#x201D; command does the actual push.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-87029r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;push</span><span 
class="pcrb7t-">&#x00A0;../hello-push</span>
<br class="fancyvrb" /><a 
 id="x1-87031r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pushing</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;../hello-push</span>
<br class="fancyvrb" /><a 
 id="x1-87033r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-87035r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-87037r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-87039r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-87041r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span>
   </div>
<!--l. 593--><p class="noindent">As with <a 
 id="dx1-87042"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D;, the <a 
 id="dx1-87043"></a>&#x201C;<span 
class="pcrr7tn-">hg push</span>&#x201D; command does not update the working directory in the repository that it&#x2019;s pushing changes
into. (Unlike <a 
 id="dx1-87044"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D;, <a 
 id="dx1-87045"></a>&#x201C;<span 
class="pcrr7tn-">hg push</span>&#x201D; does not provide a <span 
class="pcrr7tn-">-u </span>option that updates the other repository&#x2019;s working
directory.)
</p><!--l. 598--><p class="indent">   What happens if we try to pull or push changes and the receiving repository already has those changes? Nothing too
exciting.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-87047r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;push</span><span 
class="pcrb7t-">&#x00A0;../hello-push</span>
<br class="fancyvrb" /><a 
 id="x1-87049r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pushing</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;../hello-push</span>
<br class="fancyvrb" /><a 
 id="x1-87051r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-87053r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;no</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;found</span>
   </div>
<!--l. 602--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.8.4    </span> <a 
 id="x1-880003.8.4"></a>Sharing changes over a network</h4>
<!--l. 604--><p class="noindent">The commands we have covered in the previous few sections are not limited to working with local repositories.
Each works in exactly the same fashion over a network connection; simply pass in a URL instead of a local
path.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-88002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;outgoing</span><span 
class="pcrb7t-">&#x00A0;http://hg.serpentine.com/tutorial/hello</span>
<br class="fancyvrb" /><a 
 id="x1-88004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-88006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;5:c943cfd31ca5</span>
<br class="fancyvrb" /><a 
 id="x1-88008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-88010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-88012r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:35</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-88014r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;an</span><span 
class="pcrr7tn-">&#x00A0;extra</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;output</span>
<br class="fancyvrb" /><a 
 id="x1-88016r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 609--><p class="noindent">In this example, we can see what changes we could push to the remote repository, but the repository is understandably not set up to
let anonymous users push to it.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-88018r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;push</span><span 
class="pcrb7t-">&#x00A0;http://hg.serpentine.com/tutorial/hello</span>
<br class="fancyvrb" /><a 
 id="x1-88020r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pushing</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;http://hg.serpentine.com/tutorial/hello</span>
<br class="fancyvrb" /><a 
 id="x1-88022r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-88024r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;ssl</span><span 
class="pcrr7tn-">&#x00A0;required</span>
                                                                                         
                                                                                         
   </div>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;4</span><br /><a 
 id="x1-890004"></a>A tour of Mercurial: merging work</h2>
<!--l. 4--><p class="noindent">We&#x2019;ve now covered cloning a repository, making changes in a repository, and pulling or pushing changes from one repository
into another. Our next step is <span 
class="ptmri7t-">merging </span>changes from separate repositories.
</p>
   <h3 class="sectionHead"><span class="titlemark">4.1    </span> <a 
 id="x1-900004.1"></a>Merging streams of work</h3>
<!--l. 11--><p class="noindent">Merging is a fundamental part of working with a distributed revision control tool. </p>
     <ul><li><span class="dt">
     </span><span class="dd">Alice and Bob each have a personal copy of a repository for a project they&#x2019;re collaborating on. Alice fixes a bug
     in her repository; Bob adds a new feature in his. They want the shared repository to contain both the bug fix and
     the new feature.
     </span><li><span class="dt">
     </span><span class="dd">I frequently work on several different tasks for a single project at once, each safely isolated in its own repository.
     Working this way means that I often need to merge one piece of my own work with another.</li></ul>
<!--l. 24--><p class="indent">   Because merging is such a common thing to need to do, Mercurial makes it easy. Let&#x2019;s walk through the
process. We&#x2019;ll begin by cloning yet another repository (see how often they spring up?) and making a change in
it.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-90002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-90004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;hello</span><span 
class="pcrb7t-">&#x00A0;my-new-hello</span>
<br class="fancyvrb" /><a 
 id="x1-90006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-90008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;my-new-hello</span>
<br class="fancyvrb" /><a 
 id="x1-90010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">sed</span><span 
class="pcrb7t-">&#x00A0;-i</span><span 
class="pcrb7t-">&#x00A0;'/printf/i</span><span 
class="cmsy-10">&#x2216;&#x2216;</span><span 
class="pcrb7t-">tprintf("once</span><span 
class="pcrb7t-">&#x00A0;more,</span><span 
class="pcrb7t-">&#x00A0;hello.</span><span 
class="cmsy-10">&#x2216;&#x2216;</span><span 
class="pcrb7t-">n");'</span><span 
class="pcrb7t-">&#x00A0;hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-90012r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'A</span><span 
class="pcrb7t-">&#x00A0;new</span><span 
class="pcrb7t-">&#x00A0;hello</span><span 
class="pcrb7t-">&#x00A0;for</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;new</span><span 
class="pcrb7t-">&#x00A0;day.'</span>
   </div>
<!--l. 29--><p class="noindent">We should now have two copies of <span 
class="pcrr7tn-">hello.c </span>with different contents. The histories of the two repositories have also diverged, as
illustrated in figure&#x00A0;<a 
href="#x1-900691">4.1<!--tex4ht:ref: fig:tour-merge:sep-repos --></a>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-90014r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-90016r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;/&#x22C6;</span>
<br class="fancyvrb" /><a 
 id="x1-90018r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;Placed</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;public</span><span 
class="pcrr7tn-">&#x00A0;domain</span><span 
class="pcrr7tn-">&#x00A0;by</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan.</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;This</span><span 
class="pcrr7tn-">&#x00A0;program</span><span 
class="pcrr7tn-">&#x00A0;is</span>
<br class="fancyvrb" /><a 
 id="x1-90020r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;covered</span><span 
class="pcrr7tn-">&#x00A0;by</span><span 
class="pcrr7tn-">&#x00A0;patents</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;United</span><span 
class="pcrr7tn-">&#x00A0;States</span><span 
class="pcrr7tn-">&#x00A0;or</span><span 
class="pcrr7tn-">&#x00A0;other</span><span 
class="pcrr7tn-">&#x00A0;countries.</span>
<br class="fancyvrb" /><a 
 id="x1-90022r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;/</span>
<br class="fancyvrb" /><a 
 id="x1-90024r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-90026r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#include</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;stdio.h&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-90028r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-90030r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;main(int</span><span 
class="pcrr7tn-">&#x00A0;argc,</span><span 
class="pcrr7tn-">&#x00A0;char</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;argv)</span>
<br class="fancyvrb" /><a 
 id="x1-90032r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span>
<br class="fancyvrb" /><a 
 id="x1-90034r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        printf("once</span><span 
class="pcrr7tn-">&#x00A0;more,</span><span 
class="pcrr7tn-">&#x00A0;hello.</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">n");</span>
<br class="fancyvrb" /><a 
 id="x1-90036r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        printf("hello,</span><span 
class="pcrr7tn-">&#x00A0;world!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">");</span>
<br class="fancyvrb" /><a 
 id="x1-90038r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        return</span><span 
class="pcrr7tn-">&#x00A0;0;</span>
<br class="fancyvrb" /><a 
 id="x1-90040r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-90042r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;../my-hello/hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-90044r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;/&#x22C6;</span>
<br class="fancyvrb" /><a 
 id="x1-90046r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;Placed</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;public</span><span 
class="pcrr7tn-">&#x00A0;domain</span><span 
class="pcrr7tn-">&#x00A0;by</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan.</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;This</span><span 
class="pcrr7tn-">&#x00A0;program</span><span 
class="pcrr7tn-">&#x00A0;is</span>
<br class="fancyvrb" /><a 
 id="x1-90048r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;covered</span><span 
class="pcrr7tn-">&#x00A0;by</span><span 
class="pcrr7tn-">&#x00A0;patents</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;United</span><span 
class="pcrr7tn-">&#x00A0;States</span><span 
class="pcrr7tn-">&#x00A0;or</span><span 
class="pcrr7tn-">&#x00A0;other</span><span 
class="pcrr7tn-">&#x00A0;countries.</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-90050r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;/</span>
<br class="fancyvrb" /><a 
 id="x1-90052r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-90054r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#include</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;stdio.h&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-90056r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-90058r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;main(int</span><span 
class="pcrr7tn-">&#x00A0;argc,</span><span 
class="pcrr7tn-">&#x00A0;char</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;argv)</span>
<br class="fancyvrb" /><a 
 id="x1-90060r24"></a><span 
class="ptmr7t-x-x-50">24</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span>
<br class="fancyvrb" /><a 
 id="x1-90062r25"></a><span 
class="ptmr7t-x-x-50">25</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        printf("hello,</span><span 
class="pcrr7tn-">&#x00A0;world!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">");</span>
<br class="fancyvrb" /><a 
 id="x1-90064r26"></a><span 
class="ptmr7t-x-x-50">26</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        printf("hello</span><span 
class="pcrr7tn-">&#x00A0;again!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">n");</span>
<br class="fancyvrb" /><a 
 id="x1-90066r27"></a><span 
class="ptmr7t-x-x-50">27</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        return</span><span 
class="pcrr7tn-">&#x00A0;0;</span>
<br class="fancyvrb" /><a 
 id="x1-90068r28"></a><span 
class="ptmr7t-x-x-50">28</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">}</span>
   </div>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-900691"></a>
                                                                                         
                                                                                         
<!--l. 36--><p class="noindent"><img 
src="tour-merge-sep-repos.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;4.1: </td><td  
class="content">Divergent recent histories of the <span 
class="pcrr7tn-">my-hello </span>and <span 
class="pcrr7tn-">my-new-hello </span>repositories</td></tr></table><!--tex4ht:label?: x1-900691 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 42--><p class="indent">   We already know that pulling changes from our <span 
class="pcrr7tn-">my-hello </span>repository will have no effect on the working
directory.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-90071r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;pull</span><span 
class="pcrb7t-">&#x00A0;../my-hello</span>
<br class="fancyvrb" /><a 
 id="x1-90073r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pulling</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;../my-hello</span>
<br class="fancyvrb" /><a 
 id="x1-90075r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-90077r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-90079r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-90081r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-90083r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;(+1</span><span 
class="pcrr7tn-">&#x00A0;heads)</span>
<br class="fancyvrb" /><a 
 id="x1-90085r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(run</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;heads'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;heads,</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;merge'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;merge)</span>
   </div>
<!--l. 45--><p class="noindent">However, the <a 
 id="dx1-90086"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; command says something about &#x201C;heads&#x201D;.
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.1.1    </span> <a 
 id="x1-910004.1.1"></a>Head changesets</h4>
<!--l. 49--><p class="noindent">A head is a change that has no descendants, or children, as they&#x2019;re also known. The tip revision is thus a head,
because the newest revision in a repository doesn&#x2019;t have any children, but a repository can contain more than one
head.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-910012"></a>
                                                                                         
                                                                                         
<!--l. 56--><p class="noindent"><img 
src="tour-merge-pull.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;4.2: </td><td  
class="content">Repository contents after pulling from <span 
class="pcrr7tn-">my-hello </span>into <span 
class="pcrr7tn-">my-new-hello</span></td></tr></table><!--tex4ht:label?: x1-910012 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 62--><p class="indent">   In figure&#x00A0;<a 
href="#x1-910012">4.2<!--tex4ht:ref: fig:tour-merge:pull --></a>, you can see the effect of the pull from <span 
class="pcrr7tn-">my-hello </span>into <span 
class="pcrr7tn-">my-new-hello</span>. The history that was already present in
<span 
class="pcrr7tn-">my-new-hello </span>is untouched, but a new revision has been added. By referring to figure&#x00A0;<a 
href="#x1-900691">4.1<!--tex4ht:ref: fig:tour-merge:sep-repos --></a>, we can see that the <span 
class="ptmri7t-">changeset ID</span>
remains the same in the new repository, but the <span 
class="ptmri7t-">revision number </span>has changed. (This, incidentally, is a fine example of why it&#x2019;s
not safe to use revision numbers when discussing changesets.) We can view the heads in a repository using the <a 
 id="dx1-91002"></a>&#x201C;<span 
class="pcrr7tn-">hg heads</span>&#x201D;
command.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-91004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;heads</span>
<br class="fancyvrb" /><a 
 id="x1-91006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;6:c943cfd31ca5</span>
<br class="fancyvrb" /><a 
 id="x1-91008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-91010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;parent:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;4:b57f9a090b62</span>
<br class="fancyvrb" /><a 
 id="x1-91012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-91014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:35</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-91016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;an</span><span 
class="pcrr7tn-">&#x00A0;extra</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;output</span>
<br class="fancyvrb" /><a 
 id="x1-91018r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-91020r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;5:19651aae2b19</span>
<br class="fancyvrb" /><a 
 id="x1-91022r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-91024r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:40</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-91026r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;new</span><span 
class="pcrr7tn-">&#x00A0;hello</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;new</span><span 
class="pcrr7tn-">&#x00A0;day.</span>
<br class="fancyvrb" /><a 
 id="x1-91028r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
   <h4 class="subsectionHead"><span class="titlemark">4.1.2    </span> <a 
 id="x1-920004.1.2"></a>Performing the merge</h4>
<!--l. 76--><p class="noindent">What happens if we try to use the normal <a 
 id="dx1-92001"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; command to update to the new tip?
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-92003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;update</span>
<br class="fancyvrb" /><a 
 id="x1-92005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;update</span><span 
class="pcrr7tn-">&#x00A0;spans</span><span 
class="pcrr7tn-">&#x00A0;branches,</span><span 
class="pcrr7tn-">&#x00A0;use</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;merge'</span><span 
class="pcrr7tn-">&#x00A0;or</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;update</span><span 
class="pcrr7tn-">&#x00A0;-C'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;lose</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
   </div>
<!--l. 79--><p class="noindent">Mercurial is telling us that the <a 
 id="dx1-92006"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; command won&#x2019;t do a merge; it won&#x2019;t update the working directory when it thinks we
might be wanting to do a merge, unless we force it to do so. Instead, we use the <a 
 id="dx1-92007"></a>&#x201C;<span 
class="pcrr7tn-">hg merge</span>&#x201D; command to merge the two
heads.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-92009r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;merge</span>
<br class="fancyvrb" /><a 
 id="x1-92011r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;merging</span><span 
class="pcrr7tn-">&#x00A0;hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-92013r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-92015r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(branch</span><span 
class="pcrr7tn-">&#x00A0;merge,</span><span 
class="pcrr7tn-">&#x00A0;don't</span><span 
class="pcrr7tn-">&#x00A0;forget</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;commit)</span>
   </div>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-920163"></a>
                                                                                         
                                                                                         
<!--l. 87--><p class="noindent"><img 
src="tour-merge-merge.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;4.3: </td><td  
class="content">Working directory and repository during merge, and following commit</td></tr></table><!--tex4ht:label?: x1-920163 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 93--><p class="indent">   This updates the working directory so that it contains changes from <span 
class="ptmri7t-">both </span>heads, which is reflected in both the output of <a 
 id="dx1-92017"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">parents</span>&#x201D; and the contents of <span 
class="pcrr7tn-">hello.c</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-92019r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;parents</span>
<br class="fancyvrb" /><a 
 id="x1-92021r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;5:19651aae2b19</span>
<br class="fancyvrb" /><a 
 id="x1-92023r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-92025r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:40</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-92027r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;new</span><span 
class="pcrr7tn-">&#x00A0;hello</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;new</span><span 
class="pcrr7tn-">&#x00A0;day.</span>
<br class="fancyvrb" /><a 
 id="x1-92029r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-92031r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;6:c943cfd31ca5</span>
<br class="fancyvrb" /><a 
 id="x1-92033r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-92035r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;parent:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;4:b57f9a090b62</span>
<br class="fancyvrb" /><a 
 id="x1-92037r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-92039r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:35</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-92041r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;an</span><span 
class="pcrr7tn-">&#x00A0;extra</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;output</span>
<br class="fancyvrb" /><a 
 id="x1-92043r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-92045r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;hello.c</span>
<br class="fancyvrb" /><a 
 id="x1-92047r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;/&#x22C6;</span>
<br class="fancyvrb" /><a 
 id="x1-92049r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;Placed</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;public</span><span 
class="pcrr7tn-">&#x00A0;domain</span><span 
class="pcrr7tn-">&#x00A0;by</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan.</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;This</span><span 
class="pcrr7tn-">&#x00A0;program</span><span 
class="pcrr7tn-">&#x00A0;is</span>
<br class="fancyvrb" /><a 
 id="x1-92051r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;covered</span><span 
class="pcrr7tn-">&#x00A0;by</span><span 
class="pcrr7tn-">&#x00A0;patents</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;United</span><span 
class="pcrr7tn-">&#x00A0;States</span><span 
class="pcrr7tn-">&#x00A0;or</span><span 
class="pcrr7tn-">&#x00A0;other</span><span 
class="pcrr7tn-">&#x00A0;countries.</span>
<br class="fancyvrb" /><a 
 id="x1-92053r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;/</span>
<br class="fancyvrb" /><a 
 id="x1-92055r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-92057r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#include</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;stdio.h&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-92059r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-92061r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;main(int</span><span 
class="pcrr7tn-">&#x00A0;argc,</span><span 
class="pcrr7tn-">&#x00A0;char</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;argv)</span>
<br class="fancyvrb" /><a 
 id="x1-92063r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span>
<br class="fancyvrb" /><a 
 id="x1-92065r24"></a><span 
class="ptmr7t-x-x-50">24</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        printf("once</span><span 
class="pcrr7tn-">&#x00A0;more,</span><span 
class="pcrr7tn-">&#x00A0;hello.</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">n");</span>
<br class="fancyvrb" /><a 
 id="x1-92067r25"></a><span 
class="ptmr7t-x-x-50">25</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        printf("hello,</span><span 
class="pcrr7tn-">&#x00A0;world!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">");</span>
<br class="fancyvrb" /><a 
 id="x1-92069r26"></a><span 
class="ptmr7t-x-x-50">26</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        printf("hello</span><span 
class="pcrr7tn-">&#x00A0;again!</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">n");</span>
<br class="fancyvrb" /><a 
 id="x1-92071r27"></a><span 
class="ptmr7t-x-x-50">27</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        return</span><span 
class="pcrr7tn-">&#x00A0;0;</span>
<br class="fancyvrb" /><a 
 id="x1-92073r28"></a><span 
class="ptmr7t-x-x-50">28</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">}</span>
   </div>
   <h4 class="subsectionHead"><span class="titlemark">4.1.3    </span> <a 
 id="x1-930004.1.3"></a>Committing the results of the merge</h4>
<!--l. 100--><p class="noindent">Whenever we&#x2019;ve done a merge, <a 
 id="dx1-93001"></a>&#x201C;<span 
class="pcrr7tn-">hg parents</span>&#x201D; will display two parents until we <a 
 id="dx1-93002"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; the results of the
merge.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-93004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Merged</span><span 
class="pcrb7t-">&#x00A0;changes'</span>
   </div>
<!--l. 103--><p class="noindent">We now have a new tip revision; notice that it has <span 
class="ptmri7t-">both </span>of our former heads as its parents. These are the same revisions that were
previously displayed by <a 
 id="dx1-93005"></a>&#x201C;<span 
class="pcrr7tn-">hg parents</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-93007r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-93009r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;7:8d9526d30c7f</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-93011r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-93013r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;parent:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;5:19651aae2b19</span>
<br class="fancyvrb" /><a 
 id="x1-93015r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;parent:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;6:c943cfd31ca5</span>
<br class="fancyvrb" /><a 
 id="x1-93017r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-93019r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:40</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-93021r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Merged</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-93023r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 107--><p class="noindent">In figure&#x00A0;<a 
href="#x1-920163">4.3<!--tex4ht:ref: fig:tour-merge:merge --></a>, you can see a representation of what happens to the working directory during the merge, and how this affects the
repository when the commit happens. During the merge, the working directory has two parent changesets, and these become
the parents of the new changeset.
</p><!--l. 113--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">4.2    </span> <a 
 id="x1-940004.2"></a>Merging conflicting changes</h3>
<!--l. 115--><p class="noindent">Most merges are simple affairs, but sometimes you&#x2019;ll find yourself merging changes where each modifies the same portions of
the same files. Unless both modifications are identical, this results in a <span 
class="ptmri7t-">conflict</span>, where you have to decide how to reconcile the
different changes into something coherent.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-940014"></a>
                                                                                         
                                                                                         
<!--l. 123--><p class="noindent"><img 
src="tour-merge-conflict.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;4.4: </td><td  
class="content">Conflicting changes to a document</td></tr></table><!--tex4ht:label?: x1-940014 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 128--><p class="indent">   Figure&#x00A0;<a 
href="#x1-940014">4.4<!--tex4ht:ref: fig:tour-merge:conflict --></a> illustrates an instance of two conflicting changes to a document. We started with a single version of the file; then
we made some changes; while someone else made different changes to the same text. Our task in resolving the conflicting
changes is to decide what the file should look like.
</p><!--l. 134--><p class="indent">   Mercurial doesn&#x2019;t have a built-in facility for handling conflicts. Instead, it runs an external program called <a 
 id="dx1-94002"></a><span 
class="pcrr7tn-">hgmerge</span>. This is
a shell script that is bundled with Mercurial; you can change it to behave however you please. What it does by default is try to
find one of several different merging tools that are likely to be installed on your system. It first tries a few fully automatic
merging tools; if these don&#x2019;t succeed (because the resolution process requires human guidance) or aren&#x2019;t present, the script tries
a few different graphical merging tools.
</p><!--l. 144--><p class="indent">   It&#x2019;s also possible to get Mercurial to run another program or script instead of <a 
 id="dx1-94003"></a><span 
class="pcrr7tn-">hgmerge</span>, by setting the <a 
 id="dx1-94004"></a><a 
 id="dx1-94005"></a><span 
class="pcrr7tn-">HGMERGE </span>environment
variable to the name of your preferred program.
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.2.1    </span> <a 
 id="x1-950004.2.1"></a>Using a graphical merge tool</h4>
<!--l. 150--><p class="noindent">My preferred graphical merge tool is <a 
 id="dx1-95001"></a><span 
class="pcrr7tn-">kdiff3</span>, which I&#x2019;ll use to describe the features that are common to graphical file merging
tools. You can see a screenshot of <a 
 id="dx1-95002"></a><span 
class="pcrr7tn-">kdiff3 </span>in action in figure&#x00A0;<a 
href="#x1-950035">4.5<!--tex4ht:ref: fig:tour-merge:kdiff3 --></a>. The kind of merge it is performing is called a <span 
class="ptmri7t-">three-way</span>
<span 
class="ptmri7t-">merge</span>, because there are three different versions of the file of interest to us. The tool thus splits the upper portion of the window
into three panes: </p>
     <ul><li><span class="dt">
     </span><span class="dd">At the left is the <span 
class="ptmri7t-">base </span>version of the file, i.e.&#x00A0;the most recent version from which the two versions we&#x2019;re trying
     to merge are descended.
     </span><li><span class="dt">
     </span><span class="dd">In the middle is &#x201C;our&#x201D; version of the file, with the contents that we modified.
     </span><li><span class="dt">
     </span><span class="dd">On the right is &#x201C;their&#x201D; version of the file, the one that from the changeset that we&#x2019;re trying to merge with.</li></ul>
<!--l. 166--><p class="noindent">In the pane below these is the current <span 
class="ptmri7t-">result </span>of the merge. Our task is to replace all of the red text, which indicates unresolved
conflicts, with some sensible merger of the &#x201C;ours&#x201D; and &#x201C;theirs&#x201D; versions of the file.
</p><!--l. 171--><p class="indent">   All four of these panes are <span 
class="ptmri7t-">locked together</span>; if we scroll vertically or horizontally in any of them, the others are updated to
display the corresponding sections of their respective files.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-950035"></a>
                                                                                         
                                                                                         
<!--l. 177--><p class="noindent"><img 
src="kdiff3.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;4.5: </td><td  
class="content">Using <a 
 id="dx1-95004"></a><span 
class="pcrr7tn-">kdiff3 </span>to merge versions of a file</td></tr></table><!--tex4ht:label?: x1-950035 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 182--><p class="indent">   For each conflicting portion of the file, we can choose to resolve the conflict using some combination of text from the base
version, ours, or theirs. We can also manually edit the merged file at any time, in case we need to make further
modifications.
</p><!--l. 187--><p class="indent">   There are <span 
class="ptmri7t-">many </span>file merging tools available, too many to cover here. They vary in which platforms they are available for,
and in their particular strengths and weaknesses. Most are tuned for merging files containing plain text, while a few are aimed
at specialised file formats (generally XML).
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.2.2    </span> <a 
 id="x1-960004.2.2"></a>A worked example</h4>
<!--l. 195--><p class="noindent">In this example, we will reproduce the file modification history of figure&#x00A0;<a 
href="#x1-940014">4.4<!--tex4ht:ref: fig:tour-merge:conflict --></a> above. Let&#x2019;s begin by creating a repository with a
base version of our document.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-96002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;letter.txt</span><span 
class="pcrb7t-">&#x00A0;&#x003c;&#x003c;EOF</span>
<br class="fancyvrb" /><a 
 id="x1-96004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">Greetings!</span>
<br class="fancyvrb" /><a 
 id="x1-96006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">I</span><span 
class="pcrb7t-">&#x00A0;am</span><span 
class="pcrb7t-">&#x00A0;Mariam</span><span 
class="pcrb7t-">&#x00A0;Abacha,</span><span 
class="pcrb7t-">&#x00A0;the</span><span 
class="pcrb7t-">&#x00A0;wife</span><span 
class="pcrb7t-">&#x00A0;of</span><span 
class="pcrb7t-">&#x00A0;former</span>
<br class="fancyvrb" /><a 
 id="x1-96008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">Nigerian</span><span 
class="pcrb7t-">&#x00A0;dictator</span><span 
class="pcrb7t-">&#x00A0;Sani</span><span 
class="pcrb7t-">&#x00A0;Abacha.</span>
<br class="fancyvrb" /><a 
 id="x1-96010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">EOF</span>
<br class="fancyvrb" /><a 
 id="x1-96012r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;letter.txt</span>
<br class="fancyvrb" /><a 
 id="x1-96014r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'419</span><span 
class="pcrb7t-">&#x00A0;scam,</span><span 
class="pcrb7t-">&#x00A0;first</span><span 
class="pcrb7t-">&#x00A0;draft'</span>
   </div>
<!--l. 199--><p class="noindent">We&#x2019;ll clone the repository and make a change to the file.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-96016r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-96018r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;scam</span><span 
class="pcrb7t-">&#x00A0;scam-cousin</span>
<br class="fancyvrb" /><a 
 id="x1-96020r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-96022r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;scam-cousin</span>
<br class="fancyvrb" /><a 
 id="x1-96024r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;letter.txt</span><span 
class="pcrb7t-">&#x00A0;&#x003c;&#x003c;EOF</span>
<br class="fancyvrb" /><a 
 id="x1-96026r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">Greetings!</span>
<br class="fancyvrb" /><a 
 id="x1-96028r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">I</span><span 
class="pcrb7t-">&#x00A0;am</span><span 
class="pcrb7t-">&#x00A0;Shehu</span><span 
class="pcrb7t-">&#x00A0;Musa</span><span 
class="pcrb7t-">&#x00A0;Abacha,</span><span 
class="pcrb7t-">&#x00A0;cousin</span><span 
class="pcrb7t-">&#x00A0;to</span><span 
class="pcrb7t-">&#x00A0;the</span><span 
class="pcrb7t-">&#x00A0;former</span>
<br class="fancyvrb" /><a 
 id="x1-96030r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">Nigerian</span><span 
class="pcrb7t-">&#x00A0;dictator</span><span 
class="pcrb7t-">&#x00A0;Sani</span><span 
class="pcrb7t-">&#x00A0;Abacha.</span>
<br class="fancyvrb" /><a 
 id="x1-96032r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">EOF</span>
<br class="fancyvrb" /><a 
 id="x1-96034r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'419</span><span 
class="pcrb7t-">&#x00A0;scam,</span><span 
class="pcrb7t-">&#x00A0;with</span><span 
class="pcrb7t-">&#x00A0;cousin'</span>
   </div>
<!--l. 201--><p class="noindent">And another clone, to simulate someone else making a change to the file. (This hints at the idea that it&#x2019;s not all that unusual to
merge with yourself when you isolate tasks in separate repositories, and indeed to find and resolve conflicts while doing
so.)
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-96036r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-96038r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;scam</span><span 
class="pcrb7t-">&#x00A0;scam-son</span>
<br class="fancyvrb" /><a 
 id="x1-96040r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-96042r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;scam-son</span>
<br class="fancyvrb" /><a 
 id="x1-96044r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;letter.txt</span><span 
class="pcrb7t-">&#x00A0;&#x003c;&#x003c;EOF</span>
<br class="fancyvrb" /><a 
 id="x1-96046r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">Greetings!</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-96048r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">I</span><span 
class="pcrb7t-">&#x00A0;am</span><span 
class="pcrb7t-">&#x00A0;Alhaji</span><span 
class="pcrb7t-">&#x00A0;Abba</span><span 
class="pcrb7t-">&#x00A0;Abacha,</span><span 
class="pcrb7t-">&#x00A0;son</span><span 
class="pcrb7t-">&#x00A0;of</span><span 
class="pcrb7t-">&#x00A0;the</span><span 
class="pcrb7t-">&#x00A0;former</span>
<br class="fancyvrb" /><a 
 id="x1-96050r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">Nigerian</span><span 
class="pcrb7t-">&#x00A0;dictator</span><span 
class="pcrb7t-">&#x00A0;Sani</span><span 
class="pcrb7t-">&#x00A0;Abacha.</span>
<br class="fancyvrb" /><a 
 id="x1-96052r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">EOF</span>
<br class="fancyvrb" /><a 
 id="x1-96054r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'419</span><span 
class="pcrb7t-">&#x00A0;scam,</span><span 
class="pcrb7t-">&#x00A0;with</span><span 
class="pcrb7t-">&#x00A0;son'</span>
   </div>
<!--l. 206--><p class="noindent">Having created two different versions of the file, we&#x2019;ll set up an environment suitable for running our merge.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-96056r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-96058r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;scam-cousin</span><span 
class="pcrb7t-">&#x00A0;scam-merge</span>
<br class="fancyvrb" /><a 
 id="x1-96060r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-96062r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;scam-merge</span>
<br class="fancyvrb" /><a 
 id="x1-96064r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;pull</span><span 
class="pcrb7t-">&#x00A0;-u</span><span 
class="pcrb7t-">&#x00A0;../scam-son</span>
<br class="fancyvrb" /><a 
 id="x1-96066r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pulling</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;../scam-son</span>
<br class="fancyvrb" /><a 
 id="x1-96068r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-96070r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-96072r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-96074r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-96076r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;(+1</span><span 
class="pcrr7tn-">&#x00A0;heads)</span>
<br class="fancyvrb" /><a 
 id="x1-96078r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;updating,</span><span 
class="pcrr7tn-">&#x00A0;since</span><span 
class="pcrr7tn-">&#x00A0;new</span><span 
class="pcrr7tn-">&#x00A0;heads</span><span 
class="pcrr7tn-">&#x00A0;added</span>
<br class="fancyvrb" /><a 
 id="x1-96080r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(run</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;heads'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;heads,</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;merge'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;merge)</span>
   </div>
<!--l. 210--><p class="indent">   In this example, I won&#x2019;t use Mercurial&#x2019;s normal <a 
 id="dx1-96081"></a><span 
class="pcrr7tn-">hgmerge </span>program to do the merge, because it would drop my nice
automated example-running tool into a graphical user interface. Instead, I&#x2019;ll set <a 
 id="dx1-96082"></a><a 
 id="dx1-96083"></a><span 
class="pcrr7tn-">HGMERGE </span>to tell Mercurial to use the
non-interactive <a 
 id="dx1-96084"></a><span 
class="pcrr7tn-">merge </span>command. This is bundled with many Unix-like systems. If you&#x2019;re following this example on your
computer, don&#x2019;t bother setting <a 
 id="dx1-96085"></a><a 
 id="dx1-96086"></a><span 
class="pcrr7tn-">HGMERGE</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-96088r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">export</span><span 
class="pcrb7t-">&#x00A0;HGMERGE=merge</span>
<br class="fancyvrb" /><a 
 id="x1-96090r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;merge</span>
<br class="fancyvrb" /><a 
 id="x1-96092r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;merging</span><span 
class="pcrr7tn-">&#x00A0;letter.txt</span>
<br class="fancyvrb" /><a 
 id="x1-96094r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;merge:</span><span 
class="pcrr7tn-">&#x00A0;warning:</span><span 
class="pcrr7tn-">&#x00A0;conflicts</span><span 
class="pcrr7tn-">&#x00A0;during</span><span 
class="pcrr7tn-">&#x00A0;merge</span>
<br class="fancyvrb" /><a 
 id="x1-96096r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;merging</span><span 
class="pcrr7tn-">&#x00A0;letter.txt</span><span 
class="pcrr7tn-">&#x00A0;failed!</span>
<br class="fancyvrb" /><a 
 id="x1-96098r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-96100r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;There</span><span 
class="pcrr7tn-">&#x00A0;are</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span><span 
class="pcrr7tn-">&#x00A0;merges,</span><span 
class="pcrr7tn-">&#x00A0;you</span><span 
class="pcrr7tn-">&#x00A0;can</span><span 
class="pcrr7tn-">&#x00A0;redo</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;full</span><span 
class="pcrr7tn-">&#x00A0;merge</span><span 
class="pcrr7tn-">&#x00A0;using:</span>
<br class="fancyvrb" /><a 
 id="x1-96102r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;update</span><span 
class="pcrr7tn-">&#x00A0;-C</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-96104r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;merge</span><span 
class="pcrr7tn-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-96106r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;letter.txt</span>
<br class="fancyvrb" /><a 
 id="x1-96108r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Greetings!</span>
<br class="fancyvrb" /><a 
 id="x1-96110r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;&#x003c;&#x003c;&#x003c;&#x003c;&#x003c;</span><span 
class="pcrr7tn-">&#x00A0;/tmp/tour-merge-conflict0bWFt7/scam-merge/letter.txt</span>
<br class="fancyvrb" /><a 
 id="x1-96112r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;I</span><span 
class="pcrr7tn-">&#x00A0;am</span><span 
class="pcrr7tn-">&#x00A0;Shehu</span><span 
class="pcrr7tn-">&#x00A0;Musa</span><span 
class="pcrr7tn-">&#x00A0;Abacha,</span><span 
class="pcrr7tn-">&#x00A0;cousin</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;former</span>
<br class="fancyvrb" /><a 
 id="x1-96114r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;=======</span>
<br class="fancyvrb" /><a 
 id="x1-96116r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;I</span><span 
class="pcrr7tn-">&#x00A0;am</span><span 
class="pcrr7tn-">&#x00A0;Alhaji</span><span 
class="pcrr7tn-">&#x00A0;Abba</span><span 
class="pcrr7tn-">&#x00A0;Abacha,</span><span 
class="pcrr7tn-">&#x00A0;son</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;former</span>
<br class="fancyvrb" /><a 
 id="x1-96118r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;&#x003e;&#x003e;&#x003e;&#x003e;&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;/tmp/letter.txt~other.RthLdV</span>
<br class="fancyvrb" /><a 
 id="x1-96120r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Nigerian</span><span 
class="pcrr7tn-">&#x00A0;dictator</span><span 
class="pcrr7tn-">&#x00A0;Sani</span><span 
class="pcrr7tn-">&#x00A0;Abacha.</span>
   </div>
<!--l. 218--><p class="noindent">Because <a 
 id="dx1-96121"></a><span 
class="pcrr7tn-">merge </span>can&#x2019;t resolve the conflicting changes, it leaves <span 
class="ptmri7t-">merge markers </span>inside the file that has conflicts, indicating which
lines have conflicts, and whether they came from our version of the file or theirs.
                                                                                         
                                                                                         
</p><!--l. 223--><p class="indent">   Mercurial can tell from the way <a 
 id="dx1-96122"></a><span 
class="pcrr7tn-">merge </span>exits that it wasn&#x2019;t able to merge successfully, so it tells us what commands we&#x2019;ll
need to run if we want to redo the merging operation. This could be useful if, for example, we were running a graphical merge
tool and quit because we were confused or realised we had made a mistake.
</p><!--l. 229--><p class="indent">   If automatic or manual merges fail, there&#x2019;s nothing to prevent us from &#x201C;fixing up&#x201D; the affected files ourselves, and
committing the results of our merge:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-96124r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;letter.txt</span><span 
class="pcrb7t-">&#x00A0;&#x003c;&#x003c;EOF</span>
<br class="fancyvrb" /><a 
 id="x1-96126r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">Greetings!</span>
<br class="fancyvrb" /><a 
 id="x1-96128r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">I</span><span 
class="pcrb7t-">&#x00A0;am</span><span 
class="pcrb7t-">&#x00A0;Bryan</span><span 
class="pcrb7t-">&#x00A0;O'Sullivan,</span><span 
class="pcrb7t-">&#x00A0;no</span><span 
class="pcrb7t-">&#x00A0;relation</span><span 
class="pcrb7t-">&#x00A0;of</span><span 
class="pcrb7t-">&#x00A0;the</span><span 
class="pcrb7t-">&#x00A0;former</span>
<br class="fancyvrb" /><a 
 id="x1-96130r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">Nigerian</span><span 
class="pcrb7t-">&#x00A0;dictator</span><span 
class="pcrb7t-">&#x00A0;Sani</span><span 
class="pcrb7t-">&#x00A0;Abacha.</span>
<br class="fancyvrb" /><a 
 id="x1-96132r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">EOF</span>
<br class="fancyvrb" /><a 
 id="x1-96134r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Send</span><span 
class="pcrb7t-">&#x00A0;me</span><span 
class="pcrb7t-">&#x00A0;your</span><span 
class="pcrb7t-">&#x00A0;money'</span>
<br class="fancyvrb" /><a 
 id="x1-96136r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-96138r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3:f413eb6c494e</span>
<br class="fancyvrb" /><a 
 id="x1-96140r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-96142r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;parent:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:d104c6c0cc94</span>
<br class="fancyvrb" /><a 
 id="x1-96144r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;parent:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:0ece0aa795e4</span>
<br class="fancyvrb" /><a 
 id="x1-96146r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-96148r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:41</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-96150r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Send</span><span 
class="pcrr7tn-">&#x00A0;me</span><span 
class="pcrr7tn-">&#x00A0;your</span><span 
class="pcrr7tn-">&#x00A0;money</span>
<br class="fancyvrb" /><a 
 id="x1-96152r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 234--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">4.3    </span> <a 
 id="x1-970004.3"></a>Simplifying the pull-merge-commit sequence</h3>
<!--l. 237--><p class="noindent">The process of merging changes as outlined above is straightforward, but requires running three commands in
sequence.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-97002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;pull</span>
<br class="fancyvrb" /><a 
 id="x1-97004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;merge</span>
<br class="fancyvrb" /><a 
 id="x1-97006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;commit</span><span 
class="pcrr7tn-">&#x00A0;-m</span><span 
class="pcrr7tn-">&#x00A0;'Merged</span><span 
class="pcrr7tn-">&#x00A0;remote</span><span 
class="pcrr7tn-">&#x00A0;changes'</span>
   </div>
<!--l. 244--><p class="noindent">In the case of the final commit, you also need to enter a commit message, which is almost always going to be a piece of
uninteresting &#x201C;boilerplate&#x201D; text.
</p><!--l. 248--><p class="indent">   It would be nice to reduce the number of steps needed, if this were possible. Indeed, Mercurial is distributed with an
extension called <a 
 id="dx1-97007"></a><span 
class="pcrr7tn-">fetch </span>that does just this.
</p><!--l. 252--><p class="indent">   Mercurial provides a flexible extension mechanism that lets people extend its functionality, while keeping the core of
Mercurial small and easy to deal with. Some extensions add new commands that you can use from the command line, while
others work &#x201C;behind the scenes,&#x201D; for example adding capabilities to the server.
</p><!--l. 258--><p class="indent">   The <a 
 id="dx1-97008"></a><span 
class="pcrr7tn-">fetch </span>extension adds a new command called, not surprisingly, <a 
 id="dx1-97009"></a>&#x201C;<span 
class="pcrr7tn-">hg fetch</span>&#x201D;. This extension acts as a combination of
<a 
 id="dx1-97010"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D;, <a 
 id="dx1-97011"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; and <a 
 id="dx1-97012"></a>&#x201C;<span 
class="pcrr7tn-">hg merge</span>&#x201D;. It begins by pulling changes from another repository into the current repository. If
it finds that the changes added a new head to the repository, it begins a merge, then commits the result of the merge with an
automatically-generated commit message. If no new heads were added, it updates the working directory to the new tip
changeset.
                                                                                         
                                                                                         
</p><!--l. 267--><p class="indent">   Enabling the <a 
 id="dx1-97013"></a><span 
class="pcrr7tn-">fetch </span>extension is easy. Edit your <a 
 id="dx1-97014"></a><span 
class="pcrr7tn-">.hgrc</span>, and either go to the <a 
 id="dx1-97015"></a><span 
class="pcrr7tn-">[extensions] </span>section or create an
<a 
 id="dx1-97016"></a><span 
class="pcrr7tn-">[extensions] </span>section. Then add a line that simply reads &#x201C;<span class="verb"><span 
class="pcrr7tn-">fetch</span><span 
class="pcrr7tn-">&#x00A0;</span></span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-97018r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[extensions]</span>
<br class="fancyvrb" /><a 
 id="x1-97020r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;fetch</span><span 
class="pcrr7tn-">&#x00A0;=</span>
   </div>
<!--l. 275--><p class="noindent">(Normally, on the right-hand side of the &#x201C;<span 
class="pcrr7tn-">=</span>&#x201D; would appear the location of the extension, but since the <a 
 id="dx1-97021"></a><span 
class="pcrr7tn-">fetch </span>extension is in the
standard distribution, Mercurial knows where to search for it.)
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
</p>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;5</span><br /><a 
 id="x1-980005"></a>Behind the scenes</h2>
<!--l. 4--><p class="noindent">Unlike many revision control systems, the concepts upon which Mercurial is built are simple enough that it&#x2019;s easy to understand
how the software really works. Knowing this certainly isn&#x2019;t necessary, but I find it useful to have a &#x201C;mental model&#x201D; of what&#x2019;s
going on.
</p><!--l. 9--><p class="indent">   This understanding gives me confidence that Mercurial has been carefully designed to be both <span 
class="ptmri7t-">safe </span>and <span 
class="ptmri7t-">efficient</span>. And just as
importantly, if it&#x2019;s easy for me to retain a good idea of what the software is doing when I perform a revision control task, I&#x2019;m
less likely to be surprised by its behaviour.
</p><!--l. 15--><p class="indent">   In this chapter, we&#x2019;ll initially cover the core concepts behind Mercurial&#x2019;s design, then continue to discuss some of the
interesting details of its implementation.
</p>
   <h3 class="sectionHead"><span class="titlemark">5.1    </span> <a 
 id="x1-990005.1"></a>Mercurial&#x2019;s historical record</h3>
<!--l. 21--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1.1    </span> <a 
 id="x1-1000005.1.1"></a>Tracking the history of a single file</h4>
<!--l. 23--><p class="noindent">When Mercurial tracks modifications to a file, it stores the history of that file in a metadata object called a <span 
class="ptmri7t-">filelog</span>. Each entry in
the filelog contains enough information to reconstruct one revision of the file that is being tracked. Filelogs are stored as files in
the <a 
 id="dx1-100001"></a><span 
class="pcrr7tn-">.hg/store/data </span>directory. A filelog contains two kinds of information: revision data, and an index to help Mercurial to
find a revision efficiently.
</p><!--l. 31--><p class="indent">   A file that is large, or has a lot of history, has its filelog stored in separate data (&#x201C;<span 
class="pcrr7tn-">.d</span>&#x201D; suffix) and index (&#x201C;<span 
class="pcrr7tn-">.i</span>&#x201D; suffix) files. For
small files without much history, the revision data and index are combined in a single &#x201C;<span 
class="pcrr7tn-">.i</span>&#x201D; file. The correspondence
between a file in the working directory and the filelog that tracks its history in the repository is illustrated in
figure&#x00A0;<a 
href="#x1-1000021">5.1<!--tex4ht:ref: fig:concepts:filelog --></a>.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1000021"></a>
                                                                                         
                                                                                         
<!--l. 41--><p class="noindent"><img 
src="filelog.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;5.1: </td><td  
class="content">Relationships between files in working directory and filelogs in repository</td></tr></table><!--tex4ht:label?: x1-1000021 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">5.1.2    </span> <a 
 id="x1-1010005.1.2"></a>Managing tracked files</h4>
<!--l. 49--><p class="noindent">Mercurial uses a structure called a <span 
class="ptmri7t-">manifest </span>to collect together information about the files that it tracks. Each entry in the
manifest contains information about the files present in a single changeset. An entry records which files are present in the
changeset, the revision of each file, and a few other pieces of file metadata.
</p><!--l. 55--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1.3    </span> <a 
 id="x1-1020005.1.3"></a>Recording changeset information</h4>
<!--l. 57--><p class="noindent">The <span 
class="ptmri7t-">changelog </span>contains information about each changeset. Each revision records who committed a change, the changeset
comment, other pieces of changeset-related information, and the revision of the manifest to use.
</p><!--l. 62--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1.4    </span> <a 
 id="x1-1030005.1.4"></a>Relationships between revisions</h4>
<!--l. 64--><p class="noindent">Within a changelog, a manifest, or a filelog, each revision stores a pointer to its immediate parent (or to its two parents, if it&#x2019;s a
merge revision). As I mentioned above, there are also relationships between revisions <span 
class="ptmri7t-">across </span>these structures, and they are
hierarchical in nature.
</p><!--l. 70--><p class="indent">   For every changeset in a repository, there is exactly one revision stored in the changelog. Each revision of the
changelog contains a pointer to a single revision of the manifest. A revision of the manifest stores a pointer to a
single revision of each filelog tracked when that changeset was created. These relationships are illustrated in
figure&#x00A0;<a 
href="#x1-1030012">5.2<!--tex4ht:ref: fig:concepts:metadata --></a>.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1030012"></a>
                                                                                         
                                                                                         
<!--l. 79--><p class="noindent"><img 
src="metadata.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;5.2: </td><td  
class="content">Metadata relationships</td></tr></table><!--tex4ht:label?: x1-1030012 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 84--><p class="indent">   As the illustration shows, there is <span 
class="ptmri7t-">not </span>a &#x201C;one to one&#x201D; relationship between revisions in the changelog, manifest, or filelog. If
the manifest hasn&#x2019;t changed between two changesets, the changelog entries for those changesets will point to the same revision
of the manifest. If a file that Mercurial tracks hasn&#x2019;t changed between two changesets, the entry for that file in the two revisions
of the manifest will point to the same revision of its filelog.
</p>
   <h3 class="sectionHead"><span class="titlemark">5.2    </span> <a 
 id="x1-1040005.2"></a>Safe, efficient storage</h3>
<!--l. 94--><p class="noindent">The underpinnings of changelogs, manifests, and filelogs are provided by a single structure called the <span 
class="ptmri7t-">revlog</span>.
</p><!--l. 97--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2.1    </span> <a 
 id="x1-1050005.2.1"></a>Efficient storage</h4>
<!--l. 99--><p class="noindent">The revlog provides efficient storage of revisions using a <span 
class="ptmri7t-">delta </span>mechanism. Instead of storing a complete copy of a file for each
revision, it stores the changes needed to transform an older revision into the new revision. For many kinds of file data, these
deltas are typically a fraction of a percent of the size of a full copy of a file.
</p><!--l. 106--><p class="indent">   Some obsolete revision control systems can only work with deltas of text files. They must either store binary files as
complete snapshots or encoded into a text representation, both of which are wasteful approaches. Mercurial can efficiently
handle deltas of files with arbitrary binary contents; it doesn&#x2019;t need to treat text as special.
</p><!--l. 112--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2.2    </span> <a 
 id="x1-1060005.2.2"></a>Safe operation</h4>
<!--l. 115--><p class="noindent">Mercurial only ever <span 
class="ptmri7t-">appends </span>data to the end of a revlog file. It never modifies a section of a file after it has written it. This is
both more robust and efficient than schemes that need to modify or rewrite data.
</p><!--l. 120--><p class="indent">   In addition, Mercurial treats every write as part of a <span 
class="ptmri7t-">transaction </span>that can span a number of files. A transaction is <span 
class="ptmri7t-">atomic</span>:
either the entire transaction succeeds and its effects are all visible to readers in one go, or the whole thing is undone. This
guarantee of atomicity means that if you&#x2019;re running two copies of Mercurial, where one is reading data and one is writing it, the
reader will never see a partially written result that might confuse it.
</p><!--l. 128--><p class="indent">   The fact that Mercurial only appends to files makes it easier to provide this transactional guarantee. The easier it is to do
stuff like this, the more confident you should be that it&#x2019;s done correctly.
</p><!--l. 132--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2.3    </span> <a 
 id="x1-1070005.2.3"></a>Fast retrieval</h4>
<!--l. 134--><p class="noindent">Mercurial cleverly avoids a pitfall common to all earlier revision control systems: the problem of <span 
class="ptmri7t-">inefficient retrieval</span>. Most
revision control systems store the contents of a revision as an incremental series of modifications against a &#x201C;snapshot&#x201D;. To
reconstruct a specific revision, you must first read the snapshot, and then every one of the revisions between the snapshot and
your target revision. The more history that a file accumulates, the more revisions you must read, hence the longer it takes to
reconstruct a particular revision.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1070013"></a>
                                                                                         
                                                                                         
<!--l. 146--><p class="noindent"><img 
src="snapshot.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;5.3: </td><td  
class="content">Snapshot of a revlog, with incremental deltas</td></tr></table><!--tex4ht:label?: x1-1070013 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 151--><p class="indent">   The innovation that Mercurial applies to this problem is simple but effective. Once the cumulative amount of delta
information stored since the last snapshot exceeds a fixed threshold, it stores a new snapshot (compressed, of course), instead of
another delta. This makes it possible to reconstruct <span 
class="ptmri7t-">any </span>revision of a file quickly. This approach works so well that it has since
been copied by several other revision control systems.
</p><!--l. 159--><p class="indent">   Figure&#x00A0;<a 
href="#x1-1070013">5.3<!--tex4ht:ref: fig:concepts:snapshot --></a> illustrates the idea. In an entry in a revlog&#x2019;s index file, Mercurial stores the range of entries from the data file that
it must read to reconstruct a particular revision.
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-1080005.2.3"></a>Aside: the influence of video compression</h5>
<!--l. 165--><p class="noindent">If you&#x2019;re familiar with video compression or have ever watched a TV feed through a digital cable or satellite service, you may
know that most video compression schemes store each frame of video as a delta against its predecessor frame. In addition, these
schemes use &#x201C;lossy&#x201D; compression techniques to increase the compression ratio, so visual errors accumulate over the course of a
number of inter-frame deltas.
</p><!--l. 173--><p class="indent">   Because it&#x2019;s possible for a video stream to &#x201C;drop out&#x201D; occasionally due to signal glitches, and to limit the accumulation of
artefacts introduced by the lossy compression process, video encoders periodically insert a complete frame (called a &#x201C;key
frame&#x201D;) into the video stream; the next delta is generated against that frame. This means that if the video signal gets interrupted,
it will resume once the next key frame is received. Also, the accumulation of encoding errors restarts anew with each key
frame.
</p><!--l. 182--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2.4    </span> <a 
 id="x1-1090005.2.4"></a>Identification and strong integrity</h4>
<!--l. 184--><p class="noindent">Along with delta or snapshot information, a revlog entry contains a cryptographic hash of the data that it represents. This makes
it difficult to forge the contents of a revision, and easy to detect accidental corruption.
</p><!--l. 189--><p class="indent">   Hashes provide more than a mere check against corruption; they are used as the identifiers for revisions. The changeset
identification hashes that you see as an end user are from revisions of the changelog. Although filelogs and the manifest also
use hashes, Mercurial only uses these behind the scenes.
</p><!--l. 195--><p class="indent">   Mercurial verifies that hashes are correct when it retrieves file revisions and when it pulls changes from another repository.
If it encounters an integrity problem, it will complain and stop whatever it&#x2019;s doing.
</p><!--l. 200--><p class="indent">   In addition to the effect it has on retrieval efficiency, Mercurial&#x2019;s use of periodic snapshots makes it more robust against
partial data corruption. If a revlog becomes partly corrupted due to a hardware error or system bug, it&#x2019;s often possible to
reconstruct some or most revisions from the uncorrupted sections of the revlog, both before and after the corrupted section.
This would not be possible with a delta-only storage model.
</p><!--l. 209--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">5.3    </span> <a 
 id="x1-1100005.3"></a>Revision history, branching, and merging</h3>
<!--l. 211--><p class="noindent">Every entry in a Mercurial revlog knows the identity of its immediate ancestor revision, usually referred to as its <span 
class="ptmri7t-">parent</span>. In fact,
a revision contains room for not one parent, but two. Mercurial uses a special hash, called the &#x201C;null ID&#x201D;, to represent the idea
&#x201C;there is no parent here&#x201D;. This hash is simply a string of zeroes.
</p><!--l. 217--><p class="indent">   In figure&#x00A0;<a 
href="#x1-1100014">5.4<!--tex4ht:ref: fig:concepts:revlog --></a>, you can see an example of the conceptual structure of a revlog. Filelogs, manifests, and changelogs all have
this same structure; they differ only in the kind of data stored in each delta or snapshot.
</p><!--l. 222--><p class="indent">   The first revision in a revlog (at the bottom of the image) has the null ID in both of its parent slots. For a &#x201C;normal&#x201D; revision,
its first parent slot contains the ID of its parent revision, and its second contains the null ID, indicating that the revision has only
one real parent. Any two revisions that have the same parent ID are branches. A revision that represents a merge between
branches has two normal revision IDs in its parent slots.
                                                                                         
                                                                                         
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1100014"></a>
                                                                                         
                                                                                         
<!--l. 232--><p class="noindent"><img 
src="revlog.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;5.4: </td><td  
class="content"></td></tr></table><!--tex4ht:label?: x1-1100014 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">5.4    </span> <a 
 id="x1-1110005.4"></a>The working directory</h3>
<!--l. 239--><p class="noindent">In the working directory, Mercurial stores a snapshot of the files from the repository as of a particular changeset.
</p><!--l. 242--><p class="indent">   The working directory &#x201C;knows&#x201D; which changeset it contains. When you update the working directory to contain a particular
changeset, Mercurial looks up the appropriate revision of the manifest to find out which files it was tracking at the time that
changeset was committed, and which revision of each file was then current. It then recreates a copy of each of those files, with
the same contents it had when the changeset was committed.
</p><!--l. 250--><p class="indent">   The <span 
class="ptmri7t-">dirstate </span>contains Mercurial&#x2019;s knowledge of the working directory. This details which changeset the working directory
is updated to, and all of the files that Mercurial is tracking in the working directory.
</p><!--l. 255--><p class="indent">   Just as a revision of a revlog has room for two parents, so that it can represent either a normal revision (with one
parent) or a merge of two earlier revisions, the dirstate has slots for two parents. When you use the <a 
 id="dx1-111001"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D;
command, the changeset that you update to is stored in the &#x201C;first parent&#x201D; slot, and the null ID in the second. When
you <a 
 id="dx1-111002"></a>&#x201C;<span 
class="pcrr7tn-">hg merge</span>&#x201D; with another changeset, the first parent remains unchanged, and the second parent is filled in
with the changeset you&#x2019;re merging with. The <a 
 id="dx1-111003"></a>&#x201C;<span 
class="pcrr7tn-">hg parents</span>&#x201D; command tells you what the parents of the dirstate
are.
</p><!--l. 265--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.4.1    </span> <a 
 id="x1-1120005.4.1"></a>What happens when you commit</h4>
<!--l. 267--><p class="noindent">The dirstate stores parent information for more than just book-keeping purposes. Mercurial uses the parents of the dirstate as
<span 
class="ptmri7t-">the parents of a new changeset </span>when you perform a commit.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1120015"></a>
                                                                                         
                                                                                         
<!--l. 273--><p class="noindent"><img 
src="wdir.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;5.5: </td><td  
class="content">The working directory can have two parents</td></tr></table><!--tex4ht:label?: x1-1120015 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 278--><p class="indent">   Figure&#x00A0;<a 
href="#x1-1120015">5.5<!--tex4ht:ref: fig:concepts:wdir --></a> shows the normal state of the working directory, where it has a single changeset as parent. That changeset is the
<span 
class="ptmri7t-">tip</span>, the newest changeset in the repository that has no children.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1120026"></a>
                                                                                         
                                                                                         
<!--l. 285--><p class="noindent"><img 
src="wdir-after-commit.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;5.6: </td><td  
class="content">The working directory gains new parents after a commit</td></tr></table><!--tex4ht:label?: x1-1120026 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 290--><p class="indent">   It&#x2019;s useful to think of the working directory as &#x201C;the changeset I&#x2019;m about to commit&#x201D;. Any files that you tell Mercurial that
you&#x2019;ve added, removed, renamed, or copied will be reflected in that changeset, as will modifications to any
files that Mercurial is already tracking; the new changeset will have the parents of the working directory as its
parents.
</p><!--l. 297--><p class="indent">   After a commit, Mercurial will update the parents of the working directory, so that the first parent is the ID of the new
changeset, and the second is the null ID. This is shown in figure&#x00A0;<a 
href="#x1-1120026">5.6<!--tex4ht:ref: fig:concepts:wdir-after-commit --></a>. Mercurial doesn&#x2019;t touch any of the files in the working
directory when you commit; it just modifies the dirstate to note its new parents.
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.4.2    </span> <a 
 id="x1-1130005.4.2"></a>Creating a new head</h4>
<!--l. 306--><p class="noindent">It&#x2019;s perfectly normal to update the working directory to a changeset other than the current tip. For example, you might want to
know what your project looked like last Tuesday, or you could be looking through changesets to see which one introduced a
bug. In cases like this, the natural thing to do is update the working directory to the changeset you&#x2019;re interested in, and then
examine the files in the working directory directly to see their contents as they werea when you committed that changeset. The
effect of this is shown in figure&#x00A0;<a 
href="#x1-1130017">5.7<!--tex4ht:ref: fig:concepts:wdir-pre-branch --></a>.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1130017"></a>
                                                                                         
                                                                                         
<!--l. 318--><p class="noindent"><img 
src="wdir-pre-branch.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;5.7: </td><td  
class="content">The working directory, updated to an older changeset</td></tr></table><!--tex4ht:label?: x1-1130017 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 323--><p class="indent">   Having updated the working directory to an older changeset, what happens if you make some changes, and then commit?
Mercurial behaves in the same way as I outlined above. The parents of the working directory become the parents of
the new changeset. This new changeset has no children, so it becomes the new tip. And the repository now
contains two changesets that have no children; we call these <span 
class="ptmri7t-">heads</span>. You can see the structure that this creates in
figure&#x00A0;<a 
href="#x1-1130028">5.8<!--tex4ht:ref: fig:concepts:wdir-branch --></a>.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1130028"></a>
                                                                                         
                                                                                         
<!--l. 334--><p class="noindent"><img 
src="wdir-branch.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;5.8: </td><td  
class="content">After a commit made while synced to an older changeset</td></tr></table><!--tex4ht:label?: x1-1130028 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:   </span>If you&#x2019;re new to Mercurial, you should keep in mind a common &#x201C;error&#x201D;,
which  is  to  use  the  &#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D;  command  without  any  options.  By  default,  the
&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; command <span 
class="ptmri7t-">does not </span>update the working directory, so you&#x2019;ll bring new
changesets  into  your  repository,  but  the  working  directory  will  stay  synced  at
the  same  changeset  as  before  the  pull.  If  you  make  some  changes  and  commit
afterwards, you&#x2019;ll thus create a new head, because your working directory isn&#x2019;t
synced to whatever the current tip is.
I  put  the  word  &#x201C;error&#x201D;  in  quotes  because  all  that  you  need  to  do  to  rectify  this
situation is &#x201C;<span 
class="pcrr7tn-">hg merge</span>&#x201D;, then &#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D;. In other words, this almost never has
negative consequences; it just surprises people. I&#x2019;ll discuss other ways to avoid this
behaviour, and why Mercurial behaves in this initially surprising way, later on.      </div>
   <h4 class="subsectionHead"><span class="titlemark">5.4.3    </span> <a 
 id="x1-1140005.4.3"></a>Merging heads</h4>
<!--l. 359--><p class="noindent">When you run the <a 
 id="dx1-114001"></a>&#x201C;<span 
class="pcrr7tn-">hg merge</span>&#x201D; command, Mercurial leaves the first parent of the working directory unchanged, and sets the
second parent to the changeset you&#x2019;re merging with, as shown in figure&#x00A0;<a 
href="#x1-1140029">5.9<!--tex4ht:ref: fig:concepts:wdir-merge --></a>.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1140029"></a>
                                                                                         
                                                                                         
<!--l. 366--><p class="noindent"><img 
src="wdir-merge.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;5.9: </td><td  
class="content">Merging two heads</td></tr></table><!--tex4ht:label?: x1-1140029 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 371--><p class="indent">   Mercurial also has to modify the working directory, to merge the files managed in the two changesets. Simplified a little, the
merging process goes like this, for every file in the manifests of both changesets. </p>
     <ul><li><span class="dt">
     </span><span class="dd">If neither changeset has modified a file, do nothing with that file.
     </span><li><span class="dt">
     </span><span class="dd">If one changeset has modified a file, and the other hasn&#x2019;t, create the modified copy of the file in the working
     directory.
     </span><li><span class="dt">
     </span><span class="dd">If one changeset has removed a file, and the other hasn&#x2019;t (or has also deleted it), delete the file from the working
     directory.
     </span><li><span class="dt">
     </span><span class="dd">If one changeset has removed a file, but the other has modified the file, ask the user what to do: keep the modified
     file, or remove it?
     </span><li><span class="dt">
     </span><span class="dd">If both changesets have modified a file, invoke an external merge program to choose the new contents for the
     merged file. This may require input from the user.
     </span><li><span class="dt">
     </span><span class="dd">If one changeset has modified a file, and the other has renamed or copied the file, make sure that the changes
     follow the new name of the file.</li></ul>
<!--l. 392--><p class="noindent">There are more details&#x2014;merging has plenty of corner cases&#x2014;but these are the most common choices that are involved in a merge.
As you can see, most cases are completely automatic, and indeed most merges finish automatically, without requiring your
input to resolve any conflicts.
</p><!--l. 398--><p class="indent">   When you&#x2019;re thinking about what happens when you commit after a merge, once again the working directory is &#x201C;the
changeset I&#x2019;m about to commit&#x201D;. After the <a 
 id="dx1-114003"></a>&#x201C;<span 
class="pcrr7tn-">hg merge</span>&#x201D; command completes, the working directory has two parents; these will
become the parents of the new changeset.
</p><!--l. 404--><p class="indent">   Mercurial lets you perform multiple merges, but you must commit the results of each individual merge as you go. This is
necessary because Mercurial only tracks two parents for both revisions and the working directory. While it would be technically
possible to merge multiple changesets at once, the prospect of user confusion and making a terrible mess of a merge
immediately becomes overwhelming.
</p>
   <h3 class="sectionHead"><span class="titlemark">5.5    </span> <a 
 id="x1-1150005.5"></a>Other interesting design features</h3>
<!--l. 413--><p class="noindent">In the sections above, I&#x2019;ve tried to highlight some of the most important aspects of Mercurial&#x2019;s design, to illustrate that it pays
careful attention to reliability and performance. However, the attention to detail doesn&#x2019;t stop there. There are a number of other
aspects of Mercurial&#x2019;s construction that I personally find interesting. I&#x2019;ll detail a few of them here, separate from the &#x201C;big
ticket&#x201D; items above, so that if you&#x2019;re interested, you can gain a better idea of the amount of thinking that goes into a
well-designed system.
</p><!--l. 423--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.5.1    </span> <a 
 id="x1-1160005.5.1"></a>Clever compression</h4>
<!--l. 425--><p class="noindent">When appropriate, Mercurial will store both snapshots and deltas in compressed form. It does this by always <span 
class="ptmri7t-">trying to</span>
compress a snapshot or delta, but only storing the compressed version if it&#x2019;s smaller than the uncompressed
version.
                                                                                         
                                                                                         
</p><!--l. 430--><p class="indent">   This means that Mercurial does &#x201C;the right thing&#x201D; when storing a file whose native form is compressed, such as a <span 
class="pcrr7tn-">zip </span>archive
or a JPEG image. When these types of files are compressed a second time, the resulting file is usually bigger than the
once-compressed form, and so Mercurial will store the plain <span 
class="pcrr7tn-">zip </span>or JPEG.
</p><!--l. 436--><p class="indent">   Deltas between revisions of a compressed file are usually larger than snapshots of the file, and Mercurial again
does &#x201C;the right thing&#x201D; in these cases. It finds that such a delta exceeds the threshold at which it should store
a complete snapshot of the file, so it stores the snapshot, again saving space compared to a naive delta-only
approach.
</p><!--l. 443--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-1170005.5.1"></a>Network recompression</h5>
<!--l. 445--><p class="noindent">When storing revisions on disk, Mercurial uses the &#x201C;deflate&#x201D; compression algorithm (the same one used by
the popular <span 
class="pcrr7tn-">zip </span>archive format), which balances good speed with a respectable compression ratio. However,
when transmitting revision data over a network connection, Mercurial uncompresses the compressed revision
data.
</p><!--l. 452--><p class="indent">   If the connection is over HTTP, Mercurial recompresses the entire stream of data using a compression algorithm that gives a
better compression ratio (the Burrows-Wheeler algorithm from the widely used <span 
class="pcrr7tn-">bzip2 </span>compression package). This
combination of algorithm and compression of the entire stream (instead of a revision at a time) substantially
reduces the number of bytes to be transferred, yielding better network performance over almost all kinds of
network.
</p><!--l. 460--><p class="indent">   (If the connection is over <a 
 id="dx1-117001"></a><span 
class="pcrr7tn-">ssh</span>, Mercurial <span 
class="ptmri7t-">doesn&#x2019;t </span>recompress the stream, because <a 
 id="dx1-117002"></a><span 
class="pcrr7tn-">ssh </span>can already do this
itself.)
</p><!--l. 464--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.5.2    </span> <a 
 id="x1-1180005.5.2"></a>Read/write ordering and atomicity</h4>
<!--l. 466--><p class="noindent">Appending to files isn&#x2019;t the whole story when it comes to guaranteeing that a reader won&#x2019;t see a partial write. If you recall
figure&#x00A0;<a 
href="#x1-1030012">5.2<!--tex4ht:ref: fig:concepts:metadata --></a>, revisions in the changelog point to revisions in the manifest, and revisions in the manifest point to revisions in
filelogs. This hierarchy is deliberate.
</p><!--l. 472--><p class="indent">   A writer starts a transaction by writing filelog and manifest data, and doesn&#x2019;t write any changelog data until those are
finished. A reader starts by reading changelog data, then manifest data, followed by filelog data.
</p><!--l. 477--><p class="indent">   Since the writer has always finished writing filelog and manifest data before it writes to the changelog, a reader will never
read a pointer to a partially written manifest revision from the changelog, and it will never read a pointer to a partially written
filelog revision from the manifest.
</p><!--l. 483--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.5.3    </span> <a 
 id="x1-1190005.5.3"></a>Concurrent access</h4>
<!--l. 485--><p class="noindent">The read/write ordering and atomicity guarantees mean that Mercurial never needs to <span 
class="ptmri7t-">lock </span>a repository when it&#x2019;s reading data,
even if the repository is being written to while the read is occurring. This has a big effect on scalability; you can have an
arbitrary number of Mercurial processes safely reading data from a repository safely all at once, no matter whether it&#x2019;s being
written to or not.
</p><!--l. 492--><p class="indent">   The lockless nature of reading means that if you&#x2019;re sharing a repository on a multi-user system, you don&#x2019;t need to grant
other local users permission to <span 
class="ptmri7t-">write </span>to your repository in order for them to be able to clone it or pull changes from it; they only
need <span 
class="ptmri7t-">read </span>permission. (This is <span 
class="ptmri7t-">not </span>a common feature among revision control systems, so don&#x2019;t take it for granted!
Most require readers to be able to lock a repository to access it safely, and this requires write permission on
at least one directory, which of course makes for all kinds of nasty and annoying security and administrative
problems.)
                                                                                         
                                                                                         
</p><!--l. 503--><p class="indent">   Mercurial uses locks to ensure that only one process can write to a repository at a time (the locking mechanism is safe even
over filesystems that are notoriously hostile to locking, such as NFS). If a repository is locked, a writer will wait for a
while to retry if the repository becomes unlocked, but if the repository remains locked for too long, the process
attempting to write will time out after a while. This means that your daily automated scripts won&#x2019;t get stuck
forever and pile up if a system crashes unnoticed, for example. (Yes, the timeout is configurable, from zero to
infinity.)
</p><!--l. 513--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-1200005.5.3"></a>Safe dirstate access</h5>
<!--l. 515--><p class="noindent">As with revision data, Mercurial doesn&#x2019;t take a lock to read the dirstate file; it does acquire a lock to write it. To avoid the
possibility of reading a partially written copy of the dirstate file, Mercurial writes to a file with a unique name in the same
directory as the dirstate file, then renames the temporary file atomically to <span 
class="pcrr7tn-">dirstate</span>. The file named <span 
class="pcrr7tn-">dirstate </span>is thus
guaranteed to be complete, not partially written.
</p><!--l. 523--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.5.4    </span> <a 
 id="x1-1210005.5.4"></a>Avoiding seeks</h4>
<!--l. 525--><p class="noindent">Critical to Mercurial&#x2019;s performance is the avoidance of seeks of the disk head, since any seek is far more expensive than even a
comparatively large read operation.
</p><!--l. 529--><p class="indent">   This is why, for example, the dirstate is stored in a single file. If there were a dirstate file per directory that Mercurial
tracked, the disk would seek once per directory. Instead, Mercurial reads the entire single dirstate file in one
step.
</p><!--l. 534--><p class="indent">   Mercurial also uses a &#x201C;copy on write&#x201D; scheme when cloning a repository on local storage. Instead of copying every revlog
file from the old repository into the new repository, it makes a &#x201C;hard link&#x201D;, which is a shorthand way to say &#x201C;these two names
point to the same file&#x201D;. When Mercurial is about to write to one of a revlog&#x2019;s files, it checks to see if the number of names
pointing at the file is greater than one. If it is, more than one repository is using the file, so Mercurial makes a new copy of the
file that is private to this repository.
</p><!--l. 544--><p class="indent">   A few revision control developers have pointed out that this idea of making a complete private copy of a file is not very
efficient in its use of storage. While this is true, storage is cheap, and this method gives the highest performance while
deferring most book-keeping to the operating system. An alternative scheme would most likely reduce performance
and increase the complexity of the software, each of which is much more important to the &#x201C;feel&#x201D; of day-to-day
use.
</p><!--l. 552--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.5.5    </span> <a 
 id="x1-1220005.5.5"></a>Other contents of the dirstate</h4>
<!--l. 554--><p class="noindent">Because Mercurial doesn&#x2019;t force you to tell it when you&#x2019;re modifying a file, it uses the dirstate to store some extra information
so it can determine efficiently whether you have modified a file. For each file in the working directory, it stores the time that it
last modified the file itself, and the size of the file at that time.
</p><!--l. 560--><p class="indent">   When you explicitly <a 
 id="dx1-122001"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D;, <a 
 id="dx1-122002"></a>&#x201C;<span 
class="pcrr7tn-">hg remove</span>&#x201D;, <a 
 id="dx1-122003"></a>&#x201C;<span 
class="pcrr7tn-">hg rename</span>&#x201D; or <a 
 id="dx1-122004"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D; files, Mercurial updates the dirstate so that it
knows what to do with those files when you commit.
</p><!--l. 564--><p class="indent">   When Mercurial is checking the states of files in the working directory, it first checks a file&#x2019;s modification time. If that has
not changed, the file must not have been modified. If the file&#x2019;s size has changed, the file must have been modified. If the
modification time has changed, but the size has not, only then does Mercurial need to read the actual contents of the file to
see if they&#x2019;ve changed. Storing these few extra pieces of information dramatically reduces the amount of data
that Mercurial needs to read, which yields large performance improvements compared to other revision control
systems.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
</p>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;6</span><br /><a 
 id="x1-1230006"></a>Hobbit Administration Guide</h2>
   <h3 class="sectionHead"><span class="titlemark">6.1    </span> <a 
 id="x1-1240006.1"></a>Telling Mercurial which files to track</h3>
<!--l. 6--><p class="noindent">Mercurial does not work with files in your repository unless you tell it to manage them. The <a 
 id="dx1-124001"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; command will tell
you which files Mercurial doesn&#x2019;t know about; it uses a &#x201C;<span 
class="pcrr7tn-">?</span>&#x201D; to display such files.
</p><!--l. 11--><p class="indent">   To tell Mercurial to track a file, use the <a 
 id="dx1-124002"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; command. Once you have added a file, the entry in the output of <a 
 id="dx1-124003"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">status</span>&#x201D; for that file changes from &#x201C;<span 
class="pcrr7tn-">?</span>&#x201D; to &#x201C;<span 
class="pcrr7tn-">A</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-124005r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;add-example</span>
<br class="fancyvrb" /><a 
 id="x1-124007r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;add-example</span>
<br class="fancyvrb" /><a 
 id="x1-124009r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-124011r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-124013r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-124015r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-124017r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-124019r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-124021r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Added</span><span 
class="pcrb7t-">&#x00A0;one</span><span 
class="pcrb7t-">&#x00A0;file'</span>
<br class="fancyvrb" /><a 
 id="x1-124023r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
   </div>
<!--l. 16--><p class="indent">   After you run a <a 
 id="dx1-124024"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D;, the files that you added before the commit will no longer be listed in the output of <a 
 id="dx1-124025"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">status</span>&#x201D;. The reason for this is that <a 
 id="dx1-124026"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; only tells you about &#x201C;interesting&#x201D; files&#x2014;those that you have modified or told
Mercurial to do something with&#x2014;by default. If you have a repository that contains thousands of files, you will rarely want to
know about files that Mercurial is tracking, but that have not changed. (You can still get this information; we&#x2019;ll return to this
later.)
</p><!--l. 25--><p class="indent">   Once you add a file, Mercurial doesn&#x2019;t do anything with it immediately. Instead, it will take a snapshot of the file&#x2019;s state the
next time you perform a commit. It will then continue to track the changes you make to the file every time you commit, until
you remove the file.
</p><!--l. 31--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.1.1    </span> <a 
 id="x1-1250006.1.1"></a>Explicit versus implicit file naming</h4>
<!--l. 33--><p class="noindent">A useful behaviour that Mercurial has is that if you pass the name of a directory to a command, every Mercurial command will
treat this as &#x201C;I want to operate on every file in this directory and its subdirectories&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-125002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">mkdir</span><span 
class="pcrb7t-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-125004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;b</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;b/b</span>
<br class="fancyvrb" /><a 
 id="x1-125006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;c</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;b/c</span>
<br class="fancyvrb" /><a 
 id="x1-125008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">mkdir</span><span 
class="pcrb7t-">&#x00A0;b/d</span>
<br class="fancyvrb" /><a 
 id="x1-125010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;d</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;b/d/d</span>
<br class="fancyvrb" /><a 
 id="x1-125012r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-125014r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;b/b</span>
<br class="fancyvrb" /><a 
 id="x1-125016r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;b/c</span>
<br class="fancyvrb" /><a 
 id="x1-125018r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;b/d/d</span>
<br class="fancyvrb" /><a 
 id="x1-125020r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Added</span><span 
class="pcrb7t-">&#x00A0;all</span><span 
class="pcrb7t-">&#x00A0;files</span><span 
class="pcrb7t-">&#x00A0;in</span><span 
class="pcrb7t-">&#x00A0;subdirectory'</span>
   </div>
                                                                                         
                                                                                         
<!--l. 38--><p class="noindent">Notice in this example that Mercurial printed the names of the files it added, whereas it didn&#x2019;t do so when we added the file named
<span 
class="pcrr7tn-">a </span>in the earlier example.
</p><!--l. 42--><p class="indent">   What&#x2019;s going on is that in the former case, we explicitly named the file to add on the command line, so the
assumption that Mercurial makes in such cases is that you know what you were doing, and it doesn&#x2019;t print any
output.
</p><!--l. 47--><p class="indent">   However, when we <span 
class="ptmri7t-">imply </span>the names of files by giving the name of a directory, Mercurial takes the extra step of printing the
name of each file that it does something with. This makes it more clear what is happening, and reduces the likelihood of a silent
and nasty surprise. This behaviour is common to most Mercurial commands.
</p><!--l. 53--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.1.2    </span> <a 
 id="x1-1260006.1.2"></a>Aside: Mercurial tracks files, not directories</h4>
<!--l. 55--><p class="noindent">Mercurial does not track directory information. Instead, it tracks the path to a file. Before creating a file, it first creates any
missing directory components of the path. After it deletes a file, it then deletes any empty directories that were in the deleted
file&#x2019;s path. This sounds like a trivial distinction, but it has one minor practical consequence: it is not possible to represent a
completely empty directory in Mercurial.
</p><!--l. 63--><p class="indent">   Empty directories are rarely useful, and there are unintrusive workarounds that you can use to achieve an appropriate effect.
The developers of Mercurial thus felt that the complexity that would be required to manage empty directories was not worth the
limited benefit this feature would bring.
</p><!--l. 69--><p class="indent">   If you need an empty directory in your repository, there are a few ways to achieve this. One is to create a directory, then <a 
 id="dx1-126001"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">add</span>&#x201D; a &#x201C;hidden&#x201D; file to that directory. On Unix-like systems, any file name that begins with a period (&#x201C;<span 
class="pcrr7tn-">.</span>&#x201D;) is treated as hidden
by most commands and GUI tools. This approach is illustrated in figure&#x00A0;<a 
href="#x1-1260281">6.1<!--tex4ht:ref: ex:daily:hidden --></a>.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1260281"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-126003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;hidden-example</span>
<br class="fancyvrb" /><a 
 id="x1-126005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;hidden-example</span>
<br class="fancyvrb" /><a 
 id="x1-126007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">mkdir</span><span 
class="pcrb7t-">&#x00A0;empty</span>
<br class="fancyvrb" /><a 
 id="x1-126009r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">touch</span><span 
class="pcrb7t-">&#x00A0;empty/.hidden</span>
<br class="fancyvrb" /><a 
 id="x1-126011r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;empty/.hidden</span>
<br class="fancyvrb" /><a 
 id="x1-126013r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Manage</span><span 
class="pcrb7t-">&#x00A0;an</span><span 
class="pcrb7t-">&#x00A0;empty-looking</span><span 
class="pcrb7t-">&#x00A0;directory'</span>
<br class="fancyvrb" /><a 
 id="x1-126015r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span><span 
class="pcrb7t-">&#x00A0;empty</span>
<br class="fancyvrb" /><a 
 id="x1-126017r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-126019r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;hidden-example</span><span 
class="pcrb7t-">&#x00A0;tmp</span>
<br class="fancyvrb" /><a 
 id="x1-126021r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-126023r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span><span 
class="pcrb7t-">&#x00A0;tmp</span>
<br class="fancyvrb" /><a 
 id="x1-126025r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;empty</span>
<br class="fancyvrb" /><a 
 id="x1-126027r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span><span 
class="pcrb7t-">&#x00A0;tmp/empty</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;6.1: </td><td  
class="content">Simulating an empty directory using a hidden file</td></tr></table><!--tex4ht:label?: x1-1260281 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 82--><p class="indent">   Another way to tackle a need for an empty directory is to simply create one in your automated build scripts before they will
need it.
</p>
   <h3 class="sectionHead"><span class="titlemark">6.2    </span> <a 
 id="x1-1270006.2"></a>How to stop tracking a file</h3>
<!--l. 87--><p class="noindent">Once you decide that a file no longer belongs in your repository, use the <a 
 id="dx1-127001"></a>&#x201C;<span 
class="pcrr7tn-">hg remove</span>&#x201D; command; this deletes the
file, and tells Mercurial to stop tracking it. A removed file is represented in the output of <a 
 id="dx1-127002"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; with a
&#x201C;<span 
class="pcrr7tn-">R</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-127004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;remove-example</span>
<br class="fancyvrb" /><a 
 id="x1-127006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;remove-example</span>
<br class="fancyvrb" /><a 
 id="x1-127008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-127010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">mkdir</span><span 
class="pcrb7t-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-127012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;b</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;b/b</span>
<br class="fancyvrb" /><a 
 id="x1-127014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-127016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;b/b</span>
<br class="fancyvrb" /><a 
 id="x1-127018r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Small</span><span 
class="pcrb7t-">&#x00A0;example</span><span 
class="pcrb7t-">&#x00A0;for</span><span 
class="pcrb7t-">&#x00A0;file</span><span 
class="pcrb7t-">&#x00A0;removal'</span>
<br class="fancyvrb" /><a 
 id="x1-127020r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;remove</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-127022r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-127024r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;R</span><span 
class="pcrr7tn-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-127026r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;remove</span><span 
class="pcrb7t-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-127028r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;removing</span><span 
class="pcrr7tn-">&#x00A0;b/b</span>
   </div>
<!--l. 93--><p class="indent">   After you <a 
 id="dx1-127029"></a>&#x201C;<span 
class="pcrr7tn-">hg remove</span>&#x201D; a file, Mercurial will no longer track changes to that file, even if you recreate a file with the same
name in your working directory. If you do recreate a file with the same name and want Mercurial to track the new
file, simply <a 
 id="dx1-127030"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; it. Mercurial will know that the newly added file is not related to the old file of the same
name.
</p><!--l. 100--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.2.1    </span> <a 
 id="x1-1280006.2.1"></a>Removing a file does not affect its history</h4>
<!--l. 102--><p class="noindent">It is important to understand that removing a file has only two effects. </p>
     <ul><li><span class="dt">
     </span><span class="dd">It removes the current version of the file from the working directory.
     </span><li><span class="dt">
     </span><span class="dd">It stops Mercurial from tracking changes to the file, from the time of the next commit.</li></ul>
<!--l. 110--><p class="noindent">Removing a file <span 
class="ptmri7t-">does not </span>in any way alter the <span 
class="ptmri7t-">history </span>of the file.
</p><!--l. 113--><p class="indent">   If you update the working directory to a changeset in which a file that you have removed was still tracked, it will reappear in
the working directory, with the contents it had when you committed that changeset. If you then update the working directory to
a later changeset, in which the file had been removed, Mercurial will once again remove the file from the working
directory.
                                                                                         
                                                                                         
</p><!--l. 120--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.2.2    </span> <a 
 id="x1-1290006.2.2"></a>Missing files</h4>
<!--l. 122--><p class="noindent">Mercurial considers a file that you have deleted, but not used <a 
 id="dx1-129001"></a>&#x201C;<span 
class="pcrr7tn-">hg remove</span>&#x201D; to delete, to be <span 
class="ptmri7t-">missing</span>. A missing file is
represented with &#x201C;<span 
class="pcrr7tn-">!</span>&#x201D; in the output of <a 
 id="dx1-129002"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D;. Mercurial commands will not generally do anything with missing
files.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-129004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;missing-example</span>
<br class="fancyvrb" /><a 
 id="x1-129006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;missing-example</span>
<br class="fancyvrb" /><a 
 id="x1-129008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-129010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-129012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'File</span><span 
class="pcrb7t-">&#x00A0;about</span><span 
class="pcrb7t-">&#x00A0;to</span><span 
class="pcrb7t-">&#x00A0;be</span><span 
class="pcrb7t-">&#x00A0;missing'</span>
<br class="fancyvrb" /><a 
 id="x1-129014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">rm</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-129016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-129018r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;!</span><span 
class="pcrr7tn-">&#x00A0;a</span>
   </div>
<!--l. 128--><p class="indent">   If your repository contains a file that <a 
 id="dx1-129019"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; reports as missing, and you want the file to stay gone, you
can run <a 
 id="dx1-129020"></a>&#x201C;<span 
class="pcrr7tn-">hg remove</span> <a 
 id="dx1-129021"></a><span 
class="pcrr7tn-">--after</span>&#x201D; at any time later on, to tell Mercurial that you really did mean to remove the
file.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-129023r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;remove</span><span 
class="pcrb7t-">&#x00A0;--after</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-129025r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-129027r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;R</span><span 
class="pcrr7tn-">&#x00A0;a</span>
   </div>
<!--l. 134--><p class="indent">   On the other hand, if you deleted the missing file by accident, use <a 
 id="dx1-129028"></a>&#x201C;<span 
class="pcrr7tn-">hg revert </span><span 
class="pcrro7t-">filename</span>&#x201D; to recover the file. It will
reappear, in unmodified form.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-129030r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;revert</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-129032r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-129034r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-129036r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
   </div>
<!--l. 140--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.2.3    </span> <a 
 id="x1-1300006.2.3"></a>Aside: why tell Mercurial explicitly to remove a file?</h4>
<!--l. 142--><p class="noindent">You might wonder why Mercurial requires you to explicitly tell it that you are deleting a file. Early during the development of
Mercurial, it let you delete a file however you pleased; Mercurial would notice the absence of the file automatically when you
next ran a <a 
 id="dx1-130001"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D;, and stop tracking the file. In practice, this made it too easy to accidentally remove a file without
noticing.
                                                                                         
                                                                                         
</p><!--l. 150--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.2.4    </span> <a 
 id="x1-1310006.2.4"></a>Useful shorthand&#x2014;adding and removing files in one step</h4>
<!--l. 152--><p class="noindent">Mercurial offers a combination command, <a 
 id="dx1-131001"></a>&#x201C;<span 
class="pcrr7tn-">hg addremove</span>&#x201D;, that adds untracked files and marks missing files as
removed.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-131003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;addremove-example</span>
<br class="fancyvrb" /><a 
 id="x1-131005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;addremove-example</span>
<br class="fancyvrb" /><a 
 id="x1-131007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-131009r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;b</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-131011r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;addremove</span>
<br class="fancyvrb" /><a 
 id="x1-131013r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-131015r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;b</span>
   </div>
<!--l. 155--><p class="noindent">The <a 
 id="dx1-131016"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; command also provides a <a 
 id="dx1-131017"></a><span 
class="pcrr7tn-">-A </span>option that performs this same add-and-remove, immediately followed by a
commit.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-131019r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;c</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;c</span>
<br class="fancyvrb" /><a 
 id="x1-131021r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Commit</span><span 
class="pcrb7t-">&#x00A0;with</span><span 
class="pcrb7t-">&#x00A0;addremove'</span>
<br class="fancyvrb" /><a 
 id="x1-131023r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;c</span>
   </div>
<!--l. 160--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">6.3    </span> <a 
 id="x1-1320006.3"></a>Copying files</h3>
<!--l. 162--><p class="noindent">Mercurial provides a <a 
 id="dx1-132001"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D; command that lets you make a new copy of a file. When you copy a file using this command,
Mercurial makes a record of the fact that the new file is a copy of the original file. It treats these copied files specially when you
merge your work with someone else&#x2019;s.
</p><!--l. 168--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.3.1    </span> <a 
 id="x1-1330006.3.1"></a>The results of copying during a merge</h4>
<!--l. 170--><p class="noindent">What happens during a merge is that changes &#x201C;follow&#x201D; a copy. To best illustrate what this means, let&#x2019;s create an example. We&#x2019;ll
start with the usual tiny repository that contains a single file.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-133002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;my-copy</span>
<br class="fancyvrb" /><a 
 id="x1-133004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;my-copy</span>
<br class="fancyvrb" /><a 
 id="x1-133006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;line</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-133008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-133010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Added</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;file'</span>
   </div>
<!--l. 174--><p class="noindent">We need to do some work in parallel, so that we&#x2019;ll have something to merge. So let&#x2019;s clone our repository.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-133012r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-133014r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;my-copy</span><span 
class="pcrb7t-">&#x00A0;your-copy</span>
<br class="fancyvrb" /><a 
 id="x1-133016r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
   </div>
<!--l. 177--><p class="noindent">Back in our initial repository, let&#x2019;s use the <a 
 id="dx1-133017"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D; command to make a copy of the first file we created.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-133019r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;my-copy</span>
<br class="fancyvrb" /><a 
 id="x1-133021r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;copy</span><span 
class="pcrb7t-">&#x00A0;file</span><span 
class="pcrb7t-">&#x00A0;new-file</span>
   </div>
<!--l. 181--><p class="indent">   If we look at the output of the <a 
 id="dx1-133022"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; command afterwards, the copied file looks just like a normal added
file.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-133024r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-133026r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;new-file</span>
   </div>
<!--l. 184--><p class="noindent">But if we pass the <a 
 id="dx1-133027"></a><span 
class="pcrr7tn-">-C </span>option to <a 
 id="dx1-133028"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D;, it prints another line of output: this is the file that our newly-added file was copied
<span 
class="ptmri7t-">from</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-133030r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;-C</span>
<br class="fancyvrb" /><a 
 id="x1-133032r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;new-file</span>
<br class="fancyvrb" /><a 
 id="x1-133034r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-133036r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Copied</span><span 
class="pcrb7t-">&#x00A0;file'</span>
   </div>
<!--l. 189--><p class="indent">   Now, back in the repository we cloned, let&#x2019;s make a change in parallel. We&#x2019;ll add a line of content to the original file that we
created.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-133038r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;../your-copy</span>
<br class="fancyvrb" /><a 
 id="x1-133040r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'new</span><span 
class="pcrb7t-">&#x00A0;contents'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-133042r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Changed</span><span 
class="pcrb7t-">&#x00A0;file'</span>
   </div>
<!--l. 193--><p class="noindent">Now we have a modified <span 
class="pcrr7tn-">file </span>in this repository. When we pull the changes from the first repository, and merge the two heads,
Mercurial will propagate the changes that we made locally to <span 
class="pcrr7tn-">file </span>into its copy, <span 
class="pcrr7tn-">new-file</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-133044r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;pull</span><span 
class="pcrb7t-">&#x00A0;../my-copy</span>
<br class="fancyvrb" /><a 
 id="x1-133046r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pulling</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;../my-copy</span>
<br class="fancyvrb" /><a 
 id="x1-133048r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-133050r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-133052r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-133054r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-133056r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;(+1</span><span 
class="pcrr7tn-">&#x00A0;heads)</span>
<br class="fancyvrb" /><a 
 id="x1-133058r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(run</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;heads'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;heads,</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;merge'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;merge)</span>
<br class="fancyvrb" /><a 
 id="x1-133060r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;merge</span>
<br class="fancyvrb" /><a 
 id="x1-133062r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;merging</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;and</span><span 
class="pcrr7tn-">&#x00A0;new-file</span>
<br class="fancyvrb" /><a 
 id="x1-133064r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-133066r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(branch</span><span 
class="pcrr7tn-">&#x00A0;merge,</span><span 
class="pcrr7tn-">&#x00A0;don't</span><span 
class="pcrr7tn-">&#x00A0;forget</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;commit)</span>
<br class="fancyvrb" /><a 
 id="x1-133068r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;new-file</span>
<br class="fancyvrb" /><a 
 id="x1-133070r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span>
<br class="fancyvrb" /><a 
 id="x1-133072r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;new</span><span 
class="pcrr7tn-">&#x00A0;contents</span>
   </div>
<!--l. 199--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.3.2    </span> <a 
 id="x1-1340006.3.2"></a>Why should changes follow copies?</h4>
<!--l. 202--><p class="noindent">This behaviour, of changes to a file propagating out to copies of the file, might seem esoteric, but in most cases it&#x2019;s highly
desirable.
</p><!--l. 205--><p class="indent">   First of all, remember that this propagation <span 
class="ptmri7t-">only </span>happens when you merge. So if you <a 
 id="dx1-134001"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D; a file, and subsequently
modify the original file during the normal course of your work, nothing will happen.
</p><!--l. 210--><p class="indent">   The second thing to know is that modifications will only propagate across a copy as long as the repository that you&#x2019;re
pulling changes from <span 
class="ptmri7t-">doesn&#x2019;t know </span>about the copy.
</p><!--l. 214--><p class="indent">   The reason that Mercurial does this is as follows. Let&#x2019;s say I make an important bug fix in a source file, and commit my
changes. Meanwhile, you&#x2019;ve decided to <a 
 id="dx1-134002"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D; the file in your repository, without knowing about the bug or having seen
the fix, and you have started hacking on your copy of the file.
</p><!--l. 220--><p class="indent">   If you pulled and merged my changes, and Mercurial <span 
class="ptmri7t-">didn&#x2019;t </span>propagate changes across copies, your source file would now
contain the bug, and unless you remembered to propagate the bug fix by hand, the bug would <span 
class="ptmri7t-">remain </span>in your copy of the
file.
</p><!--l. 225--><p class="indent">   By automatically propagating the change that fixed the bug from the original file to the copy, Mercurial prevents this class
of problem. To my knowledge, Mercurial is the <span 
class="ptmri7t-">only </span>revision control system that propagates changes across copies like
this.
</p><!--l. 230--><p class="indent">   Once your change history has a record that the copy and subsequent merge occurred, there&#x2019;s usually no further need to
propagate changes from the original file to the copied file, and that&#x2019;s why Mercurial only propagates changes across copies until
this point, and no further.
</p><!--l. 236--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.3.3    </span> <a 
 id="x1-1350006.3.3"></a>How to make changes <span 
class="ptmri7t-">not </span>follow a copy</h4>
<!--l. 238--><p class="noindent">If, for some reason, you decide that this business of automatically propagating changes across copies is not for you, simply use
your system&#x2019;s normal file copy command (on Unix-like systems, that&#x2019;s <a 
 id="dx1-135001"></a><span 
class="pcrr7tn-">cp</span>) to make a copy of a file, then <a 
 id="dx1-135002"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; the new
copy by hand. Before you do so, though, please do reread section&#x00A0;<a 
href="#x1-1340006.3.2">6.3.2<!--tex4ht:ref: sec:daily:why-copy --></a>, and make an informed decision that this behaviour is
not appropriate to your specific case.
</p><!--l. 246--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.3.4    </span> <a 
 id="x1-1360006.3.4"></a>Behaviour of the &#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D; command</h4>
<!--l. 248--><p class="noindent">When you use the <a 
 id="dx1-136001"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D; command, Mercurial makes a copy of each source file as it currently stands in the working
directory. This means that if you make some modifications to a file, then <a 
 id="dx1-136002"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D; it without first having committed those
changes, the new copy will also contain the modifications you have made up until that point. (I find this behaviour a little
                                                                                         
                                                                                         
counterintuitive, which is why I mention it here.)
</p><!--l. 256--><p class="indent">   The <a 
 id="dx1-136003"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D; command acts similarly to the Unix <a 
 id="dx1-136004"></a><span 
class="pcrr7tn-">cp </span>command (you can use the <a 
 id="dx1-136005"></a>&#x201C;<span 
class="pcrr7tn-">hg cp</span>&#x201D; alias if you prefer). The last
argument is the <span 
class="ptmri7t-">destination</span>, and all prior arguments are <span 
class="ptmri7t-">sources</span>. If you pass it a single file as the source, and the destination
does not exist, it creates a new file with that name.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-136007r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">mkdir</span><span 
class="pcrb7t-">&#x00A0;k</span>
<br class="fancyvrb" /><a 
 id="x1-136009r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;copy</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;k</span>
<br class="fancyvrb" /><a 
 id="x1-136011r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span><span 
class="pcrb7t-">&#x00A0;k</span>
<br class="fancyvrb" /><a 
 id="x1-136013r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;a</span>
   </div>
<!--l. 262--><p class="noindent">If the destination is a directory, Mercurial copies its sources into that directory.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-136015r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">mkdir</span><span 
class="pcrb7t-">&#x00A0;d</span>
<br class="fancyvrb" /><a 
 id="x1-136017r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;copy</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;b</span><span 
class="pcrb7t-">&#x00A0;d</span>
<br class="fancyvrb" /><a 
 id="x1-136019r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span><span 
class="pcrb7t-">&#x00A0;d</span>
<br class="fancyvrb" /><a 
 id="x1-136021r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;b</span>
   </div>
<!--l. 265--><p class="noindent">Copying a directory is recursive, and preserves the directory structure of the source.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-136023r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;copy</span><span 
class="pcrb7t-">&#x00A0;c</span><span 
class="pcrb7t-">&#x00A0;e</span>
<br class="fancyvrb" /><a 
 id="x1-136025r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;copying</span><span 
class="pcrr7tn-">&#x00A0;c/a/c</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;e/a/c</span>
   </div>
<!--l. 268--><p class="noindent">If the source and destination are both directories, the source tree is recreated in the destination directory.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-136027r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;copy</span><span 
class="pcrb7t-">&#x00A0;c</span><span 
class="pcrb7t-">&#x00A0;d</span>
<br class="fancyvrb" /><a 
 id="x1-136029r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;copying</span><span 
class="pcrr7tn-">&#x00A0;c/a/c</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;d/c/a/c</span>
   </div>
<!--l. 272--><p class="indent">   As with the <a 
 id="dx1-136030"></a>&#x201C;<span 
class="pcrr7tn-">hg rename</span>&#x201D; command, if you copy a file manually and then want Mercurial to know that you&#x2019;ve copied the
file, simply use the <a 
 id="dx1-136031"></a><span 
class="pcrr7tn-">--after </span>option to <a 
 id="dx1-136032"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-136034r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cp</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;z</span>
<br class="fancyvrb" /><a 
 id="x1-136036r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;copy</span><span 
class="pcrb7t-">&#x00A0;--after</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;z</span>
   </div>
<!--l. 277--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">6.4    </span> <a 
 id="x1-1370006.4"></a>Renaming files</h3>
                                                                                         
                                                                                         
<!--l. 279--><p class="noindent">It&#x2019;s rather more common to need to rename a file than to make a copy of it. The reason I discussed the <a 
 id="dx1-137001"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D; command
before talking about renaming files is that Mercurial treats a rename in essentially the same way as a copy.
Therefore, knowing what Mercurial does when you copy a file tells you what to expect when you rename a
file.
</p><!--l. 285--><p class="indent">   When you use the <a 
 id="dx1-137002"></a>&#x201C;<span 
class="pcrr7tn-">hg rename</span>&#x201D; command, Mercurial makes a copy of each source file, then deletes it and marks the file as
removed.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-137004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;rename</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;b</span>
   </div>
<!--l. 288--><p class="noindent">The <a 
 id="dx1-137005"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; command shows the newly copied file as added, and the copied-from file as removed.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-137007r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-137009r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-137011r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;R</span><span 
class="pcrr7tn-">&#x00A0;a</span>
   </div>
<!--l. 291--><p class="noindent">As with the results of a <a 
 id="dx1-137012"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D;, we must use the <a 
 id="dx1-137013"></a><span 
class="pcrr7tn-">-C </span>option to <a 
 id="dx1-137014"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; to see that the added file is really being tracked by
Mercurial as a copy of the original, now removed, file.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-137016r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;-C</span>
<br class="fancyvrb" /><a 
 id="x1-137018r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-137020r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-137022r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;R</span><span 
class="pcrr7tn-">&#x00A0;a</span>
   </div>
<!--l. 297--><p class="indent">   As with <a 
 id="dx1-137023"></a>&#x201C;<span 
class="pcrr7tn-">hg remove</span>&#x201D; and <a 
 id="dx1-137024"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D;, you can tell Mercurial about a rename after the fact using the <a 
 id="dx1-137025"></a><span 
class="pcrr7tn-">--after </span>option. In
most other respects, the behaviour of the <a 
 id="dx1-137026"></a>&#x201C;<span 
class="pcrr7tn-">hg rename</span>&#x201D; command, and the options it accepts, are similar to the <a 
 id="dx1-137027"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D;
command.
</p><!--l. 302--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.4.1    </span> <a 
 id="x1-1380006.4.1"></a>Renaming files and merging changes</h4>
<!--l. 304--><p class="noindent">Since Mercurial&#x2019;s rename is implemented as copy-and-remove, the same propagation of changes happens when you merge after
a rename as after a copy.
</p><!--l. 308--><p class="indent">   If I modify a file, and you rename it to a new name, and then we merge our respective changes, my modifications to the file
under its original name will be propagated into the file under its new name. (This is something you might expect to &#x201C;simply
work,&#x201D; but not all revision control systems actually do this.)
</p><!--l. 314--><p class="indent">   Whereas having changes follow a copy is a feature where you can perhaps nod and say &#x201C;yes, that might be useful,&#x201D; it should
be clear that having them follow a rename is definitely important. Without this facility, it would simply be too easy for changes
to become orphaned when files are renamed.
</p><!--l. 320--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.4.2    </span> <a 
 id="x1-1390006.4.2"></a>Divergent renames and merging</h4>
                                                                                         
                                                                                         
<!--l. 322--><p class="noindent">The case of diverging names occurs when two developers start with a file&#x2014;let&#x2019;s call it <span 
class="pcrr7tn-">foo</span>&#x2014;in their respective
repositories.
</p><!--l. 326--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-139002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;orig</span><span 
class="pcrb7t-">&#x00A0;anne</span>
<br class="fancyvrb" /><a 
 id="x1-139004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-139006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;orig</span><span 
class="pcrb7t-">&#x00A0;bob</span>
<br class="fancyvrb" /><a 
 id="x1-139008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
   </div>
<!--l. 327--><p class="noindent">Anne renames the file to <span 
class="pcrr7tn-">bar</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-139010r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;anne</span>
<br class="fancyvrb" /><a 
 id="x1-139012r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;mv</span><span 
class="pcrb7t-">&#x00A0;foo</span><span 
class="pcrb7t-">&#x00A0;bar</span>
<br class="fancyvrb" /><a 
 id="x1-139014r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;ci</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Rename</span><span 
class="pcrb7t-">&#x00A0;foo</span><span 
class="pcrb7t-">&#x00A0;to</span><span 
class="pcrb7t-">&#x00A0;bar'</span>
   </div>
<!--l. 329--><p class="noindent">Meanwhile, Bob renames it to <span 
class="pcrr7tn-">quux</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-139016r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;../bob</span>
<br class="fancyvrb" /><a 
 id="x1-139018r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;mv</span><span 
class="pcrb7t-">&#x00A0;foo</span><span 
class="pcrb7t-">&#x00A0;quux</span>
<br class="fancyvrb" /><a 
 id="x1-139020r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;ci</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Rename</span><span 
class="pcrb7t-">&#x00A0;foo</span><span 
class="pcrb7t-">&#x00A0;to</span><span 
class="pcrb7t-">&#x00A0;quux'</span>
   </div>
<!--l. 332--><p class="indent">   I like to think of this as a conflict because each developer has expressed different intentions about what the file ought to be
named.
</p><!--l. 335--><p class="indent">   What do you think should happen when they merge their work? Mercurial&#x2019;s actual behaviour is that it always preserves <span 
class="ptmri7t-">both</span>
names when it merges changesets that contain divergent renames.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-139022r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;See</span><span 
class="pcrr7tn-">&#x00A0;http://www.selenic.com/mercurial/bts/issue455</span>
<br class="fancyvrb" /><a 
 id="x1-139024r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;../orig</span>
<br class="fancyvrb" /><a 
 id="x1-139026r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;pull</span><span 
class="pcrb7t-">&#x00A0;-u</span><span 
class="pcrb7t-">&#x00A0;../anne</span>
<br class="fancyvrb" /><a 
 id="x1-139028r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pulling</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;../anne</span>
<br class="fancyvrb" /><a 
 id="x1-139030r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-139032r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-139034r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-139036r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-139038r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span>
<br class="fancyvrb" /><a 
 id="x1-139040r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-139042r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;pull</span><span 
class="pcrb7t-">&#x00A0;../bob</span>
<br class="fancyvrb" /><a 
 id="x1-139044r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pulling</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;../bob</span>
<br class="fancyvrb" /><a 
 id="x1-139046r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-139048r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-139050r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-139052r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-139054r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;(+1</span><span 
class="pcrr7tn-">&#x00A0;heads)</span>
<br class="fancyvrb" /><a 
 id="x1-139056r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(run</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;heads'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;heads,</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;merge'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;merge)</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-139058r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;merge</span>
<br class="fancyvrb" /><a 
 id="x1-139060r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-139062r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(branch</span><span 
class="pcrr7tn-">&#x00A0;merge,</span><span 
class="pcrr7tn-">&#x00A0;don't</span><span 
class="pcrr7tn-">&#x00A0;forget</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;commit)</span>
<br class="fancyvrb" /><a 
 id="x1-139064r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span>
<br class="fancyvrb" /><a 
 id="x1-139066r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bar</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;quux</span>
   </div>
<!--l. 340--><p class="indent">   Notice that Mercurial does warn about the divergent renames, but it leaves it up to you to do something about the
divergence after the merge.
</p><!--l. 343--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.4.3    </span> <a 
 id="x1-1400006.4.3"></a>Convergent renames and merging</h4>
<!--l. 345--><p class="noindent">Another kind of rename conflict occurs when two people choose to rename different <span 
class="ptmri7t-">source </span>files to the same <span 
class="ptmri7t-">destination</span>. In this
case, Mercurial runs its normal merge machinery, and lets you guide it to a suitable resolution.
</p><!--l. 350--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.4.4    </span> <a 
 id="x1-1410006.4.4"></a>Other name-related corner cases</h4>
<!--l. 352--><p class="noindent">Mercurial has a longstanding bug in which it fails to handle a merge where one side has a file with a given name, while another
has a directory with the same name. This is documented as&#x00A0;<a 
 id="dx1-141001"></a><a 
href="http://www.selenic.com/mercurial/bts/issue29" >Mercurial bug no.&#x00A0;29</a>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-141003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;issue29</span>
<br class="fancyvrb" /><a 
 id="x1-141005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;issue29</span>
<br class="fancyvrb" /><a 
 id="x1-141007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-141009r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;ci</span><span 
class="pcrb7t-">&#x00A0;-Ama</span>
<br class="fancyvrb" /><a 
 id="x1-141011r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-141013r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;b</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-141015r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;ci</span><span 
class="pcrb7t-">&#x00A0;-Amb</span>
<br class="fancyvrb" /><a 
 id="x1-141017r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-141019r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;up</span><span 
class="pcrb7t-">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x1-141021r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-141023r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">mkdir</span><span 
class="pcrb7t-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-141025r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;b</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;b/b</span>
<br class="fancyvrb" /><a 
 id="x1-141027r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;ci</span><span 
class="pcrb7t-">&#x00A0;-Amc</span>
<br class="fancyvrb" /><a 
 id="x1-141029r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;b/b</span>
<br class="fancyvrb" /><a 
 id="x1-141031r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;merge</span>
<br class="fancyvrb" /><a 
 id="x1-141033r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;Is</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;directory:</span><span 
class="pcrr7tn-">&#x00A0;/tmp/issue29W_Stvr/issue29/b</span>
   </div>
<!--l. 357--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">6.5    </span> <a 
 id="x1-1420006.5"></a>Recovering from mistakes</h3>
<!--l. 359--><p class="noindent">Mercurial has some useful commands that will help you to recover from some common mistakes.
                                                                                         
                                                                                         
</p><!--l. 362--><p class="indent">   The <a 
 id="dx1-142001"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; command lets you undo changes that you have made to your working directory. For example, if you <a 
 id="dx1-142002"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">add</span>&#x201D; a file by accident, just run <a 
 id="dx1-142003"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; with the name of the file you added, and while the file won&#x2019;t be touched in any
way, it won&#x2019;t be tracked for adding by Mercurial any longer, either. You can also use <a 
 id="dx1-142004"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; to get rid of erroneous
changes to a file.
</p><!--l. 369--><p class="indent">   It&#x2019;s useful to remember that the <a 
 id="dx1-142005"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; command is useful for changes that you have not yet committed. Once you&#x2019;ve
committed a change, if you decide it was a mistake, you can still do something about it, though your options may be more
limited.
</p><!--l. 374--><p class="indent">   For more information about the <a 
 id="dx1-142006"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; command, and details about how to deal with changes you have already
committed, see chapter&#x00A0;<a 
href="#x1-1690009">9<!--tex4ht:ref: chap:undo --></a>.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
</p>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;7</span><br /><a 
 id="x1-1430007"></a>File names and pattern matching</h2>
<!--l. 4--><p class="noindent">Mercurial provides mechanisms that let you work with file names in a consistent and expressive way.
</p>
   <h3 class="sectionHead"><span class="titlemark">7.1    </span> <a 
 id="x1-1440007.1"></a>Simple file naming</h3>
<!--l. 9--><p class="noindent">Mercurial uses a unified piece of machinery &#x201C;under the hood&#x201D; to handle file names. Every command behaves uniformly with
respect to file names. The way in which commands work with file names is as follows.
</p><!--l. 14--><p class="indent">   If you explicitly name real files on the command line, Mercurial works with exactly those files, as you would
expect.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-144002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;COPYING</span><span 
class="pcrb7t-">&#x00A0;README</span><span 
class="pcrb7t-">&#x00A0;examples/simple.py</span>
   </div>
<!--l. 18--><p class="indent">   When you provide a directory name, Mercurial will interpret this as &#x201C;operate on every file in this directory and its
subdirectories&#x201D;. Mercurial traverses the files and subdirectories in a directory in alphabetical order. When it encounters a
subdirectory, it will traverse that subdirectory before continuing with the current directory.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-144004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;src</span>
<br class="fancyvrb" /><a 
 id="x1-144006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/main.py</span>
<br class="fancyvrb" /><a 
 id="x1-144008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/watcher/_watcher.c</span>
<br class="fancyvrb" /><a 
 id="x1-144010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/watcher/watcher.py</span>
<br class="fancyvrb" /><a 
 id="x1-144012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/xyzzy.txt</span>
   </div>
<!--l. 26--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">7.2    </span> <a 
 id="x1-1450007.2"></a>Running commands without any file names</h3>
<!--l. 28--><p class="noindent">Mercurial&#x2019;s commands that work with file names have useful default behaviours when you invoke them without providing any
file names or patterns. What kind of behaviour you should expect depends on what the command does. Here are a few rules
of thumb you can use to predict what a command is likely to do if you don&#x2019;t give it any names to work with.
</p>
     <ul><li><span class="dt">
     </span><span class="dd">Most commands will operate on the entire working directory. This is what the <a 
 id="dx1-145001"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; command does, for
     example.
     </span><li><span class="dt">
     </span><span class="dd">If the command has effects that are difficult or impossible to reverse, it will force you to explicitly provide at least
     one name or pattern (see below). This protects you from accidentally deleting files by running <a 
 id="dx1-145002"></a>&#x201C;<span 
class="pcrr7tn-">hg remove</span>&#x201D;
     with no arguments, for example.</li></ul>
<!--l. 44--><p class="indent">   It&#x2019;s easy to work around these default behaviours if they don&#x2019;t suit you. If a command normally operates on the whole
working directory, you can invoke it on just the current directory and its subdirectories by giving it the name
&#x201C;<span 
class="pcrr7tn-">.</span>&#x201D;.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-145004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;src</span>
<br class="fancyvrb" /><a 
 id="x1-145006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;-n</span>
<br class="fancyvrb" /><a 
 id="x1-145008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;../MANIFEST.in</span>
<br class="fancyvrb" /><a 
 id="x1-145010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;../examples/performant.py</span>
<br class="fancyvrb" /><a 
 id="x1-145012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;../setup.py</span>
<br class="fancyvrb" /><a 
 id="x1-145014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;main.py</span>
<br class="fancyvrb" /><a 
 id="x1-145016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;watcher/_watcher.c</span>
<br class="fancyvrb" /><a 
 id="x1-145018r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;watcher/watcher.py</span>
<br class="fancyvrb" /><a 
 id="x1-145020r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;xyzzy.txt</span>
<br class="fancyvrb" /><a 
 id="x1-145022r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;-n</span><span 
class="pcrb7t-">&#x00A0;.</span>
<br class="fancyvrb" /><a 
 id="x1-145024r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;main.py</span>
<br class="fancyvrb" /><a 
 id="x1-145026r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;watcher/_watcher.c</span>
<br class="fancyvrb" /><a 
 id="x1-145028r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;watcher/watcher.py</span>
<br class="fancyvrb" /><a 
 id="x1-145030r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;xyzzy.txt</span>
   </div>
<!--l. 50--><p class="indent">   Along the same lines, some commands normally print file names relative to the root of the repository, even if you&#x2019;re
invoking them from a subdirectory. Such a command will print file names relative to your subdirectory if you give it
explicit names. Here, we&#x2019;re going to run <a 
 id="dx1-145031"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; from a subdirectory, and get it to operate on the entire
working directory while printing file names relative to our subdirectory, by passing it the output of the <a 
 id="dx1-145032"></a>&#x201C;<span 
class="pcrr7tn-">hg root</span>&#x201D;
command.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-145034r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-145036r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;COPYING</span>
<br class="fancyvrb" /><a 
 id="x1-145038r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;README</span>
<br class="fancyvrb" /><a 
 id="x1-145040r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;examples/simple.py</span>
<br class="fancyvrb" /><a 
 id="x1-145042r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;MANIFEST.in</span>
<br class="fancyvrb" /><a 
 id="x1-145044r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;examples/performant.py</span>
<br class="fancyvrb" /><a 
 id="x1-145046r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;setup.py</span>
<br class="fancyvrb" /><a 
 id="x1-145048r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/main.py</span>
<br class="fancyvrb" /><a 
 id="x1-145050r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/watcher/_watcher.c</span>
<br class="fancyvrb" /><a 
 id="x1-145052r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/watcher/watcher.py</span>
<br class="fancyvrb" /><a 
 id="x1-145054r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/xyzzy.txt</span>
<br class="fancyvrb" /><a 
 id="x1-145056r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;&#x2018;hg</span><span 
class="pcrb7t-">&#x00A0;root&#x2018;</span>
<br class="fancyvrb" /><a 
 id="x1-145058r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;../COPYING</span>
<br class="fancyvrb" /><a 
 id="x1-145060r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;../README</span>
<br class="fancyvrb" /><a 
 id="x1-145062r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;../examples/simple.py</span>
<br class="fancyvrb" /><a 
 id="x1-145064r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;../MANIFEST.in</span>
<br class="fancyvrb" /><a 
 id="x1-145066r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;../examples/performant.py</span>
<br class="fancyvrb" /><a 
 id="x1-145068r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;../setup.py</span>
<br class="fancyvrb" /><a 
 id="x1-145070r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;main.py</span>
<br class="fancyvrb" /><a 
 id="x1-145072r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;watcher/_watcher.c</span>
<br class="fancyvrb" /><a 
 id="x1-145074r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;watcher/watcher.py</span>
<br class="fancyvrb" /><a 
 id="x1-145076r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;xyzzy.txt</span>
   </div>
<!--l. 59--><p class="noindent">
                                                                                         
                                                                                         
</p>
   <h3 class="sectionHead"><span class="titlemark">7.3    </span> <a 
 id="x1-1460007.3"></a>Telling you what&#x2019;s going on</h3>
<!--l. 61--><p class="noindent">The <a 
 id="dx1-146001"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; example in the preceding section illustrates something else that&#x2019;s helpful about Mercurial commands. If a
command operates on a file that you didn&#x2019;t name explicitly on the command line, it will usually print the name of the file, so
that you will not be surprised what&#x2019;s going on.
</p><!--l. 67--><p class="indent">   The principle here is of <span 
class="ptmri7t-">least surprise</span>. If you&#x2019;ve exactly named a file on the command line, there&#x2019;s no point in repeating it
back at you. If Mercurial is acting on a file <span 
class="ptmri7t-">implicitly</span>, because you provided no names, or a directory, or a pattern (see below),
it&#x2019;s safest to tell you what it&#x2019;s doing.
</p><!--l. 73--><p class="indent">   For commands that behave this way, you can silence them using the <a 
 id="dx1-146002"></a><span 
class="pcrr7tn-">-q </span>option. You can also get them to print the name of
every file, even those you&#x2019;ve named explicitly, using the <a 
 id="dx1-146003"></a><span 
class="pcrr7tn-">-v </span>option.
</p><!--l. 78--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">7.4    </span> <a 
 id="x1-1470007.4"></a>Using patterns to identify files</h3>
<!--l. 80--><p class="noindent">In addition to working with file and directory names, Mercurial lets you use <span 
class="ptmri7t-">patterns </span>to identify files. Mercurial&#x2019;s pattern
handling is expressive.
</p><!--l. 84--><p class="indent">   On Unix-like systems (Linux, MacOS, etc.), the job of matching file names to patterns normally falls to
the shell. On these systems, you must explicitly tell Mercurial that a name is a pattern. On Windows, the shell
does not expand patterns, so Mercurial will automatically identify names that are patterns, and expand them for
you.
</p><!--l. 90--><p class="indent">   To provide a pattern in place of a regular name on the command line, the mechanism is simple:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-147002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;syntax:patternbody</span>
   </div>
<!--l. 95--><p class="noindent">That is, a pattern is identified by a short text string that says what kind of pattern this is, followed by a colon, followed by the actual
pattern.
</p><!--l. 99--><p class="indent">   Mercurial supports two kinds of pattern syntax. The most frequently used is called <span 
class="pcrr7tn-">glob</span>; this is the same
kind of pattern matching used by the Unix shell, and should be familiar to Windows command prompt users,
too.
</p><!--l. 104--><p class="indent">   When Mercurial does automatic pattern matching on Windows, it uses <span 
class="pcrr7tn-">glob </span>syntax. You can thus omit the &#x201C;<span 
class="pcrr7tn-">glob:</span>&#x201D; prefix
on Windows, but it&#x2019;s safe to use it, too.
</p><!--l. 108--><p class="indent">   The <span 
class="pcrr7tn-">re </span>syntax is more powerful; it lets you specify patterns using regular expressions, also known as regexps.
</p><!--l. 111--><p class="indent">   By the way, in the examples that follow, notice that I&#x2019;m careful to wrap all of my patterns in quote characters, so that they
won&#x2019;t get expanded by the shell before Mercurial sees them.
</p><!--l. 115--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.4.1    </span> <a 
 id="x1-1480007.4.1"></a>Shell-style <span 
class="pcrr7tn-">glob </span>patterns</h4>
<!--l. 117--><p class="noindent">This is an overview of the kinds of patterns you can use when you&#x2019;re matching on glob patterns.
</p><!--l. 120--><p class="indent">   The &#x201C;<span 
class="pcrr7tn-">&#x22C6;</span>&#x201D; character matches any string, within a single directory.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-148002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;'glob:&#x22C6;.py'</span>
<br class="fancyvrb" /><a 
 id="x1-148004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;main.py</span>
   </div>
                                                                                         
                                                                                         
<!--l. 124--><p class="indent">   The &#x201C;<span 
class="pcrr7tn-">&#x22C6;&#x22C6;</span>&#x201D; pattern matches any string, and crosses directory boundaries. It&#x2019;s not a standard Unix glob token, but it&#x2019;s accepted
by several popular Unix shells, and is very useful.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-148006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-148008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;'glob:&#x22C6;&#x22C6;.py'</span>
<br class="fancyvrb" /><a 
 id="x1-148010r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;examples/simple.py</span>
<br class="fancyvrb" /><a 
 id="x1-148012r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;src/main.py</span>
<br class="fancyvrb" /><a 
 id="x1-148014r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;examples/performant.py</span>
<br class="fancyvrb" /><a 
 id="x1-148016r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;setup.py</span>
<br class="fancyvrb" /><a 
 id="x1-148018r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/watcher/watcher.py</span>
   </div>
<!--l. 129--><p class="indent">   The &#x201C;<span 
class="pcrr7tn-">?</span>&#x201D; pattern matches any single character.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-148020r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;'glob:&#x22C6;&#x22C6;.?'</span>
<br class="fancyvrb" /><a 
 id="x1-148022r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/watcher/_watcher.c</span>
   </div>
<!--l. 132--><p class="indent">   The &#x201C;<span 
class="pcrr7tn-">[</span>&#x201D; character begins a <span 
class="ptmri7t-">character class</span>. This matches any single character within the class. The class ends with a &#x201C;<span 
class="pcrr7tn-">]</span>&#x201D;
character. A class may contain multiple <span 
class="ptmri7t-">range</span>s of the form &#x201C;<span 
class="pcrr7tn-">a-f</span>&#x201D;, which is shorthand for &#x201C;<span 
class="pcrr7tn-">abcdef</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-148024r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;'glob:&#x22C6;&#x22C6;[nr-t]'</span>
<br class="fancyvrb" /><a 
 id="x1-148026r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;MANIFEST.in</span>
<br class="fancyvrb" /><a 
 id="x1-148028r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/xyzzy.txt</span>
   </div>
<!--l. 138--><p class="noindent">If the first character after the &#x201C;<span 
class="pcrr7tn-">[</span>&#x201D; in a character class is a &#x201C;<span 
class="pcrr7tn-">!</span>&#x201D;, it <span 
class="ptmri7t-">negates </span>the class, making it match any single character not in the
class.
</p><!--l. 142--><p class="indent">   A &#x201C;<span 
class="cmsy-10">{</span>&#x201D; begins a group of subpatterns, where the whole group matches if any subpattern in the group matches. The &#x201C;<span 
class="pcrr7tn-">,</span>&#x201D;
character separates subpatterns, and &#x201C;<span 
class="cmsy-10">}</span>&#x201D; ends the group.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-148030r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;'glob:&#x22C6;.</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">in,py</span><span 
class="cmsy-10">}</span><span 
class="pcrb7t-">'</span>
<br class="fancyvrb" /><a 
 id="x1-148032r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;MANIFEST.in</span>
<br class="fancyvrb" /><a 
 id="x1-148034r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;setup.py</span>
   </div>
<!--l. 147--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-1490007.4.1"></a>Watch out!</h5>
<!--l. 149--><p class="noindent">Don&#x2019;t forget that if you want to match a pattern in any directory, you should not be using the &#x201C;<span 
class="pcrr7tn-">&#x22C6;</span>&#x201D; match-any token, as this will
only match within one directory. Instead, use the &#x201C;<span 
class="pcrr7tn-">&#x22C6;&#x22C6;</span>&#x201D; token. This small example illustrates the difference between the
two.
</p>
   <div class="fancyvrb" id="fancyvrb">
                                                                                         
                                                                                         
<a 
 id="x1-149002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;'glob:&#x22C6;.py'</span>
<br class="fancyvrb" /><a 
 id="x1-149004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;setup.py</span>
<br class="fancyvrb" /><a 
 id="x1-149006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;'glob:&#x22C6;&#x22C6;.py'</span>
<br class="fancyvrb" /><a 
 id="x1-149008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;examples/simple.py</span>
<br class="fancyvrb" /><a 
 id="x1-149010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;src/main.py</span>
<br class="fancyvrb" /><a 
 id="x1-149012r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;examples/performant.py</span>
<br class="fancyvrb" /><a 
 id="x1-149014r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;setup.py</span>
<br class="fancyvrb" /><a 
 id="x1-149016r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/watcher/watcher.py</span>
   </div>
<!--l. 155--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.4.2    </span> <a 
 id="x1-1500007.4.2"></a>Regular expression matching with <span 
class="pcrr7tn-">re </span>patterns</h4>
<!--l. 157--><p class="noindent">Mercurial accepts the same regular expression syntax as the Python programming language (it uses Python&#x2019;s regexp engine
internally). This is based on the Perl language&#x2019;s regexp syntax, which is the most popular dialect in use (it&#x2019;s also used in Java,
for example).
</p><!--l. 162--><p class="indent">   I won&#x2019;t discuss Mercurial&#x2019;s regexp dialect in any detail here, as regexps are not often used. Perl-style regexps are in any
case already exhaustively documented on a multitude of web sites, and in many books. Instead, I will focus here on a few things
you should know if you find yourself needing to use regexps with Mercurial.
</p><!--l. 168--><p class="indent">   A regexp is matched against an entire file name, relative to the root of the repository. In other words, even if
you&#x2019;re already in subbdirectory <span 
class="pcrr7tn-">foo</span>, if you want to match files under this directory, your pattern must start with
&#x201C;<span 
class="pcrr7tn-">foo/</span>&#x201D;.
</p><!--l. 173--><p class="indent">   One thing to note, if you&#x2019;re familiar with Perl-style regexps, is that Mercurial&#x2019;s are <span 
class="ptmri7t-">rooted</span>. That is, a regexp starts matching
against the beginning of a string; it doesn&#x2019;t look for a match anywhere within the string. To match anywhere in a string, start
your pattern with &#x201C;<span 
class="pcrr7tn-">.&#x22C6;</span>&#x201D;.
</p><!--l. 179--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">7.5    </span> <a 
 id="x1-1510007.5"></a>Filtering files</h3>
<!--l. 181--><p class="noindent">Not only does Mercurial give you a variety of ways to specify files; it lets you further winnow those files using <span 
class="ptmri7t-">filters</span>.
Commands that work with file names accept two filtering options. </p>
     <ul><li><span class="dt">
     </span><span class="dd"><a 
 id="dx1-151001"></a><span 
class="pcrr7tn-">-I</span>, or <a 
 id="dx1-151002"></a><span 
class="pcrr7tn-">--include</span>, lets you specify a pattern that file names must match in order to be processed.
     </span><li><span class="dt">
     </span><span class="dd"><a 
 id="dx1-151003"></a><span 
class="pcrr7tn-">-X</span>, or <a 
 id="dx1-151004"></a><span 
class="pcrr7tn-">--exclude</span>, gives you a way to <span 
class="ptmri7t-">avoid </span>processing files, if they match this pattern.</li></ul>
<!--l. 190--><p class="noindent">You can provide multiple <a 
 id="dx1-151005"></a><span 
class="pcrr7tn-">-I </span>and <a 
 id="dx1-151006"></a><span 
class="pcrr7tn-">-X </span>options on the command line, and intermix them as you please. Mercurial interprets the
patterns you provide using glob syntax by default (but you can use regexps if you need to).
</p><!--l. 195--><p class="indent">   You can read a <a 
 id="dx1-151007"></a><span 
class="pcrr7tn-">-I </span>filter as &#x201C;process only the files that match this filter&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-151009r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;-I</span><span 
class="pcrb7t-">&#x00A0;'&#x22C6;.in'</span>
<br class="fancyvrb" /><a 
 id="x1-151011r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;MANIFEST.in</span>
   </div>
<!--l. 198--><p class="noindent">The <a 
 id="dx1-151012"></a><span 
class="pcrr7tn-">-X </span>filter is best read as &#x201C;process only the files that don&#x2019;t match this pattern&#x201D;.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-151014r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;-X</span><span 
class="pcrb7t-">&#x00A0;'&#x22C6;&#x22C6;.py'</span><span 
class="pcrb7t-">&#x00A0;src</span>
<br class="fancyvrb" /><a 
 id="x1-151016r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/watcher/_watcher.c</span>
<br class="fancyvrb" /><a 
 id="x1-151018r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;src/xyzzy.txt</span>
   </div>
<!--l. 202--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">7.6    </span> <a 
 id="x1-1520007.6"></a>Ignoring unwanted files and directories</h3>
<!--l. 204--><p class="noindent">XXX.
</p><!--l. 206--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">7.7    </span> <a 
 id="x1-1530007.7"></a>Case sensitivity</h3>
<!--l. 209--><p class="noindent">If you&#x2019;re working in a mixed development environment that contains both Linux (or other Unix) systems and Macs or Windows
systems, you should keep in the back of your mind the knowledge that they treat the case (&#x201C;N&#x201D; versus &#x201C;n&#x201D;) of file names in
incompatible ways. This is not very likely to affect you, and it&#x2019;s easy to deal with if it does, but it could surprise you if you
don&#x2019;t know about it.
</p><!--l. 216--><p class="indent">   Operating systems and filesystems differ in the way they handle the <span 
class="ptmri7t-">case </span>of characters in file and directory names. There are
three common ways to handle case in names. </p>
     <ul><li><span class="dt">
     </span><span class="dd">Completely case insensitive. Uppercase and lowercase versions of a letter are treated as identical, both when
     creating a file and during subsequent accesses. This is common on older DOS-based systems.
     </span><li><span class="dt">
     </span><span class="dd">Case preserving, but insensitive. When a file or directory is created, the case of its name is stored, and can be
     retrieved and displayed by the operating system. When an existing file is being looked up, its case is ignored.
     This is the standard arrangement on Windows and MacOS. The names <span 
class="pcrr7tn-">foo </span>and <span 
class="pcrr7tn-">FoO </span>identify the same file. This
     treatment of uppercase and lowercase letters as interchangeable is also referred to as <span 
class="ptmri7t-">case folding</span>.
     </span><li><span class="dt">
     </span><span class="dd">Case sensitive. The case of a name is significant at all times. The names <span 
class="pcrr7tn-">foo </span>and FoO identify different files.
     This is the way Linux and Unix systems normally work.</li></ul>
<!--l. 237--><p class="indent">   On Unix-like systems, it is possible to have any or all of the above ways of handling case in action at once. For example, if
you use a USB thumb drive formatted with a FAT32 filesystem on a Linux system, Linux will handle names on that filesystem
in a case preserving, but insensitive, way.
</p><!--l. 243--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.7.1    </span> <a 
 id="x1-1540007.7.1"></a>Safe, portable repository storage</h4>
<!--l. 245--><p class="noindent">Mercurial&#x2019;s repository storage mechanism is <span 
class="ptmri7t-">case safe</span>. It translates file names so that they can be safely stored on both case
sensitive and case insensitive filesystems. This means that you can use normal file copying tools to transfer a Mercurial
repository onto, for example, a USB thumb drive, and safely move that drive and repository back and forth between a Mac, a
PC running Windows, and a Linux box.
                                                                                         
                                                                                         
</p><!--l. 253--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.7.2    </span> <a 
 id="x1-1550007.7.2"></a>Detecting case conflicts</h4>
<!--l. 255--><p class="noindent">When operating in the working directory, Mercurial honours the naming policy of the filesystem where the working directory is
located. If the filesystem is case preserving, but insensitive, Mercurial will treat names that differ only in case as the
same.
</p><!--l. 260--><p class="indent">   An important aspect of this approach is that it is possible to commit a changeset on a case sensitive (typically Linux or
Unix) filesystem that will cause trouble for users on case insensitive (usually Windows and MacOS) users. If a Linux user
commits changes to two files, one named <span 
class="pcrr7tn-">myfile.c </span>and the other named <span 
class="pcrr7tn-">MyFile.C</span>, they will be stored correctly in the
repository. And in the working directories of other Linux users, they will be correctly represented as separate
files.
</p><!--l. 269--><p class="indent">   If a Windows or Mac user pulls this change, they will not initially have a problem, because Mercurial&#x2019;s repository storage
mechanism is case safe. However, once they try to <a 
 id="dx1-155001"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; the working directory to that changeset, or <a 
 id="dx1-155002"></a>&#x201C;<span 
class="pcrr7tn-">hg merge</span>&#x201D; with
that changeset, Mercurial will spot the conflict between the two file names that the filesystem would treat as the same, and
forbid the update or merge from occurring.
</p><!--l. 277--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.7.3    </span> <a 
 id="x1-1560007.7.3"></a>Fixing a case conflict</h4>
<!--l. 279--><p class="noindent">If you are using Windows or a Mac in a mixed environment where some of your collaborators are using Linux or Unix, and
Mercurial reports a case folding conflict when you try to <a 
 id="dx1-156001"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; or <a 
 id="dx1-156002"></a>&#x201C;<span 
class="pcrr7tn-">hg merge</span>&#x201D;, the procedure to fix the problem is
simple.
</p><!--l. 284--><p class="indent">   Just find a nearby Linux or Unix box, clone the problem repository onto it, and use Mercurial&#x2019;s <a 
 id="dx1-156003"></a>&#x201C;<span 
class="pcrr7tn-">hg rename</span>&#x201D; command to
change the names of any offending files or directories so that they will no longer cause case folding conflicts. Commit this
change, <a 
 id="dx1-156004"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; or <a 
 id="dx1-156005"></a>&#x201C;<span 
class="pcrr7tn-">hg push</span>&#x201D; it across to your Windows or MacOS system, and <a 
 id="dx1-156006"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; to the revision with the
non-conflicting names.
</p><!--l. 291--><p class="indent">   The changeset with case-conflicting names will remain in your project&#x2019;s history, and you still won&#x2019;t be able to <a 
 id="dx1-156007"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D;
your working directory to that changeset on a Windows or MacOS system, but you can continue development
unimpeded.
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:  </span>Prior to version 0.9.3, Mercurial did not use a case safe repository storage
mechanism,  and  did  not  detect  case  folding  conflicts.  If  you  are  using  an  older
version  of  Mercurial  on  Windows  or  MacOS,  I  strongly  recommend  that  you
upgrade.                                                                                                                      </div>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;8</span><br /><a 
 id="x1-1570008"></a>Managing releases and branchy development</h2>
<!--l. 4--><p class="noindent">Mercurial provides several mechanisms for you to manage a project that is making progress on multiple fronts at once. To
understand these mechanisms, let&#x2019;s first take a brief look at a fairly normal software project structure.
</p><!--l. 9--><p class="indent">   Many software projects issue periodic &#x201C;major&#x201D; releases that contain substantial new features. In parallel, they may issue
&#x201C;minor&#x201D; releases. These are usually identical to the major releases off which they&#x2019;re based, but with a few bugs
fixed.
</p><!--l. 14--><p class="indent">   In this chapter, we&#x2019;ll start by talking about how to keep records of project milestones such as releases. We&#x2019;ll then continue
on to talk about the flow of work between different phases of a project, and how Mercurial can help you to isolate and manage
this work.
</p>
   <h3 class="sectionHead"><span class="titlemark">8.1    </span> <a 
 id="x1-1580008.1"></a>Giving a persistent name to a revision</h3>
<!--l. 21--><p class="noindent">Once you decide that you&#x2019;d like to call a particular revision a &#x201C;release&#x201D;, it&#x2019;s a good idea to record the identity of that revision.
This will let you reproduce that release at a later date, for whatever purpose you might need at the time (reproducing a bug,
porting to a new platform, etc).
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-158002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;mytag</span>
<br class="fancyvrb" /><a 
 id="x1-158004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;mytag</span>
<br class="fancyvrb" /><a 
 id="x1-158006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;hello</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-158008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Initial</span><span 
class="pcrb7t-">&#x00A0;commit'</span>
<br class="fancyvrb" /><a 
 id="x1-158010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;myfile</span>
   </div>
<!--l. 28--><p class="indent">   Mercurial lets you give a permanent name to any revision using the <a 
 id="dx1-158011"></a>&#x201C;<span 
class="pcrr7tn-">hg tag</span>&#x201D; command. Not surprisingly, these names are
called &#x201C;tags&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-158013r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tag</span><span 
class="pcrb7t-">&#x00A0;v1.0</span>
   </div>
<!--l. 33--><p class="indent">   A tag is nothing more than a &#x201C;symbolic name&#x201D; for a revision. Tags exist purely for your convenience, so that you
have a handy permanent way to refer to a revision; Mercurial doesn&#x2019;t interpret the tag names you use in any
way. Neither does Mercurial place any restrictions on the name of a tag, beyond a few that are necessary to
ensure that a tag can be parsed unambiguously. A tag name cannot contain any of the following characters:
</p>
     <ul><li><span class="dt">
     </span><span class="dd">Colon (ASCII 58, &#x201C;<span 
class="pcrr7tn-">:</span>&#x201D;)
     </span><li><span class="dt">
     </span><span class="dd">Carriage return (ASCII 13, &#x201C;<span class="verb"><span 
class="pcrr7tn-">\r</span></span>&#x201D;)
     </span><li><span class="dt">
     </span><span class="dd">Newline (ASCII 10, &#x201C;<span class="verb"><span 
class="pcrr7tn-">\n</span></span>&#x201D;)</li></ul>
<!--l. 46--><p class="indent">   You can use the <a 
 id="dx1-158014"></a>&#x201C;<span 
class="pcrr7tn-">hg tags</span>&#x201D; command to display the tags present in your repository. In the output, each
tagged revision is identified first by its name, then by revision number, and finally by the unique hash of the
revision.
</p>
   <div class="fancyvrb" id="fancyvrb">
                                                                                         
                                                                                         
<a 
 id="x1-158016r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tags</span>
<br class="fancyvrb" /><a 
 id="x1-158018r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:ac5391ccee61</span>
<br class="fancyvrb" /><a 
 id="x1-158020r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;v1.0</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:99dff2ff8352</span>
   </div>
<!--l. 51--><p class="noindent">Notice that <span 
class="pcrr7tn-">tip </span>is listed in the output of <a 
 id="dx1-158021"></a>&#x201C;<span 
class="pcrr7tn-">hg tags</span>&#x201D;. The <span 
class="pcrr7tn-">tip </span>tag is a special &#x201C;floating&#x201D; tag, which always identifies the newest
revision in the repository.
</p><!--l. 55--><p class="indent">   In the output of the <a 
 id="dx1-158022"></a>&#x201C;<span 
class="pcrr7tn-">hg tags</span>&#x201D; command, tags are listed in reverse order, by revision number. This usually means that
recent tags are listed before older tags. It also means that <span 
class="pcrr7tn-">tip </span>is always going to be the first tag listed in the output of <a 
 id="dx1-158023"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">tags</span>&#x201D;.
</p><!--l. 60--><p class="indent">   When you run <a 
 id="dx1-158024"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D;, if it displays a revision that has tags associated with it, it will print those tags.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-158026r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span>
<br class="fancyvrb" /><a 
 id="x1-158028r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:ac5391ccee61</span>
<br class="fancyvrb" /><a 
 id="x1-158030r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-158032r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-158034r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:25</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-158036r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;v1.0</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;99dff2ff8352</span>
<br class="fancyvrb" /><a 
 id="x1-158038r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158040r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:99dff2ff8352</span>
<br class="fancyvrb" /><a 
 id="x1-158042r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;v1.0</span>
<br class="fancyvrb" /><a 
 id="x1-158044r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-158046r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:25</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-158048r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Initial</span><span 
class="pcrr7tn-">&#x00A0;commit</span>
<br class="fancyvrb" /><a 
 id="x1-158050r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 64--><p class="indent">   Any time you need to provide a revision&#x00A0;ID to a Mercurial command, the command will accept a tag name
in its place. Internally, Mercurial will translate your tag name into the corresponding revision&#x00A0;ID, then use
that.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-158052r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;goodbye</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile2</span>
<br class="fancyvrb" /><a 
 id="x1-158054r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Second</span><span 
class="pcrb7t-">&#x00A0;commit'</span>
<br class="fancyvrb" /><a 
 id="x1-158056r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;myfile2</span>
<br class="fancyvrb" /><a 
 id="x1-158058r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r</span><span 
class="pcrb7t-">&#x00A0;v1.0</span>
<br class="fancyvrb" /><a 
 id="x1-158060r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:99dff2ff8352</span>
<br class="fancyvrb" /><a 
 id="x1-158062r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;v1.0</span>
<br class="fancyvrb" /><a 
 id="x1-158064r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-158066r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:25</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-158068r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Initial</span><span 
class="pcrr7tn-">&#x00A0;commit</span>
<br class="fancyvrb" /><a 
 id="x1-158070r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 70--><p class="indent">   There&#x2019;s no limit on the number of tags you can have in a repository, or on the number of tags that a single revision can have.
As a practical matter, it&#x2019;s not a great idea to have &#x201C;too many&#x201D; (a number which will vary from project to project), simply
because tags are supposed to help you to find revisions. If you have lots of tags, the ease of using them to identify revisions
diminishes rapidly.
</p><!--l. 77--><p class="indent">   For example, if your project has milestones as frequent as every few days, it&#x2019;s perfectly reasonable to tag each one of those.
But if you have a continuous build system that makes sure every revision can be built cleanly, you&#x2019;d be introducing a lot of
noise if you were to tag every clean build. Instead, you could tag failed builds (on the assumption that they&#x2019;re rare!), or simply
not use tags to track buildability.
                                                                                         
                                                                                         
</p><!--l. 85--><p class="indent">   If you want to remove a tag that you no longer want, use <a 
 id="dx1-158071"></a>&#x201C;<span 
class="pcrr7tn-">hg tag --remove</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-158073r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tag</span><span 
class="pcrb7t-">&#x00A0;--remove</span><span 
class="pcrb7t-">&#x00A0;v1.0</span>
<br class="fancyvrb" /><a 
 id="x1-158075r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;option</span><span 
class="pcrr7tn-">&#x00A0;--remove</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;recognized</span>
<br class="fancyvrb" /><a 
 id="x1-158077r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;[-l]</span><span 
class="pcrr7tn-">&#x00A0;[-m</span><span 
class="pcrr7tn-">&#x00A0;TEXT]</span><span 
class="pcrr7tn-">&#x00A0;[-d</span><span 
class="pcrr7tn-">&#x00A0;DATE]</span><span 
class="pcrr7tn-">&#x00A0;[-u</span><span 
class="pcrr7tn-">&#x00A0;USER]</span><span 
class="pcrr7tn-">&#x00A0;[-r</span><span 
class="pcrr7tn-">&#x00A0;REV]</span><span 
class="pcrr7tn-">&#x00A0;NAME</span>
<br class="fancyvrb" /><a 
 id="x1-158079r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158081r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;add</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;current</span><span 
class="pcrr7tn-">&#x00A0;or</span><span 
class="pcrr7tn-">&#x00A0;given</span><span 
class="pcrr7tn-">&#x00A0;revision</span>
<br class="fancyvrb" /><a 
 id="x1-158083r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158085r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Name</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;particular</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;using</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;name&#x003e;.</span>
<br class="fancyvrb" /><a 
 id="x1-158087r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158089r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tags</span><span 
class="pcrr7tn-">&#x00A0;are</span><span 
class="pcrr7tn-">&#x00A0;used</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;particular</span><span 
class="pcrr7tn-">&#x00A0;revisions</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;repository</span><span 
class="pcrr7tn-">&#x00A0;and</span><span 
class="pcrr7tn-">&#x00A0;are</span>
<br class="fancyvrb" /><a 
 id="x1-158091r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;very</span><span 
class="pcrr7tn-">&#x00A0;useful</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;compare</span><span 
class="pcrr7tn-">&#x00A0;different</span><span 
class="pcrr7tn-">&#x00A0;revision,</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;go</span><span 
class="pcrr7tn-">&#x00A0;back</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;significant</span>
<br class="fancyvrb" /><a 
 id="x1-158093r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;earlier</span><span 
class="pcrr7tn-">&#x00A0;versions</span><span 
class="pcrr7tn-">&#x00A0;or</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;mark</span><span 
class="pcrr7tn-">&#x00A0;branch</span><span 
class="pcrr7tn-">&#x00A0;points</span><span 
class="pcrr7tn-">&#x00A0;as</span><span 
class="pcrr7tn-">&#x00A0;releases,</span><span 
class="pcrr7tn-">&#x00A0;etc.</span>
<br class="fancyvrb" /><a 
 id="x1-158095r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158097r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;If</span><span 
class="pcrr7tn-">&#x00A0;no</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;given,</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;parent</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;working</span><span 
class="pcrr7tn-">&#x00A0;directory</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;used,</span>
<br class="fancyvrb" /><a 
 id="x1-158099r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;or</span><span 
class="pcrr7tn-">&#x00A0;tip</span><span 
class="pcrr7tn-">&#x00A0;if</span><span 
class="pcrr7tn-">&#x00A0;no</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;checked</span><span 
class="pcrr7tn-">&#x00A0;out.</span>
<br class="fancyvrb" /><a 
 id="x1-158101r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158103r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;To</span><span 
class="pcrr7tn-">&#x00A0;facilitate</span><span 
class="pcrr7tn-">&#x00A0;version</span><span 
class="pcrr7tn-">&#x00A0;control,</span><span 
class="pcrr7tn-">&#x00A0;distribution,</span><span 
class="pcrr7tn-">&#x00A0;and</span><span 
class="pcrr7tn-">&#x00A0;merging</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;tags,</span>
<br class="fancyvrb" /><a 
 id="x1-158105r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;they</span><span 
class="pcrr7tn-">&#x00A0;are</span><span 
class="pcrr7tn-">&#x00A0;stored</span><span 
class="pcrr7tn-">&#x00A0;as</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;named</span><span 
class="pcrr7tn-">&#x00A0;".hgtags"</span><span 
class="pcrr7tn-">&#x00A0;which</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;managed</span>
<br class="fancyvrb" /><a 
 id="x1-158107r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;similarly</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;other</span><span 
class="pcrr7tn-">&#x00A0;project</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;and</span><span 
class="pcrr7tn-">&#x00A0;can</span><span 
class="pcrr7tn-">&#x00A0;be</span><span 
class="pcrr7tn-">&#x00A0;hand-edited</span><span 
class="pcrr7tn-">&#x00A0;if</span>
<br class="fancyvrb" /><a 
 id="x1-158109r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;necessary.</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;The</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;'.hg/localtags'</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;used</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;local</span><span 
class="pcrr7tn-">&#x00A0;tags</span><span 
class="pcrr7tn-">&#x00A0;(not</span>
<br class="fancyvrb" /><a 
 id="x1-158111r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;shared</span><span 
class="pcrr7tn-">&#x00A0;among</span><span 
class="pcrr7tn-">&#x00A0;repositories).</span>
<br class="fancyvrb" /><a 
 id="x1-158113r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158115r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;options:</span>
<br class="fancyvrb" /><a 
 id="x1-158117r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158119r24"></a><span 
class="ptmr7t-x-x-50">24</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-l</span><span 
class="pcrr7tn-">&#x00A0;--local</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;make</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;local</span>
<br class="fancyvrb" /><a 
 id="x1-158121r25"></a><span 
class="ptmr7t-x-x-50">25</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-m</span><span 
class="pcrr7tn-">&#x00A0;--message</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;message</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;commit</span><span 
class="pcrr7tn-">&#x00A0;log</span><span 
class="pcrr7tn-">&#x00A0;entry</span>
<br class="fancyvrb" /><a 
 id="x1-158123r26"></a><span 
class="ptmr7t-x-x-50">26</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-d</span><span 
class="pcrr7tn-">&#x00A0;--date</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;record</span><span 
class="pcrr7tn-">&#x00A0;datecode</span><span 
class="pcrr7tn-">&#x00A0;as</span><span 
class="pcrr7tn-">&#x00A0;commit</span><span 
class="pcrr7tn-">&#x00A0;date</span>
<br class="fancyvrb" /><a 
 id="x1-158125r27"></a><span 
class="ptmr7t-x-x-50">27</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-u</span><span 
class="pcrr7tn-">&#x00A0;--user</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;record</span><span 
class="pcrr7tn-">&#x00A0;user</span><span 
class="pcrr7tn-">&#x00A0;as</span><span 
class="pcrr7tn-">&#x00A0;commiter</span>
<br class="fancyvrb" /><a 
 id="x1-158127r28"></a><span 
class="ptmr7t-x-x-50">28</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;--rev</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;tag</span>
<br class="fancyvrb" /><a 
 id="x1-158129r29"></a><span 
class="ptmr7t-x-x-50">29</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tags</span>
<br class="fancyvrb" /><a 
 id="x1-158131r30"></a><span 
class="ptmr7t-x-x-50">30</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:6cb26d190ff4</span>
<br class="fancyvrb" /><a 
 id="x1-158133r31"></a><span 
class="ptmr7t-x-x-50">31</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;v1.0</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:99dff2ff8352</span>
   </div>
<!--l. 88--><p class="noindent">You can also modify a tag at any time, so that it identifies a different revision, by simply issuing a new <a 
 id="dx1-158134"></a>&#x201C;<span 
class="pcrr7tn-">hg tag</span>&#x201D; command. You&#x2019;ll
have to use the <a 
 id="dx1-158135"></a><span 
class="pcrr7tn-">-f </span>option to tell Mercurial that you <span 
class="ptmri7t-">really </span>want to update the tag.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-158137r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tag</span><span 
class="pcrb7t-">&#x00A0;-r</span><span 
class="pcrb7t-">&#x00A0;1</span><span 
class="pcrb7t-">&#x00A0;v1.1</span>
<br class="fancyvrb" /><a 
 id="x1-158139r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tags</span>
<br class="fancyvrb" /><a 
 id="x1-158141r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3:a97377f688af</span>
<br class="fancyvrb" /><a 
 id="x1-158143r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;v1.1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:ac5391ccee61</span>
<br class="fancyvrb" /><a 
 id="x1-158145r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;v1.0</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:99dff2ff8352</span>
<br class="fancyvrb" /><a 
 id="x1-158147r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tag</span><span 
class="pcrb7t-">&#x00A0;-r</span><span 
class="pcrb7t-">&#x00A0;2</span><span 
class="pcrb7t-">&#x00A0;v1.1</span>
<br class="fancyvrb" /><a 
 id="x1-158149r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tag</span><span 
class="pcrb7t-">&#x00A0;-f</span><span 
class="pcrb7t-">&#x00A0;-r</span><span 
class="pcrb7t-">&#x00A0;2</span><span 
class="pcrb7t-">&#x00A0;v1.1</span>
<br class="fancyvrb" /><a 
 id="x1-158151r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;option</span><span 
class="pcrr7tn-">&#x00A0;-f</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;recognized</span>
<br class="fancyvrb" /><a 
 id="x1-158153r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;[-l]</span><span 
class="pcrr7tn-">&#x00A0;[-m</span><span 
class="pcrr7tn-">&#x00A0;TEXT]</span><span 
class="pcrr7tn-">&#x00A0;[-d</span><span 
class="pcrr7tn-">&#x00A0;DATE]</span><span 
class="pcrr7tn-">&#x00A0;[-u</span><span 
class="pcrr7tn-">&#x00A0;USER]</span><span 
class="pcrr7tn-">&#x00A0;[-r</span><span 
class="pcrr7tn-">&#x00A0;REV]</span><span 
class="pcrr7tn-">&#x00A0;NAME</span>
<br class="fancyvrb" /><a 
 id="x1-158155r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158157r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;add</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;current</span><span 
class="pcrr7tn-">&#x00A0;or</span><span 
class="pcrr7tn-">&#x00A0;given</span><span 
class="pcrr7tn-">&#x00A0;revision</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-158159r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158161r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Name</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;particular</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;using</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;name&#x003e;.</span>
<br class="fancyvrb" /><a 
 id="x1-158163r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158165r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Tags</span><span 
class="pcrr7tn-">&#x00A0;are</span><span 
class="pcrr7tn-">&#x00A0;used</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;particular</span><span 
class="pcrr7tn-">&#x00A0;revisions</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;repository</span><span 
class="pcrr7tn-">&#x00A0;and</span><span 
class="pcrr7tn-">&#x00A0;are</span>
<br class="fancyvrb" /><a 
 id="x1-158167r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;very</span><span 
class="pcrr7tn-">&#x00A0;useful</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;compare</span><span 
class="pcrr7tn-">&#x00A0;different</span><span 
class="pcrr7tn-">&#x00A0;revision,</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;go</span><span 
class="pcrr7tn-">&#x00A0;back</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;significant</span>
<br class="fancyvrb" /><a 
 id="x1-158169r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;earlier</span><span 
class="pcrr7tn-">&#x00A0;versions</span><span 
class="pcrr7tn-">&#x00A0;or</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;mark</span><span 
class="pcrr7tn-">&#x00A0;branch</span><span 
class="pcrr7tn-">&#x00A0;points</span><span 
class="pcrr7tn-">&#x00A0;as</span><span 
class="pcrr7tn-">&#x00A0;releases,</span><span 
class="pcrr7tn-">&#x00A0;etc.</span>
<br class="fancyvrb" /><a 
 id="x1-158171r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158173r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;If</span><span 
class="pcrr7tn-">&#x00A0;no</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;given,</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;parent</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;working</span><span 
class="pcrr7tn-">&#x00A0;directory</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;used,</span>
<br class="fancyvrb" /><a 
 id="x1-158175r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;or</span><span 
class="pcrr7tn-">&#x00A0;tip</span><span 
class="pcrr7tn-">&#x00A0;if</span><span 
class="pcrr7tn-">&#x00A0;no</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;checked</span><span 
class="pcrr7tn-">&#x00A0;out.</span>
<br class="fancyvrb" /><a 
 id="x1-158177r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158179r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;To</span><span 
class="pcrr7tn-">&#x00A0;facilitate</span><span 
class="pcrr7tn-">&#x00A0;version</span><span 
class="pcrr7tn-">&#x00A0;control,</span><span 
class="pcrr7tn-">&#x00A0;distribution,</span><span 
class="pcrr7tn-">&#x00A0;and</span><span 
class="pcrr7tn-">&#x00A0;merging</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;tags,</span>
<br class="fancyvrb" /><a 
 id="x1-158181r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;they</span><span 
class="pcrr7tn-">&#x00A0;are</span><span 
class="pcrr7tn-">&#x00A0;stored</span><span 
class="pcrr7tn-">&#x00A0;as</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;named</span><span 
class="pcrr7tn-">&#x00A0;".hgtags"</span><span 
class="pcrr7tn-">&#x00A0;which</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;managed</span>
<br class="fancyvrb" /><a 
 id="x1-158183r24"></a><span 
class="ptmr7t-x-x-50">24</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;similarly</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;other</span><span 
class="pcrr7tn-">&#x00A0;project</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;and</span><span 
class="pcrr7tn-">&#x00A0;can</span><span 
class="pcrr7tn-">&#x00A0;be</span><span 
class="pcrr7tn-">&#x00A0;hand-edited</span><span 
class="pcrr7tn-">&#x00A0;if</span>
<br class="fancyvrb" /><a 
 id="x1-158185r25"></a><span 
class="ptmr7t-x-x-50">25</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;necessary.</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;The</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;'.hg/localtags'</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;used</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;local</span><span 
class="pcrr7tn-">&#x00A0;tags</span><span 
class="pcrr7tn-">&#x00A0;(not</span>
<br class="fancyvrb" /><a 
 id="x1-158187r26"></a><span 
class="ptmr7t-x-x-50">26</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;shared</span><span 
class="pcrr7tn-">&#x00A0;among</span><span 
class="pcrr7tn-">&#x00A0;repositories).</span>
<br class="fancyvrb" /><a 
 id="x1-158189r27"></a><span 
class="ptmr7t-x-x-50">27</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158191r28"></a><span 
class="ptmr7t-x-x-50">28</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;options:</span>
<br class="fancyvrb" /><a 
 id="x1-158193r29"></a><span 
class="ptmr7t-x-x-50">29</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-158195r30"></a><span 
class="ptmr7t-x-x-50">30</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-l</span><span 
class="pcrr7tn-">&#x00A0;--local</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;make</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;local</span>
<br class="fancyvrb" /><a 
 id="x1-158197r31"></a><span 
class="ptmr7t-x-x-50">31</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-m</span><span 
class="pcrr7tn-">&#x00A0;--message</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;message</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;commit</span><span 
class="pcrr7tn-">&#x00A0;log</span><span 
class="pcrr7tn-">&#x00A0;entry</span>
<br class="fancyvrb" /><a 
 id="x1-158199r32"></a><span 
class="ptmr7t-x-x-50">32</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-d</span><span 
class="pcrr7tn-">&#x00A0;--date</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;record</span><span 
class="pcrr7tn-">&#x00A0;datecode</span><span 
class="pcrr7tn-">&#x00A0;as</span><span 
class="pcrr7tn-">&#x00A0;commit</span><span 
class="pcrr7tn-">&#x00A0;date</span>
<br class="fancyvrb" /><a 
 id="x1-158201r33"></a><span 
class="ptmr7t-x-x-50">33</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-u</span><span 
class="pcrr7tn-">&#x00A0;--user</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;record</span><span 
class="pcrr7tn-">&#x00A0;user</span><span 
class="pcrr7tn-">&#x00A0;as</span><span 
class="pcrr7tn-">&#x00A0;commiter</span>
<br class="fancyvrb" /><a 
 id="x1-158203r34"></a><span 
class="ptmr7t-x-x-50">34</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;--rev</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;tag</span>
<br class="fancyvrb" /><a 
 id="x1-158205r35"></a><span 
class="ptmr7t-x-x-50">35</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tags</span>
<br class="fancyvrb" /><a 
 id="x1-158207r36"></a><span 
class="ptmr7t-x-x-50">36</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;4:4b816cca5e88</span>
<br class="fancyvrb" /><a 
 id="x1-158209r37"></a><span 
class="ptmr7t-x-x-50">37</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;v1.1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:6cb26d190ff4</span>
<br class="fancyvrb" /><a 
 id="x1-158211r38"></a><span 
class="ptmr7t-x-x-50">38</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;v1.0</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:99dff2ff8352</span>
   </div>
<!--l. 93--><p class="noindent">There will still be a permanent record of the previous identity of the tag, but Mercurial will no longer use it. There&#x2019;s thus no penalty
to tagging the wrong revision; all you have to do is turn around and tag the correct revision once you discover your
error.
</p><!--l. 98--><p class="indent">   Mercurial stores tags in a normal revision-controlled file in your repository. If you&#x2019;ve created any tags, you&#x2019;ll find them in a
file named <a 
 id="dx1-158212"></a><span 
class="pcrr7tn-">.hgtags</span>. When you run the <a 
 id="dx1-158213"></a>&#x201C;<span 
class="pcrr7tn-">hg tag</span>&#x201D; command, Mercurial modifies this file, then automatically commits the
change to it. This means that every time you run <a 
 id="dx1-158214"></a>&#x201C;<span 
class="pcrr7tn-">hg tag</span>&#x201D;, you&#x2019;ll see a corresponding changeset in the output of <a 
 id="dx1-158215"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">log</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-158217r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-158219r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;4:4b816cca5e88</span>
<br class="fancyvrb" /><a 
 id="x1-158221r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-158223r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-158225r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:25</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-158227r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;v1.1</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;6cb26d190ff4</span>
<br class="fancyvrb" /><a 
 id="x1-158229r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 106--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.1.1    </span> <a 
 id="x1-1590008.1.1"></a>Handling tag conflicts during a merge</h4>
                                                                                         
                                                                                         
<!--l. 108--><p class="noindent">You won&#x2019;t often need to care about the <a 
 id="dx1-159001"></a><span 
class="pcrr7tn-">.hgtags </span>file, but it sometimes makes its presence known during a merge. The format of
the file is simple: it consists of a series of lines. Each line starts with a changeset hash, followed by a space, followed by the
name of a tag.
</p><!--l. 114--><p class="indent">   If you&#x2019;re resolving a conflict in the <a 
 id="dx1-159002"></a><span 
class="pcrr7tn-">.hgtags </span>file during a merge, there&#x2019;s one twist to modifying the <a 
 id="dx1-159003"></a><span 
class="pcrr7tn-">.hgtags </span>file: when
Mercurial is parsing the tags in a repository, it <span 
class="ptmri7t-">never </span>reads the working copy of the <a 
 id="dx1-159004"></a><span 
class="pcrr7tn-">.hgtags </span>file. Instead, it reads the <span 
class="ptmri7t-">most</span>
<span 
class="ptmri7t-">recently committed </span>revision of the file.
</p><!--l. 120--><p class="indent">   An unfortunate consequence of this design is that you can&#x2019;t actually verify that your merged <a 
 id="dx1-159005"></a><span 
class="pcrr7tn-">.hgtags </span>file is correct until
<span 
class="ptmri7t-">after </span>you&#x2019;ve committed a change. So if you find yourself resolving a conflict on <a 
 id="dx1-159006"></a><span 
class="pcrr7tn-">.hgtags </span>during a merge, be sure
to run <a 
 id="dx1-159007"></a>&#x201C;<span 
class="pcrr7tn-">hg tags</span>&#x201D; after you commit. If it finds an error in the <a 
 id="dx1-159008"></a><span 
class="pcrr7tn-">.hgtags </span>file, it will report the location of the
error, which you can then fix and commit. You should then run <a 
 id="dx1-159009"></a>&#x201C;<span 
class="pcrr7tn-">hg tags</span>&#x201D; again, just to be sure that your fix is
correct.
</p><!--l. 129--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.1.2    </span> <a 
 id="x1-1600008.1.2"></a>Tags and cloning</h4>
<!--l. 131--><p class="noindent">You may have noticed that the <a 
 id="dx1-160001"></a>&#x201C;<span 
class="pcrr7tn-">hg clone</span>&#x201D; command has a <a 
 id="dx1-160002"></a><span 
class="pcrr7tn-">-r </span>option that lets you clone an exact copy of the repository as of a
particular changeset. The new clone will not contain any project history that comes after the revision you specified. This has an
interaction with tags that can surprise the unwary.
</p><!--l. 138--><p class="indent">   Recall that a tag is stored as a revision to the <a 
 id="dx1-160003"></a><span 
class="pcrr7tn-">.hgtags </span>file, so that when you create a tag, the changeset in which it&#x2019;s
recorded necessarily refers to an older changeset. When you run <a 
 id="dx1-160004"></a>&#x201C;<span 
class="pcrr7tn-">hg clone -r foo</span>&#x201D; to clone a repository as of tag <span 
class="pcrr7tn-">foo</span>, the
new clone <span 
class="ptmri7t-">will not contain the history that created the tag </span>that you used to clone the repository. The result is that
you&#x2019;ll get exactly the right subset of the project&#x2019;s history in the new repository, but <span 
class="ptmri7t-">not </span>the tag you might have
expected.
</p><!--l. 147--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.1.3    </span> <a 
 id="x1-1610008.1.3"></a>When permanent tags are too much</h4>
<!--l. 149--><p class="noindent">Since Mercurial&#x2019;s tags are revision controlled and carried around with a project&#x2019;s history, everyone you work with will see the
tags you create. But giving names to revisions has uses beyond simply noting that revision <span 
class="pcrr7tn-">4237e45506ee </span>is really <span 
class="pcrr7tn-">v2.0.2</span>. If
you&#x2019;re trying to track down a subtle bug, you might want a tag to remind you of something like &#x201C;Anne saw the symptoms with
this revision&#x201D;.
</p><!--l. 157--><p class="indent">   For cases like this, what you might want to use are <span 
class="ptmri7t-">local </span>tags. You can create a local tag with the <a 
 id="dx1-161001"></a><span 
class="pcrr7tn-">-l </span>option to the <a 
 id="dx1-161002"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">tag</span>&#x201D; command. This will store the tag in a file called <a 
 id="dx1-161003"></a><span 
class="pcrr7tn-">.hg/localtags</span>. Unlike <a 
 id="dx1-161004"></a><span 
class="pcrr7tn-">.hgtags</span>, <a 
 id="dx1-161005"></a><span 
class="pcrr7tn-">.hg/localtags </span>is not
revision controlled. Any tags you create using <a 
 id="dx1-161006"></a><span 
class="pcrr7tn-">-l </span>remain strictly local to the repository you&#x2019;re currently working
in.
</p><!--l. 165--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">8.2    </span> <a 
 id="x1-1620008.2"></a>The flow of changes&#x2014;big picture vs. little</h3>
<!--l. 167--><p class="noindent">To return to the outline I sketched at the beginning of a chapter, let&#x2019;s think about a project that has multiple concurrent pieces of
work under development at once.
</p><!--l. 171--><p class="indent">   There might be a push for a new &#x201C;main&#x201D; release; a new minor bugfix release to the last main release; and an unexpected
&#x201C;hot fix&#x201D; to an old release that is now in maintenance mode.
</p><!--l. 175--><p class="indent">   The usual way people refer to these different concurrent directions of development is as &#x201C;branches&#x201D;. However, we&#x2019;ve
already seen numerous times that Mercurial treats <span 
class="ptmri7t-">all of history </span>as a series of branches and merges. Really, what we have here is
two ideas that are peripherally related, but which happen to share a name. </p>
                                                                                         
                                                                                         
     <ul><li><span class="dt">
     </span><span class="dd">&#x201C;Big picture&#x201D; branches represent the sweep of a project&#x2019;s evolution; people give them names, and talk about
     them in conversation.
     </span><li><span class="dt">
     </span><span class="dd">&#x201C;Little picture&#x201D; branches are artefacts of the day-to-day activity of developing and merging changes. They expose
     the narrative of how the code was developed.</li></ul>
<!--l. 189--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">8.3    </span> <a 
 id="x1-1630008.3"></a>Managing big-picture branches in repositories</h3>
<!--l. 191--><p class="noindent">The easiest way to isolate a &#x201C;big picture&#x201D; branch in Mercurial is in a dedicated repository. If you have an existing shared
repository&#x2014;let&#x2019;s call it <span 
class="pcrr7tn-">myproject</span>&#x2014;that reaches a &#x201C;1.0&#x201D; milestone, you can start to prepare for future maintenance releases on
top of version&#x00A0;1.0 by tagging the revision from which you prepared the&#x00A0;1.0 release.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-163002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;myproject</span>
<br class="fancyvrb" /><a 
 id="x1-163004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tag</span><span 
class="pcrb7t-">&#x00A0;v1.0</span>
   </div>
<!--l. 198--><p class="noindent">You can then clone a new shared <span 
class="pcrr7tn-">myproject-1.0.1 </span>repository as of that tag.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-163006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-163008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;myproject</span><span 
class="pcrb7t-">&#x00A0;myproject-1.0.1</span>
<br class="fancyvrb" /><a 
 id="x1-163010r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
   </div>
<!--l. 202--><p class="indent">   Afterwards, if someone needs to work on a bug fix that ought to go into an upcoming&#x00A0;1.0.1 minor release, they clone the
<span 
class="pcrr7tn-">myproject-1.0.1 </span>repository, make their changes, and push them back.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-163012r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;myproject-1.0.1</span><span 
class="pcrb7t-">&#x00A0;my-1.0.1-bugfix</span>
<br class="fancyvrb" /><a 
 id="x1-163014r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-163016r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;my-1.0.1-bugfix</span>
<br class="fancyvrb" /><a 
 id="x1-163018r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'I</span><span 
class="pcrb7t-">&#x00A0;fixed</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;bug</span><span 
class="pcrb7t-">&#x00A0;using</span><span 
class="pcrb7t-">&#x00A0;only</span><span 
class="pcrb7t-">&#x00A0;echo!'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-163020r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Important</span><span 
class="pcrb7t-">&#x00A0;fix</span><span 
class="pcrb7t-">&#x00A0;for</span><span 
class="pcrb7t-">&#x00A0;1.0.1'</span>
<br class="fancyvrb" /><a 
 id="x1-163022r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;push</span>
<br class="fancyvrb" /><a 
 id="x1-163024r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pushing</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;/tmp/branch-repovw4xvI/myproject-1.0.1</span>
<br class="fancyvrb" /><a 
 id="x1-163026r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-163028r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-163030r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-163032r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-163034r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span>
   </div>
<!--l. 207--><p class="noindent">Meanwhile, development for the next major release can continue, isolated and unabated, in the <span 
class="pcrr7tn-">myproject </span>repository.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-163036r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-163038r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;myproject</span><span 
class="pcrb7t-">&#x00A0;my-feature</span>
<br class="fancyvrb" /><a 
 id="x1-163040r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-163042r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;my-feature</span>
<br class="fancyvrb" /><a 
 id="x1-163044r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'This</span><span 
class="pcrb7t-">&#x00A0;sure</span><span 
class="pcrb7t-">&#x00A0;is</span><span 
class="pcrb7t-">&#x00A0;an</span><span 
class="pcrb7t-">&#x00A0;exciting</span><span 
class="pcrb7t-">&#x00A0;new</span><span 
class="pcrb7t-">&#x00A0;feature!'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;mynewfile</span>
<br class="fancyvrb" /><a 
 id="x1-163046r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'New</span><span 
class="pcrb7t-">&#x00A0;feature'</span>
<br class="fancyvrb" /><a 
 id="x1-163048r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;mynewfile</span>
<br class="fancyvrb" /><a 
 id="x1-163050r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;push</span>
<br class="fancyvrb" /><a 
 id="x1-163052r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pushing</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;/tmp/branch-repovw4xvI/myproject</span>
<br class="fancyvrb" /><a 
 id="x1-163054r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-163056r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-163058r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-163060r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-163062r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span>
   </div>
<!--l. 211--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">8.4    </span> <a 
 id="x1-1640008.4"></a>Don&#x2019;t repeat yourself: merging across branches</h3>
<!--l. 213--><p class="noindent">In many cases, if you have a bug to fix on a maintenance branch, the chances are good that the bug exists on your project&#x2019;s main
branch (and possibly other maintenance branches, too). It&#x2019;s a rare developer who wants to fix the same bug multiple
times, so let&#x2019;s look at a few ways that Mercurial can help you to manage these bugfixes without duplicating your
work.
</p><!--l. 220--><p class="indent">   In the simplest instance, all you need to do is pull changes from your maintenance branch into your local clone of the target
branch.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-164002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-164004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;myproject</span><span 
class="pcrb7t-">&#x00A0;myproject-merge</span>
<br class="fancyvrb" /><a 
 id="x1-164006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-164008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;myproject-merge</span>
<br class="fancyvrb" /><a 
 id="x1-164010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;pull</span><span 
class="pcrb7t-">&#x00A0;../myproject-1.0.1</span>
<br class="fancyvrb" /><a 
 id="x1-164012r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pulling</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;../myproject-1.0.1</span>
<br class="fancyvrb" /><a 
 id="x1-164014r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-164016r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-164018r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-164020r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-164022r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;(+1</span><span 
class="pcrr7tn-">&#x00A0;heads)</span>
<br class="fancyvrb" /><a 
 id="x1-164024r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(run</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;heads'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;heads,</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;merge'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;merge)</span>
   </div>
<!--l. 223--><p class="noindent">You&#x2019;ll then need to merge the heads of the two branches, and push back to the main branch.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-164026r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;merge</span>
<br class="fancyvrb" /><a 
 id="x1-164028r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-164030r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(branch</span><span 
class="pcrr7tn-">&#x00A0;merge,</span><span 
class="pcrr7tn-">&#x00A0;don't</span><span 
class="pcrr7tn-">&#x00A0;forget</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;commit)</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-164032r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Merge</span><span 
class="pcrb7t-">&#x00A0;bugfix</span><span 
class="pcrb7t-">&#x00A0;from</span><span 
class="pcrb7t-">&#x00A0;1.0.1</span><span 
class="pcrb7t-">&#x00A0;branch'</span>
<br class="fancyvrb" /><a 
 id="x1-164034r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;push</span>
<br class="fancyvrb" /><a 
 id="x1-164036r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pushing</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;/tmp/branch-repovw4xvI/myproject</span>
<br class="fancyvrb" /><a 
 id="x1-164038r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-164040r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-164042r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-164044r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-164046r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span>
   </div>
<!--l. 227--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">8.5    </span> <a 
 id="x1-1650008.5"></a>Naming branches within one repository</h3>
<!--l. 229--><p class="noindent">In most instances, isolating branches in repositories is the right approach. Its simplicity makes it easy to understand; and so it&#x2019;s
hard to make mistakes. There&#x2019;s a one-to-one relationship between branches you&#x2019;re working in and directories on your system.
This lets you use normal (non-Mercurial-aware) tools to work on files within a branch/repository.
</p><!--l. 236--><p class="indent">   If you&#x2019;re more in the &#x201C;power user&#x201D; category (<span 
class="ptmri7t-">and </span>your collaborators are too), there is an alternative way of handling
branches that you can consider. I&#x2019;ve already mentioned the human-level distinction between &#x201C;small picture&#x201D; and &#x201C;big
picture&#x201D; branches. While Mercurial works with multiple &#x201C;small picture&#x201D; branches in a repository all the time (for
example after you pull changes in, but before you merge them), it can <span 
class="ptmri7t-">also </span>work with multiple &#x201C;big picture&#x201D;
branches.
</p><!--l. 245--><p class="indent">   The key to working this way is that Mercurial lets you assign a persistent <span 
class="ptmri7t-">name </span>to a branch. There always exists a branch
named <span 
class="pcrr7tn-">default</span>. Even before you start naming branches yourself, you can find traces of the <span 
class="pcrr7tn-">default </span>branch if you look for
them.
</p><!--l. 251--><p class="indent">   As an example, when you run the <a 
 id="dx1-165001"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; command, and it pops up your editor so that you can enter a commit
message, look for a line that contains the text &#x201C;<span 
class="pcrr7tn-">HG: branch default</span>&#x201D; at the bottom. This is telling you that your commit will
occur on the branch named <span 
class="pcrr7tn-">default</span>.
</p><!--l. 257--><p class="indent">   To start working with named branches, use the <a 
 id="dx1-165002"></a>&#x201C;<span 
class="pcrr7tn-">hg branches</span>&#x201D; command. This command lists the named branches already
present in your repository, telling you which changeset is the tip of each.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-165004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-165006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:c0dbbe44f4df</span>
<br class="fancyvrb" /><a 
 id="x1-165008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-165010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-165012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:09</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-165014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Initial</span><span 
class="pcrr7tn-">&#x00A0;commit</span>
<br class="fancyvrb" /><a 
 id="x1-165016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-165018r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;branches</span>
   </div>
<!--l. 261--><p class="noindent">Since you haven&#x2019;t created any named branches yet, the only one that exists is <span 
class="pcrr7tn-">default</span>.
</p><!--l. 264--><p class="indent">   To find out what the &#x201C;current&#x201D; branch is, run the <a 
 id="dx1-165019"></a>&#x201C;<span 
class="pcrr7tn-">hg branch</span>&#x201D; command, giving it no arguments. This tells you what branch
the parent of the current changeset is on.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-165021r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;branch</span>
   </div>
                                                                                         
                                                                                         
<!--l. 269--><p class="indent">   To create a new branch, run the <a 
 id="dx1-165022"></a>&#x201C;<span 
class="pcrr7tn-">hg branch</span>&#x201D; command again. This time, give it one argument: the name of the branch you
want to create.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-165024r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;branch</span><span 
class="pcrb7t-">&#x00A0;foo</span>
<br class="fancyvrb" /><a 
 id="x1-165026r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;branch</span>
<br class="fancyvrb" /><a 
 id="x1-165028r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;foo</span>
   </div>
<!--l. 273--><p class="indent">   After you&#x2019;ve created a branch, you might wonder what effect the <a 
 id="dx1-165029"></a>&#x201C;<span 
class="pcrr7tn-">hg branch</span>&#x201D; command has had. What do the <a 
 id="dx1-165030"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">status</span>&#x201D; and <a 
 id="dx1-165031"></a>&#x201C;<span 
class="pcrr7tn-">hg tip</span>&#x201D; commands report?
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-165033r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-165035r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-165037r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:c0dbbe44f4df</span>
<br class="fancyvrb" /><a 
 id="x1-165039r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-165041r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-165043r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:09</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-165045r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Initial</span><span 
class="pcrr7tn-">&#x00A0;commit</span>
<br class="fancyvrb" /><a 
 id="x1-165047r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 277--><p class="noindent">Nothing has changed in the working directory, and there&#x2019;s been no new history created. As this suggests, running the <a 
 id="dx1-165048"></a>&#x201C;<span 
class="pcrr7tn-">hg branch</span>&#x201D;
command has no permanent effect; it only tells Mercurial what branch name to use the <span 
class="ptmri7t-">next </span>time you commit a
changeset.
</p><!--l. 282--><p class="indent">   When you commit a change, Mercurial records the name of the branch on which you committed. Once you&#x2019;ve switched
from the <span 
class="pcrr7tn-">default </span>branch to another and committed, you&#x2019;ll see the name of the new branch show up in the output of <a 
 id="dx1-165049"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D;,
<a 
 id="dx1-165050"></a>&#x201C;<span 
class="pcrr7tn-">hg tip</span>&#x201D;, and other commands that display the same kind of output.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-165052r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'hello</span><span 
class="pcrb7t-">&#x00A0;again'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-165054r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Second</span><span 
class="pcrb7t-">&#x00A0;commit'</span>
<br class="fancyvrb" /><a 
 id="x1-165056r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-165058r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:9875a5492f0d</span>
<br class="fancyvrb" /><a 
 id="x1-165060r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;branch:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;foo</span>
<br class="fancyvrb" /><a 
 id="x1-165062r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-165064r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-165066r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:09</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-165068r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Second</span><span 
class="pcrr7tn-">&#x00A0;commit</span>
<br class="fancyvrb" /><a 
 id="x1-165070r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 288--><p class="noindent">The <a 
 id="dx1-165071"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D;-like commands will print the branch name of every changeset that&#x2019;s not on the <span 
class="pcrr7tn-">default </span>branch. As a result, if you
never use named branches, you&#x2019;ll never see this information.
</p><!--l. 292--><p class="indent">   Once you&#x2019;ve named a branch and committed a change with that name, every subsequent commit that descends from that
change will inherit the same branch name. You can change the name of a branch at any time, using the <a 
 id="dx1-165072"></a>&#x201C;<span 
class="pcrr7tn-">hg branch</span>&#x201D;
command.
</p>
   <div class="fancyvrb" id="fancyvrb">
                                                                                         
                                                                                         
<a 
 id="x1-165074r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;branch</span>
<br class="fancyvrb" /><a 
 id="x1-165076r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;foo</span>
<br class="fancyvrb" /><a 
 id="x1-165078r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;branch</span><span 
class="pcrb7t-">&#x00A0;bar</span>
<br class="fancyvrb" /><a 
 id="x1-165080r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;new</span><span 
class="pcrb7t-">&#x00A0;file</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;newfile</span>
<br class="fancyvrb" /><a 
 id="x1-165082r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Third</span><span 
class="pcrb7t-">&#x00A0;commit'</span>
<br class="fancyvrb" /><a 
 id="x1-165084r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;newfile</span>
<br class="fancyvrb" /><a 
 id="x1-165086r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-165088r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:d85d944d98e5</span>
<br class="fancyvrb" /><a 
 id="x1-165090r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;branch:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bar</span>
<br class="fancyvrb" /><a 
 id="x1-165092r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-165094r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-165096r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:09</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-165098r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Third</span><span 
class="pcrr7tn-">&#x00A0;commit</span>
<br class="fancyvrb" /><a 
 id="x1-165100r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 297--><p class="noindent">In practice, this is something you won&#x2019;t do very often, as branch names tend to have fairly long lifetimes. (This isn&#x2019;t a rule, just an
observation.)
</p><!--l. 301--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">8.6    </span> <a 
 id="x1-1660008.6"></a>Dealing with multiple named branches in a repository</h3>
<!--l. 303--><p class="noindent">If you have more than one named branch in a repository, Mercurial will remember the branch that your working directory on
when you start a command like <a 
 id="dx1-166001"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; or <a 
 id="dx1-166002"></a>&#x201C;<span 
class="pcrr7tn-">hg pull -u</span>&#x201D;. It will update the working directory to the tip of this branch,
no matter what the &#x201C;repo-wide&#x201D; tip is. To update to a revision that&#x2019;s on a different named branch, you may need to use the <a 
 id="dx1-166003"></a><span 
class="pcrr7tn-">-C</span>
option to <a 
 id="dx1-166004"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D;.
</p><!--l. 311--><p class="indent">   This behaviour is a little subtle, so let&#x2019;s see it in action. First, let&#x2019;s remind ourselves what branch we&#x2019;re currently on, and
what branches are in our repository.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-166006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;parents</span>
<br class="fancyvrb" /><a 
 id="x1-166008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:d85d944d98e5</span>
<br class="fancyvrb" /><a 
 id="x1-166010r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;branch:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bar</span>
<br class="fancyvrb" /><a 
 id="x1-166012r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-166014r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-166016r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:09</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-166018r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Third</span><span 
class="pcrr7tn-">&#x00A0;commit</span>
<br class="fancyvrb" /><a 
 id="x1-166020r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-166022r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;branches</span>
<br class="fancyvrb" /><a 
 id="x1-166024r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bar</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:d85d944d98e5</span>
<br class="fancyvrb" /><a 
 id="x1-166026r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;foo</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:9875a5492f0d</span>
   </div>
<!--l. 315--><p class="noindent">We&#x2019;re on the <span 
class="pcrr7tn-">bar </span>branch, but there also exists an older <a 
 id="dx1-166027"></a>&#x201C;<span 
class="pcrr7tn-">hg foo</span>&#x201D; branch.
</p><!--l. 318--><p class="indent">   We can <a 
 id="dx1-166028"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; back and forth between the tips of the <span 
class="pcrr7tn-">foo </span>and <span 
class="pcrr7tn-">bar </span>branches without needing to use the <a 
 id="dx1-166029"></a><span 
class="pcrr7tn-">-C </span>option,
because this only involves going backwards and forwards linearly through our change history.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-166031r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;update</span><span 
class="pcrb7t-">&#x00A0;foo</span>
<br class="fancyvrb" /><a 
 id="x1-166033r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-166035r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;parents</span>
<br class="fancyvrb" /><a 
 id="x1-166037r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:9875a5492f0d</span>
<br class="fancyvrb" /><a 
 id="x1-166039r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;branch:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;foo</span>
<br class="fancyvrb" /><a 
 id="x1-166041r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-166043r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:09</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-166045r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Second</span><span 
class="pcrr7tn-">&#x00A0;commit</span>
<br class="fancyvrb" /><a 
 id="x1-166047r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-166049r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;update</span><span 
class="pcrb7t-">&#x00A0;bar</span>
<br class="fancyvrb" /><a 
 id="x1-166051r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-166053r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;parents</span>
<br class="fancyvrb" /><a 
 id="x1-166055r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:d85d944d98e5</span>
<br class="fancyvrb" /><a 
 id="x1-166057r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;branch:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bar</span>
<br class="fancyvrb" /><a 
 id="x1-166059r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-166061r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-166063r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:09</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-166065r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Third</span><span 
class="pcrr7tn-">&#x00A0;commit</span>
<br class="fancyvrb" /><a 
 id="x1-166067r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 324--><p class="indent">   If we go back to the <span 
class="pcrr7tn-">foo </span>branch and then run <a 
 id="dx1-166068"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D;, it will keep us on <span 
class="pcrr7tn-">foo</span>, not move us to the tip of
<span 
class="pcrr7tn-">bar</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-166070r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;update</span><span 
class="pcrb7t-">&#x00A0;foo</span>
<br class="fancyvrb" /><a 
 id="x1-166072r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-166074r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;update</span>
<br class="fancyvrb" /><a 
 id="x1-166076r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
   </div>
<!--l. 329--><p class="indent">   Committing a new change on the <span 
class="pcrr7tn-">foo </span>branch introduces a new head.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-166078r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;something</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;somefile</span>
<br class="fancyvrb" /><a 
 id="x1-166080r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'New</span><span 
class="pcrb7t-">&#x00A0;file'</span>
<br class="fancyvrb" /><a 
 id="x1-166082r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;somefile</span>
<br class="fancyvrb" /><a 
 id="x1-166084r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;heads</span>
<br class="fancyvrb" /><a 
 id="x1-166086r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3:1ea29e5556a0</span>
<br class="fancyvrb" /><a 
 id="x1-166088r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;branch:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bar</span>
<br class="fancyvrb" /><a 
 id="x1-166090r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-166092r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-166094r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:10</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-166096r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;New</span><span 
class="pcrr7tn-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-166098r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 332--><p class="noindent">We can no longer update from <span 
class="pcrr7tn-">foo </span>to <span 
class="pcrr7tn-">bar </span>without going &#x201C;sideways&#x201D; in history, so Mercurial forces us to provide the <a 
 id="dx1-166099"></a><span 
class="pcrr7tn-">-C </span>option to
<a 
 id="dx1-166100"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-166102r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;update</span><span 
class="pcrb7t-">&#x00A0;bar</span>
<br class="fancyvrb" /><a 
 id="x1-166104r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-166106r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;update</span><span 
class="pcrb7t-">&#x00A0;-C</span><span 
class="pcrb7t-">&#x00A0;bar</span>
<br class="fancyvrb" /><a 
 id="x1-166108r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
   </div>
<!--l. 337--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">8.7    </span> <a 
 id="x1-1670008.7"></a>Branch names and merging</h3>
<!--l. 339--><p class="noindent">As you&#x2019;ve probably noticed, merges in Mercurial are not symmetrical. Let&#x2019;s say our repository has two heads, 17 and 23. If I
<a 
 id="dx1-167001"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; to 17 and then <a 
 id="dx1-167002"></a>&#x201C;<span 
class="pcrr7tn-">hg merge</span>&#x201D; with 23, Mercurial records 17 as the first parent of the merge, and 23 as the second.
Whereas if I <a 
 id="dx1-167003"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; to 23 and then <a 
 id="dx1-167004"></a>&#x201C;<span 
class="pcrr7tn-">hg merge</span>&#x201D; with 17, it records 23 as the first parent, and 17 as the
second.
</p><!--l. 346--><p class="indent">   This affects Mercurial&#x2019;s choice of branch name when you merge. After a merge, Mercurial will retain the branch name of
the first parent when you commit the result of the merge. If your first parent&#x2019;s branch name is <span 
class="pcrr7tn-">foo</span>, and you merge with <span 
class="pcrr7tn-">bar</span>, the
branch name will still be <span 
class="pcrr7tn-">foo </span>after you merge.
</p><!--l. 352--><p class="indent">   It&#x2019;s not unusual for a repository to contain multiple heads, each with the same branch name. Let&#x2019;s say I&#x2019;m working on the
<span 
class="pcrr7tn-">foo </span>branch, and so are you. We commit different changes; I pull your changes; I now have two heads, each
claiming to be on the <span 
class="pcrr7tn-">foo </span>branch. The result of a merge will be a single head on the <span 
class="pcrr7tn-">foo </span>branch, as you might
hope.
</p><!--l. 359--><p class="indent">   But if I&#x2019;m working on the <span 
class="pcrr7tn-">bar </span>branch, and I merge work from the <span 
class="pcrr7tn-">foo </span>branch, the result will remain on the <span 
class="pcrr7tn-">bar</span>
branch.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-167006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;branch</span>
<br class="fancyvrb" /><a 
 id="x1-167008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bar</span>
<br class="fancyvrb" /><a 
 id="x1-167010r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;merge</span>
<br class="fancyvrb" /><a 
 id="x1-167012r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;there</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;nothing</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;merge</span><span 
class="pcrr7tn-">&#x00A0;-</span><span 
class="pcrr7tn-">&#x00A0;use</span><span 
class="pcrr7tn-">&#x00A0;"hg</span><span 
class="pcrr7tn-">&#x00A0;update"</span><span 
class="pcrr7tn-">&#x00A0;instead</span>
<br class="fancyvrb" /><a 
 id="x1-167014r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Merge'</span>
<br class="fancyvrb" /><a 
 id="x1-167016r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;nothing</span><span 
class="pcrr7tn-">&#x00A0;changed</span>
<br class="fancyvrb" /><a 
 id="x1-167018r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-167020r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3:1ea29e5556a0</span>
<br class="fancyvrb" /><a 
 id="x1-167022r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;branch:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bar</span>
<br class="fancyvrb" /><a 
 id="x1-167024r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-167026r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-167028r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:10</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-167030r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;New</span><span 
class="pcrr7tn-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-167032r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 364--><p class="indent">   To give a more concrete example, if I&#x2019;m working on the <span 
class="pcrr7tn-">bleeding-edge </span>branch, and I want to bring in the latest fixes from
the <span 
class="pcrr7tn-">stable </span>branch, Mercurial will choose the &#x201C;right&#x201D; (<span 
class="pcrr7tn-">bleeding-edge</span>) branch name when I pull and merge from
<span 
class="pcrr7tn-">stable</span>.
</p><!--l. 370--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">8.8    </span> <a 
 id="x1-1680008.8"></a>Branch naming is generally useful</h3>
<!--l. 372--><p class="noindent">You shouldn&#x2019;t think of named branches as applicable only to situations where you have multiple long-lived branches cohabiting
in a single repository. They&#x2019;re very useful even in the one-branch-per-repository case.
                                                                                         
                                                                                         
</p><!--l. 377--><p class="indent">   In the simplest case, giving a name to each branch gives you a permanent record of which branch a changeset
originated on. This gives you more context when you&#x2019;re trying to follow the history of a long-lived branchy
project.
</p><!--l. 382--><p class="indent">   If you&#x2019;re working with shared repositories, you can set up a <a 
 id="dx1-168001"></a><a 
 id="dx1-168002"></a><span 
class="pcrr7tn-">pretxnchangegroup </span>hook on each that will block incoming
changes that have the &#x201C;wrong&#x201D; branch name. This provides a simple, but effective, defence against people accidentally pushing
changes from a &#x201C;bleeding edge&#x201D; branch to a &#x201C;stable&#x201D; branch. Such a hook might look like this inside the shared repo&#x2019;s
<a 
 id="dx1-168003"></a><a 
 id="dx1-168004"></a><span 
class="pcrr7tn-">hgrc</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-168006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[hooks]</span>
<br class="fancyvrb" /><a 
 id="x1-168008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pretxnchangegroup.branch</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;heads</span><span 
class="pcrr7tn-">&#x00A0;--template</span><span 
class="pcrr7tn-">&#x00A0;'branches</span><span 
class="pcrr7tn-">&#x00A0;'</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;grep</span><span 
class="pcrr7tn-">&#x00A0;mybranch</span>
   </div>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;9</span><br /><a 
 id="x1-1690009"></a>Finding and fixing your mistakes</h2>
<!--l. 4--><p class="noindent">To err might be human, but to really handle the consequences well takes a top-notch revision control system. In this chapter,
we&#x2019;ll discuss some of the techniques you can use when you find that a problem has crept into your project.
Mercurial has some highly capable features that will help you to isolate the sources of problems, and to handle them
appropriately.
</p>
   <h3 class="sectionHead"><span class="titlemark">9.1    </span> <a 
 id="x1-1700009.1"></a>Erasing local history</h3>
<!--l. 13--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.1.1    </span> <a 
 id="x1-1710009.1.1"></a>The accidental commit</h4>
<!--l. 15--><p class="noindent">I have the occasional but persistent problem of typing rather more quickly than I can think, which sometimes results in me
committing a changeset that is either incomplete or plain wrong. In my case, the usual kind of incomplete changeset is one in
which I&#x2019;ve created a new source file, but forgotten to <a 
 id="dx1-171001"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; it. A &#x201C;plain wrong&#x201D; changeset is not as common, but no less
annoying.
</p><!--l. 22--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.1.2    </span> <a 
 id="x1-1720009.1.2"></a>Rolling back a transaction</h4>
<!--l. 25--><p class="noindent">In section&#x00A0;<a 
href="#x1-1060005.2.2">5.2.2<!--tex4ht:ref: sec:concepts:txn --></a>, I mentioned that Mercurial treats each modification of a repository as a <span 
class="ptmri7t-">transaction</span>. Every time you commit a
changeset or pull changes from another repository, Mercurial remembers what you did. You can undo, or <span 
class="ptmri7t-">roll back</span>, exactly one
of these actions using the <a 
 id="dx1-172001"></a>&#x201C;<span 
class="pcrr7tn-">hg rollback</span>&#x201D; command. (See section&#x00A0;<a 
href="#x1-1740009.1.4">9.1.4<!--tex4ht:ref: sec:undo:rollback-after-push --></a> for an important caveat about the use of this
command.)
</p><!--l. 33--><p class="indent">   Here&#x2019;s a mistake that I often find myself making: committing a change in which I&#x2019;ve created a new file, but forgotten to <a 
 id="dx1-172002"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">add</span>&#x201D; it.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-172004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-172006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;M</span><span 
class="pcrr7tn-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-172008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;b</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-172010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Add</span><span 
class="pcrb7t-">&#x00A0;file</span><span 
class="pcrb7t-">&#x00A0;b'</span>
   </div>
<!--l. 36--><p class="noindent">Looking at the output of <a 
 id="dx1-172011"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; after the commit immediately confirms the error.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-172013r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-172015r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-172017r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-172019r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:ba4a882d7cb4</span>
<br class="fancyvrb" /><a 
 id="x1-172021r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-172023r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-172025r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:24</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-172027r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Add</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-172029r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
                                                                                         
                                                                                         
<!--l. 39--><p class="noindent">The commit captured the changes to the file <span 
class="pcrr7tn-">a</span>, but not the new file <span 
class="pcrr7tn-">b</span>. If I were to push this changeset to a repository that I shared
with a colleague, the chances are high that something in <span 
class="pcrr7tn-">a </span>would refer to <span 
class="pcrr7tn-">b</span>, which would not be present in their repository when
they pulled my changes. I would thus become the object of some indignation.
</p><!--l. 46--><p class="indent">   However, luck is with me&#x2014;I&#x2019;ve caught my error before I pushed the changeset. I use the <a 
 id="dx1-172030"></a>&#x201C;<span 
class="pcrr7tn-">hg rollback</span>&#x201D; command, and
Mercurial makes that last changeset vanish.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-172032r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;rollback</span>
<br class="fancyvrb" /><a 
 id="x1-172034r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;rolling</span><span 
class="pcrr7tn-">&#x00A0;back</span><span 
class="pcrr7tn-">&#x00A0;last</span><span 
class="pcrr7tn-">&#x00A0;transaction</span>
<br class="fancyvrb" /><a 
 id="x1-172036r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-172038r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:900cb42c234b</span>
<br class="fancyvrb" /><a 
 id="x1-172040r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-172042r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-172044r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:24</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-172046r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;First</span><span 
class="pcrr7tn-">&#x00A0;commit</span>
<br class="fancyvrb" /><a 
 id="x1-172048r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-172050r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-172052r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;M</span><span 
class="pcrr7tn-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-172054r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;b</span>
   </div>
<!--l. 50--><p class="noindent">Notice that the changeset is no longer present in the repository&#x2019;s history, and the working directory once again thinks
that the file <span 
class="pcrr7tn-">a </span>is modified. The commit and rollback have left the working directory exactly as it was prior to
the commit; the changeset has been completely erased. I can now safely <a 
 id="dx1-172055"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; the file <span 
class="pcrr7tn-">b</span>, and rerun my
commit.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-172057r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;b</span>
<br class="fancyvrb" /><a 
 id="x1-172059r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'Add</span><span 
class="pcrb7t-">&#x00A0;file</span><span 
class="pcrb7t-">&#x00A0;b,</span><span 
class="pcrb7t-">&#x00A0;this</span><span 
class="pcrb7t-">&#x00A0;time</span><span 
class="pcrb7t-">&#x00A0;for</span><span 
class="pcrb7t-">&#x00A0;real'</span>
   </div>
<!--l. 58--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.1.3    </span> <a 
 id="x1-1730009.1.3"></a>The erroneous pull</h4>
<!--l. 60--><p class="noindent">It&#x2019;s common practice with Mercurial to maintain separate development branches of a project in different repositories. Your
development team might have one shared repository for your project&#x2019;s &#x201C;0.9&#x201D; release, and another, containing different changes,
for the &#x201C;1.0&#x201D; release.
</p><!--l. 66--><p class="indent">   Given this, you can imagine that the consequences could be messy if you had a local &#x201C;0.9&#x201D; repository, and
accidentally pulled changes from the shared &#x201C;1.0&#x201D; repository into it. At worst, you could be paying insufficient
attention, and push those changes into the shared &#x201C;0.9&#x201D; tree, confusing your entire team (but don&#x2019;t worry, we&#x2019;ll
return to this horror scenario later). However, it&#x2019;s more likely that you&#x2019;ll notice immediately, because Mercurial
will display the URL it&#x2019;s pulling from, or you will see it pull a suspiciously large number of changes into the
repository.
</p><!--l. 76--><p class="indent">   The <a 
 id="dx1-173001"></a>&#x201C;<span 
class="pcrr7tn-">hg rollback</span>&#x201D; command will work nicely to expunge all of the changesets that you just pulled. Mercurial groups
all changes from one <a 
 id="dx1-173002"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; into a single transaction, so one <a 
 id="dx1-173003"></a>&#x201C;<span 
class="pcrr7tn-">hg rollback</span>&#x201D; is all you need to undo this
mistake.
                                                                                         
                                                                                         
</p><!--l. 81--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.1.4    </span> <a 
 id="x1-1740009.1.4"></a>Rolling back is useless once you&#x2019;ve pushed</h4>
<!--l. 84--><p class="noindent">The value of the <a 
 id="dx1-174001"></a>&#x201C;<span 
class="pcrr7tn-">hg rollback</span>&#x201D; command drops to zero once you&#x2019;ve pushed your changes to another repository. Rolling
back a change makes it disappear entirely, but <span 
class="ptmri7t-">only </span>in the repository in which you perform the <a 
 id="dx1-174002"></a>&#x201C;<span 
class="pcrr7tn-">hg rollback</span>&#x201D;.
Because a rollback eliminates history, there&#x2019;s no way for the disappearance of a change to propagate between
repositories.
</p><!--l. 91--><p class="indent">   If you&#x2019;ve pushed a change to another repository&#x2014;particularly if it&#x2019;s a shared repository&#x2014;it has essentially &#x201C;escaped into the
wild,&#x201D; and you&#x2019;ll have to recover from your mistake in a different way. What will happen if you push a changeset
somewhere, then roll it back, then pull from the repository you pushed to, is that the changeset will reappear in your
repository.
</p><!--l. 98--><p class="indent">   (If you absolutely know for sure that the change you want to roll back is the most recent change in the repository that you
pushed to, <span 
class="ptmri7t-">and </span>you know that nobody else could have pulled it from that repository, you can roll back the changeset there, too,
but you really should really not rely on this working reliably. If you do this, sooner or later a change really
will make it into a repository that you don&#x2019;t directly control (or have forgotten about), and come back to bite
you.)
</p><!--l. 107--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.1.5    </span> <a 
 id="x1-1750009.1.5"></a>You can only roll back once</h4>
<!--l. 109--><p class="noindent">Mercurial stores exactly one transaction in its transaction log; that transaction is the most recent one that occurred in the
repository. This means that you can only roll back one transaction. If you expect to be able to roll back one transaction, then its
predecessor, this is not the behaviour you will get.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-175002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;rollback</span>
<br class="fancyvrb" /><a 
 id="x1-175004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;rolling</span><span 
class="pcrr7tn-">&#x00A0;back</span><span 
class="pcrr7tn-">&#x00A0;last</span><span 
class="pcrr7tn-">&#x00A0;transaction</span>
<br class="fancyvrb" /><a 
 id="x1-175006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;rollback</span>
<br class="fancyvrb" /><a 
 id="x1-175008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;no</span><span 
class="pcrr7tn-">&#x00A0;rollback</span><span 
class="pcrr7tn-">&#x00A0;information</span><span 
class="pcrr7tn-">&#x00A0;available</span>
   </div>
<!--l. 115--><p class="noindent">Once you&#x2019;ve rolled back one transaction in a repository, you can&#x2019;t roll back again in that repository until you perform another
commit or pull.
</p><!--l. 119--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">9.2    </span> <a 
 id="x1-1760009.2"></a>Reverting the mistaken change</h3>
<!--l. 121--><p class="noindent">If you make a modification to a file, and decide that you really didn&#x2019;t want to change the file at all, and you haven&#x2019;t yet
committed your changes, the <a 
 id="dx1-176001"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; command is the one you&#x2019;ll need. It looks at the changeset that&#x2019;s the parent of the
working directory, and restores the contents of the file to their state as of that changeset. (That&#x2019;s a long-winded way of saying
that, in the normal case, it undoes your modifications.)
</p><!--l. 129--><p class="indent">   Let&#x2019;s illustrate how the <a 
 id="dx1-176002"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; command works with yet another small example. We&#x2019;ll begin by modifying a file that
Mercurial is already tracking.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-176004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-176006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;original</span><span 
class="pcrr7tn-">&#x00A0;content</span>
<br class="fancyvrb" /><a 
 id="x1-176008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;unwanted</span><span 
class="pcrb7t-">&#x00A0;change</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;file</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-176010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;diff</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-176012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;51faa6aede91</span><span 
class="pcrr7tn-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-176014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/file        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:14</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-176016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/file        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:14</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-176018r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-1,1</span><span 
class="pcrr7tn-">&#x00A0;+1,2</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;original</span><span 
class="pcrr7tn-">&#x00A0;content</span>
<br class="fancyvrb" /><a 
 id="x1-176020r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;original</span><span 
class="pcrr7tn-">&#x00A0;content</span>
<br class="fancyvrb" /><a 
 id="x1-176022r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+unwanted</span><span 
class="pcrr7tn-">&#x00A0;change</span>
   </div>
<!--l. 133--><p class="noindent">If we don&#x2019;t want that change, we can simply <a 
 id="dx1-176023"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; the file.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-176025r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-176027r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;M</span><span 
class="pcrr7tn-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-176029r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;revert</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-176031r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-176033r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;original</span><span 
class="pcrr7tn-">&#x00A0;content</span>
   </div>
<!--l. 135--><p class="noindent">The <a 
 id="dx1-176034"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; command provides us with an extra degree of safety by saving our modified file with a <span 
class="pcrr7tn-">.orig</span>
extension.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-176036r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-176038r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;file.orig</span>
<br class="fancyvrb" /><a 
 id="x1-176040r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;file.orig</span>
<br class="fancyvrb" /><a 
 id="x1-176042r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;original</span><span 
class="pcrr7tn-">&#x00A0;content</span>
<br class="fancyvrb" /><a 
 id="x1-176044r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;unwanted</span><span 
class="pcrr7tn-">&#x00A0;change</span>
   </div>
<!--l. 139--><p class="indent">   Here is a summary of the cases that the <a 
 id="dx1-176045"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; command can deal with. We will describe each of these in more detail
in the section that follows. </p>
     <ul><li><span class="dt">
     </span><span class="dd">If you modify a file, it will restore the file to its unmodified state.
     </span><li><span class="dt">
     </span><span class="dd">If you <a 
 id="dx1-176046"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; a file, it will undo the &#x201C;added&#x201D; state of the file, but leave the file itself untouched.
     </span><li><span class="dt">
     </span><span class="dd">If you delete a file without telling Mercurial, it will restore the file to its unmodified contents.
     </span><li><span class="dt">
     </span><span class="dd">If you use the <a 
 id="dx1-176047"></a>&#x201C;<span 
class="pcrr7tn-">hg remove</span>&#x201D; command to remove a file, it will undo the &#x201C;removed&#x201D; state of the file, and restore
     the file to its unmodified contents.</li></ul>
<!--l. 154--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.2.1    </span> <a 
 id="x1-1770009.2.1"></a>File management errors</h4>
<!--l. 157--><p class="noindent">The <a 
 id="dx1-177001"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; command is useful for more than just modified files. It lets you reverse the results of all of Mercurial&#x2019;s file
management commands&#x2014;<a 
 id="dx1-177002"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D;, <a 
 id="dx1-177003"></a>&#x201C;<span 
class="pcrr7tn-">hg remove</span>&#x201D;, and so on.
</p><!--l. 161--><p class="indent">   If you <a 
 id="dx1-177004"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; a file, then decide that in fact you don&#x2019;t want Mercurial to track it, use <a 
 id="dx1-177005"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; to undo the add.
Don&#x2019;t worry; Mercurial will not modify the file in any way. It will just &#x201C;unmark&#x201D; the file.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-177007r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;oops</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;oops</span>
<br class="fancyvrb" /><a 
 id="x1-177009r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;oops</span>
<br class="fancyvrb" /><a 
 id="x1-177011r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span><span 
class="pcrb7t-">&#x00A0;oops</span>
<br class="fancyvrb" /><a 
 id="x1-177013r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;A</span><span 
class="pcrr7tn-">&#x00A0;oops</span>
<br class="fancyvrb" /><a 
 id="x1-177015r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;revert</span><span 
class="pcrb7t-">&#x00A0;oops</span>
<br class="fancyvrb" /><a 
 id="x1-177017r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-177019r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;oops</span>
   </div>
<!--l. 167--><p class="indent">   Similarly, if you ask Mercurial to <a 
 id="dx1-177020"></a>&#x201C;<span 
class="pcrr7tn-">hg remove</span>&#x201D; a file, you can use <a 
 id="dx1-177021"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; to restore it to the contents it had as of the
parent of the working directory.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-177023r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;remove</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-177025r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-177027r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;R</span><span 
class="pcrr7tn-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-177029r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;revert</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-177031r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-177033r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-177035r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;file</span>
   </div>
<!--l. 171--><p class="noindent">This works just as well for a file that you deleted by hand, without telling Mercurial (recall that in Mercurial terminology, this kind
of file is called &#x201C;missing&#x201D;).
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-177037r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">rm</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-177039r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-177041r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;!</span><span 
class="pcrr7tn-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-177043r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;revert</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-177045r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-177047r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;file</span>
   </div>
<!--l. 176--><p class="indent">   If you revert a <a 
 id="dx1-177048"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D;, the copied-to file remains in your working directory afterwards, untracked. Since a copy doesn&#x2019;t
affect the copied-from file in any way, Mercurial doesn&#x2019;t do anything with the copied-from file.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-177050r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;copy</span><span 
class="pcrb7t-">&#x00A0;file</span><span 
class="pcrb7t-">&#x00A0;new-file</span>
<br class="fancyvrb" /><a 
 id="x1-177052r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;revert</span><span 
class="pcrb7t-">&#x00A0;new-file</span>
<br class="fancyvrb" /><a 
 id="x1-177054r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-177056r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;new-file</span>
   </div>
<!--l. 182--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-1780009.2.1"></a>A slightly special case: reverting a rename</h5>
<!--l. 184--><p class="noindent">If you <a 
 id="dx1-178001"></a>&#x201C;<span 
class="pcrr7tn-">hg rename</span>&#x201D; a file, there is one small detail that you should remember. When you <a 
 id="dx1-178002"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; a rename, it&#x2019;s not
enough to provide the name of the renamed-to file, as you can see here.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-178004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;rename</span><span 
class="pcrb7t-">&#x00A0;file</span><span 
class="pcrb7t-">&#x00A0;new-file</span>
<br class="fancyvrb" /><a 
 id="x1-178006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;revert</span><span 
class="pcrb7t-">&#x00A0;new-file</span>
<br class="fancyvrb" /><a 
 id="x1-178008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-178010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;R</span><span 
class="pcrr7tn-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-178012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;new-file</span>
   </div>
<!--l. 189--><p class="noindent">As you can see from the output of <a 
 id="dx1-178013"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D;, the renamed-to file is no longer identified as added, but the renamed-<span 
class="ptmri7t-">from </span>file is
still removed! This is counter-intuitive (at least to me), but at least it&#x2019;s easy to deal with.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-178015r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;revert</span><span 
class="pcrb7t-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-178017r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-178019r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;?</span><span 
class="pcrr7tn-">&#x00A0;new-file</span>
   </div>
<!--l. 194--><p class="noindent">So remember, to revert a <a 
 id="dx1-178020"></a>&#x201C;<span 
class="pcrr7tn-">hg rename</span>&#x201D;, you must provide <span 
class="ptmri7t-">both </span>the source and destination names.
</p><!--l. 197--><p class="indent">   (By the way, if you rename a file, then modify the renamed-to file, then revert both components of the rename, when
Mercurial restores the file that was removed as part of the rename, it will be unmodified. If you need the modifications in the
renamed-to file to show up in the renamed-from file, don&#x2019;t forget to copy them over.)
</p><!--l. 203--><p class="indent">   These fiddly aspects of reverting a rename arguably constitute a small bug in Mercurial.
</p><!--l. 206--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">9.3    </span> <a 
 id="x1-1790009.3"></a>Dealing with committed changes</h3>
<!--l. 208--><p class="noindent">Consider a case where you have committed a change <span 
class="zptmcmrm-">a</span>, and another change <span 
class="zptmcmrm-">b </span>on top of it; you then realise that change <span 
class="zptmcmrm-">a </span>was
incorrect. Mercurial lets you &#x201C;back out&#x201D; an entire changeset automatically, and building blocks that let you reverse part of a
changeset by hand.
</p><!--l. 214--><p class="indent">   Before you read this section, here&#x2019;s something to keep in mind: the <a 
 id="dx1-179001"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command undoes changes by <span 
class="ptmri7t-">adding</span>
history, not by modifying or erasing it. It&#x2019;s the right tool to use if you&#x2019;re fixing bugs, but not if you&#x2019;re trying to undo some
change that has catastrophic consequences. To deal with those, see section&#x00A0;<a 
href="#x1-1860009.4">9.4<!--tex4ht:ref: sec:undo:aaaiiieee --></a>.
</p><!--l. 221--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.3.1    </span> <a 
 id="x1-1800009.3.1"></a>Backing out a changeset</h4>
<!--l. 223--><p class="noindent">The <a 
 id="dx1-180001"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command lets you &#x201C;undo&#x201D; the effects of an entire changeset in an automated fashion. Because Mercurial&#x2019;s
history is immutable, this command <span 
class="ptmri7t-">does not </span>get rid of the changeset you want to undo. Instead, it creates a new changeset that
<span 
class="ptmri7t-">reverses </span>the effect of the to-be-undone changeset.
</p><!--l. 229--><p class="indent">   The operation of the <a 
 id="dx1-180002"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command is a little intricate, so let&#x2019;s illustrate it with some examples. First, we&#x2019;ll create
a repository with some simple changes.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-180004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;myrepo</span>
<br class="fancyvrb" /><a 
 id="x1-180006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;myrepo</span>
<br class="fancyvrb" /><a 
 id="x1-180008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;first</span><span 
class="pcrb7t-">&#x00A0;change</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-180010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-180012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'first</span><span 
class="pcrb7t-">&#x00A0;change'</span>
<br class="fancyvrb" /><a 
 id="x1-180014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;second</span><span 
class="pcrb7t-">&#x00A0;change</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-180016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'second</span><span 
class="pcrb7t-">&#x00A0;change'</span>
   </div>
<!--l. 234--><p class="indent">   The <a 
 id="dx1-180017"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command takes a single changeset ID as its argument; this is the changeset to back out.
Normally, <a 
 id="dx1-180018"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; will drop you into a text editor to write a commit message, so you can record why
you&#x2019;re backing the change out. In this example, we provide a commit message on the command line using the <a 
 id="dx1-180019"></a><span 
class="pcrr7tn-">-m</span>
option.
</p><!--l. 241--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.3.2    </span> <a 
 id="x1-1810009.3.2"></a>Backing out the tip changeset</h4>
<!--l. 243--><p class="noindent">We&#x2019;re going to start by backing out the last changeset we committed.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-181002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;backout</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'back</span><span 
class="pcrb7t-">&#x00A0;out</span><span 
class="pcrb7t-">&#x00A0;second</span><span 
class="pcrb7t-">&#x00A0;change'</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-181004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;reverting</span><span 
class="pcrr7tn-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-181006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;2:87e440334007</span><span 
class="pcrr7tn-">&#x00A0;backs</span><span 
class="pcrr7tn-">&#x00A0;out</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;1:93c4df0b195e</span>
<br class="fancyvrb" /><a 
 id="x1-181008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-181010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first</span><span 
class="pcrr7tn-">&#x00A0;change</span>
   </div>
<!--l. 245--><p class="noindent">You can see that the second line from <span 
class="pcrr7tn-">myfile </span>is no longer present. Taking a look at the output of <a 
 id="dx1-181011"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; gives us an idea of what
the <a 
 id="dx1-181012"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command has done.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-181014r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;--style</span><span 
class="pcrb7t-">&#x00A0;compact</span>
<br class="fancyvrb" /><a 
 id="x1-181016r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2[tip]</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;87e440334007</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-181018r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;back</span><span 
class="pcrr7tn-">&#x00A0;out</span><span 
class="pcrr7tn-">&#x00A0;second</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-181020r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-181022r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;93c4df0b195e</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-181024r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;second</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-181026r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-181028r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2dad81e41eb8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-181030r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-181032r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 249--><p class="noindent">Notice that the new changeset that <a 
 id="dx1-181033"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; has created is a child of the changeset we backed out. It&#x2019;s easier to see this
in figure&#x00A0;<a 
href="#x1-1810341">9.1<!--tex4ht:ref: fig:undo:backout --></a>, which presents a graphical view of the change history. As you can see, the history is nice and
linear.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1810341"></a>
                                                                                         
                                                                                         
<!--l. 256--><p class="noindent"><img 
src="undo-simple.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;9.1: </td><td  
class="content">Backing out a change using the <a 
 id="dx1-181035"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command</td></tr></table><!--tex4ht:label?: x1-1810341 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">9.3.3    </span> <a 
 id="x1-1820009.3.3"></a>Backing out a non-tip change</h4>
<!--l. 263--><p class="noindent">If you want to back out a change other than the last one you committed, pass the <a 
 id="dx1-182001"></a><span 
class="pcrr7tn-">--merge </span>option to the <a 
 id="dx1-182002"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D;
command.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-182004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-182006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;myrepo</span><span 
class="pcrb7t-">&#x00A0;non-tip-repo</span>
<br class="fancyvrb" /><a 
 id="x1-182008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;requesting</span><span 
class="pcrr7tn-">&#x00A0;all</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-182010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-182012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-182014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-182016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span>
<br class="fancyvrb" /><a 
 id="x1-182018r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-182020r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;non-tip-repo</span>
   </div>
<!--l. 267--><p class="noindent">This makes backing out any changeset a &#x201C;one-shot&#x201D; operation that&#x2019;s usually simple and fast.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-182022r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;third</span><span 
class="pcrb7t-">&#x00A0;change</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-182024r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'third</span><span 
class="pcrb7t-">&#x00A0;change'</span>
<br class="fancyvrb" /><a 
 id="x1-182026r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;backout</span><span 
class="pcrb7t-">&#x00A0;--merge</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'back</span><span 
class="pcrb7t-">&#x00A0;out</span><span 
class="pcrb7t-">&#x00A0;second</span><span 
class="pcrb7t-">&#x00A0;change'</span><span 
class="pcrb7t-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-182028r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;reverting</span><span 
class="pcrr7tn-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-182030r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;3:87e440334007</span><span 
class="pcrr7tn-">&#x00A0;backs</span><span 
class="pcrr7tn-">&#x00A0;out</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;1:93c4df0b195e</span>
<br class="fancyvrb" /><a 
 id="x1-182032r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;merging</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;2:31835fe18df6</span>
<br class="fancyvrb" /><a 
 id="x1-182034r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;merging</span><span 
class="pcrr7tn-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-182036r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-182038r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(branch</span><span 
class="pcrr7tn-">&#x00A0;merge,</span><span 
class="pcrr7tn-">&#x00A0;don't</span><span 
class="pcrr7tn-">&#x00A0;forget</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;commit)</span>
   </div>
<!--l. 271--><p class="indent">   If you take a look at the contents of <span 
class="pcrr7tn-">myfile </span>after the backout finishes, you&#x2019;ll see that the first and third changes are present,
but not the second.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-182040r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-182042r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-182044r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;third</span><span 
class="pcrr7tn-">&#x00A0;change</span>
   </div>
<!--l. 276--><p class="indent">   As the graphical history in figure&#x00A0;<a 
href="#x1-1820452">9.2<!--tex4ht:ref: fig:undo:backout-non-tip --></a> illustrates, Mercurial actually commits <span 
class="ptmri7t-">two </span>changes in this kind of situation (the
box-shaped nodes are the ones that Mercurial commits automatically). Before Mercurial begins the backout process, it first
remembers what the current parent of the working directory is. It then backs out the target changeset, and commits that as a
changeset. Finally, it merges back to the previous parent of the working directory, and commits the result of the
merge.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1820452"></a>
                                                                                         
                                                                                         
<!--l. 287--><p class="noindent"><img 
src="undo-non-tip.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;9.2: </td><td  
class="content">Automated backout of a non-tip change using the <a 
 id="dx1-182046"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command</td></tr></table><!--tex4ht:label?: x1-1820452 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 292--><p class="indent">   The result is that you end up &#x201C;back where you were&#x201D;, only with some extra history that undoes the effect of the changeset
you wanted to back out.
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-1830009.3.3"></a>Always use the <span 
class="pcrr7tn-">--merge </span>option</h5>
<!--l. 298--><p class="noindent">In fact, since the <a 
 id="dx1-183001"></a><span 
class="pcrr7tn-">--merge </span>option will do the &#x201C;right thing&#x201D; whether or not the changeset you&#x2019;re backing out is the tip (i.e.&#x00A0;it
won&#x2019;t try to merge if it&#x2019;s backing out the tip, since there&#x2019;s no need), you should <span 
class="ptmri7t-">always </span>use this option when you run the <a 
 id="dx1-183002"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">backout</span>&#x201D; command.
</p><!--l. 304--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.3.4    </span> <a 
 id="x1-1840009.3.4"></a>Gaining more control of the backout process</h4>
<!--l. 306--><p class="noindent">While I&#x2019;ve recommended that you always use the <a 
 id="dx1-184001"></a><span 
class="pcrr7tn-">--merge </span>option when backing out a change, the <a 
 id="dx1-184002"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D;
command lets you decide how to merge a backout changeset. Taking control of the backout process by hand is
something you will rarely need to do, but it can be useful to understand what the <a 
 id="dx1-184003"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command is
doing for you automatically. To illustrate this, let&#x2019;s clone our first repository, but omit the backout change that it
contains.
</p><!--l. 315--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-184005r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-184007r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;myrepo</span><span 
class="pcrb7t-">&#x00A0;newrepo</span>
<br class="fancyvrb" /><a 
 id="x1-184009r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;requesting</span><span 
class="pcrr7tn-">&#x00A0;all</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-184011r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-184013r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-184015r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-184017r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span>
<br class="fancyvrb" /><a 
 id="x1-184019r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-184021r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;newrepo</span>
   </div>
<!--l. 316--><p class="noindent">As with our earlier example, We&#x2019;ll commit a third changeset, then back out its parent, and see what happens.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-184023r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;third</span><span 
class="pcrb7t-">&#x00A0;change</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-184025r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'third</span><span 
class="pcrb7t-">&#x00A0;change'</span>
<br class="fancyvrb" /><a 
 id="x1-184027r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;backout</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'back</span><span 
class="pcrb7t-">&#x00A0;out</span><span 
class="pcrb7t-">&#x00A0;second</span><span 
class="pcrb7t-">&#x00A0;change'</span><span 
class="pcrb7t-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-184029r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;reverting</span><span 
class="pcrr7tn-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-184031r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;3:b68f5175d70e</span><span 
class="pcrr7tn-">&#x00A0;backs</span><span 
class="pcrr7tn-">&#x00A0;out</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;1:93c4df0b195e</span>
<br class="fancyvrb" /><a 
 id="x1-184033r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;backout</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;new</span><span 
class="pcrr7tn-">&#x00A0;head</span><span 
class="pcrr7tn-">&#x00A0;-</span><span 
class="pcrr7tn-">&#x00A0;do</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;forget</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;merge</span>
<br class="fancyvrb" /><a 
 id="x1-184035r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(use</span><span 
class="pcrr7tn-">&#x00A0;"backout</span><span 
class="pcrr7tn-">&#x00A0;--merge"</span><span 
class="pcrr7tn-">&#x00A0;if</span><span 
class="pcrr7tn-">&#x00A0;you</span><span 
class="pcrr7tn-">&#x00A0;want</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;auto-merge)</span>
   </div>
<!--l. 319--><p class="noindent">Our new changeset is again a descendant of the changeset we backout out; it&#x2019;s thus a new head, <span 
class="ptmri7t-">not </span>a descendant of the changeset
that was the tip. The <a 
 id="dx1-184036"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command was quite explicit in telling us this.
</p>
   <div class="fancyvrb" id="fancyvrb">
                                                                                         
                                                                                         
<a 
 id="x1-184038r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;--style</span><span 
class="pcrb7t-">&#x00A0;compact</span>
<br class="fancyvrb" /><a 
 id="x1-184040r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3[tip]:1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;b68f5175d70e</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-184042r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;back</span><span 
class="pcrr7tn-">&#x00A0;out</span><span 
class="pcrr7tn-">&#x00A0;second</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-184044r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-184046r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;31835fe18df6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-184048r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;third</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-184050r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-184052r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;93c4df0b195e</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-184054r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;second</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-184056r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-184058r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2dad81e41eb8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-184060r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-184062r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 325--><p class="indent">   Again, it&#x2019;s easier to see what has happened by looking at a graph of the revision history, in figure&#x00A0;<a 
href="#x1-1840643">9.3<!--tex4ht:ref: fig:undo:backout-manual --></a>. This makes it clear
that when we use <a 
 id="dx1-184063"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; to back out a change other than the tip, Mercurial adds a new head to the repository (the
change it committed is box-shaped).
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1840643"></a>
                                                                                         
                                                                                         
<!--l. 333--><p class="noindent"><img 
src="undo-manual.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;9.3: </td><td  
class="content">Backing out a change using the <a 
 id="dx1-184065"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command</td></tr></table><!--tex4ht:label?: x1-1840643 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 338--><p class="indent">   After the <a 
 id="dx1-184066"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command has completed, it leaves the new &#x201C;backout&#x201D; changeset as the parent of the working
directory.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-184068r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;parents</span>
<br class="fancyvrb" /><a 
 id="x1-184070r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3:b68f5175d70e</span>
<br class="fancyvrb" /><a 
 id="x1-184072r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-184074r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;parent:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:93c4df0b195e</span>
<br class="fancyvrb" /><a 
 id="x1-184076r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-184078r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:05</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-184080r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;back</span><span 
class="pcrr7tn-">&#x00A0;out</span><span 
class="pcrr7tn-">&#x00A0;second</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-184082r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 341--><p class="noindent">Now we have two isolated sets of changes.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-184084r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;heads</span>
<br class="fancyvrb" /><a 
 id="x1-184086r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3:b68f5175d70e</span>
<br class="fancyvrb" /><a 
 id="x1-184088r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-184090r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;parent:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:93c4df0b195e</span>
<br class="fancyvrb" /><a 
 id="x1-184092r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-184094r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:05</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-184096r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;back</span><span 
class="pcrr7tn-">&#x00A0;out</span><span 
class="pcrr7tn-">&#x00A0;second</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-184098r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-184100r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:31835fe18df6</span>
<br class="fancyvrb" /><a 
 id="x1-184102r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-184104r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:04</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-184106r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;third</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-184108r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 344--><p class="indent">   Let&#x2019;s think about what we expect to see as the contents of <span 
class="pcrr7tn-">myfile </span>now. The first change should be present, because
we&#x2019;ve never backed it out. The second change should be missing, as that&#x2019;s the change we backed out. Since
the history graph shows the third change as a separate head, we <span 
class="ptmri7t-">don&#x2019;t </span>expect to see the third change present in
<span 
class="pcrr7tn-">myfile</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-184110r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-184112r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first</span><span 
class="pcrr7tn-">&#x00A0;change</span>
   </div>
<!--l. 351--><p class="noindent">To get the third change back into the file, we just do a normal merge of our two heads.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-184114r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;merge</span>
<br class="fancyvrb" /><a 
 id="x1-184116r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;merging</span><span 
class="pcrr7tn-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-184118r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-184120r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(branch</span><span 
class="pcrr7tn-">&#x00A0;merge,</span><span 
class="pcrr7tn-">&#x00A0;don't</span><span 
class="pcrr7tn-">&#x00A0;forget</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;commit)</span>
<br class="fancyvrb" /><a 
 id="x1-184122r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'merged</span><span 
class="pcrb7t-">&#x00A0;backout</span><span 
class="pcrb7t-">&#x00A0;with</span><span 
class="pcrb7t-">&#x00A0;previous</span><span 
class="pcrb7t-">&#x00A0;tip'</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-184124r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-184126r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-184128r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;third</span><span 
class="pcrr7tn-">&#x00A0;change</span>
   </div>
<!--l. 354--><p class="noindent">Afterwards, the graphical history of our repository looks like figure&#x00A0;<a 
href="#x1-1841294">9.4<!--tex4ht:ref: fig:undo:backout-manual-merge --></a>.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-1841294"></a>
                                                                                         
                                                                                         
<!--l. 359--><p class="noindent"><img 
src="undo-manual-merge.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;9.4: </td><td  
class="content">Manually merging a backout change</td></tr></table><!--tex4ht:label?: x1-1841294 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">9.3.5    </span> <a 
 id="x1-1850009.3.5"></a>Why &#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; works as it does</h4>
<!--l. 366--><p class="noindent">Here&#x2019;s a brief description of how the <a 
 id="dx1-185001"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command works.
     </p><ol  class="enumerate1" >
     <li class="enumerate"><a 
 id="x1-185003x1"></a>It ensures that the working directory is &#x201C;clean&#x201D;, i.e.&#x00A0;that the output of <a 
 id="dx1-185004"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; would be empty.
     </li>
     <li class="enumerate"><a 
 id="x1-185006x2"></a>It remembers the current parent of the working directory. Let&#x2019;s call this changeset <span 
class="pcrr7tn-">orig</span>
     </li>
     <li class="enumerate"><a 
 id="x1-185008x3"></a>It does the equivalent of a <a 
 id="dx1-185009"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span>&#x201D; to sync the working directory to the changeset you want to back out.
     Let&#x2019;s call this changeset <span 
class="pcrr7tn-">backout</span>
     </li>
     <li class="enumerate"><a 
 id="x1-185011x4"></a>It finds the parent of that changeset. Let&#x2019;s call that changeset <span 
class="pcrr7tn-">parent</span>.
     </li>
     <li class="enumerate"><a 
 id="x1-185013x5"></a>For each file that the <span 
class="pcrr7tn-">backout </span>changeset affected, it does the equivalent of a <a 
 id="dx1-185014"></a>&#x201C;<span 
class="pcrr7tn-">hg revert -r parent</span>&#x201D; on that
     file, to restore it to the contents it had before that changeset was committed.
     </li>
     <li class="enumerate"><a 
 id="x1-185016x6"></a>It commits the result as a new changeset. This changeset has <span 
class="pcrr7tn-">backout </span>as its parent.
     </li>
     <li class="enumerate"><a 
 id="x1-185018x7"></a>If you specify <a 
 id="dx1-185019"></a><span 
class="pcrr7tn-">--merge </span>on the command line, it merges with <span 
class="pcrr7tn-">orig</span>, and commits the result of the merge.</li></ol>
<!--l. 387--><p class="indent">   An alternative way to implement the <a 
 id="dx1-185020"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command would be to <a 
 id="dx1-185021"></a>&#x201C;<span 
class="pcrr7tn-">hg export</span>&#x201D; the to-be-backed-out changeset as
a diff, then use the <a 
 id="dx1-185022"></a><span 
class="pcrr7tn-">--reverse </span>option to the <a 
 id="dx1-185023"></a><span 
class="pcrr7tn-">patch </span>command to reverse the effect of the change without fiddling with the
working directory. This sounds much simpler, but it would not work nearly as well.
</p><!--l. 394--><p class="indent">   The reason that <a 
 id="dx1-185024"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; does an update, a commit, a merge, and another commit is to give the merge machinery the
best chance to do a good job when dealing with all the changes <span 
class="ptmri7t-">between </span>the change you&#x2019;re backing out and the current
tip.
</p><!--l. 399--><p class="indent">   If you&#x2019;re backing out a changeset that&#x2019;s&#x00A0;100 revisions back in your project&#x2019;s history, the chances that the <a 
 id="dx1-185025"></a><span 
class="pcrr7tn-">patch</span>
command will be able to apply a reverse diff cleanly are not good, because intervening changes are likely to have
&#x201C;broken the context&#x201D; that <a 
 id="dx1-185026"></a><span 
class="pcrr7tn-">patch </span>uses to determine whether it can apply a patch (if this sounds like gibberish,
see <a 
href="#x1-27300012.4">12.4<!--tex4ht:ref: sec:mq:patch --></a> for a discussion of the <a 
 id="dx1-185027"></a><span 
class="pcrr7tn-">patch </span>command). Also, Mercurial&#x2019;s merge machinery will handle files and
directories being renamed, permission changes, and modifications to binary files, none of which <a 
 id="dx1-185028"></a><span 
class="pcrr7tn-">patch </span>can deal
with.
</p><!--l. 410--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">9.4    </span> <a 
 id="x1-1860009.4"></a>Changes that should never have been</h3>
<!--l. 413--><p class="noindent">Most of the time, the <a 
 id="dx1-186001"></a>&#x201C;<span 
class="pcrr7tn-">hg backout</span>&#x201D; command is exactly what you need if you want to undo the effects of a change. It leaves a
permanent record of exactly what you did, both when committing the original changeset and when you cleaned up after
it.
</p><!--l. 418--><p class="indent">   On rare occasions, though, you may find that you&#x2019;ve committed a change that really should not be present in the repository
at all. For example, it would be very unusual, and usually considered a mistake, to commit a software project&#x2019;s object files as
well as its source files. Object files have almost no intrinsic value, and they&#x2019;re <span 
class="ptmri7t-">big</span>, so they increase the size of the repository and
the amount of time it takes to clone or pull changes.
                                                                                         
                                                                                         
</p><!--l. 426--><p class="indent">   Before I discuss the options that you have if you commit a &#x201C;brown paper bag&#x201D; change (the kind that&#x2019;s so bad that
you want to pull a brown paper bag over your head), let me first discuss some approaches that probably won&#x2019;t
work.
</p><!--l. 431--><p class="indent">   Since Mercurial treats history as accumulative&#x2014;every change builds on top of all changes that preceded it&#x2014;you generally
can&#x2019;t just make disastrous changes disappear. The one exception is when you&#x2019;ve just committed a change, and it hasn&#x2019;t been
pushed or pulled into another repository. That&#x2019;s when you can safely use the <a 
 id="dx1-186002"></a>&#x201C;<span 
class="pcrr7tn-">hg rollback</span>&#x201D; command, as I detailed in
section&#x00A0;<a 
href="#x1-1720009.1.2">9.1.2<!--tex4ht:ref: sec:undo:rollback --></a>.
</p><!--l. 438--><p class="indent">   After you&#x2019;ve pushed a bad change to another repository, you <span 
class="ptmri7t-">could </span>still use <a 
 id="dx1-186003"></a>&#x201C;<span 
class="pcrr7tn-">hg rollback</span>&#x201D; to make your local copy of the
change disappear, but it won&#x2019;t have the consequences you want. The change will still be present in the remote repository, so it
will reappear in your local repository the next time you pull.
</p><!--l. 444--><p class="indent">   If a situation like this arises, and you know which repositories your bad change has propagated into, you can <span 
class="ptmri7t-">try </span>to get
rid of the changeefrom <span 
class="ptmri7t-">every </span>one of those repositories. This is, of course, not a satisfactory solution: if you
miss even a single repository while you&#x2019;re expunging, the change is still &#x201C;in the wild&#x201D;, and could propagate
further.
</p><!--l. 451--><p class="indent">   If you&#x2019;ve committed one or more changes <span 
class="ptmri7t-">after </span>the change that you&#x2019;d like to see disappear, your options are further reduced.
Mercurial doesn&#x2019;t provide a way to &#x201C;punch a hole&#x201D; in history, leaving changesets intact.
</p><!--l. 456--><p class="indent">   XXX This needs filling out. The <span 
class="pcrr7tn-">hg-replay </span>script in the <span 
class="pcrr7tn-">examples </span>directory works, but doesn&#x2019;t handle merge changesets.
Kind of an important omission.
</p><!--l. 460--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.4.1    </span> <a 
 id="x1-1870009.4.1"></a>Protect yourself from &#x201C;escaped&#x201D; changes</h4>
<!--l. 462--><p class="noindent">If you&#x2019;ve committed some changes to your local repository and they&#x2019;ve been pushed or pulled somewhere else, this isn&#x2019;t
necessarily a disaster. You can protect yourself ahead of time against some classes of bad changeset. This is particularly easy if
your team usually pulls changes from a central repository.
</p><!--l. 468--><p class="indent">   By configuring some hooks on that repository to validate incoming changesets (see chapter&#x00A0;<a 
href="#x1-19700010">10<!--tex4ht:ref: chap:hook --></a>), you can automatically
prevent some kinds of bad changeset from being pushed to the central repository at all. With such a configuration in place,
some kinds of bad changeset will naturally tend to &#x201C;die out&#x201D; because they can&#x2019;t propagate into the central repository. Better yet,
this happens without any need for explicit intervention.
</p><!--l. 476--><p class="indent">   For instance, an incoming change hook that verifies that a changeset will actually compile can prevent people from
inadvertantly &#x201C;breaking the build&#x201D;.
</p><!--l. 480--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">9.5    </span> <a 
 id="x1-1880009.5"></a>Finding the source of a bug</h3>
<!--l. 483--><p class="noindent">While it&#x2019;s all very well to be able to back out a changeset that introduced a bug, this requires that you know which changeset to
back out. Mercurial provides an invaluable command, called <a 
 id="dx1-188001"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D;, that helps you to automate this process and
accomplish it very efficiently.
</p><!--l. 489--><p class="indent">   The idea behind the <a 
 id="dx1-188002"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command is that a changeset has introduced some change of behaviour that you can
identify with a simple binary test. You don&#x2019;t know which piece of code introduced the change, but you know how to test for the
presence of the bug. The <a 
 id="dx1-188003"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command uses your test to direct its search for the changeset that introduced the code
that caused the bug.
</p><!--l. 496--><p class="indent">   Here are a few scenarios to help you understand how you might apply this command. </p>
     <ul><li><span class="dt">
     </span><span class="dd">The most recent version of your software has a bug that you remember wasn&#x2019;t present a few weeks ago, but you
     don&#x2019;t know when it was introduced. Here, your binary test checks for the presence of that bug.
                                                                                         
                                                                                         
     </span><li><span class="dt">
     </span><span class="dd">You fixed a bug in a rush, and now it&#x2019;s time to close the entry in your team&#x2019;s bug database. The bug database
     requires a changeset ID when you close an entry, but you don&#x2019;t remember which changeset you fixed the bug in.
     Once again, your binary test checks for the presence of the bug.
     </span><li><span class="dt">
     </span><span class="dd">Your software works correctly, but runs&#x00A0;15% slower than the last time you measured it. You want to know which
     changeset introduced the performance regression. In this case, your binary test measures the performance of
     your software, to see whether it&#x2019;s &#x201C;fast&#x201D; or &#x201C;slow&#x201D;.
     </span><li><span class="dt">
     </span><span class="dd">The sizes of the components of your project that you ship exploded recently, and you suspect that something
     changed in the way you build your project.</li></ul>
<!--l. 518--><p class="indent">   From these examples, it should be clear that the <a 
 id="dx1-188004"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command is not useful only for finding the sources of bugs.
You can use it to find any &#x201C;emergent property&#x201D; of a repository (anything that you can&#x2019;t find from a simple text search of the files
in the tree) for which you can write a binary test.
</p><!--l. 524--><p class="indent">   We&#x2019;ll introduce a little bit of terminology here, just to make it clear which parts of the search process are your
responsibility, and which are Mercurial&#x2019;s. A <span 
class="ptmri7t-">test </span>is something that <span 
class="ptmri7t-">you </span>run when <a 
 id="dx1-188005"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; chooses a changeset. A <span 
class="ptmri7t-">probe </span>is
what <a 
 id="dx1-188006"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; runs to tell whether a revision is good. Finally, we&#x2019;ll use the word &#x201C;bisect&#x201D;, as both a noun and a verb, to
stand in for the phrase &#x201C;search using the <a 
 id="dx1-188007"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command.
</p><!--l. 532--><p class="indent">   One simple way to automate the searching process would be simply to probe every changeset. However, this scales poorly.
If it took ten minutes to test a single changeset, and you had 10,000 changesets in your repository, the exhaustive approach
would take on average&#x00A0;35 <span 
class="ptmri7t-">days </span>to find the changeset that introduced a bug. Even if you knew that the bug was introduced by
one of the last 500 changesets, and limited your search to those, you&#x2019;d still be looking at over 40 hours to find the changeset that
introduced your bug.
</p><!--l. 541--><p class="indent">   What the <a 
 id="dx1-188008"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command does is use its knowledge of the &#x201C;shape&#x201D; of your project&#x2019;s revision history to perform a
search in time proportional to the <span 
class="ptmri7t-">logarithm </span>of the number of changesets to check (the kind of search it performs is called a
dichotomic search). With this approach, searching through 10,000 changesets will take less than three hours, even at ten
minutes per test (the search will require about 14 tests). Limit your search to the last hundred changesets, and it will take only
about an hour (roughly seven tests).
</p><!--l. 550--><p class="indent">   The <a 
 id="dx1-188009"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command is aware of the &#x201C;branchy&#x201D; nature of a Mercurial project&#x2019;s revision history, so it has no
problems dealing with branches, merges, or multiple heads in a repoository. It can prune entire branches of history with a single
probe, which is how it operates so efficiently.
</p><!--l. 556--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.5.1    </span> <a 
 id="x1-1890009.5.1"></a>Using the &#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command</h4>
<!--l. 558--><p class="noindent">Here&#x2019;s an example of <a 
 id="dx1-189001"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; in action.
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:   </span>In  versions  0.9.5  and  earlier  of  Mercurial,  &#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D;  was  not  a  core
command: it was distributed with Mercurial as an extension. This section describes
the built-in command, not the old extension.                                                             </div>
<!--l. 566--><p class="indent">   Now let&#x2019;s create a repository, so that we can try out the <a 
 id="dx1-189003"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command in isolation.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-189005r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;mybug</span>
<br class="fancyvrb" /><a 
 id="x1-189007r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;mybug</span>
   </div>
<!--l. 569--><p class="noindent">We&#x2019;ll simulate a project that has a bug in it in a simple-minded way: create trivial changes in a loop, and nominate one specific
change that will have the &#x201C;bug&#x201D;. This loop creates 35 changesets, each adding a single file to the repository. We&#x2019;ll represent our
&#x201C;bug&#x201D; with a file that contains the text &#x201C;i have a gub&#x201D;.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-189009r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">buggy_change=22</span>
<br class="fancyvrb" /><a 
 id="x1-189011r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">for</span><span 
class="pcrb7t-">&#x00A0;((</span><span 
class="pcrb7t-">&#x00A0;i</span><span 
class="pcrb7t-">&#x00A0;=</span><span 
class="pcrb7t-">&#x00A0;0;</span><span 
class="pcrb7t-">&#x00A0;i</span><span 
class="pcrb7t-">&#x00A0;&#x003c;</span><span 
class="pcrb7t-">&#x00A0;35;</span><span 
class="pcrb7t-">&#x00A0;i++</span><span 
class="pcrb7t-">&#x00A0;));</span><span 
class="pcrb7t-">&#x00A0;do</span>
<br class="fancyvrb" /><a 
 id="x1-189013r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;if</span><span 
class="pcrb7t-">&#x00A0;[[</span><span 
class="pcrb7t-">&#x00A0;$i</span><span 
class="pcrb7t-">&#x00A0;=</span><span 
class="pcrb7t-">&#x00A0;$buggy_change</span><span 
class="pcrb7t-">&#x00A0;]];</span><span 
class="pcrb7t-">&#x00A0;then</span>
<br class="fancyvrb" /><a 
 id="x1-189015r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;echo</span><span 
class="pcrb7t-">&#x00A0;'i</span><span 
class="pcrb7t-">&#x00A0;have</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;gub'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile$i</span>
<br class="fancyvrb" /><a 
 id="x1-189017r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-q</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'buggy</span><span 
class="pcrb7t-">&#x00A0;changeset'</span>
<br class="fancyvrb" /><a 
 id="x1-189019r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;else</span>
<br class="fancyvrb" /><a 
 id="x1-189021r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;echo</span><span 
class="pcrb7t-">&#x00A0;'nothing</span><span 
class="pcrb7t-">&#x00A0;to</span><span 
class="pcrb7t-">&#x00A0;see</span><span 
class="pcrb7t-">&#x00A0;here,</span><span 
class="pcrb7t-">&#x00A0;move</span><span 
class="pcrb7t-">&#x00A0;along'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;myfile$i</span>
<br class="fancyvrb" /><a 
 id="x1-189023r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-q</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'normal</span><span 
class="pcrb7t-">&#x00A0;changeset'</span>
<br class="fancyvrb" /><a 
 id="x1-189025r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;fi</span>
<br class="fancyvrb" /><a 
 id="x1-189027r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">done</span>
   </div>
<!--l. 576--><p class="indent">   The next thing that we&#x2019;d like to do is figure out how to use the <a 
 id="dx1-189028"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command. We can use Mercurial&#x2019;s normal
built-in help mechanism for this.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-189030r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;help</span><span 
class="pcrb7t-">&#x00A0;bisect</span>
<br class="fancyvrb" /><a 
 id="x1-189032r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;[help|init|reset|next|good|bad]</span>
<br class="fancyvrb" /><a 
 id="x1-189034r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-189036r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;extension:</span><span 
class="pcrr7tn-">&#x00A0;dichotomic</span><span 
class="pcrr7tn-">&#x00A0;search</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;DAG</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-189038r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;subcommands</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;"hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;help"</span>
   </div>
<!--l. 581--><p class="indent">   The <a 
 id="dx1-189039"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command works in steps. Each step proceeds as follows.
     </p><ol  class="enumerate1" >
     <li class="enumerate"><a 
 id="x1-189041x1"></a>You run your binary test.
         <ul><li><span class="dt">
         </span><span class="dd">If the test succeeded, you tell <a 
 id="dx1-189042"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; by running the <a 
 id="dx1-189043"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect good</span>&#x201D; command.
         </span><li><span class="dt">
         </span><span class="dd">If it failed, run the <a 
 id="dx1-189044"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect --bad</span>&#x201D; command.</li></ul>
     </li>
     <li class="enumerate"><a 
 id="x1-189046x2"></a>The command uses your information to decide which changeset to test next.
     </li>
     <li class="enumerate"><a 
 id="x1-189048x3"></a>It updates the working directory to that changeset, and the process begins again.</li></ol>
<!--l. 594--><p class="noindent">The process ends when <a 
 id="dx1-189049"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; identifies a unique changeset that marks the point where your test transitioned from
&#x201C;succeeding&#x201D; to &#x201C;failing&#x201D;.
</p><!--l. 598--><p class="indent">   To start the search, we must run the <a 
 id="dx1-189050"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect --reset</span>&#x201D; command.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-189052r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;bisect</span><span 
class="pcrb7t-">&#x00A0;--init</span>
<br class="fancyvrb" /><a 
 id="x1-189054r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect:</span><span 
class="pcrr7tn-">&#x00A0;option</span><span 
class="pcrr7tn-">&#x00A0;--init</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;recognized</span>
<br class="fancyvrb" /><a 
 id="x1-189056r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;[help|init|reset|next|good|bad]</span>
<br class="fancyvrb" /><a 
 id="x1-189058r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-189060r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;extension:</span><span 
class="pcrr7tn-">&#x00A0;dichotomic</span><span 
class="pcrr7tn-">&#x00A0;search</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;DAG</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-189062r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;subcommands</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;"hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;help"</span>
   </div>
                                                                                         
                                                                                         
<!--l. 601--><p class="indent">   In our case, the binary test we use is simple: we check to see if any file in the repository contains the string &#x201C;i have a gub&#x201D;.
If it does, this changeset contains the change that &#x201C;caused the bug&#x201D;. By convention, a changeset that has the property we&#x2019;re
searching for is &#x201C;bad&#x201D;, while one that doesn&#x2019;t is &#x201C;good&#x201D;.
</p><!--l. 607--><p class="indent">   Most of the time, the revision to which the working directory is synced (usually the tip) already exhibits the problem
introduced by the buggy change, so we&#x2019;ll mark it as &#x201C;bad&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-189064r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;bisect</span><span 
class="pcrb7t-">&#x00A0;--bad</span>
<br class="fancyvrb" /><a 
 id="x1-189066r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect:</span><span 
class="pcrr7tn-">&#x00A0;option</span><span 
class="pcrr7tn-">&#x00A0;--bad</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;recognized</span>
<br class="fancyvrb" /><a 
 id="x1-189068r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;[help|init|reset|next|good|bad]</span>
<br class="fancyvrb" /><a 
 id="x1-189070r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-189072r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;extension:</span><span 
class="pcrr7tn-">&#x00A0;dichotomic</span><span 
class="pcrr7tn-">&#x00A0;search</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;DAG</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-189074r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;subcommands</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;"hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;help"</span>
   </div>
<!--l. 612--><p class="indent">   Our next task is to nominate a changeset that we know <span 
class="ptmri7t-">doesn&#x2019;t </span>have the bug; the <a 
 id="dx1-189075"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command will &#x201C;bracket&#x201D; its
search between the first pair of good and bad changesets. In our case, we know that revision&#x00A0;10 didn&#x2019;t have the bug. (I&#x2019;ll have
more words about choosing the first &#x201C;good&#x201D; changeset later.)
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-189077r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;bisect</span><span 
class="pcrb7t-">&#x00A0;--good</span><span 
class="pcrb7t-">&#x00A0;10</span>
<br class="fancyvrb" /><a 
 id="x1-189079r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect:</span><span 
class="pcrr7tn-">&#x00A0;option</span><span 
class="pcrr7tn-">&#x00A0;--good</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;recognized</span>
<br class="fancyvrb" /><a 
 id="x1-189081r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;[help|init|reset|next|good|bad]</span>
<br class="fancyvrb" /><a 
 id="x1-189083r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-189085r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;extension:</span><span 
class="pcrr7tn-">&#x00A0;dichotomic</span><span 
class="pcrr7tn-">&#x00A0;search</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;DAG</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-189087r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;subcommands</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;"hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;help"</span>
   </div>
<!--l. 619--><p class="indent">   Notice that this command printed some output. </p>
     <ul><li><span class="dt">
     </span><span class="dd">It told us how many changesets it must consider before it can identify the one that introduced the bug, and how
     many tests that will require.
     </span><li><span class="dt">
     </span><span class="dd">It updated the working directory to the next changeset to test, and told us which changeset it&#x2019;s testing.</li></ul>
<!--l. 628--><p class="indent">   We now run our test in the working directory. We use the <a 
 id="dx1-189088"></a><span 
class="pcrr7tn-">grep </span>command to see if our &#x201C;bad&#x201D; file is present in the working
directory. If it is, this revision is bad; if not, this revision is good.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-189090r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">if</span><span 
class="pcrb7t-">&#x00A0;grep</span><span 
class="pcrb7t-">&#x00A0;-q</span><span 
class="pcrb7t-">&#x00A0;'i</span><span 
class="pcrb7t-">&#x00A0;have</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;gub'</span><span 
class="pcrb7t-">&#x00A0;&#x22C6;</span>
<br class="fancyvrb" /><a 
 id="x1-189092r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">then</span>
<br class="fancyvrb" /><a 
 id="x1-189094r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;result=bad</span>
<br class="fancyvrb" /><a 
 id="x1-189096r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">else</span>
<br class="fancyvrb" /><a 
 id="x1-189098r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;result=good</span>
<br class="fancyvrb" /><a 
 id="x1-189100r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">fi</span>
<br class="fancyvrb" /><a 
 id="x1-189102r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;this</span><span 
class="pcrb7t-">&#x00A0;revision</span><span 
class="pcrb7t-">&#x00A0;is</span><span 
class="pcrb7t-">&#x00A0;$result</span>
<br class="fancyvrb" /><a 
 id="x1-189104r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;this</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;bad</span>
<br class="fancyvrb" /><a 
 id="x1-189106r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;bisect</span><span 
class="pcrb7t-">&#x00A0;--$result</span>
<br class="fancyvrb" /><a 
 id="x1-189108r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect:</span><span 
class="pcrr7tn-">&#x00A0;option</span><span 
class="pcrr7tn-">&#x00A0;--bad</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;recognized</span>
<br class="fancyvrb" /><a 
 id="x1-189110r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;[help|init|reset|next|good|bad]</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-189112r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-189114r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;extension:</span><span 
class="pcrr7tn-">&#x00A0;dichotomic</span><span 
class="pcrr7tn-">&#x00A0;search</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;DAG</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-189116r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;subcommands</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;"hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;help"</span>
   </div>
<!--l. 634--><p class="indent">   This test looks like a perfect candidate for automation, so let&#x2019;s turn it into a shell function.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-189118r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">mytest()</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span>
<br class="fancyvrb" /><a 
 id="x1-189120r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;if</span><span 
class="pcrb7t-">&#x00A0;grep</span><span 
class="pcrb7t-">&#x00A0;-q</span><span 
class="pcrb7t-">&#x00A0;'i</span><span 
class="pcrb7t-">&#x00A0;have</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;gub'</span><span 
class="pcrb7t-">&#x00A0;&#x22C6;</span>
<br class="fancyvrb" /><a 
 id="x1-189122r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;then</span>
<br class="fancyvrb" /><a 
 id="x1-189124r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;result=bad</span>
<br class="fancyvrb" /><a 
 id="x1-189126r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;else</span>
<br class="fancyvrb" /><a 
 id="x1-189128r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;result=good</span>
<br class="fancyvrb" /><a 
 id="x1-189130r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;fi</span>
<br class="fancyvrb" /><a 
 id="x1-189132r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;echo</span><span 
class="pcrb7t-">&#x00A0;this</span><span 
class="pcrb7t-">&#x00A0;revision</span><span 
class="pcrb7t-">&#x00A0;is</span><span 
class="pcrb7t-">&#x00A0;$result</span>
<br class="fancyvrb" /><a 
 id="x1-189134r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="pcrb7t-">&#x00A0;hg</span><span 
class="pcrb7t-">&#x00A0;bisect</span><span 
class="pcrb7t-">&#x00A0;--$result</span>
<br class="fancyvrb" /><a 
 id="x1-189136r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">}</span>
   </div>
<!--l. 637--><p class="noindent">We can now run an entire test step with a single command, <span 
class="pcrr7tn-">mytest</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-189138r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">mytest</span>
<br class="fancyvrb" /><a 
 id="x1-189140r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;this</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;bad</span>
<br class="fancyvrb" /><a 
 id="x1-189142r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect:</span><span 
class="pcrr7tn-">&#x00A0;option</span><span 
class="pcrr7tn-">&#x00A0;--bad</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;recognized</span>
<br class="fancyvrb" /><a 
 id="x1-189144r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;[help|init|reset|next|good|bad]</span>
<br class="fancyvrb" /><a 
 id="x1-189146r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-189148r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;extension:</span><span 
class="pcrr7tn-">&#x00A0;dichotomic</span><span 
class="pcrr7tn-">&#x00A0;search</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;DAG</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-189150r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;subcommands</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;"hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;help"</span>
   </div>
<!--l. 640--><p class="noindent">A few more invocations of our canned test step command, and we&#x2019;re done.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-189152r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">mytest</span>
<br class="fancyvrb" /><a 
 id="x1-189154r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;this</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;bad</span>
<br class="fancyvrb" /><a 
 id="x1-189156r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect:</span><span 
class="pcrr7tn-">&#x00A0;option</span><span 
class="pcrr7tn-">&#x00A0;--bad</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;recognized</span>
<br class="fancyvrb" /><a 
 id="x1-189158r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;[help|init|reset|next|good|bad]</span>
<br class="fancyvrb" /><a 
 id="x1-189160r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-189162r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;extension:</span><span 
class="pcrr7tn-">&#x00A0;dichotomic</span><span 
class="pcrr7tn-">&#x00A0;search</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;DAG</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-189164r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;subcommands</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;"hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;help"</span>
<br class="fancyvrb" /><a 
 id="x1-189166r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">mytest</span>
<br class="fancyvrb" /><a 
 id="x1-189168r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;this</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;bad</span>
<br class="fancyvrb" /><a 
 id="x1-189170r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect:</span><span 
class="pcrr7tn-">&#x00A0;option</span><span 
class="pcrr7tn-">&#x00A0;--bad</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;recognized</span>
<br class="fancyvrb" /><a 
 id="x1-189172r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;[help|init|reset|next|good|bad]</span>
<br class="fancyvrb" /><a 
 id="x1-189174r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-189176r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;extension:</span><span 
class="pcrr7tn-">&#x00A0;dichotomic</span><span 
class="pcrr7tn-">&#x00A0;search</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;DAG</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-189178r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;subcommands</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;"hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;help"</span>
<br class="fancyvrb" /><a 
 id="x1-189180r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">mytest</span>
<br class="fancyvrb" /><a 
 id="x1-189182r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;this</span><span 
class="pcrr7tn-">&#x00A0;revision</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;bad</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-189184r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect:</span><span 
class="pcrr7tn-">&#x00A0;option</span><span 
class="pcrr7tn-">&#x00A0;--bad</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;recognized</span>
<br class="fancyvrb" /><a 
 id="x1-189186r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;[help|init|reset|next|good|bad]</span>
<br class="fancyvrb" /><a 
 id="x1-189188r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-189190r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;extension:</span><span 
class="pcrr7tn-">&#x00A0;dichotomic</span><span 
class="pcrr7tn-">&#x00A0;search</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;DAG</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-189192r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;subcommands</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;"hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;help"</span>
   </div>
<!--l. 644--><p class="indent">   Even though we had&#x00A0;40 changesets to search through, the <a 
 id="dx1-189193"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command let us find the changeset that introduced
our &#x201C;bug&#x201D; with only five tests. Because the number of tests that the <a 
 id="dx1-189194"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command grows logarithmically with the
number of changesets to search, the advantage that it has over the &#x201C;brute force&#x201D; search approach increases with every changeset
you add.
</p><!--l. 651--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.5.2    </span> <a 
 id="x1-1900009.5.2"></a>Cleaning up after your search</h4>
<!--l. 653--><p class="noindent">When you&#x2019;re finished using the <a 
 id="dx1-190001"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command in a repository, you can use the <a 
 id="dx1-190002"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect reset</span>&#x201D; command to drop
the information it was using to drive your search. The command doesn&#x2019;t use much space, so it doesn&#x2019;t matter if you forget to
run this command. However, <a 
 id="dx1-190003"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; won&#x2019;t let you start a new search in that repository until you do a <a 
 id="dx1-190004"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>
<span 
class="pcrr7tn-">reset</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-190006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;bisect</span><span 
class="pcrb7t-">&#x00A0;--reset</span>
<br class="fancyvrb" /><a 
 id="x1-190008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect:</span><span 
class="pcrr7tn-">&#x00A0;option</span><span 
class="pcrr7tn-">&#x00A0;--reset</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;recognized</span>
<br class="fancyvrb" /><a 
 id="x1-190010r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;[help|init|reset|next|good|bad]</span>
<br class="fancyvrb" /><a 
 id="x1-190012r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-190014r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;extension:</span><span 
class="pcrr7tn-">&#x00A0;dichotomic</span><span 
class="pcrr7tn-">&#x00A0;search</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;DAG</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-190016r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;subcommands</span><span 
class="pcrr7tn-">&#x00A0;see</span><span 
class="pcrr7tn-">&#x00A0;"hg</span><span 
class="pcrr7tn-">&#x00A0;bisect</span><span 
class="pcrr7tn-">&#x00A0;help"</span>
   </div>
<!--l. 661--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">9.6    </span> <a 
 id="x1-1910009.6"></a>Tips for finding bugs effectively</h3>
<!--l. 663--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.6.1    </span> <a 
 id="x1-1920009.6.1"></a>Give consistent input</h4>
<!--l. 665--><p class="noindent">The <a 
 id="dx1-192001"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command requires that you correctly report the result of every test you perform. If you tell it that a test failed
when it really succeeded, it <span 
class="ptmri7t-">might </span>be able to detect the inconsistency. If it can identify an inconsistency in your reports, it will
tell you that a particular changeset is both good and bad. However, it can&#x2019;t do this perfectly; it&#x2019;s about as likely to report the
wrong changeset as the source of the bug.
</p><!--l. 673--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.6.2    </span> <a 
 id="x1-1930009.6.2"></a>Automate as much as possible</h4>
                                                                                         
                                                                                         
<!--l. 675--><p class="noindent">When I started using the <a 
 id="dx1-193001"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command, I tried a few times to run my tests by hand, on the command line. This is an
approach that I, at least, am not suited to. After a few tries, I found that I was making enough mistakes that I was having to
restart my searches several times before finally getting correct results.
</p><!--l. 681--><p class="indent">   My initial problems with driving the <a 
 id="dx1-193002"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command by hand occurred even with simple searches on small
repositories; if the problem you&#x2019;re looking for is more subtle, or the number of tests that <a 
 id="dx1-193003"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; must perform increases,
the likelihood of operator error ruining the search is much higher. Once I started automating my tests, I had much better
results.
</p><!--l. 688--><p class="indent">   The key to automated testing is twofold: </p>
     <ul><li><span class="dt">
     </span><span class="dd">always test for the same symptom, and
     </span><li><span class="dt">
     </span><span class="dd">always feed consistent input to the <a 
 id="dx1-193004"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command.</li></ul>
<!--l. 693--><p class="noindent">In my tutorial example above, the <a 
 id="dx1-193005"></a><span 
class="pcrr7tn-">grep </span>command tests for the symptom, and the <span 
class="pcrr7tn-">if </span>statement takes the result of this check and
ensures that we always feed the same input to the <a 
 id="dx1-193006"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command. The <span 
class="pcrr7tn-">mytest </span>function marries these together in a
reproducible way, so that every test is uniform and consistent.
</p><!--l. 699--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.6.3    </span> <a 
 id="x1-1940009.6.3"></a>Check your results</h4>
<!--l. 701--><p class="noindent">Because the output of a <a 
 id="dx1-194001"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; search is only as good as the input you give it, don&#x2019;t take the changeset it reports as the
absolute truth. A simple way to cross-check its report is to manually run your test at each of the following changesets:
</p>
     <ul><li><span class="dt">
     </span><span class="dd">The changeset that it reports as the first bad revision. Your test should still report this as bad.
     </span><li><span class="dt">
     </span><span class="dd">The parent of that changeset (either parent, if it&#x2019;s a merge). Your test should report this changeset as good.
     </span><li><span class="dt">
     </span><span class="dd">A child of that changeset. Your test should report this changeset as bad.</li></ul>
<!--l. 714--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.6.4    </span> <a 
 id="x1-1950009.6.4"></a>Beware interference between bugs</h4>
<!--l. 716--><p class="noindent">It&#x2019;s possible that your search for one bug could be disrupted by the presence of another. For example, let&#x2019;s say your
software crashes at revision 100, and worked correctly at revision 50. Unknown to you, someone else introduced a
different crashing bug at revision 60, and fixed it at revision 80. This could distort your results in one of several
ways.
</p><!--l. 723--><p class="indent">   It is possible that this other bug completely &#x201C;masks&#x201D; yours, which is to say that it occurs before your bug has a chance to
manifest itself. If you can&#x2019;t avoid that other bug (for example, it prevents your project from building), and so can&#x2019;t tell whether
your bug is present in a particular changeset, the <a 
 id="dx1-195001"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; command cannot help you directly. Instead, you can mark a
changeset as untested by running <a 
 id="dx1-195002"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect --skip</span>&#x201D;.
</p><!--l. 731--><p class="indent">   A different problem could arise if your test for a bug&#x2019;s presence is not specific enough. If you check for &#x201C;my program
crashes&#x201D;, then both your crashing bug and an unrelated crashing bug that masks it will look like the same thing, and mislead
<a 
 id="dx1-195003"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D;.
                                                                                         
                                                                                         
</p><!--l. 736--><p class="indent">   Another useful situation in which to use <a 
 id="dx1-195004"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect --skip</span>&#x201D; is if you can&#x2019;t test a revision because your project was in a
broken and hence untestable state at that revision, perhaps because someone checked in a change that prevented the project
from building.
</p><!--l. 741--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.6.5    </span> <a 
 id="x1-1960009.6.5"></a>Bracket your search lazily</h4>
<!--l. 743--><p class="noindent">Choosing the first &#x201C;good&#x201D; and &#x201C;bad&#x201D; changesets that will mark the end points of your search is often easy, but it bears a little
discussion nevertheless. From the perspective of <a 
 id="dx1-196001"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D;, the &#x201C;newest&#x201D; changeset is conventionally &#x201C;bad&#x201D;, and the older
changeset is &#x201C;good&#x201D;.
</p><!--l. 749--><p class="indent">   If you&#x2019;re having trouble remembering when a suitable &#x201C;good&#x201D; change was, so that you can tell <a 
 id="dx1-196002"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D;, you could do
worse than testing changesets at random. Just remember to eliminate contenders that can&#x2019;t possibly exhibit the bug (perhaps
because the feature with the bug isn&#x2019;t present yet) and those where another problem masks the bug (as I discussed
above).
</p><!--l. 756--><p class="indent">   Even if you end up &#x201C;early&#x201D; by thousands of changesets or months of history, you will only add a handful of tests to the total
number that <a 
 id="dx1-196003"></a>&#x201C;<span 
class="pcrr7tn-">hg bisect</span>&#x201D; must perform, thanks to its logarithmic behaviour.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
</p>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;10</span><br /><a 
 id="x1-19700010"></a>Handling repository events with hooks</h2>
<!--l. 4--><p class="noindent">Mercurial offers a powerful mechanism to let you perform automated actions in response to events that occur in a repository. In
some cases, you can even control Mercurial&#x2019;s response to those events.
</p><!--l. 8--><p class="indent">   The name Mercurial uses for one of these actions is a <span 
class="ptmri7t-">hook</span>. Hooks are called &#x201C;triggers&#x201D; in some revision control systems,
but the two names refer to the same idea.
</p>
   <h3 class="sectionHead"><span class="titlemark">10.1    </span> <a 
 id="x1-19800010.1"></a>An overview of hooks in Mercurial</h3>
<!--l. 14--><p class="noindent">Here is a brief list of the hooks that Mercurial supports. We will revisit each of these hooks in more detail later, in
section&#x00A0;<a 
href="#x1-23100010.8">10.8<!--tex4ht:ref: sec:hook:ref --></a>.
</p>
     <ul><li><span class="dt">
<a 
 id="dx1-198001"></a><a 
 id="dx1-198002"></a><span 
class="pcrr7tn-x-x-90">changegroup</span> </span><span class="dd">This is run after a group of changesets has been brought into the repository from elsewhere.
     </span><li><span class="dt">
<a 
 id="dx1-198003"></a><a 
 id="dx1-198004"></a><span 
class="pcrr7tn-x-x-90">commit</span> </span><span class="dd">This is run after a new changeset has been created in the local repository.
     </span><li><span class="dt">
<a 
 id="dx1-198005"></a><a 
 id="dx1-198006"></a><span 
class="pcrr7tn-x-x-90">incoming</span> </span><span class="dd">This is run once for each new changeset that is brought into the repository from elsewhere. Notice the difference
     from <a 
 id="dx1-198007"></a><a 
 id="dx1-198008"></a><span 
class="pcrr7tn-">changegroup</span>, which is run once per <span 
class="ptmri7t-">group </span>of changesets brought in.
     </span><li><span class="dt">
<a 
 id="dx1-198009"></a><a 
 id="dx1-198010"></a><span 
class="pcrr7tn-x-x-90">outgoing</span> </span><span class="dd">This is run after a group of changesets has been transmitted from this repository.
     </span><li><span class="dt">
<a 
 id="dx1-198011"></a><a 
 id="dx1-198012"></a><span 
class="pcrr7tn-x-x-90">prechangegroup</span> </span><span class="dd">This is run before starting to bring a group of changesets into the repository.
     </span><li><span class="dt">
<a 
 id="dx1-198013"></a><a 
 id="dx1-198014"></a><span 
class="pcrr7tn-x-x-90">precommit</span> </span><span class="dd">Controlling. This is run before starting a commit.
     </span><li><span class="dt">
<a 
 id="dx1-198015"></a><a 
 id="dx1-198016"></a><span 
class="pcrr7tn-x-x-90">preoutgoing</span> </span><span class="dd">Controlling. This is run before starting to transmit a group of changesets from this repository.
     </span><li><span class="dt">
<a 
 id="dx1-198017"></a><a 
 id="dx1-198018"></a><span 
class="pcrr7tn-x-x-90">pretag</span> </span><span class="dd">Controlling. This is run before creating a tag.
     </span><li><span class="dt">
<a 
 id="dx1-198019"></a><a 
 id="dx1-198020"></a><span 
class="pcrr7tn-x-x-90">pretxnchangegroup</span> </span><span class="dd">Controlling. This is run after a group of changesets has been brought into the local repository from another, but
     before the transaction completes that will make the changes permanent in the repository.
     </span><li><span class="dt">
<a 
 id="dx1-198021"></a><a 
 id="dx1-198022"></a><span 
class="pcrr7tn-x-x-90">pretxncommit</span> </span><span class="dd">Controlling. This is run after a new changeset has been created in the local repository, but before the transaction
     completes that will make it permanent.
     </span><li><span class="dt">
<a 
 id="dx1-198023"></a><a 
 id="dx1-198024"></a><span 
class="pcrr7tn-x-x-90">preupdate</span> </span><span class="dd">Controlling. This is run before starting an update or merge of the working directory.
     </span><li><span class="dt">
 <a 
 id="dx1-198025"></a><a 
 id="dx1-198026"></a><span 
class="pcrr7tn-x-x-90">tag</span> </span><span class="dd">This is run after a tag is created.
     </span><li><span class="dt">
<a 
 id="dx1-198027"></a><a 
 id="dx1-198028"></a><span 
class="pcrr7tn-x-x-90">update</span> </span><span class="dd">This is run after an update or merge of the working directory has finished.</li></ul>
                                                                                         
                                                                                         
<!--l. 49--><p class="noindent">Each of the hooks whose description begins with the word &#x201C;Controlling&#x201D; has the ability to determine whether an activity can
proceed. If the hook succeeds, the activity may proceed; if it fails, the activity is either not permitted or undone, depending on
the hook.
</p><!--l. 54--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">10.2    </span> <a 
 id="x1-19900010.2"></a>Hooks and security</h3>
<!--l. 56--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.2.1    </span> <a 
 id="x1-20000010.2.1"></a>Hooks are run with your privileges</h4>
<!--l. 58--><p class="noindent">When you run a Mercurial command in a repository, and the command causes a hook to run, that hook runs on <span 
class="ptmri7t-">your </span>system,
under <span 
class="ptmri7t-">your </span>user account, with <span 
class="ptmri7t-">your </span>privilege level. Since hooks are arbitrary pieces of executable code, you should treat them
with an appropriate level of suspicion. Do not install a hook unless you are confident that you know who created it and what it
does.
</p><!--l. 65--><p class="indent">   In some cases, you may be exposed to hooks that you did not install yourself. If you work with Mercurial on an unfamiliar
system, Mercurial will run hooks defined in that system&#x2019;s global <a 
 id="dx1-200001"></a><a 
 id="dx1-200002"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file.
</p><!--l. 69--><p class="indent">   If you are working with a repository owned by another user, Mercurial can run hooks defined in that user&#x2019;s
repository, but it will still run them as &#x201C;you&#x201D;. For example, if you <a 
 id="dx1-200003"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; from that repository, and its <a 
 id="dx1-200004"></a><span 
class="pcrr7tn-">.hg/hgrc</span>
defines a local <a 
 id="dx1-200005"></a><a 
 id="dx1-200006"></a><span 
class="pcrr7tn-">outgoing </span>hook, that hook will run under your user account, even though you don&#x2019;t own that
repository.
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:  </span>This only applies if you are pulling from a repository on a local or network
filesystem. If you&#x2019;re pulling over http or ssh, any <span 
class="pcrr7tn-">outgoing </span>hook will run under
whatever account is executing the server process, on the server.                               </div>
<!--l. 83--><p class="indent">   XXX To see what hooks are defined in a repository, use the <a 
 id="dx1-200009"></a>&#x201C;<span 
class="pcrr7tn-">hg config hooks</span>&#x201D; command. If you are working in one
repository, but talking to another that you do not own (e.g.&#x00A0;using <a 
 id="dx1-200010"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; or <a 
 id="dx1-200011"></a>&#x201C;<span 
class="pcrr7tn-">hg incoming</span>&#x201D;), remember that it is the other
repository&#x2019;s hooks you should be checking, not your own.
</p><!--l. 89--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.2.2    </span> <a 
 id="x1-20100010.2.2"></a>Hooks do not propagate</h4>
<!--l. 91--><p class="noindent">In Mercurial, hooks are not revision controlled, and do not propagate when you clone, or pull from, a repository. The reason for
this is simple: a hook is a completely arbitrary piece of executable code. It runs under your user identity, with your privilege
level, on your machine.
</p><!--l. 97--><p class="indent">   It would be extremely reckless for any distributed revision control system to implement revision-controlled
hooks, as this would offer an easily exploitable way to subvert the accounts of users of the revision control
system.
</p><!--l. 102--><p class="indent">   Since Mercurial does not propagate hooks, if you are collaborating with other people on a common project, you should not
assume that they are using the same Mercurial hooks as you are, or that theirs are correctly configured. You should document
the hooks you expect people to use.
</p><!--l. 108--><p class="indent">   In a corporate intranet, this is somewhat easier to control, as you can for example provide a &#x201C;standard&#x201D; installation of
Mercurial on an NFS filesystem, and use a site-wide <a 
 id="dx1-201001"></a><a 
 id="dx1-201002"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file to define hooks that all users will see. However, this too has its
limits; see below.
                                                                                         
                                                                                         
</p><!--l. 113--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.2.3    </span> <a 
 id="x1-20200010.2.3"></a>Hooks can be overridden</h4>
<!--l. 115--><p class="noindent">Mercurial allows you to override a hook definition by redefining the hook. You can disable it by setting its value to the empty
string, or change its behaviour as you wish.
</p><!--l. 119--><p class="indent">   If you deploy a system-&#x00A0;or site-wide <a 
 id="dx1-202001"></a><a 
 id="dx1-202002"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file that defines some hooks, you should thus understand that your users can
disable or override those hooks.
</p><!--l. 123--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.2.4    </span> <a 
 id="x1-20300010.2.4"></a>Ensuring that critical hooks are run</h4>
<!--l. 125--><p class="noindent">Sometimes you may want to enforce a policy that you do not want others to be able to work around. For example, you may
have a requirement that every changeset must pass a rigorous set of tests. Defining this requirement via a hook in a site-wide
<a 
 id="dx1-203001"></a><a 
 id="dx1-203002"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;won&#x2019;t work for remote users on laptops, and of course local users can subvert it at will by overriding the
hook.
</p><!--l. 132--><p class="indent">   Instead, you can set up your policies for use of Mercurial so that people are expected to propagate changes through a
well-known &#x201C;canonical&#x201D; server that you have locked down and configured appropriately.
</p><!--l. 137--><p class="indent">   One way to do this is via a combination of social engineering and technology. Set up a restricted-access account; users can
push changes over the network to repositories managed by this account, but they cannot log into the account and run
normal shell commands. In this scenario, a user can commit a changeset that contains any old garbage they
want.
</p><!--l. 144--><p class="indent">   When someone pushes a changeset to the server that everyone pulls from, the server will test the changeset before it accepts
it as permanent, and reject it if it fails to pass the test suite. If people only pull changes from this filtering server, it will serve to
ensure that all changes that people pull have been automatically vetted.
</p><!--l. 151--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">10.3    </span> <a 
 id="x1-20400010.3"></a>Care with <span 
class="pcrr7tn-">pretxn </span>hooks in a shared-access repository</h3>
<!--l. 153--><p class="noindent">If you want to use hooks to do some automated work in a repository that a number of people have shared access to, you need to
be careful in how you do this.
</p><!--l. 157--><p class="indent">   Mercurial only locks a repository when it is writing to the repository, and only the parts of Mercurial that write to the
repository pay attention to locks. Write locks are necessary to prevent multiple simultaneous writers from scribbling on each
other&#x2019;s work, corrupting the repository.
</p><!--l. 163--><p class="indent">   Because Mercurial is careful with the order in which it reads and writes data, it does not need to acquire a lock when it
wants to read data from the repository. The parts of Mercurial that read from the repository never pay attention to locks. This
lockless reading scheme greatly increases performance and concurrency.
</p><!--l. 169--><p class="indent">   With great performance comes a trade-off, though, one which has the potential to cause you trouble unless you&#x2019;re aware of
it. To describe this requires a little detail about how Mercurial adds changesets to a repository and reads those
changes.
</p><!--l. 174--><p class="indent">   When Mercurial <span 
class="ptmri7t-">writes </span>metadata, it writes it straight into the destination file. It writes file data first, then manifest data
(which contains pointers to the new file data), then changelog data (which contains pointers to the new manifest data).
Before the first write to each file, it stores a record of where the end of the file was in its transaction log. If the
transaction must be rolled back, Mercurial simply truncates each file back to the size it was before the transaction
began.
</p><!--l. 183--><p class="indent">   When Mercurial <span 
class="ptmri7t-">reads </span>metadata, it reads the changelog first, then everything else. Since a reader will only
access parts of the manifest or file metadata that it can see in the changelog, it can never see partially written
data.
</p><!--l. 188--><p class="indent">   Some controlling hooks (<a 
 id="dx1-204001"></a><a 
 id="dx1-204002"></a><span 
class="pcrr7tn-">pretxncommit </span>and <a 
 id="dx1-204003"></a><a 
 id="dx1-204004"></a><span 
class="pcrr7tn-">pretxnchangegroup</span>) run when a transaction is almost complete. All of the
metadata has been written, but Mercurial can still roll the transaction back and cause the newly-written data to
                                                                                         
                                                                                         
disappear.
</p><!--l. 193--><p class="indent">   If one of these hooks runs for long, it opens a window of time during which a reader can see the metadata for changesets
that are not yet permanent, and should not be thought of as &#x201C;really there&#x201D;. The longer the hook runs, the longer that window is
open.
</p><!--l. 198--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.3.1    </span> <a 
 id="x1-20500010.3.1"></a>The problem illustrated</h4>
<!--l. 200--><p class="noindent">In principle, a good use for the <a 
 id="dx1-205001"></a><a 
 id="dx1-205002"></a><span 
class="pcrr7tn-">pretxnchangegroup </span>hook would be to automatically build and test incoming
changes before they are accepted into a central repository. This could let you guarantee that nobody can push
changes to this repository that &#x201C;break the build&#x201D;. But if a client can pull changes while they&#x2019;re being tested, the
usefulness of the test is zero; an unsuspecting someone can pull untested changes, potentially breaking their
build.
</p><!--l. 208--><p class="indent">   The safest technological answer to this challenge is to set up such a &#x201C;gatekeeper&#x201D; repository as <span 
class="ptmri7t-">unidirectional</span>. Let it take
changes pushed in from the outside, but do not allow anyone to pull changes from it (use the <a 
 id="dx1-205003"></a><a 
 id="dx1-205004"></a><span 
class="pcrr7tn-">preoutgoing </span>hook to lock it
down). Configure a <a 
 id="dx1-205005"></a><a 
 id="dx1-205006"></a><span 
class="pcrr7tn-">changegroup </span>hook so that if a build or test succeeds, the hook will push the new changes out to another
repository that people <span 
class="ptmri7t-">can </span>pull from.
</p><!--l. 216--><p class="indent">   In practice, putting a centralised bottleneck like this in place is not often a good idea, and transaction visibility has nothing
to do with the problem. As the size of a project&#x2014;and the time it takes to build and test&#x2014;grows, you rapidly run into a wall with
this &#x201C;try before you buy&#x201D; approach, where you have more changesets to test than time in which to deal with them. The
inevitable result is frustration on the part of all involved.
</p><!--l. 224--><p class="indent">   An approach that scales better is to get people to build and test before they push, then run automated builds and tests
centrally <span 
class="ptmri7t-">after </span>a push, to be sure all is well. The advantage of this approach is that it does not impose a limit on the rate at which
the repository can accept changes.
</p><!--l. 230--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">10.4    </span> <a 
 id="x1-20600010.4"></a>A short tutorial on using hooks</h3>
<!--l. 233--><p class="noindent">It is easy to write a Mercurial hook. Let&#x2019;s start with a hook that runs when you finish a <a 
 id="dx1-206001"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D;, and simply prints the hash
of the changeset you just created. The hook is called <a 
 id="dx1-206002"></a><a 
 id="dx1-206003"></a><span 
class="pcrr7tn-">commit</span>.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2060261"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-206005r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;hook-test</span>
<br class="fancyvrb" /><a 
 id="x1-206007r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;hook-test</span>
<br class="fancyvrb" /><a 
 id="x1-206009r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'[hooks]'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;.hg/hgrc</span>
<br class="fancyvrb" /><a 
 id="x1-206011r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'commit</span><span 
class="pcrb7t-">&#x00A0;=</span><span 
class="pcrb7t-">&#x00A0;echo</span><span 
class="pcrb7t-">&#x00A0;committed</span><span 
class="pcrb7t-">&#x00A0;$HG_NODE'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;.hg/hgrc</span>
<br class="fancyvrb" /><a 
 id="x1-206013r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;.hg/hgrc</span>
<br class="fancyvrb" /><a 
 id="x1-206015r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[hooks]</span>
<br class="fancyvrb" /><a 
 id="x1-206017r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;commit</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;echo</span><span 
class="pcrr7tn-">&#x00A0;committed</span><span 
class="pcrr7tn-">&#x00A0;$HG_NODE</span>
<br class="fancyvrb" /><a 
 id="x1-206019r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-206021r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-206023r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'testing</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;hook'</span>
<br class="fancyvrb" /><a 
 id="x1-206025r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;committed</span><span 
class="pcrr7tn-">&#x00A0;3212b7e2c7b416a53c2fcd4d1ad1be5130fb858a</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;10.1: </td><td  
class="content">A simple hook that runs when a changeset is committed</td></tr></table><!--tex4ht:label?: x1-2060261 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 243--><p class="indent">   All hooks follow the pattern in example&#x00A0;<a 
href="#x1-2060261">10.1<!--tex4ht:ref: ex:hook:init --></a>. You add an entry to the <a 
 id="dx1-206027"></a><span 
class="pcrr7tn-">[hooks] </span>section of your <a 
 id="dx1-206028"></a><a 
 id="dx1-206029"></a><span 
class="pcrr7tn-">hgrc</span>&#x022E;n the left is the name
of the event to trigger on; on the right is the action to take. As you can see, you can run an arbitrary shell command in a
hook. Mercurial passes extra information to the hook using environment variables (look for <a 
 id="dx1-206030"></a><a 
 id="dx1-206031"></a><span 
class="pcrr7tn-">HG</span><span 
class="pcrr7tn-">_NODE </span>in the
example).
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.4.1    </span> <a 
 id="x1-20700010.4.1"></a>Performing multiple actions per event</h4>
<!--l. 252--><p class="noindent">Quite often, you will want to define more than one hook for a particular kind of event, as shown in example&#x00A0;<a 
href="#x1-2070112">10.2<!--tex4ht:ref: ex:hook:ext --></a>. Mercurial
lets you do this by adding an <span 
class="ptmri7t-">extension </span>to the end of a hook&#x2019;s name. You extend a hook&#x2019;s name by giving the name of the hook,
followed by a full stop (the &#x201C;<span 
class="pcrr7tn-">.</span>&#x201D; character), followed by some more text of your choosing. For example, Mercurial will run both
<span 
class="pcrr7tn-">commit.foo </span>and <span 
class="pcrr7tn-">commit.bar </span>when the <span 
class="pcrr7tn-">commit </span>event occurs.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2070112"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-207002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'commit.when</span><span 
class="pcrb7t-">&#x00A0;=</span><span 
class="pcrb7t-">&#x00A0;echo</span><span 
class="pcrb7t-">&#x00A0;-n</span><span 
class="pcrb7t-">&#x00A0;"date</span><span 
class="pcrb7t-">&#x00A0;of</span><span 
class="pcrb7t-">&#x00A0;commit:</span><span 
class="pcrb7t-">&#x00A0;";</span><span 
class="pcrb7t-">&#x00A0;date'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;.hg/hgrc</span>
<br class="fancyvrb" /><a 
 id="x1-207004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-207006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'i</span><span 
class="pcrb7t-">&#x00A0;have</span><span 
class="pcrb7t-">&#x00A0;two</span><span 
class="pcrb7t-">&#x00A0;hooks'</span>
<br class="fancyvrb" /><a 
 id="x1-207008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;committed</span><span 
class="pcrr7tn-">&#x00A0;8e425330f4995086949356c62d262189dde1bbb1</span>
<br class="fancyvrb" /><a 
 id="x1-207010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;commit:</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:17</span><span 
class="pcrr7tn-">&#x00A0;GMT</span><span 
class="pcrr7tn-">&#x00A0;2008</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;10.2: </td><td  
class="content">Defining a second <a 
 id="dx1-207012"></a><a 
 id="dx1-207013"></a><span 
class="pcrr7tn-">commit </span>hook</td></tr></table><!--tex4ht:label?: x1-2070112 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 267--><p class="indent">   To give a well-defined order of execution when there are multiple hooks defined for an event, Mercurial sorts hooks by
extension, and executes the hook commands in this sorted order. In the above example, it will execute <span 
class="pcrr7tn-">commit.bar </span>before
<span 
class="pcrr7tn-">commit.foo</span>, and <span 
class="pcrr7tn-">commit </span>before both.
</p><!--l. 273--><p class="indent">   It is a good idea to use a somewhat descriptive extension when you define a new hook. This will help you to remember what
the hook was for. If the hook fails, you&#x2019;ll get an error message that contains the hook name and extension, so using a
descriptive extension could give you an immediate hint as to why the hook failed (see section&#x00A0;<a 
href="#x1-20800010.4.2">10.4.2<!--tex4ht:ref: sec:hook:perm --></a> for an
example).
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.4.2    </span> <a 
 id="x1-20800010.4.2"></a>Controlling whether an activity can proceed</h4>
<!--l. 283--><p class="noindent">In our earlier examples, we used the <a 
 id="dx1-208001"></a><a 
 id="dx1-208002"></a><span 
class="pcrr7tn-">commit </span>hook, which is run after a commit has completed. This is one of
several Mercurial hooks that run after an activity finishes. Such hooks have no way of influencing the activity
itself.
</p><!--l. 288--><p class="indent">   Mercurial defines a number of events that occur before an activity starts; or after it starts, but before it finishes.
Hooks that trigger on these events have the added ability to choose whether the activity can continue, or will
abort.
</p><!--l. 293--><p class="indent">   The <a 
 id="dx1-208003"></a><a 
 id="dx1-208004"></a><span 
class="pcrr7tn-">pretxncommit </span>hook runs after a commit has all but completed. In other words, the metadata representing the
changeset has been written out to disk, but the transaction has not yet been allowed to complete. The <a 
 id="dx1-208005"></a><a 
 id="dx1-208006"></a><span 
class="pcrr7tn-">pretxncommit </span>hook has
the ability to decide whether the transaction can complete, or must be rolled back.
</p><!--l. 299--><p class="indent">   If the <a 
 id="dx1-208007"></a><a 
 id="dx1-208008"></a><span 
class="pcrr7tn-">pretxncommit </span>hook exits with a status code of zero, the transaction is allowed to complete; the commit finishes; and
the <a 
 id="dx1-208009"></a><a 
 id="dx1-208010"></a><span 
class="pcrr7tn-">commit </span>hook is run. If the <a 
 id="dx1-208011"></a><a 
 id="dx1-208012"></a><span 
class="pcrr7tn-">pretxncommit </span>hook exits with a non-zero status code, the transaction is rolled back; the
metadata representing the changeset is erased; and the <a 
 id="dx1-208013"></a><a 
 id="dx1-208014"></a><span 
class="pcrr7tn-">commit </span>hook is not run.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2080413"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-208016r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;check_bug_id</span>
<br class="fancyvrb" /><a 
 id="x1-208018r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#!/bin/sh</span>
<br class="fancyvrb" /><a 
 id="x1-208020r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;check</span><span 
class="pcrr7tn-">&#x00A0;that</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;commit</span><span 
class="pcrr7tn-">&#x00A0;comment</span><span 
class="pcrr7tn-">&#x00A0;mentions</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;numeric</span><span 
class="pcrr7tn-">&#x00A0;bug</span><span 
class="pcrr7tn-">&#x00A0;id</span>
<br class="fancyvrb" /><a 
 id="x1-208022r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;log</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;$1</span><span 
class="pcrr7tn-">&#x00A0;--template</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">desc</span><span 
class="cmsy-10">}</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;grep</span><span 
class="pcrr7tn-">&#x00A0;-q</span><span 
class="pcrr7tn-">&#x00A0;"</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">&#x003c;bug</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;[0-9]"</span>
<br class="fancyvrb" /><a 
 id="x1-208024r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'pretxncommit.bug_id_required</span><span 
class="pcrb7t-">&#x00A0;=</span><span 
class="pcrb7t-">&#x00A0;./check_bug_id</span><span 
class="pcrb7t-">&#x00A0;$HG_NODE'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;.hg/hgrc</span>
<br class="fancyvrb" /><a 
 id="x1-208026r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-208028r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'i</span><span 
class="pcrb7t-">&#x00A0;am</span><span 
class="pcrb7t-">&#x00A0;not</span><span 
class="pcrb7t-">&#x00A0;mentioning</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;bug</span><span 
class="pcrb7t-">&#x00A0;id'</span>
<br class="fancyvrb" /><a 
 id="x1-208030r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;pretxncommit.bug_id_required</span><span 
class="pcrr7tn-">&#x00A0;hook</span><span 
class="pcrr7tn-">&#x00A0;exited</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;status</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-208032r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;transaction</span><span 
class="pcrr7tn-">&#x00A0;abort!</span>
<br class="fancyvrb" /><a 
 id="x1-208034r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;rollback</span><span 
class="pcrr7tn-">&#x00A0;completed</span>
<br class="fancyvrb" /><a 
 id="x1-208036r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'i</span><span 
class="pcrb7t-">&#x00A0;refer</span><span 
class="pcrb7t-">&#x00A0;you</span><span 
class="pcrb7t-">&#x00A0;to</span><span 
class="pcrb7t-">&#x00A0;bug</span><span 
class="pcrb7t-">&#x00A0;666'</span>
<br class="fancyvrb" /><a 
 id="x1-208038r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;committed</span><span 
class="pcrr7tn-">&#x00A0;fe3046c9381d79b16ac00cf55491272a2e3a12af</span>
<br class="fancyvrb" /><a 
 id="x1-208040r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;commit:</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:17</span><span 
class="pcrr7tn-">&#x00A0;GMT</span><span 
class="pcrr7tn-">&#x00A0;2008</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;10.3: </td><td  
class="content">Using the <a 
 id="dx1-208042"></a><a 
 id="dx1-208043"></a><span 
class="pcrr7tn-">pretxncommit </span>hook to control commits</td></tr></table><!--tex4ht:label?: x1-2080413 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 312--><p class="indent">   The hook in example&#x00A0;<a 
href="#x1-2080413">10.3<!--tex4ht:ref: ex:hook:pretxncommit --></a> checks that a commit comment contains a bug ID. If it does, the commit can complete. If not,
the commit is rolled back.
</p>
   <h3 class="sectionHead"><span class="titlemark">10.5    </span> <a 
 id="x1-20900010.5"></a>Writing your own hooks</h3>
<!--l. 318--><p class="noindent">When you are writing a hook, you might find it useful to run Mercurial either with the <a 
 id="dx1-209001"></a><span 
class="pcrr7tn-">-v </span>option, or the <a 
 id="dx1-209002"></a><span 
class="pcrr7tn-">verbose </span>config item set
to &#x201C;true&#x201D;. When you do so, Mercurial will print a message before it calls each hook.
</p><!--l. 323--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.5.1    </span> <a 
 id="x1-21000010.5.1"></a>Choosing how your hook should run</h4>
<!--l. 326--><p class="noindent">You can write a hook either as a normal program&#x2014;typically a shell script&#x2014;or as a Python function that is executed within the
Mercurial process.
</p><!--l. 330--><p class="indent">   Writing a hook as an external program has the advantage that it requires no knowledge of Mercurial&#x2019;s internals. You can
call normal Mercurial commands to get any added information you need. The trade-off is that external hooks are slower than
in-process hooks.
</p><!--l. 335--><p class="indent">   An in-process Python hook has complete access to the Mercurial API, and does not &#x201C;shell out&#x201D; to another process, so it is
inherently faster than an external hook. It is also easier to obtain much of the information that a hook requires by using the
Mercurial API than by running Mercurial commands.
</p><!--l. 341--><p class="indent">   If you are comfortable with Python, or require high performance, writing your hooks in Python may be a good choice.
However, when you have a straightforward hook to write and you don&#x2019;t need to care about performance (probably the majority
of hooks), a shell script is perfectly fine.
</p><!--l. 347--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.5.2    </span> <a 
 id="x1-21100010.5.2"></a>Hook parameters</h4>
<!--l. 350--><p class="noindent">Mercurial calls each hook with a set of well-defined parameters. In Python, a parameter is passed as a keyword argument to
your hook function. For an external program, a parameter is passed as an environment variable.
</p><!--l. 355--><p class="indent">   Whether your hook is written in Python or as a shell script, the hook-specific parameter names and values will be the same.
A boolean parameter will be represented as a boolean value in Python, but as the number 1 (for &#x201C;true&#x201D;) or 0 (for
&#x201C;false&#x201D;) as an environment variable for an external hook. If a hook parameter is named <span 
class="pcrr7tn-">foo</span>, the keyword argument
for a Python hook will also be named <span 
class="pcrr7tn-">foo</span>, while the environment variable for an external hook will be named
<span 
class="pcrr7tn-">HG</span><span 
class="pcrr7tn-">_FOO</span>.
</p><!--l. 364--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.5.3    </span> <a 
 id="x1-21200010.5.3"></a>Hook return values and activity control</h4>
<!--l. 366--><p class="noindent">A hook that executes successfully must exit with a status of zero if external, or return boolean &#x201C;false&#x201D; if in-process. Failure is
indicated with a non-zero exit status from an external hook, or an in-process hook returning boolean &#x201C;true&#x201D;. If an in-process
hook raises an exception, the hook is considered to have failed.
</p><!--l. 372--><p class="indent">   For a hook that controls whether an activity can proceed, zero/false means &#x201C;allow&#x201D;, while non-zero/true/exception means
&#x201C;deny&#x201D;.
                                                                                         
                                                                                         
</p><!--l. 375--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.5.4    </span> <a 
 id="x1-21300010.5.4"></a>Writing an external hook</h4>
<!--l. 377--><p class="noindent">When you define an external hook in your <a 
 id="dx1-213001"></a><a 
 id="dx1-213002"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;and the hook is run, its value is passed to your shell, which interprets it. This
means that you can use normal shell constructs in the body of the hook.
</p><!--l. 381--><p class="indent">   An executable hook is always run with its current directory set to a repository&#x2019;s root directory.
</p><!--l. 384--><p class="indent">   Each hook parameter is passed in as an environment variable; the name is upper-cased, and prefixed with the string
&#x201C;<span 
class="pcrr7tn-">HG</span><span 
class="pcrr7tn-">_</span>&#x201D;.
</p><!--l. 387--><p class="indent">   With the exception of hook parameters, Mercurial does not set or modify any environment variables when running a hook.
This is useful to remember if you are writing a site-wide hook that may be run by a number of different users with differing
environment variables set. In multi-user situations, you should not rely on environment variables being set to the values you
have in your environment when testing the hook.
</p><!--l. 395--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.5.5    </span> <a 
 id="x1-21400010.5.5"></a>Telling Mercurial to use an in-process hook</h4>
<!--l. 397--><p class="noindent">The <a 
 id="dx1-214001"></a><a 
 id="dx1-214002"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;syntax for defining an in-process hook is slightly different than for an executable hook. The value of the hook must
start with the text &#x201C;<span 
class="pcrr7tn-">python:</span>&#x201D;, and continue with the fully-qualified name of a callable object to use as the hook&#x2019;s
value.
</p><!--l. 402--><p class="indent">   The module in which a hook lives is automatically imported when a hook is run. So long as you have the module name and
<a 
 id="dx1-214003"></a><a 
 id="dx1-214004"></a><span 
class="pcrr7tn-">PYTHONPATH </span>right, it should &#x201C;just work&#x201D;.
</p><!--l. 406--><p class="indent">   The following <a 
 id="dx1-214005"></a><a 
 id="dx1-214006"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;example snippet illustrates the syntax and meaning of the notions we just described.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-214008r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[hooks]</span>
<br class="fancyvrb" /><a 
 id="x1-214010r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;commit.example</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;python:mymodule.submodule.myhook</span>
   </div>
<!--l. 412--><p class="noindent">When Mercurial runs the <span 
class="pcrr7tn-">commit.example </span>hook, it imports <span 
class="pcrr7tn-">mymodule.submodule</span>, looks for the callable object named <span 
class="pcrr7tn-">myhook</span>,
and calls it.
</p><!--l. 416--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.5.6    </span> <a 
 id="x1-21500010.5.6"></a>Writing an in-process hook</h4>
<!--l. 418--><p class="noindent">The simplest in-process hook does nothing, but illustrates the basic shape of the hook API:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-215002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;def</span><span 
class="pcrr7tn-">&#x00A0;myhook(ui,</span><span 
class="pcrr7tn-">&#x00A0;repo,</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;kwargs):</span>
<br class="fancyvrb" /><a 
 id="x1-215004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pass</span>
   </div>
<!--l. 424--><p class="noindent">The first argument to a Python hook is always a <a 
 id="dx1-215005"></a><span 
class="pcrr7tn-">mercurial.ui.ui </span>object. The second is a repository object; at the moment, it is
always an instance of <a 
 id="dx1-215006"></a><span 
class="pcrr7tn-">mercurial.localrepo.localrepository</span>. Following these two arguments are other keyword
arguments. Which ones are passed in depends on the hook being called, but a hook can ignore arguments it doesn&#x2019;t care about
by dropping them into a keyword argument dict, as with <span 
class="pcrr7tn-">&#x22C6;&#x22C6;kwargs </span>above.
                                                                                         
                                                                                         
</p><!--l. 433--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">10.6    </span> <a 
 id="x1-21600010.6"></a>Some hook examples</h3>
<!--l. 435--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.6.1    </span> <a 
 id="x1-21700010.6.1"></a>Writing meaningful commit messages</h4>
<!--l. 437--><p class="noindent">It&#x2019;s hard to imagine a useful commit message being very short. The simple <a 
 id="dx1-217001"></a><a 
 id="dx1-217002"></a><span 
class="pcrr7tn-">pretxncommit </span>hook of figure&#x00A0;<a 
href="#x1-2170234">10.4<!--tex4ht:ref: ex:hook:msglen.go --></a> will prevent you
from committing a changeset with a message that is less than ten bytes long.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2170234"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-217004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;.hg/hgrc</span>
<br class="fancyvrb" /><a 
 id="x1-217006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[hooks]</span>
<br class="fancyvrb" /><a 
 id="x1-217008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pretxncommit.msglen</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;test</span><span 
class="pcrr7tn-">&#x00A0;&#x2018;hg</span><span 
class="pcrr7tn-">&#x00A0;tip</span><span 
class="pcrr7tn-">&#x00A0;--template</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">desc</span><span 
class="cmsy-10">}</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;wc</span><span 
class="pcrr7tn-">&#x00A0;-c&#x2018;</span><span 
class="pcrr7tn-">&#x00A0;-ge</span><span 
class="pcrr7tn-">&#x00A0;10</span>
<br class="fancyvrb" /><a 
 id="x1-217010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-217012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-217014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'too</span><span 
class="pcrb7t-">&#x00A0;short'</span>
<br class="fancyvrb" /><a 
 id="x1-217016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;pretxncommit.msglen</span><span 
class="pcrr7tn-">&#x00A0;hook</span><span 
class="pcrr7tn-">&#x00A0;exited</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;status</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-217018r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;transaction</span><span 
class="pcrr7tn-">&#x00A0;abort!</span>
<br class="fancyvrb" /><a 
 id="x1-217020r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;rollback</span><span 
class="pcrr7tn-">&#x00A0;completed</span>
<br class="fancyvrb" /><a 
 id="x1-217022r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'long</span><span 
class="pcrb7t-">&#x00A0;enough'</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;10.4: </td><td  
class="content">A hook that forbids overly short commit messages</td></tr></table><!--tex4ht:label?: x1-2170234 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">10.6.2    </span> <a 
 id="x1-21800010.6.2"></a>Checking for trailing whitespace</h4>
<!--l. 450--><p class="noindent">An interesting use of a commit-related hook is to help you to write cleaner code. A simple example of &#x201C;cleaner code&#x201D; is the
dictum that a change should not add any new lines of text that contain &#x201C;trailing whitespace&#x201D;. Trailing whitespace is a series of
space and tab characters at the end of a line of text. In most cases, trailing whitespace is unnecessary, invisible noise, but it is
occasionally problematic, and people often prefer to get rid of it.
</p><!--l. 458--><p class="indent">   You can use either the <a 
 id="dx1-218001"></a><a 
 id="dx1-218002"></a><span 
class="pcrr7tn-">precommit </span>or <a 
 id="dx1-218003"></a><a 
 id="dx1-218004"></a><span 
class="pcrr7tn-">pretxncommit </span>hook to tell whether you have a trailing whitespace problem. If you
use the <a 
 id="dx1-218005"></a><a 
 id="dx1-218006"></a><span 
class="pcrr7tn-">precommit </span>hook, the hook will not know which files you are committing, so it will have to check every modified file in
the repository for trailing white space. If you want to commit a change to just the file <span 
class="pcrr7tn-">foo</span>, but the file <span 
class="pcrr7tn-">bar </span>contains trailing
whitespace, doing a check in the <a 
 id="dx1-218007"></a><a 
 id="dx1-218008"></a><span 
class="pcrr7tn-">precommit </span>hook will prevent you from committing <span 
class="pcrr7tn-">foo </span>due to the problem with <span 
class="pcrr7tn-">bar</span>. This
doesn&#x2019;t seem right.
</p><!--l. 468--><p class="indent">   Should you choose the <a 
 id="dx1-218009"></a><a 
 id="dx1-218010"></a><span 
class="pcrr7tn-">pretxncommit </span>hook, the check won&#x2019;t occur until just before the transaction for the commit
completes. This will allow you to check for problems only the exact files that are being committed. However, if you entered the
commit message interactively and the hook fails, the transaction will roll back; you&#x2019;ll have to re-enter the commit message after
you fix the trailing whitespace and run <a 
 id="dx1-218011"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; again.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2180345"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-218013r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;.hg/hgrc</span>
<br class="fancyvrb" /><a 
 id="x1-218015r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[hooks]</span>
<br class="fancyvrb" /><a 
 id="x1-218017r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pretxncommit.whitespace</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;export</span><span 
class="pcrr7tn-">&#x00A0;tip</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;(!</span><span 
class="pcrr7tn-">&#x00A0;egrep</span><span 
class="pcrr7tn-">&#x00A0;-q</span><span 
class="pcrr7tn-">&#x00A0;'&#x0302;</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">+.&#x22C6;[</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">t]$')</span>
<br class="fancyvrb" /><a 
 id="x1-218019r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'a</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-218021r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'test</span><span 
class="pcrb7t-">&#x00A0;with</span><span 
class="pcrb7t-">&#x00A0;trailing</span><span 
class="pcrb7t-">&#x00A0;whitespace'</span>
<br class="fancyvrb" /><a 
 id="x1-218023r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-218025r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;pretxncommit.whitespace</span><span 
class="pcrr7tn-">&#x00A0;hook</span><span 
class="pcrr7tn-">&#x00A0;exited</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;status</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-218027r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;transaction</span><span 
class="pcrr7tn-">&#x00A0;abort!</span>
<br class="fancyvrb" /><a 
 id="x1-218029r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;rollback</span><span 
class="pcrr7tn-">&#x00A0;completed</span>
<br class="fancyvrb" /><a 
 id="x1-218031r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'a'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-218033r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'drop</span><span 
class="pcrb7t-">&#x00A0;trailing</span><span 
class="pcrb7t-">&#x00A0;whitespace</span><span 
class="pcrb7t-">&#x00A0;and</span><span 
class="pcrb7t-">&#x00A0;try</span><span 
class="pcrb7t-">&#x00A0;again'</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;10.5: </td><td  
class="content">A simple hook that checks for trailing whitespace</td></tr></table><!--tex4ht:label?: x1-2180345 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 482--><p class="indent">   Figure&#x00A0;<a 
href="#x1-2180345">10.5<!--tex4ht:ref: ex:hook:ws.simple --></a> introduces a simple <a 
 id="dx1-218035"></a><a 
 id="dx1-218036"></a><span 
class="pcrr7tn-">pretxncommit </span>hook that checks for trailing whitespace. This hook is short,
but not very helpful. It exits with an error status if a change adds a line with trailing whitespace to any file,
but does not print any information that might help us to identify the offending file or line. It also has the nice
property of not paying attention to unmodified lines; only lines that introduce new trailing whitespace cause
problems.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2180716"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-218038r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;.hg/hgrc</span>
<br class="fancyvrb" /><a 
 id="x1-218040r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[hooks]</span>
<br class="fancyvrb" /><a 
 id="x1-218042r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pretxncommit.whitespace</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;.hg/check_whitespace.py</span>
<br class="fancyvrb" /><a 
 id="x1-218044r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'a</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-218046r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'add</span><span 
class="pcrb7t-">&#x00A0;new</span><span 
class="pcrb7t-">&#x00A0;line</span><span 
class="pcrb7t-">&#x00A0;with</span><span 
class="pcrb7t-">&#x00A0;trailing</span><span 
class="pcrb7t-">&#x00A0;whitespace'</span>
<br class="fancyvrb" /><a 
 id="x1-218048r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;a,</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;2:</span><span 
class="pcrr7tn-">&#x00A0;trailing</span><span 
class="pcrr7tn-">&#x00A0;whitespace</span><span 
class="pcrr7tn-">&#x00A0;added</span>
<br class="fancyvrb" /><a 
 id="x1-218050r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;commit</span><span 
class="pcrr7tn-">&#x00A0;message</span><span 
class="pcrr7tn-">&#x00A0;saved</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;.hg/commit.save</span>
<br class="fancyvrb" /><a 
 id="x1-218052r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;pretxncommit.whitespace</span><span 
class="pcrr7tn-">&#x00A0;hook</span><span 
class="pcrr7tn-">&#x00A0;exited</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;status</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-218054r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;transaction</span><span 
class="pcrr7tn-">&#x00A0;abort!</span>
<br class="fancyvrb" /><a 
 id="x1-218056r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;rollback</span><span 
class="pcrr7tn-">&#x00A0;completed</span>
<br class="fancyvrb" /><a 
 id="x1-218058r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">sed</span><span 
class="pcrb7t-">&#x00A0;-i</span><span 
class="pcrb7t-">&#x00A0;'s,</span><span 
class="pcrb7t-">&#x00A0;&#x22C6;$,,'</span><span 
class="pcrb7t-">&#x00A0;a</span>
<br class="fancyvrb" /><a 
 id="x1-218060r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-A</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'trimmed</span><span 
class="pcrb7t-">&#x00A0;trailing</span><span 
class="pcrb7t-">&#x00A0;whitespace'</span>
<br class="fancyvrb" /><a 
 id="x1-218062r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;a,</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;2:</span><span 
class="pcrr7tn-">&#x00A0;trailing</span><span 
class="pcrr7tn-">&#x00A0;whitespace</span><span 
class="pcrr7tn-">&#x00A0;added</span>
<br class="fancyvrb" /><a 
 id="x1-218064r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;commit</span><span 
class="pcrr7tn-">&#x00A0;message</span><span 
class="pcrr7tn-">&#x00A0;saved</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;.hg/commit.save</span>
<br class="fancyvrb" /><a 
 id="x1-218066r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;pretxncommit.whitespace</span><span 
class="pcrr7tn-">&#x00A0;hook</span><span 
class="pcrr7tn-">&#x00A0;exited</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;status</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-218068r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;transaction</span><span 
class="pcrr7tn-">&#x00A0;abort!</span>
<br class="fancyvrb" /><a 
 id="x1-218070r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;rollback</span><span 
class="pcrr7tn-">&#x00A0;completed</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;10.6: </td><td  
class="content">A better trailing whitespace hook</td></tr></table><!--tex4ht:label?: x1-2180716 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 497--><p class="indent">   The example of figure&#x00A0;<a 
href="#x1-2180716">10.6<!--tex4ht:ref: ex:hook:ws.better --></a> is much more complex, but also more useful. It parses a unified diff to see if any lines add
trailing whitespace, and prints the name of the file and the line number of each such occurrence. Even better, if the change adds
trailing whitespace, this hook saves the commit comment and prints the name of the save file before exiting and telling
Mercurial to roll the transaction back, so you can use <a 
 id="dx1-218072"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span> <a 
 id="dx1-218073"></a><span 
class="pcrr7tn-">-l</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrro7t-">filename</span>&#x201D; to reuse the saved commit message once
you&#x2019;ve corrected the problem.
</p><!--l. 507--><p class="indent">   As a final aside, note in figure&#x00A0;<a 
href="#x1-2180716">10.6<!--tex4ht:ref: ex:hook:ws.better --></a> the use of <a 
 id="dx1-218074"></a><span 
class="pcrr7tn-">perl</span>&#x2019;s in-place editing feature to get rid of trailing whitespace from a file.
This is concise and useful enough that I will reproduce it here.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-218076r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;perl</span><span 
class="pcrr7tn-">&#x00A0;-pi</span><span 
class="pcrr7tn-">&#x00A0;-e</span><span 
class="pcrr7tn-">&#x00A0;'s,</span><br class="newline" /><span 
class="pcrr7tn-">s+$,,'</span><span 
class="pcrr7tn-">&#x00A0;filename</span>
   </div>
   <h3 class="sectionHead"><span class="titlemark">10.7    </span> <a 
 id="x1-21900010.7"></a>Bundled hooks</h3>
<!--l. 517--><p class="noindent">Mercurial ships with several bundled hooks. You can find them in the <span 
class="pcrr7tn-">hgext </span>directory of a Mercurial source tree. If you are
using a Mercurial binary package, the hooks will be located in the <span 
class="pcrr7tn-">hgext </span>directory of wherever your package installer put
Mercurial.
</p><!--l. 523--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.7.1    </span> <a 
 id="x1-22000010.7.1"></a><span 
class="pcrr7tn-">acl</span>&#x2014;access control for parts of a repository</h4>
<!--l. 525--><p class="noindent">The <a 
 id="dx1-220001"></a><span 
class="pcrr7tn-">acl </span>extension lets you control which remote users are allowed to push changesets to a networked server. You can protect
any portion of a repository (including the entire repo), so that a specific remote user can push changes that do not affect the
protected portion.
</p><!--l. 531--><p class="indent">   This extension implements access control based on the identity of the user performing a push, <span 
class="ptmri7t-">not </span>on who committed the
changesets they&#x2019;re pushing. It makes sense to use this hook only if you have a locked-down server environment that
authenticates remote users, and you want to be sure that only specific users are allowed to push changes to that
server.
</p><!--l. 538--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-22100010.7.1"></a>Configuring the <span 
class="pcrr7tn-">acl </span>hook</h5>
<!--l. 540--><p class="noindent">In order to manage incoming changesets, the <a 
 id="dx1-221001"></a><span 
class="pcrr7tn-">acl </span>hook must be used as a <a 
 id="dx1-221002"></a><a 
 id="dx1-221003"></a><span 
class="pcrr7tn-">pretxnchangegroup </span>hook. This lets it see which files
are modified by each incoming changeset, and roll back a group of changesets if they modify &#x201C;forbidden&#x201D; files.
Example:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-221005r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[hooks]</span>
<br class="fancyvrb" /><a 
 id="x1-221007r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pretxnchangegroup.acl</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;python:hgext.acl.hook</span>
   </div>
<!--l. 549--><p class="indent">   The <a 
 id="dx1-221008"></a><span 
class="pcrr7tn-">acl </span>extension is configured using three sections.
</p><!--l. 551--><p class="indent">   The <a 
 id="dx1-221009"></a><span 
class="pcrr7tn-">[acl] </span>section has only one entry, <a 
 id="dx1-221010"></a><span 
class="pcrr7tn-">sources</span>, which lists the sources of incoming changesets that the hook should pay
attention to. You don&#x2019;t normally need to configure this section. </p>
     <ul><li><span class="dt">
<a 
 id="dx1-221011"></a><span 
class="pcrr7tn-">serve</span> </span><span class="dd">Control incoming changesets that are arriving from a remote repository over http or ssh. This is the default value
     of <a 
 id="dx1-221012"></a><span 
class="pcrr7tn-">sources</span>, and usually the only setting you&#x2019;ll need for this configuration item.
                                                                                         
                                                                                         
     </span><li><span class="dt">
<a 
 id="dx1-221013"></a><span 
class="pcrr7tn-">pull</span> </span><span class="dd">Control incoming changesets that are arriving via a pull from a local repository.
     </span><li><span class="dt">
<a 
 id="dx1-221014"></a><span 
class="pcrr7tn-">push</span> </span><span class="dd">Control incoming changesets that are arriving via a push from a local repository.
     </span><li><span class="dt">
<a 
 id="dx1-221015"></a><span 
class="pcrr7tn-">bundle</span> </span><span class="dd">Control incoming changesets that are arriving from another repository via a bundle.</li></ul>
<!--l. 567--><p class="indent">   The <a 
 id="dx1-221016"></a><span 
class="pcrr7tn-">[acl.allow] </span>section controls the users that are allowed to add changesets to the repository. If this section is not
present, all users that are not explicitly denied are allowed. If this section is present, all users that are not explicitly allowed are
denied (so an empty section means that all users are denied).
</p><!--l. 573--><p class="indent">   The <a 
 id="dx1-221017"></a><span 
class="pcrr7tn-">[acl.deny] </span>section determines which users are denied from adding changesets to the repository. If this section is not
present or is empty, no users are denied.
</p><!--l. 577--><p class="indent">   The syntaxes for the <a 
 id="dx1-221018"></a><span 
class="pcrr7tn-">[acl.allow] </span>and <a 
 id="dx1-221019"></a><span 
class="pcrr7tn-">[acl.deny] </span>sections are identical. On the left of each entry is a glob pattern that
matches files or directories, relative to the root of the repository; on the right, a user name.
</p><!--l. 582--><p class="indent">   In the following example, the user <span 
class="pcrr7tn-">docwriter </span>can only push changes to the <span 
class="pcrr7tn-">docs </span>subtree of the repository, while <span 
class="pcrr7tn-">intern</span>
can push changes to any file or directory except <span 
class="pcrr7tn-">source/sensitive</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-221021r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[acl.allow]</span>
<br class="fancyvrb" /><a 
 id="x1-221023r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;docs/&#x22C6;&#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;docwriter</span>
<br class="fancyvrb" /><a 
 id="x1-221025r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-221027r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[acl.deny]</span>
<br class="fancyvrb" /><a 
 id="x1-221029r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;source/sensitive/&#x22C6;&#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;intern</span>
   </div>
<!--l. 594--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-22200010.7.1"></a>Testing and troubleshooting</h5>
<!--l. 596--><p class="noindent">If you want to test the <a 
 id="dx1-222001"></a><span 
class="pcrr7tn-">acl </span>hook, run it with Mercurial&#x2019;s debugging output enabled. Since you&#x2019;ll probably be running it on a
server where it&#x2019;s not convenient (or sometimes possible) to pass in the <a 
 id="dx1-222002"></a><span 
class="pcrr7tn-">--debug </span>option, don&#x2019;t forget that you can enable
debugging output in your <a 
 id="dx1-222003"></a><a 
 id="dx1-222004"></a><span 
class="pcrr7tn-">hgrc</span>:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-222006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[ui]</span>
<br class="fancyvrb" /><a 
 id="x1-222008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;debug</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;true</span>
   </div>
<!--l. 605--><p class="noindent">With this enabled, the <a 
 id="dx1-222009"></a><span 
class="pcrr7tn-">acl </span>hook will print enough information to let you figure out why it is allowing or forbidding pushes from
specific users.
</p><!--l. 609--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.7.2    </span> <a 
 id="x1-22300010.7.2"></a><span 
class="pcrr7tn-">bugzilla</span>&#x2014;integration with Bugzilla</h4>
<!--l. 611--><p class="noindent">The <a 
 id="dx1-223001"></a><span 
class="pcrr7tn-">bugzilla </span>extension adds a comment to a Bugzilla bug whenever it finds a reference to that bug ID in a commit comment.
You can install this hook on a shared server, so that any time a remote user pushes changes to this server, the hook gets
run.
</p><!--l. 616--><p class="indent">   It adds a comment to the bug that looks like this (you can configure the contents of the comment&#x2014;see below):
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-223003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Changeset</span><span 
class="pcrr7tn-">&#x00A0;aad8b264143a,</span><span 
class="pcrr7tn-">&#x00A0;made</span><span 
class="pcrr7tn-">&#x00A0;by</span><span 
class="pcrr7tn-">&#x00A0;Joe</span><span 
class="pcrr7tn-">&#x00A0;User</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;joe.user@domain.com&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;in</span>
<br class="fancyvrb" /><a 
 id="x1-223005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;frobnitz</span><span 
class="pcrr7tn-">&#x00A0;repository,</span><span 
class="pcrr7tn-">&#x00A0;refers</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;this</span><span 
class="pcrr7tn-">&#x00A0;bug.</span>
<br class="fancyvrb" /><a 
 id="x1-223007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-223009r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;For</span><span 
class="pcrr7tn-">&#x00A0;complete</span><span 
class="pcrr7tn-">&#x00A0;details,</span><span 
class="pcrr7tn-">&#x00A0;see</span>
<br class="fancyvrb" /><a 
 id="x1-223011r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;http://hg.domain.com/frobnitz?cmd=changeset;node=aad8b264143a</span>
<br class="fancyvrb" /><a 
 id="x1-223013r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-223015r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Changeset</span><span 
class="pcrr7tn-">&#x00A0;description:</span>
<br class="fancyvrb" /><a 
 id="x1-223017r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Fix</span><span 
class="pcrr7tn-">&#x00A0;bug</span><span 
class="pcrr7tn-">&#x00A0;10483</span><span 
class="pcrr7tn-">&#x00A0;by</span><span 
class="pcrr7tn-">&#x00A0;guarding</span><span 
class="pcrr7tn-">&#x00A0;against</span><span 
class="pcrr7tn-">&#x00A0;some</span><span 
class="pcrr7tn-">&#x00A0;NULL</span><span 
class="pcrr7tn-">&#x00A0;pointers</span>
   </div>
<!--l. 628--><p class="noindent">The value of this hook is that it automates the process of updating a bug any time a changeset refers to it. If you configure the hook
properly, it makes it easy for people to browse straight from a Bugzilla bug to a changeset that refers to that
bug.
</p><!--l. 633--><p class="indent">   You can use the code in this hook as a starting point for some more exotic Bugzilla integration recipes. Here are a few
possibilities: </p>
     <ul><li><span class="dt">
     </span><span class="dd">Require that every changeset pushed to the server have a valid bug&#x00A0;ID in its commit comment. In this case,
     you&#x2019;d want to configure the hook as a <a 
 id="dx1-223018"></a><a 
 id="dx1-223019"></a><span 
class="pcrr7tn-">pretxncommit </span>hook. This would allow the hook to reject changes that
     didn&#x2019;t contain bug IDs.
     </span><li><span class="dt">
     </span><span class="dd">Allow incoming changesets to automatically modify the <span 
class="ptmri7t-">state </span>of a bug, as well as simply adding a comment. For
     example, the hook could recognise the string &#x201C;fixed bug 31337&#x201D; as indicating that it should update the state of
     bug 31337 to &#x201C;requires testing&#x201D;.</li></ul>
<!--l. 647--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-22400010.7.2"></a>Configuring the <span 
class="pcrr7tn-">bugzilla </span>hook</h5>
<!--l. 650--><p class="noindent">You should configure this hook in your server&#x2019;s <a 
 id="dx1-224001"></a><a 
 id="dx1-224002"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;as an <a 
 id="dx1-224003"></a><a 
 id="dx1-224004"></a><span 
class="pcrr7tn-">incoming </span>hook, for example as follows:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-224006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[hooks]</span>
<br class="fancyvrb" /><a 
 id="x1-224008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;incoming.bugzilla</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;python:hgext.bugzilla.hook</span>
   </div>
<!--l. 657--><p class="indent">   Because of the specialised nature of this hook, and because Bugzilla was not written with this kind of integration in mind,
configuring this hook is a somewhat involved process.
</p><!--l. 661--><p class="indent">   Before you begin, you must install the MySQL bindings for Python on the host(s) where you&#x2019;ll be running the hook. If this
is not available as a binary package for your system, you can download it from&#x00A0;<span class="cite">[<span 
class="ptmb7t-">?</span>]</span>.
</p><!--l. 666--><p class="indent">   Configuration information for this hook lives in the <a 
 id="dx1-224009"></a><span 
class="pcrr7tn-">[bugzilla] </span>section of your <a 
 id="dx1-224010"></a><a 
 id="dx1-224011"></a><span 
class="pcrr7tn-">hgrc</span>. </p>
     <ul><li><span class="dt">
<a 
 id="dx1-224012"></a><span 
class="pcrr7tn-">version</span> </span><span class="dd">The version of Bugzilla installed on the server. The database schema that Bugzilla uses changes occasionally,
     so this hook has to know exactly which schema to use. At the moment, the only version supported is <span 
class="pcrr7tn-">2.16</span>.
     </span><li><span class="dt">
<a 
 id="dx1-224013"></a><span 
class="pcrr7tn-">host</span> </span><span class="dd">The hostname of the MySQL server that stores your Bugzilla data. The database must be configured to allow
     connections from whatever host you are running the <a 
 id="dx1-224014"></a><a 
 id="dx1-224015"></a><span 
class="pcrr7tn-">bugzilla </span>hook on.
                                                                                         
                                                                                         
     </span><li><span class="dt">
<a 
 id="dx1-224016"></a><span 
class="pcrr7tn-">user</span> </span><span class="dd">The username with which to connect to the MySQL server. The database must be configured to allow this user
     to connect from whatever host you are running the <a 
 id="dx1-224017"></a><a 
 id="dx1-224018"></a><span 
class="pcrr7tn-">bugzilla </span>hook on. This user must be able to access and
     modify Bugzilla tables. The default value of this item is <span 
class="pcrr7tn-">bugs</span>, which is the standard name of the Bugzilla user
     in a MySQL database.
     </span><li><span class="dt">
<a 
 id="dx1-224019"></a><span 
class="pcrr7tn-">password</span> </span><span class="dd">The MySQL password for the user you configured above. This is stored as plain text, so you should make sure
     that unauthorised users cannot read the <a 
 id="dx1-224020"></a><a 
 id="dx1-224021"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file where you store this information.
     </span><li><span class="dt">
  <a 
 id="dx1-224022"></a><span 
class="pcrr7tn-">db</span> </span><span class="dd">The name of the Bugzilla database on the MySQL server. The default value of this item is <span 
class="pcrr7tn-">bugs</span>, which is the
     standard name of the MySQL database where Bugzilla stores its data.
     </span><li><span class="dt">
<a 
 id="dx1-224023"></a><span 
class="pcrr7tn-">notify</span> </span><span class="dd">If you want Bugzilla to send out a notification email to subscribers after this hook has added a comment to a bug, you
     will need this hook to run a command whenever it updates the database. The command to run depends on where you
     have installed Bugzilla, but it will typically look something like this, if you have Bugzilla installed in
     <span 
class="pcrr7tn-">/var/www/html/bugzilla</span>:
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-224025r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cd</span><span 
class="pcrr7tn-">&#x00A0;/var/www/html/bugzilla</span><span 
class="pcrr7tn-">&#x00A0;&&</span><span 
class="pcrr7tn-">&#x00A0;./processmail</span><span 
class="pcrr7tn-">&#x00A0;%s</span><span 
class="pcrr7tn-">&#x00A0;nobody@nowhere.com</span>
</div>
     <!--l. 702--><p class="noindent">The Bugzilla <span 
class="pcrr7tn-">processmail </span>program expects to be given a bug&#x00A0;ID (the hook replaces &#x201C;<span 
class="pcrr7tn-">%s</span>&#x201D; with the bug&#x00A0;ID) and an
     email address. It also expects to be able to write to some files in the directory that it runs in. If Bugzilla and this hook are
     not installed on the same machine, you will need to find a way to run <span 
class="pcrr7tn-">processmail </span>on the server where Bugzilla is
     installed.</p></li></ul>
<!--l. 710--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-22500010.7.2"></a>Mapping committer names to Bugzilla user names</h5>
<!--l. 712--><p class="noindent">By default, the <a 
 id="dx1-225001"></a><span 
class="pcrr7tn-">bugzilla </span>hook tries to use the email address of a changeset&#x2019;s committer as the Bugzilla user name with which
to update a bug. If this does not suit your needs, you can map committer email addresses to Bugzilla user names using a
<a 
 id="dx1-225002"></a><span 
class="pcrr7tn-">[usermap] </span>section.
</p><!--l. 718--><p class="indent">   Each item in the <a 
 id="dx1-225003"></a><span 
class="pcrr7tn-">[usermap] </span>section contains an email address on the left, and a Bugzilla user name on the
right.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-225005r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[usermap]</span>
<br class="fancyvrb" /><a 
 id="x1-225007r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;jane.user@example.com</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;jane</span>
   </div>
<!--l. 724--><p class="noindent">You can either keep the <a 
 id="dx1-225008"></a><span 
class="pcrr7tn-">[usermap] </span>data in a normal <a 
 id="dx1-225009"></a><a 
 id="dx1-225010"></a><span 
class="pcrr7tn-">hgrc</span>, or tell the <a 
 id="dx1-225011"></a><span 
class="pcrr7tn-">bugzilla </span>hook to read the information from an external
<span 
class="pcrr7tn-">usermap </span>file. In the latter case, you can store <span 
class="pcrr7tn-">usermap </span>data by itself in (for example) a user-modifiable repository. This
makes it possible to let your users maintain their own <a 
 id="dx1-225012"></a><span 
class="pcrr7tn-">usermap </span>entries. The main <a 
 id="dx1-225013"></a><a 
 id="dx1-225014"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file might look like
this:
</p>
   <div class="fancyvrb" id="fancyvrb">
                                                                                         
                                                                                         
<a 
 id="x1-225016r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;regular</span><span 
class="pcrr7tn-">&#x00A0;hgrc</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;refers</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;external</span><span 
class="pcrr7tn-">&#x00A0;usermap</span><span 
class="pcrr7tn-">&#x00A0;file</span>
<br class="fancyvrb" /><a 
 id="x1-225018r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[bugzilla]</span>
<br class="fancyvrb" /><a 
 id="x1-225020r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;usermap</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;/home/hg/repos/userdata/bugzilla-usermap.conf</span>
   </div>
<!--l. 736--><p class="noindent">While the <span 
class="pcrr7tn-">usermap </span>file that it refers to might look like this:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-225022r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;bugzilla-usermap.conf</span><span 
class="pcrr7tn-">&#x00A0;-</span><span 
class="pcrr7tn-">&#x00A0;inside</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;repository</span>
<br class="fancyvrb" /><a 
 id="x1-225024r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[usermap]</span>
<br class="fancyvrb" /><a 
 id="x1-225026r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;stephanie@example.com</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;steph</span>
   </div>
<!--l. 744--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-22600010.7.2"></a>Configuring the text that gets added to a bug</h5>
<!--l. 746--><p class="noindent">You can configure the text that this hook adds as a comment; you specify it in the form of a Mercurial template. Several
<a 
 id="dx1-226001"></a><a 
 id="dx1-226002"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;entries (still in the <a 
 id="dx1-226003"></a><span 
class="pcrr7tn-">[bugzilla] </span>section) control this behaviour. </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">strip</span> </span><span class="dd">The number of leading path elements to strip from a repository&#x2019;s path name to construct a partial path for a
     URL. For example, if the repositories on your server live under <span 
class="pcrr7tn-">/home/hg/repos</span>, and you have a repository
     whose path is <span 
class="pcrr7tn-">/home/hg/repos/app/tests</span>, then setting <span 
class="pcrr7tn-">strip </span>to <span 
class="pcrr7tn-">4 </span>will give a partial path of <span 
class="pcrr7tn-">app/tests</span>. The
     hook will make this partial path available when expanding a template, as <span 
class="pcrr7tn-">webroot</span>.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">template</span> </span><span class="dd">The text of the template to use. In addition to the usual changeset-related variables, this template can use <span 
class="pcrr7tn-">hgweb</span>
     (the value of the <span 
class="pcrr7tn-">hgweb </span>configuration item above) and <span 
class="pcrr7tn-">webroot </span>(the path constructed using <span 
class="pcrr7tn-">strip </span>above).</li></ul>
<!--l. 766--><p class="indent">   In addition, you can add a <a 
 id="dx1-226004"></a><span 
class="pcrr7tn-">baseurl </span>item to the <a 
 id="dx1-226005"></a><span 
class="pcrr7tn-">[web] </span>section of your <a 
 id="dx1-226006"></a><a 
 id="dx1-226007"></a><span 
class="pcrr7tn-">hgrc</span>. The <a 
 id="dx1-226008"></a><span 
class="pcrr7tn-">bugzilla </span>hook will make this available
when expanding a template, as the base string to use when constructing a URL that will let users browse from a Bugzilla
comment to view a changeset. Example:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-226010r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[web]</span>
<br class="fancyvrb" /><a 
 id="x1-226012r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;baseurl</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;http://hg.domain.com/</span>
   </div>
<!--l. 776--><p class="indent">   Here is an example set of <a 
 id="dx1-226013"></a><span 
class="pcrr7tn-">bugzilla </span>hook config information.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-226015r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[bugzilla]</span>
<br class="fancyvrb" /><a 
 id="x1-226017r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;host</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;bugzilla.example.com</span>
<br class="fancyvrb" /><a 
 id="x1-226019r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;password</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;mypassword</span>
<br class="fancyvrb" /><a 
 id="x1-226021r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;version</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;2.16</span>
<br class="fancyvrb" /><a 
 id="x1-226023r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;server-side</span><span 
class="pcrr7tn-">&#x00A0;repos</span><span 
class="pcrr7tn-">&#x00A0;live</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;/home/hg/repos,</span><span 
class="pcrr7tn-">&#x00A0;so</span><span 
class="pcrr7tn-">&#x00A0;strip</span><span 
class="pcrr7tn-">&#x00A0;4</span><span 
class="pcrr7tn-">&#x00A0;leading</span>
<br class="fancyvrb" /><a 
 id="x1-226025r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;separators</span>
<br class="fancyvrb" /><a 
 id="x1-226027r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;strip</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;4</span>
<br class="fancyvrb" /><a 
 id="x1-226029r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hgweb</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;http://hg.example.com/</span>
<br class="fancyvrb" /><a 
 id="x1-226031r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;usermap</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;/home/hg/repos/notify/bugzilla.conf</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-226033r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;template</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;Changeset</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">node|short</span><span 
class="cmsy-10">}</span><span 
class="pcrr7tn-">,</span><span 
class="pcrr7tn-">&#x00A0;made</span><span 
class="pcrr7tn-">&#x00A0;by</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">author</span><span 
class="cmsy-10">}</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">webroot</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-226035r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;repo,</span><span 
class="pcrr7tn-">&#x00A0;refers</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;this</span><span 
class="pcrr7tn-">&#x00A0;bug.</span><br class="newline" /><span 
class="pcrr7tn-">nFor</span><span 
class="pcrr7tn-">&#x00A0;complete</span><span 
class="pcrr7tn-">&#x00A0;details,</span><span 
class="pcrr7tn-">&#x00A0;see</span>
<br class="fancyvrb" /><a 
 id="x1-226037r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">hgweb</span><span 
class="cmsy-10">}{</span><span 
class="pcrr7tn-">webroot</span><span 
class="cmsy-10">}</span><span 
class="pcrr7tn-">?cmd=changeset;node=</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">node|short</span><span 
class="cmsy-10">}</span><br class="newline" /><span 
class="pcrr7tn-">nChangeset</span>
<br class="fancyvrb" /><a 
 id="x1-226039r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;description:</span><br class="newline" /><span 
class="pcrr7tn-">n</span><br class="newline" /><span 
class="pcrr7tn-">t</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">desc|tabindent</span><span 
class="cmsy-10">}</span>
   </div>
<!--l. 793--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-22700010.7.2"></a>Testing and troubleshooting</h5>
<!--l. 795--><p class="noindent">The most common problems with configuring the <a 
 id="dx1-227001"></a><span 
class="pcrr7tn-">bugzilla </span>hook relate to running Bugzilla&#x2019;s <span 
class="pcrr7tn-">processmail </span>script and
mapping committer names to user names.
</p><!--l. 799--><p class="indent">   Recall from section&#x00A0;<a 
href="#x1-22400010.7.2">10.7.2<!--tex4ht:ref: sec:hook:bugzilla:config --></a> above that the user that runs the Mercurial process on the server is also the one that
will run the <span 
class="pcrr7tn-">processmail </span>script. The <span 
class="pcrr7tn-">processmail </span>script sometimes causes Bugzilla to write to files in its
configuration directory, and Bugzilla&#x2019;s configuration files are usually owned by the user that your web server runs
under.
</p><!--l. 806--><p class="indent">   You can cause <span 
class="pcrr7tn-">processmail </span>to be run with the suitable user&#x2019;s identity using the <a 
 id="dx1-227002"></a><span 
class="pcrr7tn-">sudo </span>command. Here is an example entry
for a <span 
class="pcrr7tn-">sudoers </span>file.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-227004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg_user</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;(httpd_user)</span><span 
class="pcrr7tn-">&#x00A0;NOPASSWD:</span><span 
class="pcrr7tn-">&#x00A0;/var/www/html/bugzilla/processmail-wrapper</span><span 
class="pcrr7tn-">&#x00A0;%s</span>
   </div>
<!--l. 812--><p class="noindent">This allows the <span 
class="pcrr7tn-">hg</span><span 
class="pcrr7tn-">_user </span>user to run a <span 
class="pcrr7tn-">processmail-wrapper </span>program under the identity of <span 
class="pcrr7tn-">httpd</span><span 
class="pcrr7tn-">_user</span>.
</p><!--l. 816--><p class="indent">   This indirection through a wrapper script is necessary, because <span 
class="pcrr7tn-">processmail </span>expects to be run with its current directory set
to wherever you installed Bugzilla; you can&#x2019;t specify that kind of constraint in a <span 
class="pcrr7tn-">sudoers </span>file. The contents of the wrapper
script are simple:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-227006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#!/bin/sh</span>
<br class="fancyvrb" /><a 
 id="x1-227008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cd</span><span 
class="pcrr7tn-">&#x00A0;&#x2018;dirname</span><span 
class="pcrr7tn-">&#x00A0;$0&#x2018;</span><span 
class="pcrr7tn-">&#x00A0;&&</span><span 
class="pcrr7tn-">&#x00A0;./processmail</span><span 
class="pcrr7tn-">&#x00A0;"$1"</span><span 
class="pcrr7tn-">&#x00A0;nobody@example.com</span>
   </div>
<!--l. 825--><p class="noindent">It doesn&#x2019;t seem to matter what email address you pass to <span 
class="pcrr7tn-">processmail</span>.
</p><!--l. 828--><p class="indent">   If your <a 
 id="dx1-227009"></a><span 
class="pcrr7tn-">[usermap] </span>is not set up correctly, users will see an error message from the <a 
 id="dx1-227010"></a><span 
class="pcrr7tn-">bugzilla </span>hook when they push changes
to the server. The error message will look like this:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-227012r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cannot</span><span 
class="pcrr7tn-">&#x00A0;find</span><span 
class="pcrr7tn-">&#x00A0;bugzilla</span><span 
class="pcrr7tn-">&#x00A0;user</span><span 
class="pcrr7tn-">&#x00A0;id</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;john.q.public@example.com</span>
   </div>
<!--l. 834--><p class="noindent">What this means is that the committer&#x2019;s address, <span 
class="pcrr7tn-">john.q.public@example.com</span>, is not a valid Bugzilla user name, nor does it
have an entry in your <a 
 id="dx1-227013"></a><span 
class="pcrr7tn-">[usermap] </span>that maps it to a valid Bugzilla user name.
</p><!--l. 839--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.7.3    </span> <a 
 id="x1-22800010.7.3"></a><span 
class="pcrr7tn-">notify</span>&#x2014;send email notifications</h4>
<!--l. 841--><p class="noindent">Although Mercurial&#x2019;s built-in web server provides RSS feeds of changes in every repository, many people prefer to receive
change notifications via email. The <a 
 id="dx1-228001"></a><span 
class="pcrr7tn-">notify </span>hook lets you send out notifications to a set of email addresses whenever changesets
arrive that those subscribers are interested in.
                                                                                         
                                                                                         
</p><!--l. 847--><p class="indent">   As with the <a 
 id="dx1-228002"></a><span 
class="pcrr7tn-">bugzilla </span>hook, the <a 
 id="dx1-228003"></a><span 
class="pcrr7tn-">notify </span>hook is template-driven, so you can customise the contents of the notification
messages that it sends.
</p><!--l. 851--><p class="indent">   By default, the <a 
 id="dx1-228004"></a><span 
class="pcrr7tn-">notify </span>hook includes a diff of every changeset that it sends out; you can limit the size of the diff, or turn
this feature off entirely. It is useful for letting subscribers review changes immediately, rather than clicking to follow a
URL.
</p><!--l. 856--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-22900010.7.3"></a>Configuring the <span 
class="pcrr7tn-">notify </span>hook</h5>
<!--l. 858--><p class="noindent">You can set up the <a 
 id="dx1-229001"></a><span 
class="pcrr7tn-">notify </span>hook to send one email message per incoming changeset, or one per incoming group of changesets
(all those that arrived in a single pull or push).
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-229003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[hooks]</span>
<br class="fancyvrb" /><a 
 id="x1-229005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;send</span><span 
class="pcrr7tn-">&#x00A0;one</span><span 
class="pcrr7tn-">&#x00A0;email</span><span 
class="pcrr7tn-">&#x00A0;per</span><span 
class="pcrr7tn-">&#x00A0;group</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-229007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changegroup.notify</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;python:hgext.notify.hook</span>
<br class="fancyvrb" /><a 
 id="x1-229009r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;send</span><span 
class="pcrr7tn-">&#x00A0;one</span><span 
class="pcrr7tn-">&#x00A0;email</span><span 
class="pcrr7tn-">&#x00A0;per</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-229011r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;incoming.notify</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;python:hgext.notify.hook</span>
   </div>
<!--l. 869--><p class="indent">   Configuration information for this hook lives in the <a 
 id="dx1-229012"></a><span 
class="pcrr7tn-">[notify] </span>section of a <a 
 id="dx1-229013"></a><a 
 id="dx1-229014"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file. </p>
     <ul><li><span class="dt">
<a 
 id="dx1-229015"></a><span 
class="pcrr7tn-">test</span> </span><span class="dd">By default, this hook does not send out email at all; instead, it prints the message that it <span 
class="ptmri7t-">would </span>send. Set this
     item to <span 
class="pcrr7tn-">false </span>to allow email to be sent. The reason that sending of email is turned off by default is that it takes
     several tries to configure this extension exactly as you would like, and it would be bad form to spam subscribers
     with a number of &#x201C;broken&#x201D; notifications while you debug your configuration.
     </span><li><span class="dt">
<a 
 id="dx1-229016"></a><span 
class="pcrr7tn-">config</span> </span><span class="dd">The  path  to  a  configuration  file  that  contains  subscription  information.  This  is  kept  separate  from  the  main
     <a 
 id="dx1-229017"></a><a 
 id="dx1-229018"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;so that you can maintain it in a repository of its own. People can then clone that repository, update their
     subscriptions, and push the changes back to your server.
     </span><li><span class="dt">
<a 
 id="dx1-229019"></a><span 
class="pcrr7tn-">strip</span> </span><span class="dd">The number of leading path separator characters to strip from a repository&#x2019;s path, when deciding whether a
     repository has subscribers. For example, if the repositories on your server live in <span 
class="pcrr7tn-">/home/hg/repos</span>, and <a 
 id="dx1-229020"></a><span 
class="pcrr7tn-">notify</span>
     is considering a repository named <span 
class="pcrr7tn-">/home/hg/repos/shared/test</span>, setting <a 
 id="dx1-229021"></a><span 
class="pcrr7tn-">strip </span>to <span 
class="pcrr7tn-">4 </span>will cause <a 
 id="dx1-229022"></a><span 
class="pcrr7tn-">notify </span>to
     trim the path it considers down to <span 
class="pcrr7tn-">shared/test</span>, and it will match subscribers against that.
     </span><li><span class="dt">
<a 
 id="dx1-229023"></a><span 
class="pcrr7tn-">template</span> </span><span class="dd">The template text to use when sending messages. This specifies both the contents of the message header and its
     body.
     </span><li><span class="dt">
<a 
 id="dx1-229024"></a><span 
class="pcrr7tn-">maxdiff</span> </span><span class="dd">The maximum number of lines of diff data to append to the end of a message. If a diff is longer than this, it is
     truncated. By default, this is set to 300. Set this to <span 
class="pcrr7tn-">0 </span>to omit diffs from notification emails.
     </span><li><span class="dt">
<a 
 id="dx1-229025"></a><span 
class="pcrr7tn-">sources</span> </span><span class="dd">A list of sources of changesets to consider. This lets you limit <a 
 id="dx1-229026"></a><span 
class="pcrr7tn-">notify </span>to only sending out email about changes
     that remote users pushed into this repository via a server, for example. See section&#x00A0;<a 
href="#x1-23500010.8.3">10.8.3<!--tex4ht:ref: sec:hook:sources --></a> for the sources you
     can specify here.</li></ul>
<!--l. 906--><p class="indent">   If you set the <a 
 id="dx1-229027"></a><span 
class="pcrr7tn-">baseurl </span>item in the <a 
 id="dx1-229028"></a><span 
class="pcrr7tn-">[web] </span>section, you can use it in a template; it will be available as <span 
class="pcrr7tn-">webroot</span>.
</p><!--l. 910--><p class="indent">   Here is an example set of <a 
 id="dx1-229029"></a><span 
class="pcrr7tn-">notify </span>configuration information.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-229031r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[notify]</span>
<br class="fancyvrb" /><a 
 id="x1-229033r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;really</span><span 
class="pcrr7tn-">&#x00A0;send</span><span 
class="pcrr7tn-">&#x00A0;email</span>
<br class="fancyvrb" /><a 
 id="x1-229035r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;test</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;false</span>
<br class="fancyvrb" /><a 
 id="x1-229037r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;subscriber</span><span 
class="pcrr7tn-">&#x00A0;data</span><span 
class="pcrr7tn-">&#x00A0;lives</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;notify</span><span 
class="pcrr7tn-">&#x00A0;repo</span>
<br class="fancyvrb" /><a 
 id="x1-229039r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;config</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;/home/hg/repos/notify/notify.conf</span>
<br class="fancyvrb" /><a 
 id="x1-229041r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;repos</span><span 
class="pcrr7tn-">&#x00A0;live</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;/home/hg/repos</span><span 
class="pcrr7tn-">&#x00A0;on</span><span 
class="pcrr7tn-">&#x00A0;server,</span><span 
class="pcrr7tn-">&#x00A0;so</span><span 
class="pcrr7tn-">&#x00A0;strip</span><span 
class="pcrr7tn-">&#x00A0;4</span><span 
class="pcrr7tn-">&#x00A0;"/"</span><span 
class="pcrr7tn-">&#x00A0;chars</span>
<br class="fancyvrb" /><a 
 id="x1-229043r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;strip</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;4</span>
<br class="fancyvrb" /><a 
 id="x1-229045r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;template</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;X-Hg-Repo:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">webroot</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-229047r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Subject:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">webroot</span><span 
class="cmsy-10">}</span><span 
class="pcrr7tn-">:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">desc|firstline|strip</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-229049r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;From:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">author</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-229051r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-229053r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">node|short</span><span 
class="cmsy-10">}</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">root</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-229055r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;details:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">baseurl</span><span 
class="cmsy-10">}{</span><span 
class="pcrr7tn-">webroot</span><span 
class="cmsy-10">}</span><span 
class="pcrr7tn-">?cmd=changeset;node=</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">node|short</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-229057r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;description:</span>
<br class="fancyvrb" /><a 
 id="x1-229059r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">desc|tabindent|strip</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-229061r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-229063r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[web]</span>
<br class="fancyvrb" /><a 
 id="x1-229065r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;baseurl</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;http://hg.example.com/</span>
   </div>
<!--l. 932--><p class="indent">   This will produce a message that looks like the following:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-229067r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;X-Hg-Repo:</span><span 
class="pcrr7tn-">&#x00A0;tests/slave</span>
<br class="fancyvrb" /><a 
 id="x1-229069r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Subject:</span><span 
class="pcrr7tn-">&#x00A0;tests/slave:</span><span 
class="pcrr7tn-">&#x00A0;Handle</span><span 
class="pcrr7tn-">&#x00A0;error</span><span 
class="pcrr7tn-">&#x00A0;case</span><span 
class="pcrr7tn-">&#x00A0;when</span><span 
class="pcrr7tn-">&#x00A0;slave</span><span 
class="pcrr7tn-">&#x00A0;has</span><span 
class="pcrr7tn-">&#x00A0;no</span><span 
class="pcrr7tn-">&#x00A0;buffers</span>
<br class="fancyvrb" /><a 
 id="x1-229071r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Date:</span><span 
class="pcrr7tn-">&#x00A0;Wed,</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2</span><span 
class="pcrr7tn-">&#x00A0;Aug</span><span 
class="pcrr7tn-">&#x00A0;2006</span><span 
class="pcrr7tn-">&#x00A0;15:25:46</span><span 
class="pcrr7tn-">&#x00A0;-0700</span><span 
class="pcrr7tn-">&#x00A0;(PDT)</span>
<br class="fancyvrb" /><a 
 id="x1-229073r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-229075r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;3cba9bfe74b5</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;/home/hg/repos/tests/slave</span>
<br class="fancyvrb" /><a 
 id="x1-229077r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;details:</span><span 
class="pcrr7tn-">&#x00A0;http://hg.example.com/tests/slave?cmd=changeset;node=3cba9bfe74b5</span>
<br class="fancyvrb" /><a 
 id="x1-229079r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;description:</span>
<br class="fancyvrb" /><a 
 id="x1-229081r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Handle</span><span 
class="pcrr7tn-">&#x00A0;error</span><span 
class="pcrr7tn-">&#x00A0;case</span><span 
class="pcrr7tn-">&#x00A0;when</span><span 
class="pcrr7tn-">&#x00A0;slave</span><span 
class="pcrr7tn-">&#x00A0;has</span><span 
class="pcrr7tn-">&#x00A0;no</span><span 
class="pcrr7tn-">&#x00A0;buffers</span>
<br class="fancyvrb" /><a 
 id="x1-229083r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diffs</span><span 
class="pcrr7tn-">&#x00A0;(54</span><span 
class="pcrr7tn-">&#x00A0;lines):</span>
<br class="fancyvrb" /><a 
 id="x1-229085r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-229087r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;9d95df7cf2ad</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;3cba9bfe74b5</span><span 
class="pcrr7tn-">&#x00A0;include/tests.h</span>
<br class="fancyvrb" /><a 
 id="x1-229089r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/include/tests.h</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Wed</span><span 
class="pcrr7tn-">&#x00A0;Aug</span><span 
class="pcrr7tn-">&#x00A0;02</span><span 
class="pcrr7tn-">&#x00A0;15:19:52</span><span 
class="pcrr7tn-">&#x00A0;2006</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-229091r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/include/tests.h</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Wed</span><span 
class="pcrr7tn-">&#x00A0;Aug</span><span 
class="pcrr7tn-">&#x00A0;02</span><span 
class="pcrr7tn-">&#x00A0;15:25:26</span><span 
class="pcrr7tn-">&#x00A0;2006</span><span 
class="pcrr7tn-">&#x00A0;-0700</span>
<br class="fancyvrb" /><a 
 id="x1-229093r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-212,6</span><span 
class="pcrr7tn-">&#x00A0;+212,15</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;static</span><span 
class="pcrr7tn-">&#x00A0;__inline__</span><span 
class="pcrr7tn-">&#x00A0;void</span><span 
class="pcrr7tn-">&#x00A0;test_headers(void</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;h)</span>
<br class="fancyvrb" /><a 
 id="x1-229095r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[...snip...]</span>
   </div>
<!--l. 951--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-23000010.7.3"></a>Testing and troubleshooting</h5>
<!--l. 953--><p class="noindent">Do not forget that by default, the <a 
 id="dx1-230001"></a><span 
class="pcrr7tn-">notify </span>extension <span 
class="ptmri7t-">will not send any mail </span>until you explicitly configure it to do so, by setting
<a 
 id="dx1-230002"></a><span 
class="pcrr7tn-">test </span>to <span 
class="pcrr7tn-">false</span>. Until you do that, it simply prints the message it <span 
class="ptmri7t-">would </span>send.
                                                                                         
                                                                                         
</p><!--l. 958--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">10.8    </span> <a 
 id="x1-23100010.8"></a>Information for writers of hooks</h3>
<!--l. 961--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.8.1    </span> <a 
 id="x1-23200010.8.1"></a>In-process hook execution</h4>
<!--l. 963--><p class="noindent">An in-process hook is called with arguments of the following form:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-232002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;def</span><span 
class="pcrr7tn-">&#x00A0;myhook(ui,</span><span 
class="pcrr7tn-">&#x00A0;repo,</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;kwargs):</span>
<br class="fancyvrb" /><a 
 id="x1-232004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pass</span>
   </div>
<!--l. 968--><p class="noindent">The <span 
class="pcrr7tn-">ui </span>parameter is a <a 
 id="dx1-232005"></a><span 
class="pcrr7tn-">mercurial.ui.ui </span>object. The <span 
class="pcrr7tn-">repo </span>parameter is a <a 
 id="dx1-232006"></a><span 
class="pcrr7tn-">mercurial.localrepo.localrepository </span>object. The
names and values of the <span 
class="pcrr7tn-">&#x22C6;&#x22C6;kwargs </span>parameters depend on the hook being invoked, with the following common features:
</p>
     <ul><li><span class="dt">
     </span><span class="dd">If a parameter is named <span 
class="pcrr7tn-">node </span>or <span 
class="pcrr7tn-">parent</span><span 
class="pcrro7t-">N</span>, it will contain a hexadecimal changeset ID. The empty string is used
     to represent &#x201C;null changeset ID&#x201D; instead of a string of zeroes.
     </span><li><span class="dt">
     </span><span class="dd">If a parameter is named <span 
class="pcrr7tn-">url</span>, it will contain the URL of a remote repository, if that can be determined.
     </span><li><span class="dt">
     </span><span class="dd">Boolean-valued parameters are represented as Python <span 
class="pcrr7tn-">bool </span>objects.</li></ul>
<!--l. 984--><p class="indent">   An in-process hook is called without a change to the process&#x2019;s working directory (unlike external hooks, which are run in
the root of the repository). It must not change the process&#x2019;s working directory, or it will cause any calls it makes into the
Mercurial API to fail.
</p><!--l. 989--><p class="indent">   If a hook returns a boolean &#x201C;false&#x201D; value, it is considered to have succeeded. If it returns a boolean &#x201C;true&#x201D; value or raises
an exception, it is considered to have failed. A useful way to think of the calling convention is &#x201C;tell me if you
fail&#x201D;.
</p><!--l. 994--><p class="indent">   Note that changeset IDs are passed into Python hooks as hexadecimal strings, not the binary hashes that Mercurial&#x2019;s APIs
normally use. To convert a hash from hex to binary, use the <a 
 id="dx1-232007"></a><span 
class="pcrr7tn-">mercurial.node.bin </span>function.
</p><!--l. 999--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.8.2    </span> <a 
 id="x1-23300010.8.2"></a>External hook execution</h4>
<!--l. 1001--><p class="noindent">An external hook is passed to the shell of the user running Mercurial. Features of that shell, such as variable substitution and
command redirection, are available. The hook is run in the root directory of the repository (unlike in-process hooks, which are
run in the same directory that Mercurial was run in).
</p><!--l. 1007--><p class="indent">   Hook parameters are passed to the hook as environment variables. Each environment variable&#x2019;s name is converted in upper
case and prefixed with the string &#x201C;<span 
class="pcrr7tn-">HG</span><span 
class="pcrr7tn-">_</span>&#x201D;. For example, if the name of a parameter is &#x201C;<span 
class="pcrr7tn-">node</span>&#x201D;, the name of the environment
variable representing that parameter will be &#x201C;<span 
class="pcrr7tn-">HG</span><span 
class="pcrr7tn-">_NODE</span>&#x201D;.
</p><!--l. 1013--><p class="indent">   A boolean parameter is represented as the string &#x201C;<span 
class="pcrr7tn-">1</span>&#x201D; for &#x201C;true&#x201D;, &#x201C;<span 
class="pcrr7tn-">0</span>&#x201D; for &#x201C;false&#x201D;. If an environment variable is named
<a 
 id="dx1-233001"></a><a 
 id="dx1-233002"></a><span 
class="pcrr7tn-">HG</span><span 
class="pcrr7tn-">_NODE</span>, <a 
 id="dx1-233003"></a><a 
 id="dx1-233004"></a><span 
class="pcrr7tn-">HG</span><span 
class="pcrr7tn-">_PARENT1 </span>or <a 
 id="dx1-233005"></a><a 
 id="dx1-233006"></a><span 
class="pcrr7tn-">HG</span><span 
class="pcrr7tn-">_PARENT2</span>, it contains a changeset ID represented as a hexadecimal string. The empty string is
used to represent &#x201C;null changeset ID&#x201D; instead of a string of zeroes. If an environment variable is named <a 
 id="dx1-233007"></a><a 
 id="dx1-233008"></a><span 
class="pcrr7tn-">HG</span><span 
class="pcrr7tn-">_URL</span>, it will contain
the URL of a remote repository, if that can be determined.
                                                                                         
                                                                                         
</p><!--l. 1022--><p class="indent">   If a hook exits with a status of zero, it is considered to have succeeded. If it exits with a non-zero status, it is considered to
have failed.
</p><!--l. 1026--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.8.3    </span> <a 
 id="x1-23400010.8.3"></a>Finding out where changesets come from</h4>
<!--l. 1028--><p class="noindent">A hook that involves the transfer of changesets between a local repository and another may be able to find out information
about the &#x201C;far side&#x201D;. Mercurial knows <span 
class="ptmri7t-">how </span>changes are being transferred, and in many cases <span 
class="ptmri7t-">where </span>they are being transferred to
or from.
</p><!--l. 1034--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-23500010.8.3"></a>Sources of changesets</h5>
<!--l. 1037--><p class="noindent">Mercurial will tell a hook what means are, or were, used to transfer changesets between repositories. This is provided by
Mercurial in a Python parameter named <span 
class="pcrr7tn-">source</span>, or an environment variable named <a 
 id="dx1-235001"></a><a 
 id="dx1-235002"></a><span 
class="pcrr7tn-">HG</span><span 
class="pcrr7tn-">_SOURCE</span>.
</p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">serve</span> </span><span class="dd">Changesets are transferred to or from a remote repository over http or ssh.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">pull</span> </span><span class="dd">Changesets are being transferred via a pull from one repository into another.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">push</span> </span><span class="dd">Changesets are being transferred via a push from one repository into another.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">bundle</span> </span><span class="dd">Changesets are being transferred to or from a bundle.</li></ul>
<!--l. 1053--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-23600010.8.3"></a>Where changes are going&#x2014;remote repository URLs</h5>
<!--l. 1056--><p class="noindent">When possible, Mercurial will tell a hook the location of the &#x201C;far side&#x201D; of an activity that transfers changeset data between
repositories. This is provided by Mercurial in a Python parameter named <span 
class="pcrr7tn-">url</span>, or an environment variable named
<a 
 id="dx1-236001"></a><a 
 id="dx1-236002"></a><span 
class="pcrr7tn-">HG</span><span 
class="pcrr7tn-">_URL</span>.
</p><!--l. 1061--><p class="indent">   This information is not always known. If a hook is invoked in a repository that is being served via http or ssh, Mercurial
cannot tell where the remote repository is, but it may know where the client is connecting from. In such cases, the URL will
take one of the following forms: </p>
     <ul><li><span class="dt">
     </span><span class="dd"><span 
class="pcrr7tn-">remote:ssh:</span><span 
class="pcrro7t-">ip-address</span>&#x2014;remote ssh client, at the given IP address.
     </span><li><span class="dt">
     </span><span class="dd"><span 
class="pcrr7tn-">remote:http:</span><span 
class="pcrro7t-">ip-address</span>&#x2014;remote http client, at the given IP address. If the client is using SSL, this will
     be of the form <span 
class="pcrr7tn-">remote:https:</span><span 
class="pcrro7t-">ip-address</span>.
     </span><li><span class="dt">
     </span><span class="dd">Empty&#x2014;no information could be discovered about the remote client.</li></ul>
                                                                                         
                                                                                         
<!--l. 1076--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">10.9    </span> <a 
 id="x1-23700010.9"></a>Hook reference</h3>
<!--l. 1078--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.1    </span> <a 
 id="x1-23800010.9.1"></a><span 
class="pcrr7tn-">changegroup</span>&#x2014;after remote changesets added</h4>
<!--l. 1081--><p class="noindent">This hook is run after a group of pre-existing changesets has been added to the repository, for example via a <a 
 id="dx1-238001"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">pull</span>&#x201D; or <a 
 id="dx1-238002"></a>&#x201C;<span 
class="pcrr7tn-">hg unbundle</span>&#x201D;. This hook is run once per operation that added one or more changesets. This is in
contrast to the <a 
 id="dx1-238003"></a><a 
 id="dx1-238004"></a><span 
class="pcrr7tn-">incoming </span>hook, which is run once per changeset, regardless of whether the changesets arrive in a
group.
</p><!--l. 1088--><p class="indent">   Some possible uses for this hook include kicking off an automated build or test of the added changesets, updating a bug
database, or notifying subscribers that a repository contains new changes.
</p><!--l. 1092--><p class="indent">   Parameters to this hook: </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">node</span> </span><span class="dd">A changeset ID. The changeset ID of the first changeset in the group that was added. All changesets between
     this and <a 
 id="dx1-238005"></a><span 
class="pcrr7tn-">tip</span>, inclusive, were added by a single <a 
 id="dx1-238006"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D;, <a 
 id="dx1-238007"></a>&#x201C;<span 
class="pcrr7tn-">hg push</span>&#x201D; or <a 
 id="dx1-238008"></a>&#x201C;<span 
class="pcrr7tn-">hg unbundle</span>&#x201D;.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">source</span> </span><span class="dd">A string. The source of these changes. See section&#x00A0;<a 
href="#x1-23500010.8.3">10.8.3<!--tex4ht:ref: sec:hook:sources --></a> for details.
     </span><li><span class="dt">
 <span 
class="pcrr7tn-">url</span> </span><span class="dd">A URL. The location of the remote repository, if known. See section&#x00A0;<a 
href="#x1-23600010.8.3">10.8.3<!--tex4ht:ref: sec:hook:url --></a> for more information.</li></ul>
<!--l. 1104--><p class="indent">   See also: <a 
 id="dx1-238009"></a><a 
 id="dx1-238010"></a><span 
class="pcrr7tn-">incoming </span>(section&#x00A0;<a 
href="#x1-24000010.9.3">10.9.3<!--tex4ht:ref: sec:hook:incoming --></a>), <a 
 id="dx1-238011"></a><a 
 id="dx1-238012"></a><span 
class="pcrr7tn-">prechangegroup </span>(section&#x00A0;<a 
href="#x1-24200010.9.5">10.9.5<!--tex4ht:ref: sec:hook:prechangegroup --></a>), <a 
 id="dx1-238013"></a><a 
 id="dx1-238014"></a><span 
class="pcrr7tn-">pretxnchangegroup </span>(section&#x00A0;<a 
href="#x1-24600010.9.9">10.9.9<!--tex4ht:ref: sec:hook:pretxnchangegroup --></a>)
</p><!--l. 1108--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.2    </span> <a 
 id="x1-23900010.9.2"></a><span 
class="pcrr7tn-">commit</span>&#x2014;after a new changeset is created</h4>
<!--l. 1111--><p class="noindent">This hook is run after a new changeset has been created.
</p><!--l. 1113--><p class="indent">   Parameters to this hook: </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">node</span> </span><span class="dd">A changeset ID. The changeset ID of the newly committed changeset.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">parent1</span> </span><span class="dd">A changeset ID. The changeset ID of the first parent of the newly committed changeset.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">parent2</span> </span><span class="dd">A changeset ID. The changeset ID of the second parent of the newly committed changeset.</li></ul>
<!--l. 1123--><p class="indent">   See also: <a 
 id="dx1-239001"></a><a 
 id="dx1-239002"></a><span 
class="pcrr7tn-">precommit </span>(section&#x00A0;<a 
href="#x1-24300010.9.6">10.9.6<!--tex4ht:ref: sec:hook:precommit --></a>), <a 
 id="dx1-239003"></a><a 
 id="dx1-239004"></a><span 
class="pcrr7tn-">pretxncommit </span>(section&#x00A0;<a 
href="#x1-24700010.9.10">10.9.10<!--tex4ht:ref: sec:hook:pretxncommit --></a>)
</p><!--l. 1126--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.3    </span> <a 
 id="x1-24000010.9.3"></a><span 
class="pcrr7tn-">incoming</span>&#x2014;after one remote changeset is added</h4>
<!--l. 1129--><p class="noindent">This hook is run after a pre-existing changeset has been added to the repository, for example via a <a 
 id="dx1-240001"></a>&#x201C;<span 
class="pcrr7tn-">hg push</span>&#x201D;. If a group of
changesets was added in a single operation, this hook is called once for each added changeset.
</p><!--l. 1134--><p class="indent">   You can use this hook for the same purposes as the <a 
 id="dx1-240002"></a><a 
 id="dx1-240003"></a><span 
class="pcrr7tn-">changegroup </span>hook (section&#x00A0;<a 
href="#x1-23800010.9.1">10.9.1<!--tex4ht:ref: sec:hook:changegroup --></a>); it&#x2019;s simply more convenient
sometimes to run a hook once per group of changesets, while other times it&#x2019;s handier once per changeset.
</p><!--l. 1139--><p class="indent">   Parameters to this hook: </p>
                                                                                         
                                                                                         
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">node</span> </span><span class="dd">A changeset ID. The ID of the newly added changeset.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">source</span> </span><span class="dd">A string. The source of these changes. See section&#x00A0;<a 
href="#x1-23500010.8.3">10.8.3<!--tex4ht:ref: sec:hook:sources --></a> for details.
     </span><li><span class="dt">
 <span 
class="pcrr7tn-">url</span> </span><span class="dd">A URL. The location of the remote repository, if known. See section&#x00A0;<a 
href="#x1-23600010.8.3">10.8.3<!--tex4ht:ref: sec:hook:url --></a> for more information.</li></ul>
<!--l. 1149--><p class="indent">   See also: <a 
 id="dx1-240004"></a><a 
 id="dx1-240005"></a><span 
class="pcrr7tn-">changegroup </span>(section&#x00A0;<a 
href="#x1-23800010.9.1">10.9.1<!--tex4ht:ref: sec:hook:changegroup --></a>) <a 
 id="dx1-240006"></a><a 
 id="dx1-240007"></a><span 
class="pcrr7tn-">prechangegroup </span>(section&#x00A0;<a 
href="#x1-24200010.9.5">10.9.5<!--tex4ht:ref: sec:hook:prechangegroup --></a>), <a 
 id="dx1-240008"></a><a 
 id="dx1-240009"></a><span 
class="pcrr7tn-">pretxnchangegroup </span>(section&#x00A0;<a 
href="#x1-24600010.9.9">10.9.9<!--tex4ht:ref: sec:hook:pretxnchangegroup --></a>)
</p><!--l. 1151--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.4    </span> <a 
 id="x1-24100010.9.4"></a><span 
class="pcrr7tn-">outgoing</span>&#x2014;after changesets are propagated</h4>
<!--l. 1154--><p class="noindent">This hook is run after a group of changesets has been propagated out of this repository, for example by a <a 
 id="dx1-241001"></a>&#x201C;<span 
class="pcrr7tn-">hg push</span>&#x201D; or <a 
 id="dx1-241002"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">bundle</span>&#x201D; command.
</p><!--l. 1158--><p class="indent">   One possible use for this hook is to notify administrators that changes have been pulled.
</p><!--l. 1161--><p class="indent">   Parameters to this hook: </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">node</span> </span><span class="dd">A changeset ID. The changeset ID of the first changeset of the group that was sent.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">source</span> </span><span class="dd">A string. The source of the of the operation (see section&#x00A0;<a 
href="#x1-23500010.8.3">10.8.3<!--tex4ht:ref: sec:hook:sources --></a>). If a remote client pulled changes from this
     repository, <span 
class="pcrr7tn-">source </span>will be <span 
class="pcrr7tn-">serve</span>. If the client that obtained changes from this repository was local, <span 
class="pcrr7tn-">source </span>will
     be <span 
class="pcrr7tn-">bundle</span>, <span 
class="pcrr7tn-">pull</span>, or <span 
class="pcrr7tn-">push</span>, depending on the operation the client performed.
     </span><li><span class="dt">
 <span 
class="pcrr7tn-">url</span> </span><span class="dd">A URL. The location of the remote repository, if known. See section&#x00A0;<a 
href="#x1-23600010.8.3">10.8.3<!--tex4ht:ref: sec:hook:url --></a> for more information.</li></ul>
<!--l. 1176--><p class="indent">   See also: <a 
 id="dx1-241003"></a><a 
 id="dx1-241004"></a><span 
class="pcrr7tn-">preoutgoing </span>(section&#x00A0;<a 
href="#x1-24400010.9.7">10.9.7<!--tex4ht:ref: sec:hook:preoutgoing --></a>)
</p><!--l. 1178--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.5    </span> <a 
 id="x1-24200010.9.5"></a><span 
class="pcrr7tn-">prechangegroup</span>&#x2014;before starting to add remote changesets</h4>
<!--l. 1181--><p class="noindent">This controlling hook is run before Mercurial begins to add a group of changesets from another repository.
</p><!--l. 1184--><p class="indent">   This hook does not have any information about the changesets to be added, because it is run before transmission of those
changesets is allowed to begin. If this hook fails, the changesets will not be transmitted.
</p><!--l. 1189--><p class="indent">   One use for this hook is to prevent external changes from being added to a repository. For example, you could use this to
&#x201C;freeze&#x201D; a server-hosted branch temporarily or permanently so that users cannot push to it, while still allowing a local
administrator to modify the repository.
</p><!--l. 1195--><p class="indent">   Parameters to this hook: </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">source</span> </span><span class="dd">A string. The source of these changes. See section&#x00A0;<a 
href="#x1-23500010.8.3">10.8.3<!--tex4ht:ref: sec:hook:sources --></a> for details.
     </span><li><span class="dt">
 <span 
class="pcrr7tn-">url</span> </span><span class="dd">A URL. The location of the remote repository, if known. See section&#x00A0;<a 
href="#x1-23600010.8.3">10.8.3<!--tex4ht:ref: sec:hook:url --></a> for more information.</li></ul>
<!--l. 1203--><p class="indent">   See also: <a 
 id="dx1-242001"></a><a 
 id="dx1-242002"></a><span 
class="pcrr7tn-">changegroup </span>(section&#x00A0;<a 
href="#x1-23800010.9.1">10.9.1<!--tex4ht:ref: sec:hook:changegroup --></a>), <a 
 id="dx1-242003"></a><a 
 id="dx1-242004"></a><span 
class="pcrr7tn-">incoming </span>(section&#x00A0;<a 
href="#x1-24000010.9.3">10.9.3<!--tex4ht:ref: sec:hook:incoming --></a>), , <a 
 id="dx1-242005"></a><a 
 id="dx1-242006"></a><span 
class="pcrr7tn-">pretxnchangegroup </span>(section&#x00A0;<a 
href="#x1-24600010.9.9">10.9.9<!--tex4ht:ref: sec:hook:pretxnchangegroup --></a>)
                                                                                         
                                                                                         
</p><!--l. 1207--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.6    </span> <a 
 id="x1-24300010.9.6"></a><span 
class="pcrr7tn-">precommit</span>&#x2014;before starting to commit a changeset</h4>
<!--l. 1210--><p class="noindent">This hook is run before Mercurial begins to commit a new changeset. It is run before Mercurial has any of the metadata for the
commit, such as the files to be committed, the commit message, or the commit date.
</p><!--l. 1215--><p class="indent">   One use for this hook is to disable the ability to commit new changesets, while still allowing incoming changesets. Another
is to run a build or test, and only allow the commit to begin if the build or test succeeds.
</p><!--l. 1220--><p class="indent">   Parameters to this hook: </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">parent1</span> </span><span class="dd">A changeset ID. The changeset ID of the first parent of the working directory.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">parent2</span> </span><span class="dd">A changeset ID. The changeset ID of the second parent of the working directory.</li></ul>
<!--l. 1227--><p class="noindent">If the commit proceeds, the parents of the working directory will become the parents of the new changeset.
</p><!--l. 1230--><p class="indent">   See also: <a 
 id="dx1-243001"></a><a 
 id="dx1-243002"></a><span 
class="pcrr7tn-">commit </span>(section&#x00A0;<a 
href="#x1-23900010.9.2">10.9.2<!--tex4ht:ref: sec:hook:commit --></a>), <a 
 id="dx1-243003"></a><a 
 id="dx1-243004"></a><span 
class="pcrr7tn-">pretxncommit </span>(section&#x00A0;<a 
href="#x1-24700010.9.10">10.9.10<!--tex4ht:ref: sec:hook:pretxncommit --></a>)
</p><!--l. 1233--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.7    </span> <a 
 id="x1-24400010.9.7"></a><span 
class="pcrr7tn-">preoutgoing</span>&#x2014;before starting to propagate changesets</h4>
<!--l. 1236--><p class="noindent">This hook is invoked before Mercurial knows the identities of the changesets to be transmitted.
</p><!--l. 1239--><p class="indent">   One use for this hook is to prevent changes from being transmitted to another repository.
</p><!--l. 1242--><p class="indent">   Parameters to this hook: </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">source</span> </span><span class="dd">A  string.  The  source  of  the  operation  that  is  attempting  to  obtain  changes  from  this  repository  (see
     section&#x00A0;<a 
href="#x1-23500010.8.3">10.8.3<!--tex4ht:ref: sec:hook:sources --></a>). See the documentation for the <span 
class="pcrr7tn-">source </span>parameter to the <a 
 id="dx1-244001"></a><a 
 id="dx1-244002"></a><span 
class="pcrr7tn-">outgoing </span>hook, in section&#x00A0;<a 
href="#x1-24100010.9.4">10.9.4<!--tex4ht:ref: sec:hook:outgoing --></a>, for
     possible values of this parameter.
     </span><li><span class="dt">
 <span 
class="pcrr7tn-">url</span> </span><span class="dd">A URL. The location of the remote repository, if known. See section&#x00A0;<a 
href="#x1-23600010.8.3">10.8.3<!--tex4ht:ref: sec:hook:url --></a> for more information.</li></ul>
<!--l. 1254--><p class="indent">   See also: <a 
 id="dx1-244003"></a><a 
 id="dx1-244004"></a><span 
class="pcrr7tn-">outgoing </span>(section&#x00A0;<a 
href="#x1-24100010.9.4">10.9.4<!--tex4ht:ref: sec:hook:outgoing --></a>)
</p><!--l. 1256--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.8    </span> <a 
 id="x1-24500010.9.8"></a><span 
class="pcrr7tn-">pretag</span>&#x2014;before tagging a changeset</h4>
<!--l. 1259--><p class="noindent">This controlling hook is run before a tag is created. If the hook succeeds, creation of the tag proceeds. If the hook fails, the tag
is not created.
</p><!--l. 1263--><p class="indent">   Parameters to this hook: </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">local</span> </span><span class="dd">A boolean. Whether the tag is local to this repository instance (i.e.&#x00A0;stored in <a 
 id="dx1-245001"></a><span 
class="pcrr7tn-">.hg/localtags</span>) or managed by
     Mercurial (stored in <a 
 id="dx1-245002"></a><span 
class="pcrr7tn-">.hgtags</span>).
     </span><li><span class="dt">
<span 
class="pcrr7tn-">node</span> </span><span class="dd">A changeset ID. The ID of the changeset to be tagged.
     </span><li><span class="dt">
 <span 
class="pcrr7tn-">tag</span> </span><span class="dd">A string. The name of the tag to be created.</li></ul>
                                                                                         
                                                                                         
<!--l. 1272--><p class="indent">   If the tag to be created is revision-controlled, the <a 
 id="dx1-245003"></a><a 
 id="dx1-245004"></a><span 
class="pcrr7tn-">precommit </span>and <a 
 id="dx1-245005"></a><a 
 id="dx1-245006"></a><span 
class="pcrr7tn-">pretxncommit </span>hooks (sections&#x00A0;<a 
href="#x1-23900010.9.2">10.9.2<!--tex4ht:ref: sec:hook:commit --></a> and&#x00A0;<a 
href="#x1-24700010.9.10">10.9.10<!--tex4ht:ref: sec:hook:pretxncommit --></a>) will
also be run.
</p><!--l. 1276--><p class="indent">   See also: <a 
 id="dx1-245007"></a><a 
 id="dx1-245008"></a><span 
class="pcrr7tn-">tag </span>(section&#x00A0;<a 
href="#x1-24900010.9.12">10.9.12<!--tex4ht:ref: sec:hook:tag --></a>)
</p><!--l. 1279--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.9    </span> <a 
 id="x1-24600010.9.9"></a><span 
class="pcrr7tn-">pretxnchangegroup</span>&#x2014;before completing addition of remote changesets</h4>
<!--l. 1282--><p class="noindent">This controlling hook is run before a transaction&#x2014;that manages the addition of a group of new changesets from outside
the repository&#x2014;completes. If the hook succeeds, the transaction completes, and all of the changesets become
permanent within this repository. If the hook fails, the transaction is rolled back, and the data for the changesets is
erased.
</p><!--l. 1289--><p class="indent">   This hook can access the metadata associated with the almost-added changesets, but it should not do anything permanent
with this data. It must also not modify the working directory.
</p><!--l. 1293--><p class="indent">   While this hook is running, if other Mercurial processes access this repository, they will be able to see the
almost-added changesets as if they are permanent. This may lead to race conditions if you do not take steps to avoid
them.
</p><!--l. 1298--><p class="indent">   This hook can be used to automatically vet a group of changesets. If the hook fails, all of the changesets are &#x201C;rejected&#x201D;
when the transaction rolls back.
</p><!--l. 1302--><p class="indent">   Parameters to this hook: </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">node</span> </span><span class="dd">A changeset ID. The changeset ID of the first changeset in the group that was added. All changesets between
     this and <a 
 id="dx1-246001"></a><span 
class="pcrr7tn-">tip</span>, inclusive, were added by a single <a 
 id="dx1-246002"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D;, <a 
 id="dx1-246003"></a>&#x201C;<span 
class="pcrr7tn-">hg push</span>&#x201D; or <a 
 id="dx1-246004"></a>&#x201C;<span 
class="pcrr7tn-">hg unbundle</span>&#x201D;.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">source</span> </span><span class="dd">A string. The source of these changes. See section&#x00A0;<a 
href="#x1-23500010.8.3">10.8.3<!--tex4ht:ref: sec:hook:sources --></a> for details.
     </span><li><span class="dt">
 <span 
class="pcrr7tn-">url</span> </span><span class="dd">A URL. The location of the remote repository, if known. See section&#x00A0;<a 
href="#x1-23600010.8.3">10.8.3<!--tex4ht:ref: sec:hook:url --></a> for more information.</li></ul>
<!--l. 1314--><p class="indent">   See also: <a 
 id="dx1-246005"></a><a 
 id="dx1-246006"></a><span 
class="pcrr7tn-">changegroup </span>(section&#x00A0;<a 
href="#x1-23800010.9.1">10.9.1<!--tex4ht:ref: sec:hook:changegroup --></a>), <a 
 id="dx1-246007"></a><a 
 id="dx1-246008"></a><span 
class="pcrr7tn-">incoming </span>(section&#x00A0;<a 
href="#x1-24000010.9.3">10.9.3<!--tex4ht:ref: sec:hook:incoming --></a>), <a 
 id="dx1-246009"></a><a 
 id="dx1-246010"></a><span 
class="pcrr7tn-">prechangegroup </span>(section&#x00A0;<a 
href="#x1-24200010.9.5">10.9.5<!--tex4ht:ref: sec:hook:prechangegroup --></a>)
</p><!--l. 1318--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.10    </span> <a 
 id="x1-24700010.9.10"></a><span 
class="pcrr7tn-">pretxncommit</span>&#x2014;before completing commit of new changeset</h4>
<!--l. 1321--><p class="noindent">This controlling hook is run before a transaction&#x2014;that manages a new commit&#x2014;completes. If the hook succeeds, the
transaction completes and the changeset becomes permanent within this repository. If the hook fails, the transaction is rolled
back, and the commit data is erased.
</p><!--l. 1327--><p class="indent">   This hook can access the metadata associated with the almost-new changeset, but it should not do anything permanent with
this data. It must also not modify the working directory.
</p><!--l. 1331--><p class="indent">   While this hook is running, if other Mercurial processes access this repository, they will be able to see the
almost-new changeset as if it is permanent. This may lead to race conditions if you do not take steps to avoid
them.
</p><!--l. 1336--><p class="indent">   Parameters to this hook: </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">node</span> </span><span class="dd">A changeset ID. The changeset ID of the newly committed changeset.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">parent1</span> </span><span class="dd">A changeset ID. The changeset ID of the first parent of the newly committed changeset.
                                                                                         
                                                                                         
     </span><li><span class="dt">
<span 
class="pcrr7tn-">parent2</span> </span><span class="dd">A changeset ID. The changeset ID of the second parent of the newly committed changeset.</li></ul>
<!--l. 1346--><p class="indent">   See also: <a 
 id="dx1-247001"></a><a 
 id="dx1-247002"></a><span 
class="pcrr7tn-">precommit </span>(section&#x00A0;<a 
href="#x1-24300010.9.6">10.9.6<!--tex4ht:ref: sec:hook:precommit --></a>)
</p><!--l. 1348--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.11    </span> <a 
 id="x1-24800010.9.11"></a><span 
class="pcrr7tn-">preupdate</span>&#x2014;before updating or merging working directory</h4>
<!--l. 1351--><p class="noindent">This controlling hook is run before an update or merge of the working directory begins. It is run only if Mercurial&#x2019;s normal
pre-update checks determine that the update or merge can proceed. If the hook succeeds, the update or merge may proceed; if it
fails, the update or merge does not start.
</p><!--l. 1357--><p class="indent">   Parameters to this hook: </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">parent1</span> </span><span class="dd">A changeset ID. The ID of the parent that the working directory is to be updated to. If the working directory is
     being merged, it will not change this parent.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">parent2</span> </span><span class="dd">A changeset ID. Only set if the working directory is being merged. The ID of the revision that the working
     directory is being merged with.</li></ul>
<!--l. 1367--><p class="indent">   See also: <a 
 id="dx1-248001"></a><a 
 id="dx1-248002"></a><span 
class="pcrr7tn-">update </span>(section&#x00A0;<a 
href="#x1-25000010.9.13">10.9.13<!--tex4ht:ref: sec:hook:update --></a>)
</p><!--l. 1369--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.12    </span> <a 
 id="x1-24900010.9.12"></a><span 
class="pcrr7tn-">tag</span>&#x2014;after tagging a changeset</h4>
<!--l. 1372--><p class="noindent">This hook is run after a tag has been created.
</p><!--l. 1374--><p class="indent">   Parameters to this hook: </p>
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">local</span> </span><span class="dd">A boolean. Whether the new tag is local to this repository instance (i.e.&#x00A0;stored in <a 
 id="dx1-249001"></a><span 
class="pcrr7tn-">.hg/localtags</span>) or managed
     by Mercurial (stored in <a 
 id="dx1-249002"></a><span 
class="pcrr7tn-">.hgtags</span>).
     </span><li><span class="dt">
<span 
class="pcrr7tn-">node</span> </span><span class="dd">A changeset ID. The ID of the changeset that was tagged.
     </span><li><span class="dt">
 <span 
class="pcrr7tn-">tag</span> </span><span class="dd">A string. The name of the tag that was created.</li></ul>
<!--l. 1384--><p class="indent">   If the created tag is revision-controlled, the <a 
 id="dx1-249003"></a><a 
 id="dx1-249004"></a><span 
class="pcrr7tn-">commit </span>hook (section&#x00A0;<a 
href="#x1-23900010.9.2">10.9.2<!--tex4ht:ref: sec:hook:commit --></a>) is run before this hook.
</p><!--l. 1387--><p class="indent">   See also: <a 
 id="dx1-249005"></a><a 
 id="dx1-249006"></a><span 
class="pcrr7tn-">pretag </span>(section&#x00A0;<a 
href="#x1-24500010.9.8">10.9.8<!--tex4ht:ref: sec:hook:pretag --></a>)
</p><!--l. 1389--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.9.13    </span> <a 
 id="x1-25000010.9.13"></a><span 
class="pcrr7tn-">update</span>&#x2014;after updating or merging working directory</h4>
<!--l. 1392--><p class="noindent">This hook is run after an update or merge of the working directory completes. Since a merge can fail (if the external <a 
 id="dx1-250001"></a><span 
class="pcrr7tn-">hgmerge</span>
command fails to resolve conflicts in a file), this hook communicates whether the update or merge completed
cleanly.
</p>
                                                                                         
                                                                                         
     <ul><li><span class="dt">
<span 
class="pcrr7tn-">error</span> </span><span class="dd">A boolean. Indicates whether the update or merge completed successfully.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">parent1</span> </span><span class="dd">A changeset ID. The ID of the parent that the working directory was updated to. If the working directory was
     merged, it will not have changed this parent.
     </span><li><span class="dt">
<span 
class="pcrr7tn-">parent2</span> </span><span class="dd">A changeset ID. Only set if the working directory was merged. The ID of the revision that the working directory
     was merged with.</li></ul>
<!--l. 1408--><p class="indent">   See also: <a 
 id="dx1-250002"></a><a 
 id="dx1-250003"></a><span 
class="pcrr7tn-">preupdate </span>(section&#x00A0;<a 
href="#x1-24800010.9.11">10.9.11<!--tex4ht:ref: sec:hook:preupdate --></a>)
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
</p>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;11</span><br /><a 
 id="x1-25100011"></a>Customising the output of Mercurial</h2>
<!--l. 4--><p class="noindent">Mercurial provides a powerful mechanism to let you control how it displays information. The mechanism is based on
templates. You can use templates to generate specific output for a single command, or to customise the entire appearance of the
built-in web interface.
</p>
   <h3 class="sectionHead"><span class="titlemark">11.1    </span> <a 
 id="x1-25200011.1"></a>Using precanned output styles</h3>
<!--l. 12--><p class="noindent">Packaged with Mercurial are some output styles that you can use immediately. A style is simply a precanned template that
someone wrote and installed somewhere that Mercurial can find.
</p><!--l. 16--><p class="indent">   Before we take a look at Mercurial&#x2019;s bundled styles, let&#x2019;s review its normal output.
</p><!--l. 19--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-252002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span>
<br class="fancyvrb" /><a 
 id="x1-252004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:37f903b308e5</span>
<br class="fancyvrb" /><a 
 id="x1-252006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;mytag</span>
<br class="fancyvrb" /><a 
 id="x1-252008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-252010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:26</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-252012r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-252014r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 21--><p class="indent">   This is somewhat informative, but it takes up a lot of space&#x2014;five lines of output per changeset. The <span 
class="pcrr7tn-">compact </span>style reduces
this to three lines, presented in a sparse manner.
</p><!--l. 25--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-252016r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;--style</span><span 
class="pcrb7t-">&#x00A0;compact</span>
<br class="fancyvrb" /><a 
 id="x1-252018r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3[tip]</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;ee5ab79601d1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-252020r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;v0.1</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;3e6934fa6d03</span>
<br class="fancyvrb" /><a 
 id="x1-252022r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-252024r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2[v0.1]</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3e6934fa6d03</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-252026r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;mytag</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;37f903b308e5</span>
<br class="fancyvrb" /><a 
 id="x1-252028r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-252030r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1[mytag]</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;37f903b308e5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-252032r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-252034r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-252036r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2ee744e761f3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-252038r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;hello</span>
<br class="fancyvrb" /><a 
 id="x1-252040r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 27--><p class="indent">   The <span 
class="pcrr7tn-">changelog </span>style hints at the expressive power of Mercurial&#x2019;s templating engine. This style attempts to follow the GNU
Project&#x2019;s changelog guidelines<span class="cite">[<span 
class="ptmb7t-">?</span>]</span>.
</p><!--l. 31--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-252042r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;--style</span><span 
class="pcrb7t-">&#x00A0;changelog</span>
<br class="fancyvrb" /><a 
 id="x1-252044r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-252046r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-252048r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        &#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;.hgtags:</span>
<br class="fancyvrb" /><a 
 id="x1-252050r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        Added</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;v0.1</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;3e6934fa6d03</span>
<br class="fancyvrb" /><a 
 id="x1-252052r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        [ee5ab79601d1]</span><span 
class="pcrr7tn-">&#x00A0;[tip]</span>
<br class="fancyvrb" /><a 
 id="x1-252054r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-252056r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        &#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;.hgtags:</span>
<br class="fancyvrb" /><a 
 id="x1-252058r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        Added</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;mytag</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;37f903b308e5</span>
<br class="fancyvrb" /><a 
 id="x1-252060r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        [3e6934fa6d03]</span><span 
class="pcrr7tn-">&#x00A0;[v0.1]</span>
<br class="fancyvrb" /><a 
 id="x1-252062r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-252064r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        &#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;goodbye,</span><span 
class="pcrr7tn-">&#x00A0;hello:</span>
<br class="fancyvrb" /><a 
 id="x1-252066r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-252068r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-252070r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        in</span><span 
class="pcrr7tn-">&#x00A0;addition,</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;helpful</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;(at</span><span 
class="pcrr7tn-">&#x00A0;least</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;hope</span>
<br class="fancyvrb" /><a 
 id="x1-252072r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        that</span><span 
class="pcrr7tn-">&#x00A0;some</span><span 
class="pcrr7tn-">&#x00A0;might</span><span 
class="pcrr7tn-">&#x00A0;consider</span><span 
class="pcrr7tn-">&#x00A0;it</span><span 
class="pcrr7tn-">&#x00A0;so)</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;goodbye.</span>
<br class="fancyvrb" /><a 
 id="x1-252074r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        [37f903b308e5]</span><span 
class="pcrr7tn-">&#x00A0;[mytag]</span>
<br class="fancyvrb" /><a 
 id="x1-252076r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-252078r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        &#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;hello:</span>
<br class="fancyvrb" /><a 
 id="x1-252080r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        added</span><span 
class="pcrr7tn-">&#x00A0;hello</span>
<br class="fancyvrb" /><a 
 id="x1-252082r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        [2ee744e761f3]</span>
<br class="fancyvrb" /><a 
 id="x1-252084r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 33--><p class="indent">   You will not be shocked to learn that Mercurial&#x2019;s default output style is named <span 
class="pcrr7tn-">default</span>.
</p><!--l. 36--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.1.1    </span> <a 
 id="x1-25300011.1.1"></a>Setting a default style</h4>
<!--l. 38--><p class="noindent">You can modify the output style that Mercurial will use for every command by editing your <a 
 id="dx1-253001"></a><a 
 id="dx1-253002"></a><span 
class="pcrr7tn-">hgrc</span>&#x00A0;file, naming the style you
would prefer to use.
</p><!--l. 42--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-253004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[ui]</span>
<br class="fancyvrb" /><a 
 id="x1-253006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;style</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;compact</span>
   </div>
<!--l. 47--><p class="indent">   If you write a style of your own, you can use it by either providing the path to your style file, or copying your style
file into a location where Mercurial can find it (typically the <span 
class="pcrr7tn-">templates </span>subdirectory of your Mercurial install
directory).
</p><!--l. 52--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">11.2    </span> <a 
 id="x1-25400011.2"></a>Commands that support styles and templates</h3>
<!--l. 54--><p class="noindent">All of Mercurial&#x2019;s &#x201C;<span 
class="pcrr7tn-">log</span>-like&#x201D; commands let you use styles and templates: <a 
 id="dx1-254001"></a>&#x201C;<span 
class="pcrr7tn-">hg incoming</span>&#x201D;, <a 
 id="dx1-254002"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D;, <a 
 id="dx1-254003"></a>&#x201C;<span 
class="pcrr7tn-">hg outgoing</span>&#x201D;, and
<a 
 id="dx1-254004"></a>&#x201C;<span 
class="pcrr7tn-">hg tip</span>&#x201D;.
</p><!--l. 58--><p class="indent">   As I write this manual, these are so far the only commands that support styles and templates. Since these are the most
important commands that need customisable output, there has been little pressure from the Mercurial user community to add
style and template support to other commands.
                                                                                         
                                                                                         
</p><!--l. 64--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">11.3    </span> <a 
 id="x1-25500011.3"></a>The basics of templating</h3>
<!--l. 66--><p class="noindent">At its simplest, a Mercurial template is a piece of text. Some of the text never changes, while other parts are <span 
class="ptmri7t-">expanded</span>, or
replaced with new text, when necessary.
</p><!--l. 70--><p class="indent">   Before we continue, let&#x2019;s look again at a simple example of Mercurial&#x2019;s normal output.
</p><!--l. 73--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-255002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span>
<br class="fancyvrb" /><a 
 id="x1-255004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:37f903b308e5</span>
<br class="fancyvrb" /><a 
 id="x1-255006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;mytag</span>
<br class="fancyvrb" /><a 
 id="x1-255008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-255010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:26</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-255012r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-255014r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 75--><p class="indent">   Now, let&#x2019;s run the same command, but using a template to change its output.
</p><!--l. 78--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-255016r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'i</span><span 
class="pcrb7t-">&#x00A0;saw</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;changeset</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-255018r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;saw</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;changeset</span>
   </div>
<!--l. 80--><p class="indent">   The example above illustrates the simplest possible template; it&#x2019;s just a piece of static text, printed once for each changeset.
The <a 
 id="dx1-255019"></a><span 
class="pcrr7tn-">--template </span>option to the <a 
 id="dx1-255020"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; command tells Mercurial to use the given text as the template when printing each
changeset.
</p><!--l. 86--><p class="indent">   Notice that the template string above ends with the text &#x201C;<span class="verb"><span 
class="pcrr7tn-">\n</span></span>&#x201D;. This is an <span 
class="ptmri7t-">escape sequence</span>, telling Mercurial to print a
newline at the end of each template item. If you omit this newline, Mercurial will run each piece of output together. See
section&#x00A0;<a 
href="#x1-25700011.5">11.5<!--tex4ht:ref: sec:template:escape --></a> for more details of escape sequences.
</p><!--l. 92--><p class="indent">   A template that prints a fixed string of text all the time isn&#x2019;t very useful; let&#x2019;s try something a bit more complex.
</p><!--l. 95--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-255022r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'i</span><span 
class="pcrb7t-">&#x00A0;saw</span><span 
class="pcrb7t-">&#x00A0;a</span><span 
class="pcrb7t-">&#x00A0;changeset:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">desc</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-255024r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;saw</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;v0.1</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;3e6934fa6d03</span>
<br class="fancyvrb" /><a 
 id="x1-255026r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;saw</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;Added</span><span 
class="pcrr7tn-">&#x00A0;tag</span><span 
class="pcrr7tn-">&#x00A0;mytag</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;37f903b308e5</span>
<br class="fancyvrb" /><a 
 id="x1-255028r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;saw</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-255030r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-255032r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;addition,</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;helpful</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;(at</span><span 
class="pcrr7tn-">&#x00A0;least</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;hope</span><span 
class="pcrr7tn-">&#x00A0;that</span><span 
class="pcrr7tn-">&#x00A0;some</span><span 
class="pcrr7tn-">&#x00A0;might</span><span 
class="pcrr7tn-">&#x00A0;consider</span><span 
class="pcrr7tn-">&#x00A0;it</span><span 
class="pcrr7tn-">&#x00A0;so)</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;goodbye.</span>
<br class="fancyvrb" /><a 
 id="x1-255034r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;saw</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;hello</span>
   </div>
<!--l. 97--><p class="indent">   As you can see, the string &#x201C;<span class="verb"><span 
class="pcrr7tn-">{desc}</span></span>&#x201D; in the template has been replaced in the output with the description of each
changeset. Every time Mercurial finds text enclosed in curly braces (&#x201C;<span 
class="cmsy-10">{</span>&#x201D; and &#x201C;<span 
class="cmsy-10">}</span>&#x201D;), it will try to replace the braces and
text with the expansion of whatever is inside. To print a literal curly brace, you must escape it, as described in
section&#x00A0;<a 
href="#x1-25700011.5">11.5<!--tex4ht:ref: sec:template:escape --></a>.
                                                                                         
                                                                                         
</p><!--l. 104--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">11.4    </span> <a 
 id="x1-25600011.4"></a>Common template keywords</h3>
<!--l. 107--><p class="noindent">You can start writing simple templates immediately using the keywords below.
</p>
     <ul><li><span class="dt">
<a 
 id="dx1-256001"></a><a 
 id="dx1-256002"></a><span 
class="pcrr7tn-">author</span> </span><span class="dd">String. The unmodified author of the changeset.
     </span><li><span class="dt">
<a 
 id="dx1-256003"></a><a 
 id="dx1-256004"></a><span 
class="pcrr7tn-">branches</span> </span><span class="dd">String. The name of the branch on which the changeset was committed. Will be empty if the branch name was
     <span 
class="pcrr7tn-">default</span>.
     </span><li><span class="dt">
<a 
 id="dx1-256005"></a><a 
 id="dx1-256006"></a><span 
class="pcrr7tn-">date</span> </span><span class="dd">Date information. The date when the changeset was committed. This is <span 
class="ptmri7t-">not </span>human-readable; you must pass it
     through a filter that will render it appropriately. See section&#x00A0;<a 
href="#x1-25800011.6">11.6<!--tex4ht:ref: sec:template:filter --></a> for more information on filters. The date is
     expressed as a pair of numbers. The first number is a Unix UTC timestamp (seconds since January 1, 1970); the
     second is the offset of the committer&#x2019;s timezone from UTC, in seconds.
     </span><li><span class="dt">
<a 
 id="dx1-256007"></a><a 
 id="dx1-256008"></a><span 
class="pcrr7tn-">desc</span> </span><span class="dd">String. The text of the changeset description.
     </span><li><span class="dt">
<a 
 id="dx1-256009"></a><a 
 id="dx1-256010"></a><span 
class="pcrr7tn-">files</span> </span><span class="dd">List of strings. All files modified, added, or removed by this changeset.
     </span><li><span class="dt">
<a 
 id="dx1-256011"></a><a 
 id="dx1-256012"></a><span 
class="pcrr7tn-">file</span><span 
class="pcrr7tn-">_adds</span> </span><span class="dd">List of strings. Files added by this changeset.
     </span><li><span class="dt">
<a 
 id="dx1-256013"></a><a 
 id="dx1-256014"></a><span 
class="pcrr7tn-">file</span><span 
class="pcrr7tn-">_dels</span> </span><span class="dd">List of strings. Files removed by this changeset.
     </span><li><span class="dt">
<a 
 id="dx1-256015"></a><a 
 id="dx1-256016"></a><span 
class="pcrr7tn-">node</span> </span><span class="dd">String. The changeset identification hash, as a 40-character hexadecimal string.
     </span><li><span class="dt">
<a 
 id="dx1-256017"></a><a 
 id="dx1-256018"></a><span 
class="pcrr7tn-">parents</span> </span><span class="dd">List of strings. The parents of the changeset.
     </span><li><span class="dt">
 <a 
 id="dx1-256019"></a><a 
 id="dx1-256020"></a><span 
class="pcrr7tn-">rev</span> </span><span class="dd">Integer. The repository-local changeset revision number.
     </span><li><span class="dt">
<a 
 id="dx1-256021"></a><a 
 id="dx1-256022"></a><span 
class="pcrr7tn-">tags</span> </span><span class="dd">List of strings. Any tags associated with the changeset.</li></ul>
<!--l. 139--><p class="indent">   A few simple experiments will show us what to expect when we use these keywords; you can see the results in
figure&#x00A0;<a 
href="#x1-2560651">11.1<!--tex4ht:ref: fig:template:keywords --></a>.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2560651"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-256024r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'author:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">author</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-256026r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;author:</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-256028r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'desc:</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrb7t-">n</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">desc</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-256030r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;desc:</span>
<br class="fancyvrb" /><a 
 id="x1-256032r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-256034r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-256036r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;addition,</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;helpful</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;(at</span><span 
class="pcrr7tn-">&#x00A0;least</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;hope</span><span 
class="pcrr7tn-">&#x00A0;that</span><span 
class="pcrr7tn-">&#x00A0;some</span><span 
class="pcrr7tn-">&#x00A0;might</span><span 
class="pcrr7tn-">&#x00A0;consider</span><span 
class="pcrr7tn-">&#x00A0;it</span><span 
class="pcrr7tn-">&#x00A0;so)</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;goodbye.</span>
<br class="fancyvrb" /><a 
 id="x1-256038r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'files:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">files</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-256040r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;files:</span><span 
class="pcrr7tn-">&#x00A0;goodbye</span><span 
class="pcrr7tn-">&#x00A0;hello</span>
<br class="fancyvrb" /><a 
 id="x1-256042r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'file_adds:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">file_adds</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-256044r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;file_adds:</span>
<br class="fancyvrb" /><a 
 id="x1-256046r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'file_dels:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">file_dels</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-256048r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;file_dels:</span>
<br class="fancyvrb" /><a 
 id="x1-256050r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'node:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">node</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-256052r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;node:</span><span 
class="pcrr7tn-">&#x00A0;37f903b308e526999d6dec2956323705e60307b9</span>
<br class="fancyvrb" /><a 
 id="x1-256054r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'parents:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">parents</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-256056r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;parents:</span>
<br class="fancyvrb" /><a 
 id="x1-256058r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'rev:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">rev</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-256060r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;rev:</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-256062r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'tags:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">tags</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-256064r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tags:</span><span 
class="pcrr7tn-">&#x00A0;mytag</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;11.1: </td><td  
class="content">Template keywords in use</td></tr></table><!--tex4ht:label?: x1-2560651 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 149--><p class="indent">   As we noted above, the date keyword does not produce human-readable output, so we must treat it specially. This involves
using a <span 
class="ptmri7t-">filter</span>, about which more in section&#x00A0;<a 
href="#x1-25800011.6">11.6<!--tex4ht:ref: sec:template:filter --></a>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-256067r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'date:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">date</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-256069r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;1209254666.00</span>
<br class="fancyvrb" /><a 
 id="x1-256071r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'date:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">date|isodate</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-256073r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
   </div>
   <h3 class="sectionHead"><span class="titlemark">11.5    </span> <a 
 id="x1-25700011.5"></a>Escape sequences</h3>
<!--l. 158--><p class="noindent">Mercurial&#x2019;s templating engine recognises the most commonly used escape sequences in strings. When it sees a backslash (&#x201C;<span class="verb"><span 
class="pcrr7tn-">\</span></span>&#x201D;)
character, it looks at the following character and substitutes the two characters with a single replacement, as described
below.
</p>
     <ul><li><span class="dt">
  <span class="verb"><span 
class="cmsy-10">&#x2216;&#x2216;</span></span> </span><span class="dd">Backslash, &#x201C;<span class="verb"><span 
class="pcrr7tn-">\</span></span>&#x201D;, ASCII&#x00A0;134.
     </span><li><span class="dt">
  <span class="verb"><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">n</span></span> </span><span class="dd">Newline, ASCII&#x00A0;12.
     </span><li><span class="dt">
  <span class="verb"><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">r</span></span> </span><span class="dd">Carriage return, ASCII&#x00A0;15.
     </span><li><span class="dt">
  <span class="verb"><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">t</span></span> </span><span class="dd">Tab, ASCII&#x00A0;11.
     </span><li><span class="dt">
  <span class="verb"><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">v</span></span> </span><span class="dd">Vertical tab, ASCII&#x00A0;13.
     </span><li><span class="dt">
  <span class="verb"><span 
class="cmsy-10">&#x2216;{</span></span> </span><span class="dd">Open curly brace, &#x201C;<span class="verb"><span 
class="pcrr7tn-">{</span></span>&#x201D;, ASCII&#x00A0;173.
     </span><li><span class="dt">
  <span class="verb"><span 
class="cmsy-10">&#x2216;}</span></span> </span><span class="dd">Close curly brace, &#x201C;<span class="verb"><span 
class="pcrr7tn-">}</span></span>&#x201D;, ASCII&#x00A0;175.</li></ul>
<!--l. 174--><p class="indent">   As indicated above, if you want the expansion of a template to contain a literal &#x201C;<span class="verb"><span 
class="pcrr7tn-">\</span></span>&#x201D;, &#x201C;<span class="verb"><span 
class="pcrr7tn-">{</span></span>&#x201D;, or &#x201C;<span class="verb"><span 
class="pcrr7tn-">{</span></span>&#x201D; character, you must escape
it.
</p><!--l. 178--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">11.6    </span> <a 
 id="x1-25800011.6"></a>Filtering keywords to change their results</h3>
<!--l. 181--><p class="noindent">Some of the results of template expansion are not immediately easy to use. Mercurial lets you specify an optional chain of
<span 
class="ptmri7t-">filters </span>to modify the result of expanding a keyword. You have already seen a common filter, <a 
 id="dx1-258001"></a><a 
 id="dx1-258002"></a><a 
 id="dx1-258003"></a><span 
class="pcrr7tn-">isodate</span>, in action above, to make
a date readable.
</p><!--l. 187--><p class="indent">   Below is a list of the most commonly used filters that Mercurial supports. While some filters can be applied to any text,
others can only be used in specific circumstances. The name of each filter is followed first by an indication of where it can be
used, then a description of its effect.
                                                                                         
                                                                                         
</p>
     <ul><li><span class="dt">
<a 
 id="dx1-258004"></a><a 
 id="dx1-258005"></a><span 
class="pcrr7tn-">addbreaks</span> </span><span class="dd">Any text. Add an XHTML &#x201C;<span class="verb"><span 
class="pcrr7tn-">&#x003c;br/&#x003e;</span></span>&#x201D; tag before the end of every line except the last. For example, &#x201C;<span class="verb"><span 
class="pcrr7tn-">foo\nbar</span></span>&#x201D;
     becomes &#x201C;<span class="verb"><span 
class="pcrr7tn-">foo&#x003c;br/&#x003e;\nbar</span></span>&#x201D;.
     </span><li><span class="dt">
 <a 
 id="dx1-258006"></a><a 
 id="dx1-258007"></a><a 
 id="dx1-258008"></a><span 
class="pcrr7tn-">age</span> </span><span class="dd"><a 
 id="dx1-258009"></a><a 
 id="dx1-258010"></a><span 
class="pcrr7tn-">date </span>keyword. Render the age of the date, relative to the current time. Yields a string like &#x201C;<span class="verb"><span 
class="pcrr7tn-">10</span><span 
class="pcrr7tn-">&#x00A0;minutes</span></span>&#x201D;.
     </span><li><span class="dt">
<a 
 id="dx1-258011"></a><a 
 id="dx1-258012"></a><span 
class="pcrr7tn-">basename</span> </span><span class="dd">Any  text,  but  most  useful  for  the  <a 
 id="dx1-258013"></a><a 
 id="dx1-258014"></a><span 
class="pcrr7tn-">files </span>keyword  and  its  relatives.  Treat  the  text  as  a  path,  and  return  the
     basename. For example, &#x201C;<span class="verb"><span 
class="pcrr7tn-">foo/bar/baz</span></span>&#x201D; becomes &#x201C;<span class="verb"><span 
class="pcrr7tn-">baz</span></span>&#x201D;.
     </span><li><span class="dt">
<a 
 id="dx1-258015"></a><a 
 id="dx1-258016"></a><a 
 id="dx1-258017"></a><span 
class="pcrr7tn-">date</span> </span><span class="dd"><a 
 id="dx1-258018"></a><a 
 id="dx1-258019"></a><span 
class="pcrr7tn-">date </span>keyword. Render a date in a similar format to the Unix <a 
 id="dx1-258020"></a><a 
 id="dx1-258021"></a><span 
class="pcrr7tn-">date </span>command, but with timezone included. Yields
     a string like &#x201C;<span class="verb"><span 
class="pcrr7tn-">Mon</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;04</span><span 
class="pcrr7tn-">&#x00A0;15:13:13</span><span 
class="pcrr7tn-">&#x00A0;2006</span><span 
class="pcrr7tn-">&#x00A0;-0700</span></span>&#x201D;.
     </span><li><span class="dt">
<a 
 id="dx1-258022"></a><a 
 id="dx1-258023"></a><a 
 id="dx1-258024"></a><span 
class="pcrr7tn-">domain</span> </span><span class="dd">Any text, but most useful for the <a 
 id="dx1-258025"></a><a 
 id="dx1-258026"></a><span 
class="pcrr7tn-">author </span>keyword. Finds the first string that looks like an email address, and
     extract  just  the  domain  component.  For  example,  &#x201C;<span class="verb"><span 
class="pcrr7tn-">Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span></span>&#x201D;  becomes
     &#x201C;<span class="verb"><span 
class="pcrr7tn-">serpentine.com</span></span>&#x201D;.
     </span><li><span class="dt">
<a 
 id="dx1-258027"></a><a 
 id="dx1-258028"></a><a 
 id="dx1-258029"></a><span 
class="pcrr7tn-">email</span> </span><span class="dd">Any text, but most useful for the <a 
 id="dx1-258030"></a><a 
 id="dx1-258031"></a><span 
class="pcrr7tn-">author </span>keyword. Extract the first string that looks like an email address. For
     example, &#x201C;<span class="verb"><span 
class="pcrr7tn-">Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span></span>&#x201D; becomes &#x201C;<span class="verb"><span 
class="pcrr7tn-">bos@serpentine.com</span></span>&#x201D;.
     </span><li><span class="dt">
<a 
 id="dx1-258032"></a><a 
 id="dx1-258033"></a><span 
class="pcrr7tn-">escape</span> </span><span class="dd">Any text. Replace the special XML/XHTML characters &#x201C;<span class="verb"><span 
class="pcrr7tn-">&</span></span>&#x201D;, &#x201C;<span class="verb"><span 
class="pcrr7tn-">&#x003c;</span></span>&#x201D; and &#x201C;<span class="verb"><span 
class="pcrr7tn-">&#x003e;</span></span>&#x201D; with XML entities.
     </span><li><span class="dt">
<a 
 id="dx1-258034"></a><a 
 id="dx1-258035"></a><span 
class="pcrr7tn-">fill68</span> </span><span class="dd">Any text. Wrap the text to fit in 68 columns. This is useful before you pass text through the <a 
 id="dx1-258036"></a><a 
 id="dx1-258037"></a><span 
class="pcrr7tn-">tabindent </span>filter,
     and still want it to fit in an 80-column fixed-font window.
     </span><li><span class="dt">
<a 
 id="dx1-258038"></a><a 
 id="dx1-258039"></a><span 
class="pcrr7tn-">fill76</span> </span><span class="dd">Any text. Wrap the text to fit in 76 columns.
     </span><li><span class="dt">
<a 
 id="dx1-258040"></a><a 
 id="dx1-258041"></a><span 
class="pcrr7tn-">firstline</span> </span><span class="dd">Any text. Yield the first line of text, without any trailing newlines.
     </span><li><span class="dt">
<a 
 id="dx1-258042"></a><a 
 id="dx1-258043"></a><a 
 id="dx1-258044"></a><span 
class="pcrr7tn-">hgdate</span> </span><span class="dd"><a 
 id="dx1-258045"></a><a 
 id="dx1-258046"></a><span 
class="pcrr7tn-">date </span>keyword. Render the date as a pair of readable numbers. Yields a string like &#x201C;<span class="verb"><span 
class="pcrr7tn-">1157407993</span><span 
class="pcrr7tn-">&#x00A0;25200</span></span>&#x201D;.
     </span><li><span class="dt">
<a 
 id="dx1-258047"></a><a 
 id="dx1-258048"></a><a 
 id="dx1-258049"></a><span 
class="pcrr7tn-">isodate</span> </span><span class="dd"><a 
 id="dx1-258050"></a><a 
 id="dx1-258051"></a><span 
class="pcrr7tn-">date  </span>keyword.    Render    the    date    as    a    text    string    in    ISO&#x00A0;8601    format.    Yields    a    string    like
     &#x201C;<span class="verb"><span 
class="pcrr7tn-">2006-09-04</span><span 
class="pcrr7tn-">&#x00A0;15:13:13</span><span 
class="pcrr7tn-">&#x00A0;-0700</span></span>&#x201D;.
     </span><li><span class="dt">
<a 
 id="dx1-258052"></a><a 
 id="dx1-258053"></a><span 
class="pcrr7tn-">obfuscate</span> </span><span class="dd">Any text, but most useful for the <a 
 id="dx1-258054"></a><a 
 id="dx1-258055"></a><span 
class="pcrr7tn-">author </span>keyword. Yield the input text rendered as a sequence of XML entities.
     This helps to defeat some particularly stupid screen-scraping email harvesting spambots.
     </span><li><span class="dt">
<a 
 id="dx1-258056"></a><a 
 id="dx1-258057"></a><a 
 id="dx1-258058"></a><span 
class="pcrr7tn-">person</span> </span><span class="dd">Any  text,  but  most  useful  for  the  <a 
 id="dx1-258059"></a><a 
 id="dx1-258060"></a><span 
class="pcrr7tn-">author </span>keyword.  Yield  the  text  before  an  email  address.  For  example,
     &#x201C;<span class="verb"><span 
class="pcrr7tn-">Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span></span>&#x201D; becomes &#x201C;<span class="verb"><span 
class="pcrr7tn-">Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span></span>&#x201D;.
     </span><li><span class="dt">
<a 
 id="dx1-258061"></a><a 
 id="dx1-258062"></a><a 
 id="dx1-258063"></a><span 
class="pcrr7tn-">rfc822date</span> </span><span class="dd"><a 
 id="dx1-258064"></a><a 
 id="dx1-258065"></a><span 
class="pcrr7tn-">date </span>keyword.   Render   a   date   using   the   same   format   used   in   email   headers.   Yields   a   string   like
     &#x201C;<span class="verb"><span 
class="pcrr7tn-">Mon,</span><span 
class="pcrr7tn-">&#x00A0;04</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;2006</span><span 
class="pcrr7tn-">&#x00A0;15:13:13</span><span 
class="pcrr7tn-">&#x00A0;-0700</span></span>&#x201D;.
                                                                                         
                                                                                         
     </span><li><span class="dt">
<a 
 id="dx1-258066"></a><a 
 id="dx1-258067"></a><a 
 id="dx1-258068"></a><span 
class="pcrr7tn-">short</span> </span><span class="dd">Changeset hash. Yield the short form of a changeset hash, i.e.&#x00A0;a 12-byte hexadecimal string.
     </span><li><span class="dt">
<a 
 id="dx1-258069"></a><a 
 id="dx1-258070"></a><a 
 id="dx1-258071"></a><span 
class="pcrr7tn-">shortdate</span> </span><span class="dd"><a 
 id="dx1-258072"></a><a 
 id="dx1-258073"></a><span 
class="pcrr7tn-">date </span>keyword. Render the year, month, and day of the date. Yields a string like &#x201C;<span class="verb"><span 
class="pcrr7tn-">2006-09-04</span></span>&#x201D;.
     </span><li><span class="dt">
<a 
 id="dx1-258074"></a><a 
 id="dx1-258075"></a><span 
class="pcrr7tn-">strip</span> </span><span class="dd">Any text. Strip all leading and trailing whitespace from the string.
     </span><li><span class="dt">
<a 
 id="dx1-258076"></a><a 
 id="dx1-258077"></a><span 
class="pcrr7tn-">tabindent</span> </span><span class="dd">Any text. Yield the text, with every line except the first starting with a tab character.
     </span><li><span class="dt">
<a 
 id="dx1-258078"></a><a 
 id="dx1-258079"></a><span 
class="pcrr7tn-">urlescape</span> </span><span class="dd">Any text. Escape all characters that are considered &#x201C;special&#x201D; by URL parsers. For example, <span class="verb"><span 
class="pcrr7tn-">foo</span><span 
class="pcrr7tn-">&#x00A0;bar</span></span> becomes
     <span class="verb"><span 
class="pcrr7tn-">foo%20bar</span></span>.
     </span><li><span class="dt">
<a 
 id="dx1-258080"></a><a 
 id="dx1-258081"></a><a 
 id="dx1-258082"></a><span 
class="pcrr7tn-">user</span> </span><span class="dd">Any text, but most useful for the <a 
 id="dx1-258083"></a><a 
 id="dx1-258084"></a><span 
class="pcrr7tn-">author </span>keyword. Return the &#x201C;user&#x201D; portion of an email address. For example,
     &#x201C;<span class="verb"><span 
class="pcrr7tn-">Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span></span>&#x201D; becomes &#x201C;<span class="verb"><span 
class="pcrr7tn-">bos</span></span>&#x201D;.</li></ul>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2582092"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-258086r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">author</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258088r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-258090r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">author|domain</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258092r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;serpentine.com</span>
<br class="fancyvrb" /><a 
 id="x1-258094r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">author|email</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258096r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos@serpentine.com</span>
<br class="fancyvrb" /><a 
 id="x1-258098r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">author|obfuscate</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span><span 
class="pcrb7t-">&#x00A0;|</span><span 
class="pcrb7t-">&#x00A0;cut</span><span 
class="pcrb7t-">&#x00A0;-c-76</span>
<br class="fancyvrb" /><a 
 id="x1-258100r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#66;&#114;&#121;&#97;&#110;&#32;&#79;&#39;&#83;&#117;&#108;&#108;&#105;&#11</span>
<br class="fancyvrb" /><a 
 id="x1-258102r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">author|person</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258104r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span>
<br class="fancyvrb" /><a 
 id="x1-258106r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">author|user</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258108r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-258110r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'looks</span><span 
class="pcrb7t-">&#x00A0;almost</span><span 
class="pcrb7t-">&#x00A0;right,</span><span 
class="pcrb7t-">&#x00A0;but</span><span 
class="pcrb7t-">&#x00A0;actually</span><span 
class="pcrb7t-">&#x00A0;garbage:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">date</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258112r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;looks</span><span 
class="pcrr7tn-">&#x00A0;almost</span><span 
class="pcrr7tn-">&#x00A0;right,</span><span 
class="pcrr7tn-">&#x00A0;but</span><span 
class="pcrr7tn-">&#x00A0;actually</span><span 
class="pcrr7tn-">&#x00A0;garbage:</span><span 
class="pcrr7tn-">&#x00A0;1209254666.00</span>
<br class="fancyvrb" /><a 
 id="x1-258114r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">date|age</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258116r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;second</span>
<br class="fancyvrb" /><a 
 id="x1-258118r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">date|date</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258120r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:26</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-258122r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">date|hgdate</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258124r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1209254666</span><span 
class="pcrr7tn-">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x1-258126r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">date|isodate</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258128r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-258130r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">date|rfc822date</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258132r24"></a><span 
class="ptmr7t-x-x-50">24</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun,</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;00:04:26</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-258134r25"></a><span 
class="ptmr7t-x-x-50">25</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">date|shortdate</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258136r26"></a><span 
class="ptmr7t-x-x-50">26</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span>
<br class="fancyvrb" /><a 
 id="x1-258138r27"></a><span 
class="ptmr7t-x-x-50">27</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">desc</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span><span 
class="pcrb7t-">&#x00A0;|</span><span 
class="pcrb7t-">&#x00A0;cut</span><span 
class="pcrb7t-">&#x00A0;-c-76</span>
<br class="fancyvrb" /><a 
 id="x1-258140r28"></a><span 
class="ptmr7t-x-x-50">28</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-258142r29"></a><span 
class="ptmr7t-x-x-50">29</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-258144r30"></a><span 
class="ptmr7t-x-x-50">30</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;addition,</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;helpful</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;(at</span><span 
class="pcrr7tn-">&#x00A0;least</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;hope</span><span 
class="pcrr7tn-">&#x00A0;that</span><span 
class="pcrr7tn-">&#x00A0;some</span><span 
class="pcrr7tn-">&#x00A0;m</span>
<br class="fancyvrb" /><a 
 id="x1-258146r31"></a><span 
class="ptmr7t-x-x-50">31</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">desc|addbreaks</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span><span 
class="pcrb7t-">&#x00A0;|</span><span 
class="pcrb7t-">&#x00A0;cut</span><span 
class="pcrb7t-">&#x00A0;-c-76</span>
<br class="fancyvrb" /><a 
 id="x1-258148r32"></a><span 
class="ptmr7t-x-x-50">32</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.&#x003c;br/&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-258150r33"></a><span 
class="ptmr7t-x-x-50">33</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;br/&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-258152r34"></a><span 
class="ptmr7t-x-x-50">34</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;addition,</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;helpful</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;(at</span><span 
class="pcrr7tn-">&#x00A0;least</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;hope</span><span 
class="pcrr7tn-">&#x00A0;that</span><span 
class="pcrr7tn-">&#x00A0;some</span><span 
class="pcrr7tn-">&#x00A0;m</span>
<br class="fancyvrb" /><a 
 id="x1-258154r35"></a><span 
class="ptmr7t-x-x-50">35</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">desc|escape</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span><span 
class="pcrb7t-">&#x00A0;|</span><span 
class="pcrb7t-">&#x00A0;cut</span><span 
class="pcrb7t-">&#x00A0;-c-76</span>
<br class="fancyvrb" /><a 
 id="x1-258156r36"></a><span 
class="ptmr7t-x-x-50">36</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&lt;&lt;hello&gt;&gt;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-258158r37"></a><span 
class="ptmr7t-x-x-50">37</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-258160r38"></a><span 
class="ptmr7t-x-x-50">38</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;addition,</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;helpful</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;(at</span><span 
class="pcrr7tn-">&#x00A0;least</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;hope</span><span 
class="pcrr7tn-">&#x00A0;that</span><span 
class="pcrr7tn-">&#x00A0;some</span><span 
class="pcrr7tn-">&#x00A0;m</span>
<br class="fancyvrb" /><a 
 id="x1-258162r39"></a><span 
class="ptmr7t-x-x-50">39</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">desc|fill68</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258164r40"></a><span 
class="ptmr7t-x-x-50">40</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-258166r41"></a><span 
class="ptmr7t-x-x-50">41</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-258168r42"></a><span 
class="ptmr7t-x-x-50">42</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;addition,</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;helpful</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;(at</span><span 
class="pcrr7tn-">&#x00A0;least</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;hope</span>
<br class="fancyvrb" /><a 
 id="x1-258170r43"></a><span 
class="ptmr7t-x-x-50">43</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;that</span><span 
class="pcrr7tn-">&#x00A0;some</span><span 
class="pcrr7tn-">&#x00A0;might</span><span 
class="pcrr7tn-">&#x00A0;consider</span><span 
class="pcrr7tn-">&#x00A0;it</span><span 
class="pcrr7tn-">&#x00A0;so)</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;goodbye.</span>
<br class="fancyvrb" /><a 
 id="x1-258172r44"></a><span 
class="ptmr7t-x-x-50">44</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">desc|fill76</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258174r45"></a><span 
class="ptmr7t-x-x-50">45</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-258176r46"></a><span 
class="ptmr7t-x-x-50">46</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-258178r47"></a><span 
class="ptmr7t-x-x-50">47</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;addition,</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;helpful</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;(at</span><span 
class="pcrr7tn-">&#x00A0;least</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;hope</span><span 
class="pcrr7tn-">&#x00A0;that</span><span 
class="pcrr7tn-">&#x00A0;some</span>
<br class="fancyvrb" /><a 
 id="x1-258180r48"></a><span 
class="ptmr7t-x-x-50">48</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;might</span><span 
class="pcrr7tn-">&#x00A0;consider</span><span 
class="pcrr7tn-">&#x00A0;it</span><span 
class="pcrr7tn-">&#x00A0;so)</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;goodbye.</span>
<br class="fancyvrb" /><a 
 id="x1-258182r49"></a><span 
class="ptmr7t-x-x-50">49</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">desc|firstline</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258184r50"></a><span 
class="ptmr7t-x-x-50">50</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-258186r51"></a><span 
class="ptmr7t-x-x-50">51</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">desc|strip</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span><span 
class="pcrb7t-">&#x00A0;|</span><span 
class="pcrb7t-">&#x00A0;cut</span><span 
class="pcrb7t-">&#x00A0;-c-76</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-258188r52"></a><span 
class="ptmr7t-x-x-50">52</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-258190r53"></a><span 
class="ptmr7t-x-x-50">53</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-258192r54"></a><span 
class="ptmr7t-x-x-50">54</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;addition,</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;helpful</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;(at</span><span 
class="pcrr7tn-">&#x00A0;least</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;hope</span><span 
class="pcrr7tn-">&#x00A0;that</span><span 
class="pcrr7tn-">&#x00A0;some</span><span 
class="pcrr7tn-">&#x00A0;m</span>
<br class="fancyvrb" /><a 
 id="x1-258194r55"></a><span 
class="ptmr7t-x-x-50">55</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">desc|tabindent</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span><span 
class="pcrb7t-">&#x00A0;|</span><span 
class="pcrb7t-">&#x00A0;expand</span><span 
class="pcrb7t-">&#x00A0;|</span><span 
class="pcrb7t-">&#x00A0;cut</span><span 
class="pcrb7t-">&#x00A0;-c-76</span>
<br class="fancyvrb" /><a 
 id="x1-258196r56"></a><span 
class="ptmr7t-x-x-50">56</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-258198r57"></a><span 
class="ptmr7t-x-x-50">57</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-258200r58"></a><span 
class="ptmr7t-x-x-50">58</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;addition,</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;helpful</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;(at</span><span 
class="pcrr7tn-">&#x00A0;least</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;hope</span><span 
class="pcrr7tn-">&#x00A0;tha</span>
<br class="fancyvrb" /><a 
 id="x1-258202r59"></a><span 
class="ptmr7t-x-x-50">59</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">node</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258204r60"></a><span 
class="ptmr7t-x-x-50">60</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;37f903b308e526999d6dec2956323705e60307b9</span>
<br class="fancyvrb" /><a 
 id="x1-258206r61"></a><span 
class="ptmr7t-x-x-50">61</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">node|short</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-258208r62"></a><span 
class="ptmr7t-x-x-50">62</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;37f903b308e5</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;11.2: </td><td  
class="content">Template filters in action</td></tr></table><!--tex4ht:label?: x1-2582092 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:  </span>If you try to apply a filter to a piece of data that it cannot process, Mercurial
will fail and print a Python exception. For example, trying to run the output of the
<span 
class="pcrr7tn-">desc </span>keyword into the <span 
class="pcrr7tn-">isodate </span>filter is not a good idea.                                         </div>
   <h4 class="subsectionHead"><span class="titlemark">11.6.1    </span> <a 
 id="x1-25900011.6.1"></a>Combining filters</h4>
<!--l. 280--><p class="noindent">It is easy to combine filters to yield output in the form you would like. The following chain of filters tidies up a description,
then makes sure that it fits cleanly into 68 columns, then indents it by a further 8&#x00A0;characters (at least on Unix-like systems,
where a tab is conventionally 8&#x00A0;characters wide).
</p><!--l. 286--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-259002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'description:</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrb7t-">n</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrb7t-">t</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">desc|strip|fill68|tabindent</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-259004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;description:</span>
<br class="fancyvrb" /><a 
 id="x1-259006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        added</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;end</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;&#x003c;hello&#x003e;&#x003e;</span><span 
class="pcrr7tn-">&#x00A0;file.</span>
<br class="fancyvrb" /><a 
 id="x1-259008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-259010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        in</span><span 
class="pcrr7tn-">&#x00A0;addition,</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;helpful</span><span 
class="pcrr7tn-">&#x00A0;name</span><span 
class="pcrr7tn-">&#x00A0;(at</span><span 
class="pcrr7tn-">&#x00A0;least</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;hope</span>
<br class="fancyvrb" /><a 
 id="x1-259012r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        that</span><span 
class="pcrr7tn-">&#x00A0;some</span><span 
class="pcrr7tn-">&#x00A0;might</span><span 
class="pcrr7tn-">&#x00A0;consider</span><span 
class="pcrr7tn-">&#x00A0;it</span><span 
class="pcrr7tn-">&#x00A0;so)</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;goodbye.</span>
   </div>
<!--l. 288--><p class="indent">   Note the use of &#x201C;<span class="verb"><span 
class="pcrr7tn-">\t</span></span>&#x201D; (a tab character) in the template to force the first line to be indented; this is necessary since <a 
 id="dx1-259013"></a><a 
 id="dx1-259014"></a><span 
class="pcrr7tn-">tabindent</span>
indents all lines <span 
class="ptmri7t-">except </span>the first.
</p><!--l. 292--><p class="indent">   Keep in mind that the order of filters in a chain is significant. The first filter is applied to the result of the keyword; the
second to the result of the first filter; and so on. For example, using <span class="verb"><span 
class="pcrr7tn-">fill68|tabindent</span></span> gives very different results from
<span class="verb"><span 
class="pcrr7tn-">tabindent|fill68</span></span>.
</p><!--l. 299--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">11.7    </span> <a 
 id="x1-26000011.7"></a>From templates to styles</h3>
<!--l. 301--><p class="noindent">A command line template provides a quick and simple way to format some output. Templates can become verbose,
though, and it&#x2019;s useful to be able to give a template a name. A style file is a template with a name, stored in a
file.
</p><!--l. 306--><p class="indent">   More than that, using a style file unlocks the power of Mercurial&#x2019;s templating engine in ways that are not possible using the
command line <a 
 id="dx1-260001"></a><span 
class="pcrr7tn-">--template </span>option.
</p><!--l. 310--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.7.1    </span> <a 
 id="x1-26100011.7.1"></a>The simplest of style files</h4>
<!--l. 312--><p class="noindent">Our simple style file contains just one line:
</p><!--l. 314--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-261002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'changeset</span><span 
class="pcrb7t-">&#x00A0;=</span><span 
class="pcrb7t-">&#x00A0;"rev:</span><span 
class="pcrb7t-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">rev</span><span 
class="cmsy-10">}&#x2216;</span><span 
class="pcrb7t-">n"'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;rev</span>
<br class="fancyvrb" /><a 
 id="x1-261004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-l1</span><span 
class="pcrb7t-">&#x00A0;--style</span><span 
class="pcrb7t-">&#x00A0;./rev</span>
<br class="fancyvrb" /><a 
 id="x1-261006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;rev:</span><span 
class="pcrr7tn-">&#x00A0;3</span>
   </div>
                                                                                         
                                                                                         
<!--l. 316--><p class="indent">   This tells Mercurial, &#x201C;if you&#x2019;re printing a changeset, use the text on the right as the template&#x201D;.
</p><!--l. 319--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.7.2    </span> <a 
 id="x1-26200011.7.2"></a>Style file syntax</h4>
<!--l. 321--><p class="noindent">The syntax rules for a style file are simple.
</p>
     <ul><li><span class="dt">
     </span><span class="dd">The file is processed one line at a time.
     </span><li><span class="dt">
     </span><span class="dd">Leading and trailing white space are ignored.
     </span><li><span class="dt">
     </span><span class="dd">Empty lines are skipped.
     </span><li><span class="dt">
     </span><span class="dd">If a line starts with either of the characters &#x201C;<span 
class="pcrr7tn-">#</span>&#x201D; or &#x201C;<span 
class="pcrr7tn-">;</span>&#x201D;, the entire line is treated as a comment, and skipped as if
     empty.
     </span><li><span class="dt">
     </span><span class="dd">A  line  starts  with  a  keyword.  This  must  start  with  an  alphabetic  character  or  underscore,  and  can
     subsequently contain any alphanumeric character or underscore. (In regexp notation, a keyword must match
     <span class="verb"><span 
class="pcrr7tn-">[A-Za-z_][A-Za-z0-9_]&#x22C6;</span></span>.)
     </span><li><span class="dt">
     </span><span class="dd">The next element must be an &#x201C;<span 
class="pcrr7tn-">=</span>&#x201D; character, which can be preceded or followed by an arbitrary amount of white
     space.
     </span><li><span class="dt">
     </span><span class="dd">If the rest of the line starts and ends with matching quote characters (either single or double quote), it is treated
     as a template body.
     </span><li><span class="dt">
     </span><span class="dd">If the rest of the line <span 
class="ptmri7t-">does not </span>start with a quote character, it is treated as the name of a file; the contents of this
     file will be read and used as a template body.</li></ul>
<!--l. 351--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">11.8    </span> <a 
 id="x1-26300011.8"></a>Style files by example</h3>
<!--l. 353--><p class="noindent">To illustrate how to write a style file, we will construct a few by example. Rather than provide a complete style file and walk
through it, we&#x2019;ll mirror the usual process of developing a style file by starting with something very simple, and walking through
a series of successively more complete examples.
                                                                                         
                                                                                         
</p><!--l. 359--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.8.1    </span> <a 
 id="x1-26400011.8.1"></a>Identifying mistakes in style files</h4>
<!--l. 361--><p class="noindent">If Mercurial encounters a problem in a style file you are working on, it prints a terse error message that, once you figure out
what it means, is actually quite useful.
</p><!--l. 365--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-264002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;broken.style</span>
<br class="fancyvrb" /><a 
 id="x1-264004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;=</span>
   </div>
<!--l. 367--><p class="indent">   Notice that <span 
class="pcrr7tn-">broken.style </span>attempts to define a <span 
class="pcrr7tn-">changeset </span>keyword, but forgets to give any content for it. When instructed
to use this style file, Mercurial promptly complains.
</p><!--l. 371--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-264006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r1</span><span 
class="pcrb7t-">&#x00A0;--style</span><span 
class="pcrb7t-">&#x00A0;broken.style</span>
<br class="fancyvrb" /><a 
 id="x1-264008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;broken.style:1:</span><span 
class="pcrr7tn-">&#x00A0;parse</span><span 
class="pcrr7tn-">&#x00A0;error</span>
   </div>
<!--l. 373--><p class="indent">   This error message looks intimidating, but it is not too hard to follow.
</p>
     <ul><li><span class="dt">
     </span><span class="dd">The first component is simply Mercurial&#x2019;s way of saying &#x201C;I am giving up&#x201D;.
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-264010r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">abort:</span><span 
class="pcrr7tn-">&#x00A0;broken.style:1:</span><span 
class="pcrr7tn-">&#x00A0;parse</span><span 
class="pcrr7tn-">&#x00A0;error</span>
</div>
     </span><li><span class="dt">
     </span><span class="dd">Next comes the name of the style file that contains the error.
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-264012r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">broken.style</span><span 
class="pcrr7tn-">:1:</span><span 
class="pcrr7tn-">&#x00A0;parse</span><span 
class="pcrr7tn-">&#x00A0;error</span>
</div>
     </span><li><span class="dt">
     </span><span class="dd">Following the file name is the line number where the error was encountered.
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-264014r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;broken.style:</span><span 
class="pcrb7t-">1</span><span 
class="pcrr7tn-">:</span><span 
class="pcrr7tn-">&#x00A0;parse</span><span 
class="pcrr7tn-">&#x00A0;error</span>
</div>
     </span><li><span class="dt">
     </span><span class="dd">Finally, a description of what went wrong.
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-264016r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;broken.style:1:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">parse</span><span 
class="pcrb7t-">&#x00A0;error</span>
</div>
                                                                                         
                                                                                         
     <!--l. 398--><p class="noindent">The description of the problem is not always clear (as in this case), but even when it is cryptic, it is almost always trivial
     to visually inspect the offending line in the style file and see what is wrong.</p></li></ul>
<!--l. 404--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.8.2    </span> <a 
 id="x1-26500011.8.2"></a>Uniquely identifying a repository</h4>
<!--l. 406--><p class="noindent">If you would like to be able to identify a Mercurial repository &#x201C;fairly uniquely&#x201D; using a short string as an identifier, you can use
the first revision in the repository.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-265002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r0</span><span 
class="pcrb7t-">&#x00A0;--template</span><span 
class="pcrb7t-">&#x00A0;'</span><span 
class="cmsy-10">{</span><span 
class="pcrb7t-">node</span><span 
class="cmsy-10">}</span><span 
class="pcrb7t-">'</span>
<br class="fancyvrb" /><a 
 id="x1-265004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2fe64ed16f8f667b336187bd5f7fa5f501fbc6ae</span>
   </div>
<!--l. 410--><p class="noindent">This is not guaranteed to be unique, but it is nevertheless useful in many cases. </p>
     <ul><li><span class="dt">
     </span><span class="dd">It will not work in a completely empty repository, because such a repository does not have a revision&#x00A0;zero.
     </span><li><span class="dt">
     </span><span class="dd">Neither  will  it  work  in  the  (extremely  rare)  case  where  a  repository  is  a  merge  of  two  or  more  formerly
     independent repositories, and you still have those repositories around.</li></ul>
<!--l. 419--><p class="noindent">Here are some uses to which you could put this identifier: </p>
     <ul><li><span class="dt">
     </span><span class="dd">As a key into a table for a database that manages repositories on a server.
     </span><li><span class="dt">
     </span><span class="dd">As half of a <span 
class="zpzccmry-">{</span><span 
class="ptmri7t-">repository</span><span 
class="ptmri7t-">&#x00A0;ID</span>, <span 
class="ptmri7t-">revision</span><span 
class="ptmri7t-">&#x00A0;ID</span><span 
class="zpzccmry-">} </span>tuple. Save this information away when you run an automated build
     or other activity, so that you can &#x201C;replay&#x201D; the build later if necessary.</li></ul>
<!--l. 428--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.8.3    </span> <a 
 id="x1-26600011.8.3"></a>Mimicking Subversion&#x2019;s output</h4>
<!--l. 430--><p class="noindent">Let&#x2019;s try to emulate the default output format used by another revision control tool, Subversion.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-266002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">svn</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r9653</span>
<br class="fancyvrb" /><a 
 id="x1-266004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;------------------------------------------------------------------------</span>
<br class="fancyvrb" /><a 
 id="x1-266006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;r9653</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;sean.hefty</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;2006-09-27</span><span 
class="pcrr7tn-">&#x00A0;14:39:55</span><span 
class="pcrr7tn-">&#x00A0;-0700</span><span 
class="pcrr7tn-">&#x00A0;(Wed,</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;Sep</span><span 
class="pcrr7tn-">&#x00A0;2006)</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;5</span><span 
class="pcrr7tn-">&#x00A0;lines</span>
<br class="fancyvrb" /><a 
 id="x1-266008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-266010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;On</span><span 
class="pcrr7tn-">&#x00A0;reporting</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;route</span><span 
class="pcrr7tn-">&#x00A0;error,</span><span 
class="pcrr7tn-">&#x00A0;also</span><span 
class="pcrr7tn-">&#x00A0;include</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;status</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;error,</span>
<br class="fancyvrb" /><a 
 id="x1-266012r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;rather</span><span 
class="pcrr7tn-">&#x00A0;than</span><span 
class="pcrr7tn-">&#x00A0;indicating</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;status</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;when</span><span 
class="pcrr7tn-">&#x00A0;an</span><span 
class="pcrr7tn-">&#x00A0;error</span><span 
class="pcrr7tn-">&#x00A0;has</span><span 
class="pcrr7tn-">&#x00A0;occurred.</span>
<br class="fancyvrb" /><a 
 id="x1-266014r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-266016r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Signed-off-by:</span><span 
class="pcrr7tn-">&#x00A0;Sean</span><span 
class="pcrr7tn-">&#x00A0;Hefty</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;sean.hefty@intel.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-266018r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-266020r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;------------------------------------------------------------------------</span>
   </div>
                                                                                         
                                                                                         
<!--l. 434--><p class="indent">   Since Subversion&#x2019;s output style is fairly simple, it is easy to copy-and-paste a hunk of its output into a file, and replace the
text produced above by Subversion with the template values we&#x2019;d like to see expanded.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-266022r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;svn.template</span>
<br class="fancyvrb" /><a 
 id="x1-266024r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;r</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">rev</span><span 
class="cmsy-10">}</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">author|user</span><span 
class="cmsy-10">}</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">date|isodate</span><span 
class="cmsy-10">}</span><span 
class="pcrr7tn-">&#x00A0;(</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">date|rfc822date</span><span 
class="cmsy-10">}</span><span 
class="pcrr7tn-">)</span>
<br class="fancyvrb" /><a 
 id="x1-266026r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-266028r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span><span 
class="pcrr7tn-">desc|strip|fill76</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-266030r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-266032r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;------------------------------------------------------------------------</span>
   </div>
<!--l. 440--><p class="indent">   There are a few small ways in which this template deviates from the output produced by Subversion. </p>
     <ul><li><span class="dt">
     </span><span class="dd">Subversion prints a &#x201C;readable&#x201D; date (the &#x201C;<span 
class="pcrr7tn-">Wed, 27 Sep 2006</span>&#x201D; in the example output above) in parentheses.
     Mercurial&#x2019;s templating engine does not provide a way to display a date in this format without also printing the
     time and time zone.
     </span><li><span class="dt">
     </span><span class="dd">We emulate Subversion&#x2019;s printing of &#x201C;separator&#x201D; lines full of &#x201C;<span 
class="pcrr7tn-">-</span>&#x201D; characters by ending the template with such
     a line. We use the templating engine&#x2019;s <a 
 id="dx1-266033"></a><a 
 id="dx1-266034"></a><span 
class="pcrr7tn-">header </span>keyword to print a separator line as the first line of output (see
     below), thus achieving similar output to Subversion.
     </span><li><span class="dt">
     </span><span class="dd">Subversion&#x2019;s output includes a count in the header of the number of lines in the commit message. We cannot
     replicate this in Mercurial; the templating engine does not currently provide a filter that counts the number of
     items it is passed.</li></ul>
<!--l. 457--><p class="noindent">It took me no more than a minute or two of work to replace literal text from an example of Subversion&#x2019;s output with some
keywords and filters to give the template above. The style file simply refers to the template.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-266036r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;svn.style</span>
<br class="fancyvrb" /><a 
 id="x1-266038r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;header</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;'------------------------------------------------------------------------</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">n</span><span 
class="cmsy-10">&#x2216;</span><span 
class="pcrr7tn-">n'</span>
<br class="fancyvrb" /><a 
 id="x1-266040r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;svn.template</span>
   </div>
<!--l. 463--><p class="indent">   We could have included the text of the template file directly in the style file by enclosing it in quotes and replacing the
newlines with &#x201C;
<br class="newline" /><span 
class="pcrr7tn-">n</span>&#x201D; sequences, but it would have made the style file too difficult to read. Readability is a good guide when you&#x2019;re trying to
decide whether some text belongs in a style file, or in a template file that the style file points to. If the style file will look too big
or cluttered if you insert a literal piece of text, drop it into a template instead.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
</p>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;12</span><br /><a 
 id="x1-26700012"></a>Managing change with Mercurial Queues</h2>
   <h3 class="sectionHead"><span class="titlemark">12.1    </span> <a 
 id="x1-26800012.1"></a>The patch management problem</h3>
<!--l. 7--><p class="noindent">Here is a common scenario: you need to install a software package from source, but you find a bug that you must fix in the
source before you can start using the package. You make your changes, forget about the package for a while, and a few months
later you need to upgrade to a newer version of the package. If the newer version of the package still has the bug, you must
extract your fix from the older source tree and apply it against the newer version. This is a tedious task, and it&#x2019;s easy to make
mistakes.
</p><!--l. 16--><p class="indent">   This is a simple case of the &#x201C;patch management&#x201D; problem. You have an &#x201C;upstream&#x201D; source tree that you can&#x2019;t change; you
need to make some local changes on top of the upstream tree; and you&#x2019;d like to be able to keep those changes separate, so that
you can apply them to newer versions of the upstream source.
</p><!--l. 22--><p class="indent">   The patch management problem arises in many situations. Probably the most visible is that a user of an open
source software project will contribute a bug fix or new feature to the project&#x2019;s maintainers in the form of a
patch.
</p><!--l. 27--><p class="indent">   Distributors of operating systems that include open source software often need to make changes to the packages they
distribute so that they will build properly in their environments.
</p><!--l. 31--><p class="indent">   When you have few changes to maintain, it is easy to manage a single patch using the standard <a 
 id="dx1-268001"></a><span 
class="pcrr7tn-">diff </span>and <a 
 id="dx1-268002"></a><span 
class="pcrr7tn-">patch </span>programs
(see section&#x00A0;<a 
href="#x1-27300012.4">12.4<!--tex4ht:ref: sec:mq:patch --></a> for a discussion of these tools). Once the number of changes grows, it starts to make sense to maintain
patches as discrete &#x201C;chunks of work,&#x201D; so that for example a single patch will contain only one bug fix (the patch might modify
several files, but it&#x2019;s doing &#x201C;only one thing&#x201D;), and you may have a number of such patches for different bugs you need fixed and
local changes you require. In this situation, if you submit a bug fix patch to the upstream maintainers of a package and they
include your fix in a subsequent release, you can simply drop that single patch when you&#x2019;re updating to the newer
release.
</p><!--l. 44--><p class="indent">   Maintaining a single patch against an upstream tree is a little tedious and error-prone, but not difficult. However, the
complexity of the problem grows rapidly as the number of patches you have to maintain increases. With more than a tiny
number of patches in hand, understanding which ones you have applied and maintaining them moves from messy to
overwhelming.
</p><!--l. 51--><p class="indent">   Fortunately, Mercurial includes a powerful extension, Mercurial Queues (or simply &#x201C;MQ&#x201D;), that massively simplifies the
patch management problem.
</p><!--l. 55--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">12.2    </span> <a 
 id="x1-26900012.2"></a>The prehistory of Mercurial Queues</h3>
<!--l. 58--><p class="noindent">During the late 1990s, several Linux kernel developers started to maintain &#x201C;patch series&#x201D; that modified the behaviour of the
Linux kernel. Some of these series were focused on stability, some on feature coverage, and others were more
speculative.
</p><!--l. 63--><p class="indent">   The sizes of these patch series grew rapidly. In 2002, Andrew Morton published some shell scripts he had been using to
automate the task of managing his patch queues. Andrew was successfully using these scripts to manage hundreds (sometimes
thousands) of patches on top of the Linux kernel.
</p><!--l. 69--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.2.1    </span> <a 
 id="x1-27000012.2.1"></a>A patchwork quilt</h4>
<!--l. 72--><p class="noindent">In early 2003, Andreas Gruenbacher and Martin Quinson borrowed the approach of Andrew&#x2019;s scripts and published a tool
called &#x201C;patchwork quilt&#x201D;&#x00A0;<span class="cite">[<span 
class="ptmb7t-">?</span>]</span>, or simply &#x201C;quilt&#x201D; (see&#x00A0;<span class="cite">[<span 
class="ptmb7t-">?</span>]</span> for a paper describing it). Because quilt substantially automated patch
management, it rapidly gained a large following among open source software developers.
                                                                                         
                                                                                         
</p><!--l. 79--><p class="indent">   Quilt manages a <span 
class="ptmri7t-">stack of patches </span>on top of a directory tree. To begin, you tell quilt to manage a directory tree, and tell it
which files you want to manage; it stores away the names and contents of those files. To fix a bug, you create a new patch (using
a single command), edit the files you need to fix, then &#x201C;refresh&#x201D; the patch.
</p><!--l. 85--><p class="indent">   The refresh step causes quilt to scan the directory tree; it updates the patch with all of the changes you have made. You can
create another patch on top of the first, which will track the changes required to modify the tree from &#x201C;tree with one patch
applied&#x201D; to &#x201C;tree with two patches applied&#x201D;.
</p><!--l. 91--><p class="indent">   You can <span 
class="ptmri7t-">change </span>which patches are applied to the tree. If you &#x201C;pop&#x201D; a patch, the changes made by that patch will
vanish from the directory tree. Quilt remembers which patches you have popped, though, so you can &#x201C;push&#x201D;
a popped patch again, and the directory tree will be restored to contain the modifications in the patch. Most
importantly, you can run the &#x201C;refresh&#x201D; command at any time, and the topmost applied patch will be updated. This
means that you can, at any time, change both which patches are applied and what modifications those patches
make.
</p><!--l. 101--><p class="indent">   Quilt knows nothing about revision control tools, so it works equally well on top of an unpacked tarball or a Subversion
working copy.
</p><!--l. 104--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.2.2    </span> <a 
 id="x1-27100012.2.2"></a>From patchwork quilt to Mercurial Queues</h4>
<!--l. 107--><p class="noindent">In mid-2005, Chris Mason took the features of quilt and wrote an extension that he called Mercurial Queues, which added
quilt-like behaviour to Mercurial.
</p><!--l. 111--><p class="indent">   The key difference between quilt and MQ is that quilt knows nothing about revision control systems, while MQ is
<span 
class="ptmri7t-">integrated </span>into Mercurial. Each patch that you push is represented as a Mercurial changeset. Pop a patch, and the changeset
goes away.
</p><!--l. 116--><p class="indent">   Because quilt does not care about revision control tools, it is still a tremendously useful piece of software to know about for
situations where you cannot use Mercurial and MQ.
</p><!--l. 120--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">12.3    </span> <a 
 id="x1-27200012.3"></a>The huge advantage of MQ</h3>
<!--l. 122--><p class="noindent">I cannot overstate the value that MQ offers through the unification of patches and revision control.
</p><!--l. 125--><p class="indent">   A major reason that patches have persisted in the free software and open source world&#x2014;in spite of the availability of
increasingly capable revision control tools over the years&#x2014;is the <span 
class="ptmri7t-">agility </span>they offer.
</p><!--l. 130--><p class="indent">   Traditional revision control tools make a permanent, irreversible record of everything that you do. While this has great
value, it&#x2019;s also somewhat stifling. If you want to perform a wild-eyed experiment, you have to be careful in how you go about it,
or you risk leaving unneeded&#x2014;or worse, misleading or destabilising&#x2014;traces of your missteps and errors in the permanent
revision record.
</p><!--l. 137--><p class="indent">   By contrast, MQ&#x2019;s marriage of distributed revision control with patches makes it much easier to isolate your work. Your
patches live on top of normal revision history, and you can make them disappear or reappear at will. If you don&#x2019;t like a patch,
you can drop it. If a patch isn&#x2019;t quite as you want it to be, simply fix it&#x2014;as many times as you need to, until you have refined it
into the form you desire.
</p><!--l. 144--><p class="indent">   As an example, the integration of patches with revision control makes understanding patches and debugging their
effects&#x2014;and their interplay with the code they&#x2019;re based on&#x2014;<span 
class="ptmri7t-">enormously </span>easier. Since every applied patch has an associated
changeset, you can use <a 
 id="dx1-272001"></a>&#x201C;<span 
class="pcrr7tn-">hg log </span><span 
class="pcrro7t-">filename</span>&#x201D; to see which changesets and patches affected a file. You can use the <a 
 id="dx1-272002"></a><span 
class="pcrr7tn-">bisect</span>
command to binary-search through all changesets and applied patches to see where a bug got introduced or fixed. You can use
the <a 
 id="dx1-272003"></a>&#x201C;<span 
class="pcrr7tn-">hg annotate</span>&#x201D; command to see which changeset or patch modified a particular line of a source file. And so
on.
                                                                                         
                                                                                         
</p><!--l. 155--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">12.4    </span> <a 
 id="x1-27300012.4"></a>Understanding patches</h3>
<!--l. 158--><p class="noindent">Because MQ doesn&#x2019;t hide its patch-oriented nature, it is helpful to understand what patches are, and a little about the tools that
work with them.
</p><!--l. 162--><p class="indent">   The traditional Unix <a 
 id="dx1-273001"></a><span 
class="pcrr7tn-">diff </span>command compares two files, and prints a list of differences between them. The <a 
 id="dx1-273002"></a><span 
class="pcrr7tn-">patch </span>command
understands these differences as <span 
class="ptmri7t-">modifications </span>to make to a file. Take a look at figure&#x00A0;<a 
href="#x1-2730291">12.1<!--tex4ht:ref: ex:mq:diff --></a> for a simple example of these
commands in action.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2730291"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-273004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'this</span><span 
class="pcrb7t-">&#x00A0;is</span><span 
class="pcrb7t-">&#x00A0;my</span><span 
class="pcrb7t-">&#x00A0;original</span><span 
class="pcrb7t-">&#x00A0;thought'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;oldfile</span>
<br class="fancyvrb" /><a 
 id="x1-273006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'i</span><span 
class="pcrb7t-">&#x00A0;have</span><span 
class="pcrb7t-">&#x00A0;changed</span><span 
class="pcrb7t-">&#x00A0;my</span><span 
class="pcrb7t-">&#x00A0;mind'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;newfile</span>
<br class="fancyvrb" /><a 
 id="x1-273008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">diff</span><span 
class="pcrb7t-">&#x00A0;-u</span><span 
class="pcrb7t-">&#x00A0;oldfile</span><span 
class="pcrb7t-">&#x00A0;newfile</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;tiny.patch</span>
<br class="fancyvrb" /><a 
 id="x1-273010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;tiny.patch</span>
<br class="fancyvrb" /><a 
 id="x1-273012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;oldfile        2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04:20.000000000</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-273014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;newfile        2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04:20.000000000</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-273016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-1</span><span 
class="pcrr7tn-">&#x00A0;+1</span><span 
class="pcrr7tn-">&#x00A0;@@</span>
<br class="fancyvrb" /><a 
 id="x1-273018r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-this</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;my</span><span 
class="pcrr7tn-">&#x00A0;original</span><span 
class="pcrr7tn-">&#x00A0;thought</span>
<br class="fancyvrb" /><a 
 id="x1-273020r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+i</span><span 
class="pcrr7tn-">&#x00A0;have</span><span 
class="pcrr7tn-">&#x00A0;changed</span><span 
class="pcrr7tn-">&#x00A0;my</span><span 
class="pcrr7tn-">&#x00A0;mind</span>
<br class="fancyvrb" /><a 
 id="x1-273022r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">patch</span><span 
class="pcrb7t-">&#x00A0;&#x003c;</span><span 
class="pcrb7t-">&#x00A0;tiny.patch</span>
<br class="fancyvrb" /><a 
 id="x1-273024r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;patching</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;oldfile</span>
<br class="fancyvrb" /><a 
 id="x1-273026r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;oldfile</span>
<br class="fancyvrb" /><a 
 id="x1-273028r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;i</span><span 
class="pcrr7tn-">&#x00A0;have</span><span 
class="pcrr7tn-">&#x00A0;changed</span><span 
class="pcrr7tn-">&#x00A0;my</span><span 
class="pcrr7tn-">&#x00A0;mind</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.1: </td><td  
class="content">Simple uses of the <a 
 id="dx1-273030"></a><span 
class="pcrr7tn-">diff </span>and <a 
 id="dx1-273031"></a><span 
class="pcrr7tn-">patch </span>commands</td></tr></table><!--tex4ht:label?: x1-2730291 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 174--><p class="indent">   The type of file that <a 
 id="dx1-273032"></a><span 
class="pcrr7tn-">diff </span>generates (and <a 
 id="dx1-273033"></a><span 
class="pcrr7tn-">patch </span>takes as input) is called a &#x201C;patch&#x201D; or a &#x201C;diff&#x201D;; there is no difference between
a patch and a diff. (We&#x2019;ll use the term &#x201C;patch&#x201D;, since it&#x2019;s more commonly used.)
</p><!--l. 179--><p class="indent">   A patch file can start with arbitrary text; the <a 
 id="dx1-273034"></a><span 
class="pcrr7tn-">patch </span>command ignores this text, but MQ uses it as the commit message when
creating changesets. To find the beginning of the patch content, <a 
 id="dx1-273035"></a><span 
class="pcrr7tn-">patch </span>searches for the first line that starts with the string
&#x201C;<span 
class="pcrr7tn-">diff</span><span 
class="pcrr7tn-">&#x00A0;-</span>&#x201D;.
</p><!--l. 185--><p class="indent">   MQ works with <span 
class="ptmri7t-">unified </span>diffs (<a 
 id="dx1-273036"></a><span 
class="pcrr7tn-">patch </span>can accept several other diff formats, but MQ doesn&#x2019;t). A unified diff contains two
kinds of header. The <span 
class="ptmri7t-">file header </span>describes the file being modified; it contains the name of the file to modify. When <a 
 id="dx1-273037"></a><span 
class="pcrr7tn-">patch </span>sees a
new file header, it looks for a file with that name to start modifying.
</p><!--l. 192--><p class="indent">   After the file header comes a series of <span 
class="ptmri7t-">hunks</span>. Each hunk starts with a header; this identifies the range of line numbers within
the file that the hunk should modify. Following the header, a hunk starts and ends with a few (usually three) lines of text from
the unmodified file; these are called the <span 
class="ptmri7t-">context </span>for the hunk. If there&#x2019;s only a small amount of context between successive
hunks, <a 
 id="dx1-273038"></a><span 
class="pcrr7tn-">diff </span>doesn&#x2019;t print a new hunk header; it just runs the hunks together, with a few lines of context between
modifications.
</p><!--l. 201--><p class="indent">   Each line of context begins with a space character. Within the hunk, a line that begins with &#x201C;<span 
class="pcrr7tn-">-</span>&#x201D; means &#x201C;remove this line,&#x201D;
while a line that begins with &#x201C;<span 
class="pcrr7tn-">+</span>&#x201D; means &#x201C;insert this line.&#x201D; For example, a line that is modified is represented by one deletion and
one insertion.
</p><!--l. 207--><p class="indent">   We will return to some of the more subtle aspects of patches later (in section&#x00A0;<a 
href="#x1-28200012.6">12.6<!--tex4ht:ref: sec:mq:adv-patch --></a>), but you should have enough
information now to use MQ.
</p>
   <h3 class="sectionHead"><span class="titlemark">12.5    </span> <a 
 id="x1-27400012.5"></a>Getting started with Mercurial Queues</h3>
<!--l. 214--><p class="noindent">Because MQ is implemented as an extension, you must explicitly enable before you can use it. (You don&#x2019;t need to download
anything; MQ ships with the standard Mercurial distribution.) To enable MQ, edit your <span 
class="pcrr7tn-">~/.hgrc </span>file, and add the lines in
figure&#x00A0;<a 
href="#x1-27400012.5">12.5<!--tex4ht:ref: ex:mq:config --></a>.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2740052"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-274002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[extensions]</span>
<br class="fancyvrb" /><a 
 id="x1-274004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hgext.mq</span><span 
class="pcrr7tn-">&#x00A0;=</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.2: </td><td  
class="content">Contents to add to <span 
class="pcrr7tn-">~/.hgrc </span>to enable the MQ extension</td></tr></table><!--tex4ht:label?: x1-2740052 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 228--><p class="indent">   Once the extension is enabled, it will make a number of new commands available. To verify that the extension
is working, you can use <a 
 id="dx1-274006"></a>&#x201C;<span 
class="pcrr7tn-">hg help</span>&#x201D; to see if the <a 
 id="dx1-274007"></a><a 
 id="dx1-274008"></a>&#x201C;<span 
class="pcrr7tn-">hg qinit</span>&#x201D; command is now available; see the example in
figure&#x00A0;<a 
href="#x1-2740353">12.3<!--tex4ht:ref: ex:mq:enabled --></a>.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2740353"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-274010r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;help</span><span 
class="pcrb7t-">&#x00A0;qinit</span>
<br class="fancyvrb" /><a 
 id="x1-274012r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;qinit</span><span 
class="pcrr7tn-">&#x00A0;[-c]</span>
<br class="fancyvrb" /><a 
 id="x1-274014r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-274016r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;init</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;new</span><span 
class="pcrr7tn-">&#x00A0;queue</span><span 
class="pcrr7tn-">&#x00A0;repository</span>
<br class="fancyvrb" /><a 
 id="x1-274018r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-274020r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;The</span><span 
class="pcrr7tn-">&#x00A0;queue</span><span 
class="pcrr7tn-">&#x00A0;repository</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;unversioned</span><span 
class="pcrr7tn-">&#x00A0;by</span><span 
class="pcrr7tn-">&#x00A0;default.</span><span 
class="pcrr7tn-">&#x00A0;If</span><span 
class="pcrr7tn-">&#x00A0;-c</span><span 
class="pcrr7tn-">&#x00A0;is</span>
<br class="fancyvrb" /><a 
 id="x1-274022r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;specified,</span><span 
class="pcrr7tn-">&#x00A0;qinit</span><span 
class="pcrr7tn-">&#x00A0;will</span><span 
class="pcrr7tn-">&#x00A0;create</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;separate</span><span 
class="pcrr7tn-">&#x00A0;nested</span><span 
class="pcrr7tn-">&#x00A0;repository</span>
<br class="fancyvrb" /><a 
 id="x1-274024r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;patches.</span><span 
class="pcrr7tn-">&#x00A0;Use</span><span 
class="pcrr7tn-">&#x00A0;qcommit</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;commit</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;this</span><span 
class="pcrr7tn-">&#x00A0;queue</span>
<br class="fancyvrb" /><a 
 id="x1-274026r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;repository.</span>
<br class="fancyvrb" /><a 
 id="x1-274028r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-274030r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;options:</span>
<br class="fancyvrb" /><a 
 id="x1-274032r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-274034r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-c</span><span 
class="pcrr7tn-">&#x00A0;--create-repo</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;create</span><span 
class="pcrr7tn-">&#x00A0;queue</span><span 
class="pcrr7tn-">&#x00A0;repository</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.3: </td><td  
class="content">How to verify that MQ is enabled</td></tr></table><!--tex4ht:label?: x1-2740353 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 239--><p class="indent">   You can use MQ with <span 
class="ptmri7t-">any </span>Mercurial repository, and its commands only operate within that repository. To get started,
simply prepare the repository using the <a 
 id="dx1-274036"></a><a 
 id="dx1-274037"></a>&#x201C;<span 
class="pcrr7tn-">hg qinit</span>&#x201D; command (see figure&#x00A0;<a 
href="#x1-2740554">12.4<!--tex4ht:ref: ex:mq:qinit --></a>). This command creates an empty directory
called <a 
 id="dx1-274038"></a><span 
class="pcrr7tn-">.hg/patches</span>, where MQ will keep its metadata. As with many Mercurial commands, the <a 
 id="dx1-274039"></a><a 
 id="dx1-274040"></a>&#x201C;<span 
class="pcrr7tn-">hg qinit</span>&#x201D; command prints
nothing if it succeeds.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2740554"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-274042r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span><span 
class="pcrb7t-">&#x00A0;mq-sandbox</span>
<br class="fancyvrb" /><a 
 id="x1-274044r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;mq-sandbox</span>
<br class="fancyvrb" /><a 
 id="x1-274046r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'line</span><span 
class="pcrb7t-">&#x00A0;1'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;file1</span>
<br class="fancyvrb" /><a 
 id="x1-274048r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'another</span><span 
class="pcrb7t-">&#x00A0;line</span><span 
class="pcrb7t-">&#x00A0;1'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;file2</span>
<br class="fancyvrb" /><a 
 id="x1-274050r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;file1</span><span 
class="pcrb7t-">&#x00A0;file2</span>
<br class="fancyvrb" /><a 
 id="x1-274052r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-m'first</span><span 
class="pcrb7t-">&#x00A0;change'</span>
<br class="fancyvrb" /><a 
 id="x1-274054r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qinit</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.4: </td><td  
class="content">Preparing a repository for use with MQ</td></tr></table><!--tex4ht:label?: x1-2740554 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2740965"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-274057r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-274059r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:88621f3050a8</span>
<br class="fancyvrb" /><a 
 id="x1-274061r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-274063r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-274065r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:22</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-274067r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first</span><span 
class="pcrr7tn-">&#x00A0;change</span>
<br class="fancyvrb" /><a 
 id="x1-274069r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-274071r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qnew</span><span 
class="pcrb7t-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-274073r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-274075r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:2fd7dfef30eb</span>
<br class="fancyvrb" /><a 
 id="x1-274077r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;qtip</span>
<br class="fancyvrb" /><a 
 id="x1-274079r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-274081r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-274083r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;qbase</span>
<br class="fancyvrb" /><a 
 id="x1-274085r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-274087r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:22</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-274089r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;New</span><span 
class="pcrr7tn-">&#x00A0;patch:</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-274091r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-274093r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">ls</span><span 
class="pcrb7t-">&#x00A0;.hg/patches</span>
<br class="fancyvrb" /><a 
 id="x1-274095r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;series</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;status</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.5: </td><td  
class="content">Creating a new patch</td></tr></table><!--tex4ht:label?: x1-2740965 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">12.5.1    </span> <a 
 id="x1-27500012.5.1"></a>Creating a new patch</h4>
<!--l. 261--><p class="noindent">To begin work on a new patch, use the <a 
 id="dx1-275001"></a><a 
 id="dx1-275002"></a>&#x201C;<span 
class="pcrr7tn-">hg qnew</span>&#x201D; command. This command takes one argument, the name of the
patch to create. MQ will use this as the name of an actual file in the <a 
 id="dx1-275003"></a><span 
class="pcrr7tn-">.hg/patches </span>directory, as you can see in
figure&#x00A0;<a 
href="#x1-2740965">12.5<!--tex4ht:ref: ex:mq:qnew --></a>.
</p><!--l. 266--><p class="indent">   Also newly present in the <a 
 id="dx1-275004"></a><span 
class="pcrr7tn-">.hg/patches </span>directory are two other files, <a 
 id="dx1-275005"></a><span 
class="pcrr7tn-">series </span>and <a 
 id="dx1-275006"></a><span 
class="pcrr7tn-">status</span>. The <a 
 id="dx1-275007"></a><span 
class="pcrr7tn-">series </span>file lists all of the
patches that MQ knows about for this repository, with one patch per line. Mercurial uses the <a 
 id="dx1-275008"></a><span 
class="pcrr7tn-">status </span>file for internal
book-keeping; it tracks all of the patches that MQ has <span 
class="ptmri7t-">applied </span>in this repository.
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:   </span>You may sometimes want to edit the <span 
class="pcrr7tn-">series </span>file by hand; for example,
to change the sequence in which some patches are applied. However, manually
editing the <span 
class="pcrr7tn-">status </span>file is almost always a bad idea, as it&#x2019;s easy to corrupt MQ&#x2019;s
idea of what is happening.                                                                                         </div>
<!--l. 281--><p class="indent">   Once you have created your new patch, you can edit files in the working directory as you usually would. All of the normal
Mercurial commands, such as <a 
 id="dx1-275011"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; and <a 
 id="dx1-275012"></a>&#x201C;<span 
class="pcrr7tn-">hg annotate</span>&#x201D;, work exactly as they did before.
</p><!--l. 286--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.5.2    </span> <a 
 id="x1-27600012.5.2"></a>Refreshing a patch</h4>
<!--l. 288--><p class="noindent">When you reach a point where you want to save your work, use the <a 
 id="dx1-276001"></a><a 
 id="dx1-276002"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D; command (figure&#x00A0;<a 
href="#x1-2740965">12.5<!--tex4ht:ref: ex:mq:qnew --></a>) to update the patch
you are working on. This command folds the changes you have made in the working directory into your patch, and updates its
corresponding changeset to contain those changes.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2760456"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-276004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'line</span><span 
class="pcrb7t-">&#x00A0;2'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;file1</span>
<br class="fancyvrb" /><a 
 id="x1-276006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;diff</span>
<br class="fancyvrb" /><a 
 id="x1-276008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;2fd7dfef30eb</span><span 
class="pcrr7tn-">&#x00A0;file1</span>
<br class="fancyvrb" /><a 
 id="x1-276010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/file1        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:22</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-276012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/file1        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:22</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-276014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-1,1</span><span 
class="pcrr7tn-">&#x00A0;+1,2</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-276016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-276018r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+line</span><span 
class="pcrr7tn-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-276020r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qrefresh</span>
<br class="fancyvrb" /><a 
 id="x1-276022r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;diff</span>
<br class="fancyvrb" /><a 
 id="x1-276024r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span><span 
class="pcrb7t-">&#x00A0;--style=compact</span><span 
class="pcrb7t-">&#x00A0;--patch</span>
<br class="fancyvrb" /><a 
 id="x1-276026r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1[qtip,first.patch,tip,qbase]</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;396e00dd675d</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-276028r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;patch</span><span 
class="pcrr7tn-">&#x00A0;queue:</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-276030r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-276032r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;88621f3050a8</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;396e00dd675d</span><span 
class="pcrr7tn-">&#x00A0;file1</span>
<br class="fancyvrb" /><a 
 id="x1-276034r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/file1        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:22</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-276036r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/file1        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:22</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-276038r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-1,1</span><span 
class="pcrr7tn-">&#x00A0;+1,2</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-276040r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-276042r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+line</span><span 
class="pcrr7tn-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-276044r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.6: </td><td  
class="content">Refreshing a patch</td></tr></table><!--tex4ht:label?: x1-2760456 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 300--><p class="indent">   You can run <a 
 id="dx1-276046"></a><a 
 id="dx1-276047"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D; as often as you like, so it&#x2019;s a good way to &#x201C;checkpoint&#x201D; your work. Refresh your patch at an
opportune time; try an experiment; and if the experiment doesn&#x2019;t work out, <a 
 id="dx1-276048"></a>&#x201C;<span 
class="pcrr7tn-">hg revert</span>&#x201D; your modifications back to the last
time you refreshed.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2760817"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-276050r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'line</span><span 
class="pcrb7t-">&#x00A0;3'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;file1</span>
<br class="fancyvrb" /><a 
 id="x1-276052r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;status</span>
<br class="fancyvrb" /><a 
 id="x1-276054r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;M</span><span 
class="pcrr7tn-">&#x00A0;file1</span>
<br class="fancyvrb" /><a 
 id="x1-276056r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qrefresh</span>
<br class="fancyvrb" /><a 
 id="x1-276058r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span><span 
class="pcrb7t-">&#x00A0;--style=compact</span><span 
class="pcrb7t-">&#x00A0;--patch</span>
<br class="fancyvrb" /><a 
 id="x1-276060r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1[qtip,first.patch,tip,qbase]</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;50104d7b0f9b</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-276062r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;patch</span><span 
class="pcrr7tn-">&#x00A0;queue:</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-276064r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-276066r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;88621f3050a8</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;50104d7b0f9b</span><span 
class="pcrr7tn-">&#x00A0;file1</span>
<br class="fancyvrb" /><a 
 id="x1-276068r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/file1        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:22</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-276070r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/file1        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:23</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-276072r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-1,1</span><span 
class="pcrr7tn-">&#x00A0;+1,3</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-276074r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-276076r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+line</span><span 
class="pcrr7tn-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-276078r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+line</span><span 
class="pcrr7tn-">&#x00A0;3</span>
<br class="fancyvrb" /><a 
 id="x1-276080r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.7: </td><td  
class="content">Refresh a patch many times to accumulate changes</td></tr></table><!--tex4ht:label?: x1-2760817 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">12.5.3    </span> <a 
 id="x1-27700012.5.3"></a>Stacking and tracking patches</h4>
<!--l. 313--><p class="noindent">Once you have finished working on a patch, or need to work on another, you can use the <a 
 id="dx1-277001"></a><a 
 id="dx1-277002"></a>&#x201C;<span 
class="pcrr7tn-">hg qnew</span>&#x201D; command again to create a
new patch. Mercurial will apply this patch on top of your existing patch. See figure&#x00A0;<a 
href="#x1-2770608">12.8<!--tex4ht:ref: ex:mq:qnew2 --></a> for an example. Notice that the patch
contains the changes in our prior patch as part of its context (you can see this more clearly in the output of <a 
 id="dx1-277003"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">annotate</span>&#x201D;).
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2770608"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-277005r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qnew</span><span 
class="pcrb7t-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-277007r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;--style=compact</span><span 
class="pcrb7t-">&#x00A0;--limit=2</span>
<br class="fancyvrb" /><a 
 id="x1-277009r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2[second.patch,qtip,tip]</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;c8de3a91dc96</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-277011r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;New</span><span 
class="pcrr7tn-">&#x00A0;patch:</span><span 
class="pcrr7tn-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-277013r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-277015r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1[first.patch,qbase]</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;50104d7b0f9b</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-277017r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;patch</span><span 
class="pcrr7tn-">&#x00A0;queue:</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-277019r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-277021r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'line</span><span 
class="pcrb7t-">&#x00A0;4'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;file1</span>
<br class="fancyvrb" /><a 
 id="x1-277023r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qrefresh</span>
<br class="fancyvrb" /><a 
 id="x1-277025r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span><span 
class="pcrb7t-">&#x00A0;--style=compact</span><span 
class="pcrb7t-">&#x00A0;--patch</span>
<br class="fancyvrb" /><a 
 id="x1-277027r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2[second.patch,qtip,tip]</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;a3d13171a276</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04</span><span 
class="pcrr7tn-">&#x00A0;+0000</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;bos</span>
<br class="fancyvrb" /><a 
 id="x1-277029r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;patch</span><span 
class="pcrr7tn-">&#x00A0;queue:</span><span 
class="pcrr7tn-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-277031r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-277033r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;50104d7b0f9b</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;a3d13171a276</span><span 
class="pcrr7tn-">&#x00A0;file1</span>
<br class="fancyvrb" /><a 
 id="x1-277035r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/file1        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:23</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-277037r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/file1        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:23</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-277039r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-1,3</span><span 
class="pcrr7tn-">&#x00A0;+1,4</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-277041r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-277043r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-277045r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;3</span>
<br class="fancyvrb" /><a 
 id="x1-277047r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+line</span><span 
class="pcrr7tn-">&#x00A0;4</span>
<br class="fancyvrb" /><a 
 id="x1-277049r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-277051r24"></a><span 
class="ptmr7t-x-x-50">24</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;annotate</span><span 
class="pcrb7t-">&#x00A0;file1</span>
<br class="fancyvrb" /><a 
 id="x1-277053r25"></a><span 
class="ptmr7t-x-x-50">25</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;0:</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-277055r26"></a><span 
class="ptmr7t-x-x-50">26</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-277057r27"></a><span 
class="ptmr7t-x-x-50">27</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;3</span>
<br class="fancyvrb" /><a 
 id="x1-277059r28"></a><span 
class="ptmr7t-x-x-50">28</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;4</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.8: </td><td  
class="content">Stacking a second patch on top of the first</td></tr></table><!--tex4ht:label?: x1-2770608 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 326--><p class="indent">   So far, with the exception of <a 
 id="dx1-277061"></a><a 
 id="dx1-277062"></a>&#x201C;<span 
class="pcrr7tn-">hg qnew</span>&#x201D; and <a 
 id="dx1-277063"></a><a 
 id="dx1-277064"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D;, we&#x2019;ve been careful to only use regular Mercurial commands.
However, MQ provides many commands that are easier to use when you are thinking about patches, as illustrated in
figure&#x00A0;<a 
href="#x1-2770819">12.9<!--tex4ht:ref: ex:mq:qseries --></a>:
</p>
     <ul><li><span class="dt">
     </span><span class="dd">The <a 
 id="dx1-277065"></a><a 
 id="dx1-277066"></a>&#x201C;<span 
class="pcrr7tn-">hg qseries</span>&#x201D; command lists every patch that MQ knows about in this repository, from oldest to newest
     (most recently <span 
class="ptmri7t-">created</span>).
     </span><li><span class="dt">
     </span><span class="dd">The <a 
 id="dx1-277067"></a><a 
 id="dx1-277068"></a>&#x201C;<span 
class="pcrr7tn-">hg qapplied</span>&#x201D; command lists every patch that MQ has <span 
class="ptmri7t-">applied </span>in this repository, again from oldest to
     newest (most recently applied).</li></ul>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-2770819"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-277070r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qseries</span>
<br class="fancyvrb" /><a 
 id="x1-277072r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-277074r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-277076r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qapplied</span>
<br class="fancyvrb" /><a 
 id="x1-277078r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-277080r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;second.patch</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.9: </td><td  
class="content">Understanding the patch stack with <a 
 id="dx1-277082"></a><a 
 id="dx1-277083"></a>&#x201C;<span 
class="pcrr7tn-">hg qseries</span>&#x201D; and <a 
 id="dx1-277084"></a><a 
 id="dx1-277085"></a>&#x201C;<span 
class="pcrr7tn-">hg qapplied</span>&#x201D;</td></tr></table><!--tex4ht:label?: x1-2770819 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">12.5.4    </span> <a 
 id="x1-27800012.5.4"></a>Manipulating the patch stack</h4>
<!--l. 349--><p class="noindent">The previous discussion implied that there must be a difference between &#x201C;known&#x201D; and &#x201C;applied&#x201D; patches, and there is. MQ can
manage a patch without it being applied in the repository.
</p><!--l. 353--><p class="indent">   An <span 
class="ptmri7t-">applied </span>patch has a corresponding changeset in the repository, and the effects of the patch and changeset are visible in
the working directory. You can undo the application of a patch using the <a 
 id="dx1-278001"></a><a 
 id="dx1-278002"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; command. MQ still <span 
class="ptmri7t-">knows about</span>, or
manages, a popped patch, but the patch no longer has a corresponding changeset in the repository, and the working directory
does not contain the changes made by the patch. Figure&#x00A0;<a 
href="#x1-27800310">12.10<!--tex4ht:ref: fig:mq:stack --></a> illustrates the difference between applied and tracked
patches.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-27800310"></a>
                                                                                         
                                                                                         
<!--l. 364--><p class="noindent"><img 
src="mq-stack.png" alt="PIC"  
 />
<br /> </p><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.10: </td><td  
class="content">Applied and unapplied patches in the MQ patch stack</td></tr></table><!--tex4ht:label?: x1-27800310 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 369--><p class="indent">   You can reapply an unapplied, or popped, patch using the <a 
 id="dx1-278004"></a><a 
 id="dx1-278005"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; command. This creates a new changeset to
correspond to the patch, and the patch&#x2019;s changes once again become present in the working directory. See figure&#x00A0;<a 
href="#x1-27804211">12.11<!--tex4ht:ref: ex:mq:qpop --></a> for
examples of <a 
 id="dx1-278006"></a><a 
 id="dx1-278007"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; and <a 
 id="dx1-278008"></a><a 
 id="dx1-278009"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; in action. Notice that once we have popped a patch or two patches, the output of <a 
 id="dx1-278010"></a><a 
 id="dx1-278011"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">qseries</span>&#x201D; remains the same, while that of <a 
 id="dx1-278012"></a><a 
 id="dx1-278013"></a>&#x201C;<span 
class="pcrr7tn-">hg qapplied</span>&#x201D; has changed.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-27804211"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-278015r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qapplied</span>
<br class="fancyvrb" /><a 
 id="x1-278017r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-278019r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-278021r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qpop</span>
<br class="fancyvrb" /><a 
 id="x1-278023r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Now</span><span 
class="pcrr7tn-">&#x00A0;at:</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-278025r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qseries</span>
<br class="fancyvrb" /><a 
 id="x1-278027r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-278029r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-278031r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qapplied</span>
<br class="fancyvrb" /><a 
 id="x1-278033r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-278035r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;file1</span>
<br class="fancyvrb" /><a 
 id="x1-278037r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-278039r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-278041r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;3</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.11: </td><td  
class="content">Modifying the stack of applied patches</td></tr></table><!--tex4ht:label?: x1-27804211 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">12.5.5    </span> <a 
 id="x1-27900012.5.5"></a>Pushing and popping many patches</h4>
<!--l. 385--><p class="noindent">While <a 
 id="dx1-279001"></a><a 
 id="dx1-279002"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; and <a 
 id="dx1-279003"></a><a 
 id="dx1-279004"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; each operate on a single patch at a time by default, you can push and pop many patches in
one go. The <a 
 id="dx1-279005"></a><a 
 id="dx1-279006"></a><span 
class="pcrr7tn-">-a </span>option to <a 
 id="dx1-279007"></a><a 
 id="dx1-279008"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; causes it to push all unapplied patches, while the <a 
 id="dx1-279009"></a><a 
 id="dx1-279010"></a><span 
class="pcrr7tn-">-a </span>option to <a 
 id="dx1-279011"></a><a 
 id="dx1-279012"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D;
causes it to pop all applied patches. (For some more ways to push and pop many patches, see section&#x00A0;<a 
href="#x1-28800012.7">12.7<!--tex4ht:ref: sec:mq:perf --></a>
below.)
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-27902912"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-279014r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qpush</span><span 
class="pcrb7t-">&#x00A0;-a</span>
<br class="fancyvrb" /><a 
 id="x1-279016r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;applying</span><span 
class="pcrr7tn-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-279018r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Now</span><span 
class="pcrr7tn-">&#x00A0;at:</span><span 
class="pcrr7tn-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-279020r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;file1</span>
<br class="fancyvrb" /><a 
 id="x1-279022r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-279024r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-279026r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;3</span>
<br class="fancyvrb" /><a 
 id="x1-279028r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;line</span><span 
class="pcrr7tn-">&#x00A0;4</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.12: </td><td  
class="content">Pushing all unapplied patches</td></tr></table><!--tex4ht:label?: x1-27902912 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">12.5.6    </span> <a 
 id="x1-28000012.5.6"></a>Safety checks, and overriding them</h4>
<!--l. 400--><p class="noindent">Several MQ commands check the working directory before they do anything, and fail if they find any modifications. They do
this to ensure that you won&#x2019;t lose any changes that you have made, but not yet incorporated into a patch. Figure&#x00A0;<a 
href="#x1-28001213">12.13<!--tex4ht:ref: ex:mq:add --></a>
illustrates this; the <a 
 id="dx1-280001"></a><a 
 id="dx1-280002"></a>&#x201C;<span 
class="pcrr7tn-">hg qnew</span>&#x201D; command will not create a new patch if there are outstanding changes, caused in this case by the
<a 
 id="dx1-280003"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; of <span 
class="pcrr7tn-">file3</span>.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-28001213"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-280005r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'file</span><span 
class="pcrb7t-">&#x00A0;3,</span><span 
class="pcrb7t-">&#x00A0;line</span><span 
class="pcrb7t-">&#x00A0;1'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;file3</span>
<br class="fancyvrb" /><a 
 id="x1-280007r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qnew</span><span 
class="pcrb7t-">&#x00A0;add-file3.patch</span>
<br class="fancyvrb" /><a 
 id="x1-280009r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qnew</span><span 
class="pcrb7t-">&#x00A0;-f</span><span 
class="pcrb7t-">&#x00A0;add-file3.patch</span>
<br class="fancyvrb" /><a 
 id="x1-280011r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;patch</span><span 
class="pcrr7tn-">&#x00A0;"add-file3.patch"</span><span 
class="pcrr7tn-">&#x00A0;already</span><span 
class="pcrr7tn-">&#x00A0;exists</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.13: </td><td  
class="content">Forcibly creating a patch</td></tr></table><!--tex4ht:label?: x1-28001213 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 414--><p class="indent">   Commands that check the working directory all take an &#x201C;I know what I&#x2019;m doing&#x201D; option, which is always
named <span 
class="pcrr7tn-">-f</span>. The exact meaning of <span 
class="pcrr7tn-">-f </span>depends on the command. For example, <a 
 id="dx1-280013"></a>&#x201C;<span 
class="pcrr7tn-">hg qnew</span> <a 
 id="dx1-280014"></a><a 
 id="dx1-280015"></a><span 
class="pcrr7tn-">-f</span>&#x201D; will incorporate any
outstanding changes into the new patch it creates, but <a 
 id="dx1-280016"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span> <a 
 id="dx1-280017"></a><a 
 id="dx1-280018"></a><span 
class="pcrr7tn-">-f</span>&#x201D; will revert modifications to any files affected
by the patch that it is popping. Be sure to read the documentation for a command&#x2019;s <span 
class="pcrr7tn-">-f </span>option before you use
it!
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.5.7    </span> <a 
 id="x1-28100012.5.7"></a>Working on several patches at once</h4>
<!--l. 425--><p class="noindent">The <a 
 id="dx1-281001"></a><a 
 id="dx1-281002"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D; command always refreshes the <span 
class="ptmri7t-">topmost </span>applied patch. This means that you can suspend work
on one patch (by refreshing it), pop or push to make a different patch the top, and work on <span 
class="ptmri7t-">that </span>patch for a
while.
</p><!--l. 430--><p class="indent">   Here&#x2019;s an example that illustrates how you can use this ability. Let&#x2019;s say you&#x2019;re developing a new feature as two patches.
The first is a change to the core of your software, and the second&#x2014;layered on top of the first&#x2014;changes the user interface to use
the code you just added to the core. If you notice a bug in the core while you&#x2019;re working on the UI patch, it&#x2019;s easy to fix the
core. Simply <a 
 id="dx1-281003"></a><a 
 id="dx1-281004"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D; the UI patch to save your in-progress changes, and <a 
 id="dx1-281005"></a><a 
 id="dx1-281006"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; down to the core patch. Fix the
core bug, <a 
 id="dx1-281007"></a><a 
 id="dx1-281008"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D; the core patch, and <a 
 id="dx1-281009"></a><a 
 id="dx1-281010"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; back to the UI patch to continue where you left
off.
</p><!--l. 441--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">12.6    </span> <a 
 id="x1-28200012.6"></a>More about patches</h3>
<!--l. 444--><p class="noindent">MQ uses the GNU <a 
 id="dx1-282001"></a><span 
class="pcrr7tn-">patch </span>command to apply patches, so it&#x2019;s helpful to know a few more detailed aspects of how <a 
 id="dx1-282002"></a><span 
class="pcrr7tn-">patch </span>works,
and about patches themselves.
</p><!--l. 448--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.6.1    </span> <a 
 id="x1-28300012.6.1"></a>The strip count</h4>
<!--l. 450--><p class="noindent">If you look at the file headers in a patch, you will notice that the pathnames usually have an extra component on the front that
isn&#x2019;t present in the actual path name. This is a holdover from the way that people used to generate patches (people still do this,
but it&#x2019;s somewhat rare with modern revision control tools).
</p><!--l. 456--><p class="indent">   Alice would unpack a tarball, edit her files, then decide that she wanted to create a patch. So she&#x2019;d rename her working
directory, unpack the tarball again (hence the need for the rename), and use the <a 
 id="dx1-283001"></a><span 
class="pcrr7tn-">-r </span>and <a 
 id="dx1-283002"></a><span 
class="pcrr7tn-">-N </span>options to <a 
 id="dx1-283003"></a><span 
class="pcrr7tn-">diff </span>to recursively
generate a patch between the unmodified directory and the modified one. The result would be that the name of the unmodified
directory would be at the front of the left-hand path in every file header, and the name of the modified directory would be at the
front of the right-hand path.
</p><!--l. 466--><p class="indent">   Since someone receiving a patch from the Alices of the net would be unlikely to have unmodified and modified directories
with exactly the same names, the <a 
 id="dx1-283004"></a><span 
class="pcrr7tn-">patch </span>command has a <a 
 id="dx1-283005"></a><span 
class="pcrr7tn-">-p </span>option that indicates the number of leading path name components
to strip when trying to apply a patch. This number is called the <span 
class="ptmri7t-">strip count</span>.
</p><!--l. 473--><p class="indent">   An option of &#x201C;<span 
class="pcrr7tn-">-p1</span>&#x201D; means &#x201C;use a strip count of one&#x201D;. If <a 
 id="dx1-283006"></a><span 
class="pcrr7tn-">patch </span>sees a file name <span 
class="pcrr7tn-">foo/bar/baz </span>in a file header, it will strip
<span 
class="pcrr7tn-">foo </span>and try to patch a file named <span 
class="pcrr7tn-">bar/baz</span>. (Strictly speaking, the strip count refers to the number of <span 
class="ptmri7t-">path separators </span>(and the
components that go with them ) to strip. A strip count of one will turn <span 
class="pcrr7tn-">foo/bar </span>into <span 
class="pcrr7tn-">bar</span>, but <span 
class="pcrr7tn-">/foo/bar </span>(notice the extra
leading slash) into <span 
class="pcrr7tn-">foo/bar</span>.)
</p><!--l. 482--><p class="indent">   The &#x201C;standard&#x201D; strip count for patches is one; almost all patches contain one leading path name component that needs to be
stripped. Mercurial&#x2019;s <a 
 id="dx1-283007"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; command generates path names in this form, and the <a 
 id="dx1-283008"></a>&#x201C;<span 
class="pcrr7tn-">hg import</span>&#x201D; command and MQ expect
patches to have a strip count of one.
                                                                                         
                                                                                         
</p><!--l. 488--><p class="indent">   If you receive a patch from someone that you want to add to your patch queue, and the patch needs a strip count other than
one, you cannot just <a 
 id="dx1-283009"></a><a 
 id="dx1-283010"></a>&#x201C;<span 
class="pcrr7tn-">hg qimport</span>&#x201D; the patch, because <a 
 id="dx1-283011"></a><a 
 id="dx1-283012"></a>&#x201C;<span 
class="pcrr7tn-">hg qimport</span>&#x201D; does not yet have a <span 
class="pcrr7tn-">-p </span>option (see&#x00A0;<a 
 id="dx1-283013"></a><a 
href="http://www.selenic.com/mercurial/bts/issue311" >Mercurial bug
no.&#x00A0;311</a>). Your best bet is to <a 
 id="dx1-283014"></a><a 
 id="dx1-283015"></a>&#x201C;<span 
class="pcrr7tn-">hg qnew</span>&#x201D; a patch of your own, then use <a 
 id="dx1-283016"></a>&#x201C;<span 
class="pcrr7tn-">patch -p</span><span 
class="pcrro7t-">N</span>&#x201D; to apply their patch, followed by <a 
 id="dx1-283017"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">addremove</span>&#x201D; to pick up any files added or removed by the patch, followed by <a 
 id="dx1-283018"></a><a 
 id="dx1-283019"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D;. This complexity may become
unnecessary; see&#x00A0;<a 
 id="dx1-283020"></a><a 
href="http://www.selenic.com/mercurial/bts/issue311" >Mercurial bug no.&#x00A0;311</a> for details.
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.6.2    </span> <a 
 id="x1-28400012.6.2"></a>Strategies for applying a patch</h4>
<!--l. 498--><p class="noindent">When <a 
 id="dx1-284001"></a><span 
class="pcrr7tn-">patch </span>applies a hunk, it tries a handful of successively less accurate strategies to try to make the hunk apply. This
falling-back technique often makes it possible to take a patch that was generated against an old version of a file, and apply it
against a newer version of that file.
</p><!--l. 504--><p class="indent">   First, <a 
 id="dx1-284002"></a><span 
class="pcrr7tn-">patch </span>tries an exact match, where the line numbers, the context, and the text to be modified must apply exactly. If it
cannot make an exact match, it tries to find an exact match for the context, without honouring the line numbering information.
If this succeeds, it prints a line of output saying that the hunk was applied, but at some <span 
class="ptmri7t-">offset </span>from the original line
number.
</p><!--l. 511--><p class="indent">   If a context-only match fails, <a 
 id="dx1-284003"></a><span 
class="pcrr7tn-">patch </span>removes the first and last lines of the context, and tries a <span 
class="ptmri7t-">reduced </span>context-only
match. If the hunk with reduced context succeeds, it prints a message saying that it applied the hunk with a <span 
class="ptmri7t-">fuzz</span>
<span 
class="ptmri7t-">factor </span>(the number after the fuzz factor indicates how many lines of context <a 
 id="dx1-284004"></a><span 
class="pcrr7tn-">patch </span>had to trim before the patch
applied).
</p><!--l. 518--><p class="indent">   When neither of these techniques works, <a 
 id="dx1-284005"></a><span 
class="pcrr7tn-">patch </span>prints a message saying that the hunk in question was rejected. It saves
rejected hunks (also simply called &#x201C;rejects&#x201D;) to a file with the same name, and an added <a 
 id="dx1-284006"></a><span 
class="pcrr7tn-">.rej </span>extension. It also saves an
unmodified copy of the file with a <a 
 id="dx1-284007"></a><span 
class="pcrr7tn-">.orig </span>extension; the copy of the file without any extensions will contain any changes made
by hunks that <span 
class="ptmri7t-">did </span>apply cleanly. If you have a patch that modifies <span 
class="pcrr7tn-">foo </span>with six hunks, and one of them fails to apply, you will
have: an unmodified <span 
class="pcrr7tn-">foo.orig</span>, a <span 
class="pcrr7tn-">foo.rej </span>containing one hunk, and <span 
class="pcrr7tn-">foo</span>, containing the changes made by the five successful
five hunks.
</p><!--l. 530--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.6.3    </span> <a 
 id="x1-28500012.6.3"></a>Some quirks of patch representation</h4>
<!--l. 532--><p class="noindent">There are a few useful things to know about how <a 
 id="dx1-285001"></a><span 
class="pcrr7tn-">patch </span>works with files. </p>
     <ul><li><span class="dt">
     </span><span class="dd">This should already be obvious, but <a 
 id="dx1-285002"></a><span 
class="pcrr7tn-">patch </span>cannot handle binary files.
     </span><li><span class="dt">
     </span><span class="dd">Neither does it care about the executable bit; it creates new files as readable, but not executable.
     </span><li><span class="dt">
     </span><span class="dd"><a 
 id="dx1-285003"></a><span 
class="pcrr7tn-">patch </span>treats the removal of a file as a diff between the file to be removed and the empty file. So your idea of &#x201C;I
     deleted this file&#x201D; looks like &#x201C;every line of this file was deleted&#x201D; in a patch.
     </span><li><span class="dt">
     </span><span class="dd">It treats the addition of a file as a diff between the empty file and the file to be added. So in a patch, your idea of
     &#x201C;I added this file&#x201D; looks like &#x201C;every line of this file was added&#x201D;.
     </span><li><span class="dt">
     </span><span class="dd">It treats a renamed file as the removal of the old name, and the addition of the new name. This means that
     renamed files have a big footprint in patches. (Note also that Mercurial does not currently try to infer when files
     have been renamed or copied in a patch.)
                                                                                         
                                                                                         
     </span><li><span class="dt">
     </span><span class="dd"><a 
 id="dx1-285004"></a><span 
class="pcrr7tn-">patch </span>cannot represent empty files, so you cannot use a patch to represent the notion &#x201C;I added this empty file to
     the tree&#x201D;.</li></ul>
<!--l. 554--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.6.4    </span> <a 
 id="x1-28600012.6.4"></a>Beware the fuzz</h4>
<!--l. 556--><p class="noindent">While applying a hunk at an offset, or with a fuzz factor, will often be completely successful, these inexact techniques naturally
leave open the possibility of corrupting the patched file. The most common cases typically involve applying a patch twice, or at
an incorrect location in the file. If <a 
 id="dx1-286001"></a><span 
class="pcrr7tn-">patch </span>or <a 
 id="dx1-286002"></a><a 
 id="dx1-286003"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; ever mentions an offset or fuzz factor, you should make sure that the
modified files are correct afterwards.
</p><!--l. 564--><p class="indent">   It&#x2019;s often a good idea to refresh a patch that has applied with an offset or fuzz factor; refreshing the patch generates new
context information that will make it apply cleanly. I say &#x201C;often,&#x201D; not &#x201C;always,&#x201D; because sometimes refreshing a patch will make
it fail to apply against a different revision of the underlying files. In some cases, such as when you&#x2019;re maintaining a patch that
must sit on top of multiple versions of a source tree, it&#x2019;s acceptable to have a patch apply with some fuzz, provided you&#x2019;ve
verified the results of the patching process in such cases.
</p><!--l. 574--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.6.5    </span> <a 
 id="x1-28700012.6.5"></a>Handling rejection</h4>
<!--l. 576--><p class="noindent">If <a 
 id="dx1-287001"></a><a 
 id="dx1-287002"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; fails to apply a patch, it will print an error message and exit. If it has left <a 
 id="dx1-287003"></a><span 
class="pcrr7tn-">.rej </span>files behind, it is usually best to
fix up the rejected hunks before you push more patches or do any further work.
</p><!--l. 581--><p class="indent">   If your patch <span 
class="ptmri7t-">used to </span>apply cleanly, and no longer does because you&#x2019;ve changed the underlying code that your patches are
based on, Mercurial Queues can help; see section&#x00A0;<a 
href="#x1-28900012.8">12.8<!--tex4ht:ref: sec:mq:merge --></a> for details.
</p><!--l. 585--><p class="indent">   Unfortunately, there aren&#x2019;t any great techniques for dealing with rejected hunks. Most often, you&#x2019;ll need to view the <a 
 id="dx1-287004"></a><span 
class="pcrr7tn-">.rej</span>
file and edit the target file, applying the rejected hunks by hand.
</p><!--l. 589--><p class="indent">   If you&#x2019;re feeling adventurous, Neil Brown, a Linux kernel hacker, wrote a tool called <a 
 id="dx1-287005"></a><span 
class="pcrr7tn-">wiggle</span>&#x00A0;<span class="cite">[<span 
class="ptmb7t-">?</span>]</span>, which is more vigorous
than <a 
 id="dx1-287006"></a><span 
class="pcrr7tn-">patch </span>in its attempts to make a patch apply.
</p><!--l. 593--><p class="indent">   Another Linux kernel hacker, Chris Mason (the author of Mercurial Queues), wrote a similar tool called <a 
 id="dx1-287007"></a><span 
class="pcrr7tn-">mpatch</span>&#x00A0;<span class="cite">[<span 
class="ptmb7t-">?</span>]</span>, which
takes a simple approach to automating the application of hunks rejected by <a 
 id="dx1-287008"></a><span 
class="pcrr7tn-">patch</span>. The <a 
 id="dx1-287009"></a><span 
class="pcrr7tn-">mpatch </span>command can help with four
common reasons that a hunk may be rejected:
</p>
     <ul><li><span class="dt">
     </span><span class="dd">The context in the middle of a hunk has changed.
     </span><li><span class="dt">
     </span><span class="dd">A hunk is missing some context at the beginning or end.
     </span><li><span class="dt">
     </span><span class="dd">A large hunk might apply better&#x2014;either entirely or in part&#x2014;if it was broken up into smaller hunks.
     </span><li><span class="dt">
     </span><span class="dd">A hunk removes lines with slightly different content than those currently present in the file.</li></ul>
<!--l. 609--><p class="indent">   If you use <a 
 id="dx1-287010"></a><span 
class="pcrr7tn-">wiggle </span>or <a 
 id="dx1-287011"></a><span 
class="pcrr7tn-">mpatch</span>, you should be doubly careful to check your results when you&#x2019;re done. In fact, <a 
 id="dx1-287012"></a><span 
class="pcrr7tn-">mpatch</span>
enforces this method of double-checking the tool&#x2019;s output, by automatically dropping you into a merge program when it has
done its job, so that you can verify its work and finish off any remaining merges.
                                                                                         
                                                                                         
</p><!--l. 616--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">12.7    </span> <a 
 id="x1-28800012.7"></a>Getting the best performance out of MQ</h3>
<!--l. 619--><p class="noindent">MQ is very efficient at handling a large number of patches. I ran some performance experiments in mid-2006 for a talk that I
gave at the 2006 EuroPython conference&#x00A0;<span class="cite">[<span 
class="ptmb7t-">?</span>]</span>. I used as my data set the Linux 2.6.17-mm1 patch series, which consists of 1,738
patches. I applied these on top of a Linux kernel repository containing all 27,472 revisions between Linux 2.6.12-rc2 and Linux
2.6.17.
</p><!--l. 627--><p class="indent">   On my old, slow laptop, I was able to <a 
 id="dx1-288001"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span> <a 
 id="dx1-288002"></a><a 
 id="dx1-288003"></a><span 
class="pcrr7tn-">-a</span>&#x201D; all 1,738 patches in 3.5 minutes, and <a 
 id="dx1-288004"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span> <a 
 id="dx1-288005"></a><a 
 id="dx1-288006"></a><span 
class="pcrr7tn-">-a</span>&#x201D; them all in 30
seconds. (On a newer laptop, the time to push all patches dropped to two minutes.) I could <a 
 id="dx1-288007"></a><a 
 id="dx1-288008"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D; one of the biggest
patches (which made 22,779 lines of changes to 287 files) in 6.6 seconds.
</p><!--l. 634--><p class="indent">   Clearly, MQ is well suited to working in large trees, but there are a few tricks you can use to get the best performance of
it.
</p><!--l. 637--><p class="indent">   First of all, try to &#x201C;batch&#x201D; operations together. Every time you run <a 
 id="dx1-288009"></a><a 
 id="dx1-288010"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; or <a 
 id="dx1-288011"></a><a 
 id="dx1-288012"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D;, these commands scan the
working directory once to make sure you haven&#x2019;t made some changes and then forgotten to run <a 
 id="dx1-288013"></a><a 
 id="dx1-288014"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D;. On a small
tree, the time that this scan takes is unnoticeable. However, on a medium-sized tree (containing tens of thousands of files), it
can take a second or more.
</p><!--l. 644--><p class="indent">   The <a 
 id="dx1-288015"></a><a 
 id="dx1-288016"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; and <a 
 id="dx1-288017"></a><a 
 id="dx1-288018"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; commands allow you to push and pop multiple patches at a time. You can identify the
&#x201C;destination patch&#x201D; that you want to end up at. When you <a 
 id="dx1-288019"></a><a 
 id="dx1-288020"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; with a destination specified, it will push patches until
that patch is at the top of the applied stack. When you <a 
 id="dx1-288021"></a><a 
 id="dx1-288022"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; to a destination, MQ will pop patches until the destination
patch is at the top.
</p><!--l. 651--><p class="indent">   You can identify a destination patch using either the name of the patch, or by number. If you use numeric addressing,
patches are counted from zero; this means that the first patch is zero, the second is one, and so on.
</p><!--l. 656--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">12.8    </span> <a 
 id="x1-28900012.8"></a>Updating your patches when the underlying code changes</h3>
<!--l. 659--><p class="noindent">It&#x2019;s common to have a stack of patches on top of an underlying repository that you don&#x2019;t modify directly. If you&#x2019;re working on
changes to third-party code, or on a feature that is taking longer to develop than the rate of change of the code beneath, you will
often need to sync up with the underlying code, and fix up any hunks in your patches that no longer apply. This is called
<span 
class="ptmri7t-">rebasing </span>your patch series.
</p><!--l. 667--><p class="indent">   The simplest way to do this is to <a 
 id="dx1-289001"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span> <a 
 id="dx1-289002"></a><a 
 id="dx1-289003"></a><span 
class="pcrr7tn-">-a</span>&#x201D; your patches, then <a 
 id="dx1-289004"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; changes into the underlying repository, and
finally <a 
 id="dx1-289005"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span> <a 
 id="dx1-289006"></a><a 
 id="dx1-289007"></a><span 
class="pcrr7tn-">-a</span>&#x201D; your patches again. MQ will stop pushing any time it runs across a patch that fails to apply during
conflicts, allowing you to fix your conflicts, <a 
 id="dx1-289008"></a><a 
 id="dx1-289009"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D; the affected patch, and continue pushing until you have fixed your
entire stack.
</p><!--l. 675--><p class="indent">   This approach is easy to use and works well if you don&#x2019;t expect changes to the underlying code to affect how well your
patches apply. If your patch stack touches code that is modified frequently or invasively in the underlying repository, however,
fixing up rejected hunks by hand quickly becomes tiresome.
</p><!--l. 681--><p class="indent">   It&#x2019;s possible to partially automate the rebasing process. If your patches apply cleanly against some revision of the
underlying repo, MQ can use this information to help you to resolve conflicts between your patches and a different
revision.
</p><!--l. 686--><p class="indent">   The process is a little involved.
     </p><ol  class="enumerate1" >
     <li class="enumerate"><a 
 id="x1-289011x1"></a>To begin, <a 
 id="dx1-289012"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush -a</span>&#x201D; all of your patches on top of the revision where you know that they apply cleanly.
     </li>
     <li class="enumerate"><a 
 id="x1-289014x2"></a>Save a backup copy of your patch directory using <a 
 id="dx1-289015"></a>&#x201C;<span 
class="pcrr7tn-">hg qsave</span> <a 
 id="dx1-289016"></a><a 
 id="dx1-289017"></a><span 
class="pcrr7tn-">-e</span> <a 
 id="dx1-289018"></a><a 
 id="dx1-289019"></a><span 
class="pcrr7tn-">-c</span>&#x201D;. This prints the name of the directory that
     it has saved the patches in. It will save the patches to a directory called <a 
 id="dx1-289020"></a><span 
class="pcrr7tn-">.hg/patches.</span><span 
class="pcrro7t-">N</span>, where <span 
class="pcrro7t-">N </span>is a small
     integer. It also commits a &#x201C;save changeset&#x201D; on top of your applied patches; this is for internal book-keeping, and
     records the states of the <a 
 id="dx1-289021"></a><span 
class="pcrr7tn-">series </span>and <a 
 id="dx1-289022"></a><span 
class="pcrr7tn-">status </span>files.
                                                                                         
                                                                                         
     </li>
     <li class="enumerate"><a 
 id="x1-289024x3"></a>Use <a 
 id="dx1-289025"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D; to bring new changes into the underlying repository. (Don&#x2019;t run <a 
 id="dx1-289026"></a>&#x201C;<span 
class="pcrr7tn-">hg pull -u</span>&#x201D;; see below for
     why.)
     </li>
     <li class="enumerate"><a 
 id="x1-289028x4"></a>Update to the new tip revision, using <a 
 id="dx1-289029"></a>&#x201C;<span 
class="pcrr7tn-">hg update</span> <a 
 id="dx1-289030"></a><span 
class="pcrr7tn-">-C</span>&#x201D; to override the patches you have pushed.
     </li>
     <li class="enumerate"><a 
 id="x1-289032x5"></a>Merge all patches using <a 
 id="dx1-289033"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span> <a 
 id="dx1-289034"></a><a 
 id="dx1-289035"></a><span 
class="pcrr7tn-">-m</span> <a 
 id="dx1-289036"></a><a 
 id="dx1-289037"></a><span 
class="pcrr7tn-">-a</span>&#x201D;. The <a 
 id="dx1-289038"></a><a 
 id="dx1-289039"></a><span 
class="pcrr7tn-">-m </span>option to <a 
 id="dx1-289040"></a><a 
 id="dx1-289041"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; tells MQ to perform a three-way
     merge if the patch fails to apply.</li></ol>
<!--l. 708--><p class="indent">   During the <a 
 id="dx1-289042"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span> <a 
 id="dx1-289043"></a><a 
 id="dx1-289044"></a><span 
class="pcrr7tn-">-m</span>&#x201D;, each patch in the <a 
 id="dx1-289045"></a><span 
class="pcrr7tn-">series </span>file is applied normally. If a patch applies with fuzz or rejects, MQ
looks at the queue you <a 
 id="dx1-289046"></a><a 
 id="dx1-289047"></a>&#x201C;<span 
class="pcrr7tn-">hg qsave</span>&#x201D;d, and performs a three-way merge with the corresponding changeset. This
merge uses Mercurial&#x2019;s normal merge machinery, so it may pop up a GUI merge tool to help you to resolve
problems.
</p><!--l. 715--><p class="indent">   When you finish resolving the effects of a patch, MQ refreshes your patch based on the result of the merge.
</p><!--l. 718--><p class="indent">   At the end of this process, your repository will have one extra head from the old patch queue, and a copy
of the old patch queue will be in <a 
 id="dx1-289048"></a><span 
class="pcrr7tn-">.hg/patches.</span><span 
class="pcrro7t-">N</span>. You can remove the extra head using <a 
 id="dx1-289049"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span> <a 
 id="dx1-289050"></a><a 
 id="dx1-289051"></a><span 
class="pcrr7tn-">-a</span> <a 
 id="dx1-289052"></a><a 
 id="dx1-289053"></a><span 
class="pcrr7tn-">-n</span>
<span 
class="pcrr7tn-">patches.</span><span 
class="pcrro7t-">N</span>&#x201D; or <a 
 id="dx1-289054"></a>&#x201C;<span 
class="pcrr7tn-">hg strip</span>&#x201D;. You can delete <a 
 id="dx1-289055"></a><span 
class="pcrr7tn-">.hg/patches.</span><span 
class="pcrro7t-">N </span>once you are sure that you no longer need it as a
backup.
</p><!--l. 725--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">12.9    </span> <a 
 id="x1-29000012.9"></a>Identifying patches</h3>
<!--l. 727--><p class="noindent">MQ commands that work with patches let you refer to a patch either by using its name or by a number. By name is obvious
enough; pass the name <span 
class="pcrr7tn-">foo.patch </span>to <a 
 id="dx1-290001"></a><a 
 id="dx1-290002"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D;, for example, and it will push patches until <span 
class="pcrr7tn-">foo.patch </span>is
applied.
</p><!--l. 732--><p class="indent">   As a shortcut, you can refer to a patch using both a name and a numeric offset; <span 
class="pcrr7tn-">foo.patch-2 </span>means &#x201C;two patches before
<span 
class="pcrr7tn-">foo.patch</span>&#x201D;, while <span 
class="pcrr7tn-">bar.patch+4 </span>means &#x201C;four patches after <span 
class="pcrr7tn-">bar.patch</span>&#x201D;.
</p><!--l. 737--><p class="indent">   Referring to a patch by index isn&#x2019;t much different. The first patch printed in the output of <a 
 id="dx1-290003"></a><a 
 id="dx1-290004"></a>&#x201C;<span 
class="pcrr7tn-">hg qseries</span>&#x201D; is patch zero (yes,
it&#x2019;s one of those start-at-zero counting systems); the second is patch one; and so on
</p><!--l. 742--><p class="indent">   MQ also makes it easy to work with patches when you are using normal Mercurial commands. Every command that accepts
a changeset ID will also accept the name of an applied patch. MQ augments the tags normally in the repository with an
eponymous one for each applied patch. In addition, the special tags <a 
 id="dx1-290005"></a><span 
class="pcrr7tn-">qbase </span>and <a 
 id="dx1-290006"></a><span 
class="pcrr7tn-">qtip </span>identify the &#x201C;bottom-most&#x201D; and topmost
applied patches, respectively.
</p><!--l. 751--><p class="indent">   These additions to Mercurial&#x2019;s normal tagging capabilities make dealing with patches even more of a breeze.
</p>
     <ul><li><span class="dt">
     </span><span class="dd">Want to patchbomb a mailing list with your latest series of changes?
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-290008r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;email</span><span 
class="pcrr7tn-">&#x00A0;qbase:qtip</span>
</div>
     <!--l. 759--><p class="noindent">(Don&#x2019;t know what &#x201C;patchbombing&#x201D; is? See section&#x00A0;<a 
href="#x1-32100014.4">14.4<!--tex4ht:ref: sec:hgext:patchbomb --></a>.)
     </p></span><li><span class="dt">
     </span><span class="dd">Need to see all of the patches since <span 
class="pcrr7tn-">foo.patch </span>that have touched files in a subdirectory of your tree?
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-290010r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;log</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;foo.patch:qtip</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrro7t-">subdir</span>
</div>
                                                                                         
                                                                                         
     </li></ul>
<!--l. 768--><p class="indent">   Because MQ makes the names of patches available to the rest of Mercurial through its normal internal tag machinery, you
don&#x2019;t need to type in the entire name of a patch when you want to identify it by name.
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-29007514"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-290012r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qapplied</span>
<br class="fancyvrb" /><a 
 id="x1-290014r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-290016r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-290018r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;log</span><span 
class="pcrb7t-">&#x00A0;-r</span><span 
class="pcrb7t-">&#x00A0;qbase:qtip</span>
<br class="fancyvrb" /><a 
 id="x1-290020r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:fe9dd6094b8c</span>
<br class="fancyvrb" /><a 
 id="x1-290022r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-290024r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;qbase</span>
<br class="fancyvrb" /><a 
 id="x1-290026r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-290028r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:20</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-290030r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;patch</span><span 
class="pcrr7tn-">&#x00A0;queue:</span><span 
class="pcrr7tn-">&#x00A0;first.patch</span>
<br class="fancyvrb" /><a 
 id="x1-290032r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-290034r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;2:8433cfd09e0c</span>
<br class="fancyvrb" /><a 
 id="x1-290036r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-290038r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;qtip</span>
<br class="fancyvrb" /><a 
 id="x1-290040r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-290042r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-290044r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:21</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-290046r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;patch</span><span 
class="pcrr7tn-">&#x00A0;queue:</span><span 
class="pcrr7tn-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-290048r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-290050r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;export</span><span 
class="pcrb7t-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-290052r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;HG</span><span 
class="pcrr7tn-">&#x00A0;changeset</span><span 
class="pcrr7tn-">&#x00A0;patch</span>
<br class="fancyvrb" /><a 
 id="x1-290054r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;User</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-290056r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;Date</span><span 
class="pcrr7tn-">&#x00A0;1209254661</span><span 
class="pcrr7tn-">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x1-290058r24"></a><span 
class="ptmr7t-x-x-50">24</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;Node</span><span 
class="pcrr7tn-">&#x00A0;ID</span><span 
class="pcrr7tn-">&#x00A0;8433cfd09e0cbe32d67661b543050e82daa16fe3</span>
<br class="fancyvrb" /><a 
 id="x1-290060r25"></a><span 
class="ptmr7t-x-x-50">25</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;Parent</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;fe9dd6094b8c8e71d77008942deb2fc2302f5960</span>
<br class="fancyvrb" /><a 
 id="x1-290062r26"></a><span 
class="ptmr7t-x-x-50">26</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;patch</span><span 
class="pcrr7tn-">&#x00A0;queue:</span><span 
class="pcrr7tn-">&#x00A0;second.patch</span>
<br class="fancyvrb" /><a 
 id="x1-290064r27"></a><span 
class="ptmr7t-x-x-50">27</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-290066r28"></a><span 
class="ptmr7t-x-x-50">28</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;fe9dd6094b8c</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;8433cfd09e0c</span><span 
class="pcrr7tn-">&#x00A0;other.c</span>
<br class="fancyvrb" /><a 
 id="x1-290068r29"></a><span 
class="ptmr7t-x-x-50">29</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;/dev/null        Thu</span><span 
class="pcrr7tn-">&#x00A0;Jan</span><span 
class="pcrr7tn-">&#x00A0;01</span><span 
class="pcrr7tn-">&#x00A0;00:00:00</span><span 
class="pcrr7tn-">&#x00A0;1970</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-290070r30"></a><span 
class="ptmr7t-x-x-50">30</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/other.c        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:21</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-290072r31"></a><span 
class="ptmr7t-x-x-50">31</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-0,0</span><span 
class="pcrr7tn-">&#x00A0;+1,1</span><span 
class="pcrr7tn-">&#x00A0;@@</span>
<br class="fancyvrb" /><a 
 id="x1-290074r32"></a><span 
class="ptmr7t-x-x-50">32</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+double</span><span 
class="pcrr7tn-">&#x00A0;u;</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.14: </td><td  
class="content">Using MQ&#x2019;s tag features to work with patches</td></tr></table><!--tex4ht:label?: x1-29007514 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 779--><p class="indent">   Another nice consequence of representing patch names as tags is that when you run the <a 
 id="dx1-290076"></a>&#x201C;<span 
class="pcrr7tn-">hg log</span>&#x201D; command, it will display
a patch&#x2019;s name as a tag, simply as part of its normal output. This makes it easy to visually distinguish applied patches from
underlying &#x201C;normal&#x201D; revisions. Figure&#x00A0;<a 
href="#x1-29007514">12.14<!--tex4ht:ref: ex:mq:id --></a> shows a few normal Mercurial commands in use with applied
patches.
</p>
   <h3 class="sectionHead"><span class="titlemark">12.10    </span> <a 
 id="x1-29100012.10"></a>Useful things to know about</h3>
<!--l. 788--><p class="noindent">There are a number of aspects of MQ usage that don&#x2019;t fit tidily into sections of their own, but that are good to know. Here they
are, in one place.
</p>
     <ul><li><span class="dt">
     </span><span class="dd">Normally,  when  you  <a 
 id="dx1-291001"></a><a 
 id="dx1-291002"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D;  a  patch  and  <a 
 id="dx1-291003"></a><a 
 id="dx1-291004"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D;  it  again,  the  changeset  that  represents  the  patch
     after the pop/push will have a <span 
class="ptmri7t-">different identity </span>than the changeset that represented the hash beforehand. See
     section&#x00A0;<a 
href="#x1-358000B.1.13">B.1.13<!--tex4ht:ref: sec:mqref:cmd:qpush --></a> for information as to why this is.
     </span><li><span class="dt">
     </span><span class="dd">It&#x2019;s not a good idea to <a 
 id="dx1-291005"></a>&#x201C;<span 
class="pcrr7tn-">hg merge</span>&#x201D; changes from another branch with a patch changeset, at least if you want to
     maintain the &#x201C;patchiness&#x201D; of that changeset and changesets below it on the patch stack. If you try to do this, it
     will appear to succeed, but MQ will become confused.</li></ul>
<!--l. 805--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">12.11    </span> <a 
 id="x1-29200012.11"></a>Managing patches in a repository</h3>
<!--l. 808--><p class="noindent">Because MQ&#x2019;s <a 
 id="dx1-292001"></a><span 
class="pcrr7tn-">.hg/patches </span>directory resides outside a Mercurial repository&#x2019;s working directory, the &#x201C;underlying&#x201D; Mercurial
repository knows nothing about the management or presence of patches.
</p><!--l. 812--><p class="indent">   This presents the interesting possibility of managing the contents of the patch directory as a Mercurial repository in its own
right. This can be a useful way to work. For example, you can work on a patch for a while, <a 
 id="dx1-292002"></a><a 
 id="dx1-292003"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D;
it, then <a 
 id="dx1-292004"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; the current state of the patch. This lets you &#x201C;roll back&#x201D; to that version of the patch later
on.
</p><!--l. 819--><p class="indent">   You can then share different versions of the same patch stack among multiple underlying repositories. I use this when I am
developing a Linux kernel feature. I have a pristine copy of my kernel sources for each of several CPU architectures, and a
cloned repository under each that contains the patches I am working on. When I want to test a change on a different
architecture, I push my current patches to the patch repository associated with that kernel tree, pop and push all of my patches,
and build and test that kernel.
</p><!--l. 828--><p class="indent">   Managing patches in a repository makes it possible for multiple developers to work on the same patch series without
colliding with each other, all on top of an underlying source base that they may or may not control.
</p><!--l. 833--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.11.1    </span> <a 
 id="x1-29300012.11.1"></a>MQ support for patch repositories</h4>
<!--l. 835--><p class="noindent">MQ helps you to work with the <a 
 id="dx1-293001"></a><span 
class="pcrr7tn-">.hg/patches </span>directory as a repository; when you prepare a repository for working with
patches using <a 
 id="dx1-293002"></a><a 
 id="dx1-293003"></a>&#x201C;<span 
class="pcrr7tn-">hg qinit</span>&#x201D;, you can pass the <a 
 id="dx1-293004"></a><a 
 id="dx1-293005"></a><span 
class="pcrr7tn-">-c </span>option to create the <a 
 id="dx1-293006"></a><span 
class="pcrr7tn-">.hg/patches </span>directory as a Mercurial
repository.
</p>
                                                                                         
                                                                                         
   <div class="fbox"><span 
class="ptmb7t-">Note:  </span>If you forget to use the <span 
class="pcrr7tn-">-c </span>option, you can simply go into the <span 
class="pcrr7tn-">.hg/patches</span>
directory  at  any  time  and  run  &#x201C;<span 
class="pcrr7tn-">hg init</span>&#x201D;.  Don&#x2019;t  forget  to  add  an  entry  for  the
<span 
class="pcrr7tn-">status </span>file to the <span 
class="pcrr7tn-">.hgignore </span>file, though
(&#x201C;<span 
class="pcrr7tn-">hg qinit -c</span>&#x201D; does this for you automatically); you <span 
class="ptmri7t-">really </span>don&#x2019;t want to manage
the <span 
class="pcrr7tn-">status </span>file.                                                                                                          </div>
<!--l. 851--><p class="indent">   As a convenience, if MQ notices that the <span 
class="pcrr7tn-">.hg/patches </span>directory is a repository, it will automatically <a 
 id="dx1-293017"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; every patch
that you create and import.
</p><!--l. 855--><p class="indent">   MQ provides a shortcut command, <a 
 id="dx1-293018"></a><a 
 id="dx1-293019"></a>&#x201C;<span 
class="pcrr7tn-">hg qcommit</span>&#x201D;, that runs <a 
 id="dx1-293020"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; in the <a 
 id="dx1-293021"></a><span 
class="pcrr7tn-">.hg/patches </span>directory. This saves some
bothersome typing.
</p><!--l. 859--><p class="indent">   Finally, as a convenience to manage the patch directory, you can define the alias <a 
 id="dx1-293022"></a><span 
class="pcrr7tn-">mq </span>on Unix systems. For example, on
Linux systems using the <a 
 id="dx1-293023"></a><span 
class="pcrr7tn-">bash </span>shell, you can include the following snippet in your <span 
class="pcrr7tn-">~/.bashrc</span>.
</p><!--l. 864--><p class="indent">
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-293025r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;alias</span><span 
class="pcrr7tn-">&#x00A0;mq=&#x2018;hg</span><span 
class="pcrr7tn-">&#x00A0;-R</span><span 
class="pcrr7tn-">&#x00A0;$(hg</span><span 
class="pcrr7tn-">&#x00A0;root)/.hg/patches'</span>
   </div>
<!--l. 868--><p class="indent">   You can then issue commands of the form <a 
 id="dx1-293026"></a>&#x201C;<span 
class="pcrr7tn-">mq pull</span>&#x201D; from the main repository.
</p><!--l. 871--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.11.2    </span> <a 
 id="x1-29400012.11.2"></a>A few things to watch out for</h4>
<!--l. 873--><p class="noindent">MQ&#x2019;s support for working with a repository full of patches is limited in a few small respects.
</p><!--l. 876--><p class="indent">   MQ cannot automatically detect changes that you make to the patch directory. If you <a 
 id="dx1-294001"></a>&#x201C;<span 
class="pcrr7tn-">hg pull</span>&#x201D;, manually edit, or <a 
 id="dx1-294002"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">update</span>&#x201D; changes to patches or the <a 
 id="dx1-294003"></a><span 
class="pcrr7tn-">series </span>file, you will have to <a 
 id="dx1-294004"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span> <a 
 id="dx1-294005"></a><a 
 id="dx1-294006"></a><span 
class="pcrr7tn-">-a</span>&#x201D; and then <a 
 id="dx1-294007"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span> <a 
 id="dx1-294008"></a><a 
 id="dx1-294009"></a><span 
class="pcrr7tn-">-a</span>&#x201D; in the underlying
repository to see those changes show up there. If you forget to do this, you can confuse MQ&#x2019;s idea of which patches are
applied.
</p><!--l. 884--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">12.12    </span> <a 
 id="x1-29500012.12"></a>Third party tools for working with patches</h3>
<!--l. 887--><p class="noindent">Once you&#x2019;ve been working with patches for a while, you&#x2019;ll find yourself hungry for tools that will help you to understand and
manipulate the patches you&#x2019;re dealing with.
</p><!--l. 891--><p class="indent">   The <a 
 id="dx1-295001"></a><span 
class="pcrr7tn-">diffstat </span>command&#x00A0;<span class="cite">[<span 
class="ptmb7t-">?</span>]</span> generates a histogram of the modifications made to each file in a patch. It provides a good
way to &#x201C;get a sense of&#x201D; a patch&#x2014;which files it affects, and how much change it introduces to each file and as a whole. (I find
that it&#x2019;s a good idea to use <a 
 id="dx1-295002"></a><span 
class="pcrr7tn-">diffstat</span>&#x2019;s <a 
 id="dx1-295003"></a><span 
class="pcrr7tn-">-p </span>option as a matter of course, as otherwise it will try to do clever things with prefixes
of file names that inevitably confuse at least me.)
</p>
   <hr class="figure" /><div class="figure" 
><table class="figure"><tr class="figure"><td class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-29505015"></a>
                                                                                         
                                                                                         
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-295005r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">diffstat</span><span 
class="pcrb7t-">&#x00A0;-p1</span><span 
class="pcrb7t-">&#x00A0;remove-redundant-null-checks.patch</span>
<br class="fancyvrb" /><a 
 id="x1-295007r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;drivers/char/agp/sgi-agp.c</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;5</span><span 
class="pcrr7tn-">&#x00A0;++---</span>
<br class="fancyvrb" /><a 
 id="x1-295009r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;drivers/char/hvcs.c</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;11</span><span 
class="pcrr7tn-">&#x00A0;+++++------</span>
<br class="fancyvrb" /><a 
 id="x1-295011r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;drivers/message/fusion/mptfc.c</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;6</span><span 
class="pcrr7tn-">&#x00A0;++----</span>
<br class="fancyvrb" /><a 
 id="x1-295013r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;drivers/message/fusion/mptsas.c</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3</span><span 
class="pcrr7tn-">&#x00A0;+--</span>
<br class="fancyvrb" /><a 
 id="x1-295015r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;drivers/net/fs_enet/fs_enet-mii.c</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3</span><span 
class="pcrr7tn-">&#x00A0;+--</span>
<br class="fancyvrb" /><a 
 id="x1-295017r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;drivers/net/wireless/ipw2200.c</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;22</span><span 
class="pcrr7tn-">&#x00A0;++++++----------------</span>
<br class="fancyvrb" /><a 
 id="x1-295019r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;drivers/scsi/libata-scsi.c</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;4</span><span 
class="pcrr7tn-">&#x00A0;+---</span>
<br class="fancyvrb" /><a 
 id="x1-295021r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;drivers/video/au1100fb.c</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;3</span><span 
class="pcrr7tn-">&#x00A0;+--</span>
<br class="fancyvrb" /><a 
 id="x1-295023r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;8</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;changed,</span><span 
class="pcrr7tn-">&#x00A0;19</span><span 
class="pcrr7tn-">&#x00A0;insertions(+),</span><span 
class="pcrr7tn-">&#x00A0;38</span><span 
class="pcrr7tn-">&#x00A0;deletions(-)</span>
<br class="fancyvrb" /><a 
 id="x1-295025r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">filterdiff</span><span 
class="pcrb7t-">&#x00A0;-i</span><span 
class="pcrb7t-">&#x00A0;'&#x22C6;/video/&#x22C6;'</span><span 
class="pcrb7t-">&#x00A0;remove-redundant-null-checks.patch</span>
<br class="fancyvrb" /><a 
 id="x1-295027r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/drivers/video/au1100fb.c~remove-redundant-null-checks-before-free-in-drivers</span>
<br class="fancyvrb" /><a 
 id="x1-295029r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;a/drivers/video/au1100fb.c</span>
<br class="fancyvrb" /><a 
 id="x1-295031r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-743,8</span><span 
class="pcrr7tn-">&#x00A0;+743,7</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;void</span><span 
class="pcrr7tn-">&#x00A0;__exit</span><span 
class="pcrr7tn-">&#x00A0;au1100fb_cleanup(void)</span>
<br class="fancyvrb" /><a 
 id="x1-295033r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span>
<br class="fancyvrb" /><a 
 id="x1-295035r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        driver_unregister(&au1100fb_driver);</span>
<br class="fancyvrb" /><a 
 id="x1-295037r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-295039r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-        if</span><span 
class="pcrr7tn-">&#x00A0;(drv_info.opt_mode)</span>
<br class="fancyvrb" /><a 
 id="x1-295041r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-                kfree(drv_info.opt_mode);</span>
<br class="fancyvrb" /><a 
 id="x1-295043r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+        kfree(drv_info.opt_mode);</span>
<br class="fancyvrb" /><a 
 id="x1-295045r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-295047r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-295049r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;module_init(au1100fb_init);</span>
   </div>
<br /><table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Figure&#x00A0;12.15: </td><td  
class="content">The <a 
 id="dx1-295051"></a><span 
class="pcrr7tn-">diffstat</span>, <a 
 id="dx1-295052"></a><span 
class="pcrr7tn-">filterdiff</span>, and <a 
 id="dx1-295053"></a><span 
class="pcrr7tn-">lsdiff </span>commands</td></tr></table><!--tex4ht:label?: x1-29505015 -->
                                                                                         
                                                                                         
   </td></tr></table></div><hr class="endfigure" />
<!--l. 906--><p class="indent">   The <a 
 id="dx1-295054"></a><span 
class="pcrr7tn-">patchutils </span>package&#x00A0;<span class="cite">[<span 
class="ptmb7t-">?</span>]</span> is invaluable. It provides a set of small utilities that follow the &#x201C;Unix philosophy;&#x201D; each does
one useful thing with a patch. The <a 
 id="dx1-295055"></a><span 
class="pcrr7tn-">patchutils </span>command I use most is <a 
 id="dx1-295056"></a><span 
class="pcrr7tn-">filterdiff</span>, which extracts subsets from a patch file.
For example, given a patch that modifies hundreds of files across dozens of directories, a single invocation of <a 
 id="dx1-295057"></a><span 
class="pcrr7tn-">filterdiff </span>can
generate a smaller patch that only touches files whose names match a particular glob pattern. See section&#x00A0;<a 
href="#x1-31500013.9.2">13.9.2<!--tex4ht:ref: mq-collab:tips:interdiff --></a> for another
example.
</p>
   <h3 class="sectionHead"><span class="titlemark">12.13    </span> <a 
 id="x1-29600012.13"></a>Good ways to work with patches</h3>
<!--l. 918--><p class="noindent">Whether you are working on a patch series to submit to a free software or open source project, or a series that you intend to
treat as a sequence of regular changesets when you&#x2019;re done, you can use some simple techniques to keep your work well
organised.
</p><!--l. 923--><p class="indent">   Give your patches descriptive names. A good name for a patch might be <span 
class="pcrr7tn-">rework-device-alloc.patch</span>, because it will
immediately give you a hint what the purpose of the patch is. Long names shouldn&#x2019;t be a problem; you won&#x2019;t be typing the
names often, but you <span 
class="ptmri7t-">will </span>be running commands like <a 
 id="dx1-296001"></a><a 
 id="dx1-296002"></a>&#x201C;<span 
class="pcrr7tn-">hg qapplied</span>&#x201D; and <a 
 id="dx1-296003"></a><a 
 id="dx1-296004"></a>&#x201C;<span 
class="pcrr7tn-">hg qtop</span>&#x201D; over and over. Good naming becomes
especially important when you have a number of patches to work with, or if you are juggling a number of different tasks and
your patches only get a fraction of your attention.
</p><!--l. 932--><p class="indent">   Be aware of what patch you&#x2019;re working on. Use the <a 
 id="dx1-296005"></a><a 
 id="dx1-296006"></a>&#x201C;<span 
class="pcrr7tn-">hg qtop</span>&#x201D; command and skim over the text of your patches
frequently&#x2014;for example, using <a 
 id="dx1-296007"></a>&#x201C;<span 
class="pcrr7tn-">hg tip</span> <a 
 id="dx1-296008"></a><span 
class="pcrr7tn-">-p</span>&#x201D;)&#x2014;to be sure of where you stand. I have several times worked on and <a 
 id="dx1-296009"></a><a 
 id="dx1-296010"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">qrefresh</span>&#x201D;ed a patch other than the one I intended, and it&#x2019;s often tricky to migrate changes into the right patch after making
them in the wrong one.
</p><!--l. 939--><p class="indent">   For this reason, it is very much worth investing a little time to learn how to use some of the third-party tools I
described in section&#x00A0;<a 
href="#x1-29500012.12">12.12<!--tex4ht:ref: sec:mq:tools --></a>, particularly <a 
 id="dx1-296011"></a><span 
class="pcrr7tn-">diffstat </span>and <a 
 id="dx1-296012"></a><span 
class="pcrr7tn-">filterdiff</span>. The former will give you a quick idea of what
changes your patch is making, while the latter makes it easy to splice hunks selectively out of one patch and into
another.
</p><!--l. 946--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">12.14    </span> <a 
 id="x1-29700012.14"></a>MQ cookbook</h3>
<!--l. 948--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.14.1    </span> <a 
 id="x1-29800012.14.1"></a>Manage &#x201C;trivial&#x201D; patches</h4>
<!--l. 950--><p class="noindent">Because the overhead of dropping files into a new Mercurial repository is so low, it makes a lot of sense to manage patches this
way even if you simply want to make a few changes to a source tarball that you downloaded.
</p><!--l. 955--><p class="indent">   Begin by downloading and unpacking the source tarball, and turning it into a Mercurial repository.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-298002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">download</span><span 
class="pcrb7t-">&#x00A0;netplug-1.2.5.tar.bz2</span>
<br class="fancyvrb" /><a 
 id="x1-298004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">tar</span><span 
class="pcrb7t-">&#x00A0;jxf</span><span 
class="pcrb7t-">&#x00A0;netplug-1.2.5.tar.bz2</span>
<br class="fancyvrb" /><a 
 id="x1-298006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;netplug-1.2.5</span>
<br class="fancyvrb" /><a 
 id="x1-298008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;init</span>
<br class="fancyvrb" /><a 
 id="x1-298010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;-q</span><span 
class="pcrb7t-">&#x00A0;--addremove</span><span 
class="pcrb7t-">&#x00A0;--message</span><span 
class="pcrb7t-">&#x00A0;netplug-1.2.5</span>
<br class="fancyvrb" /><a 
 id="x1-298012r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-298014r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;netplug-1.2.5</span><span 
class="pcrb7t-">&#x00A0;netplug</span>
<br class="fancyvrb" /><a 
 id="x1-298016r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;18</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
   </div>
                                                                                         
                                                                                         
<!--l. 959--><p class="indent">   Continue by creating a patch stack and making your changes.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-298018r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;netplug</span>
<br class="fancyvrb" /><a 
 id="x1-298020r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qinit</span>
<br class="fancyvrb" /><a 
 id="x1-298022r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qnew</span><span 
class="pcrb7t-">&#x00A0;-m</span><span 
class="pcrb7t-">&#x00A0;'fix</span><span 
class="pcrb7t-">&#x00A0;build</span><span 
class="pcrb7t-">&#x00A0;problem</span><span 
class="pcrb7t-">&#x00A0;with</span><span 
class="pcrb7t-">&#x00A0;gcc</span><span 
class="pcrb7t-">&#x00A0;4'</span><span 
class="pcrb7t-">&#x00A0;build-fix.patch</span>
<br class="fancyvrb" /><a 
 id="x1-298024r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">perl</span><span 
class="pcrb7t-">&#x00A0;-pi</span><span 
class="pcrb7t-">&#x00A0;-e</span><span 
class="pcrb7t-">&#x00A0;'s/int</span><span 
class="pcrb7t-">&#x00A0;addr_len/socklen_t</span><span 
class="pcrb7t-">&#x00A0;addr_len/'</span><span 
class="pcrb7t-">&#x00A0;netlink.c</span>
<br class="fancyvrb" /><a 
 id="x1-298026r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qrefresh</span>
<br class="fancyvrb" /><a 
 id="x1-298028r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;tip</span><span 
class="pcrb7t-">&#x00A0;-p</span>
<br class="fancyvrb" /><a 
 id="x1-298030r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;changeset:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;1:4f5053e25c5a</span>
<br class="fancyvrb" /><a 
 id="x1-298032r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;qtip</span>
<br class="fancyvrb" /><a 
 id="x1-298034r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;build-fix.patch</span>
<br class="fancyvrb" /><a 
 id="x1-298036r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tip</span>
<br class="fancyvrb" /><a 
 id="x1-298038r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;tag:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;qbase</span>
<br class="fancyvrb" /><a 
 id="x1-298040r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;user:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-298042r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;date:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:21</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-298044r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;summary:</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;fix</span><span 
class="pcrr7tn-">&#x00A0;build</span><span 
class="pcrr7tn-">&#x00A0;problem</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;gcc</span><span 
class="pcrr7tn-">&#x00A0;4</span>
<br class="fancyvrb" /><a 
 id="x1-298046r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-298048r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;af6a01b86aa5</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;4f5053e25c5a</span><span 
class="pcrr7tn-">&#x00A0;netlink.c</span>
<br class="fancyvrb" /><a 
 id="x1-298050r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/netlink.c        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:21</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-298052r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/netlink.c        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:21</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-298054r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-275,7</span><span 
class="pcrr7tn-">&#x00A0;+275,7</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;netlink_open(void)</span>
<br class="fancyvrb" /><a 
 id="x1-298056r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;exit(1);</span>
<br class="fancyvrb" /><a 
 id="x1-298058r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-298060r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-298062r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;addr_len</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;sizeof(addr);</span>
<br class="fancyvrb" /><a 
 id="x1-298064r24"></a><span 
class="ptmr7t-x-x-50">24</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;socklen_t</span><span 
class="pcrr7tn-">&#x00A0;addr_len</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;sizeof(addr);</span>
<br class="fancyvrb" /><a 
 id="x1-298066r25"></a><span 
class="ptmr7t-x-x-50">25</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-298068r26"></a><span 
class="ptmr7t-x-x-50">26</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;if</span><span 
class="pcrr7tn-">&#x00A0;(getsockname(fd,</span><span 
class="pcrr7tn-">&#x00A0;(struct</span><span 
class="pcrr7tn-">&#x00A0;sockaddr</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;)</span><span 
class="pcrr7tn-">&#x00A0;&addr,</span><span 
class="pcrr7tn-">&#x00A0;&addr_len)</span><span 
class="pcrr7tn-">&#x00A0;==</span><span 
class="pcrr7tn-">&#x00A0;-1)</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span>
<br class="fancyvrb" /><a 
 id="x1-298070r27"></a><span 
class="ptmr7t-x-x-50">27</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;do_log(LOG_ERR,</span><span 
class="pcrr7tn-">&#x00A0;"Could</span><span 
class="pcrr7tn-">&#x00A0;not</span><span 
class="pcrr7tn-">&#x00A0;get</span><span 
class="pcrr7tn-">&#x00A0;socket</span><span 
class="pcrr7tn-">&#x00A0;details:</span><span 
class="pcrr7tn-">&#x00A0;%m");</span>
<br class="fancyvrb" /><a 
 id="x1-298072r28"></a><span 
class="ptmr7t-x-x-50">28</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
   </div>
<!--l. 962--><p class="indent">   Let&#x2019;s say a few weeks or months pass, and your package author releases a new version. First, bring their changes into the
repository.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-298074r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qpop</span><span 
class="pcrb7t-">&#x00A0;-a</span>
<br class="fancyvrb" /><a 
 id="x1-298076r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Patch</span><span 
class="pcrr7tn-">&#x00A0;queue</span><span 
class="pcrr7tn-">&#x00A0;now</span><span 
class="pcrr7tn-">&#x00A0;empty</span>
<br class="fancyvrb" /><a 
 id="x1-298078r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-298080r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">download</span><span 
class="pcrb7t-">&#x00A0;netplug-1.2.8.tar.bz2</span>
<br class="fancyvrb" /><a 
 id="x1-298082r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;clone</span><span 
class="pcrb7t-">&#x00A0;netplug-1.2.5</span><span 
class="pcrb7t-">&#x00A0;netplug-1.2.8</span>
<br class="fancyvrb" /><a 
 id="x1-298084r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;18</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;updated,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;merged,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;removed,</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;unresolved</span>
<br class="fancyvrb" /><a 
 id="x1-298086r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;netplug-1.2.8</span>
<br class="fancyvrb" /><a 
 id="x1-298088r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;locate</span><span 
class="pcrb7t-">&#x00A0;-0</span><span 
class="pcrb7t-">&#x00A0;|</span><span 
class="pcrb7t-">&#x00A0;xargs</span><span 
class="pcrb7t-">&#x00A0;-0</span><span 
class="pcrb7t-">&#x00A0;rm</span>
<br class="fancyvrb" /><a 
 id="x1-298090r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;..</span>
<br class="fancyvrb" /><a 
 id="x1-298092r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">tar</span><span 
class="pcrb7t-">&#x00A0;jxf</span><span 
class="pcrb7t-">&#x00A0;netplug-1.2.8.tar.bz2</span>
<br class="fancyvrb" /><a 
 id="x1-298094r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;netplug-1.2.8</span>
<br class="fancyvrb" /><a 
 id="x1-298096r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;commit</span><span 
class="pcrb7t-">&#x00A0;--addremove</span><span 
class="pcrb7t-">&#x00A0;--message</span><span 
class="pcrb7t-">&#x00A0;netplug-1.2.8</span>
   </div>
<!--l. 965--><p class="noindent">The pipeline starting with <a 
 id="dx1-298097"></a>&#x201C;<span 
class="pcrr7tn-">hg locate</span>&#x201D; above deletes all files in the working directory, so that <a 
 id="dx1-298098"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D;&#x2019;s <a 
 id="dx1-298099"></a><span 
class="pcrr7tn-">--addremove</span>
                                                                                         
                                                                                         
option can actually tell which files have really been removed in the newer version of the source.
</p><!--l. 970--><p class="indent">   Finally, you can apply your patches on top of the new tree.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-298101r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cd</span><span 
class="pcrb7t-">&#x00A0;../netplug</span>
<br class="fancyvrb" /><a 
 id="x1-298103r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;pull</span><span 
class="pcrb7t-">&#x00A0;../netplug-1.2.8</span>
<br class="fancyvrb" /><a 
 id="x1-298105r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;pulling</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;../netplug-1.2.8</span>
<br class="fancyvrb" /><a 
 id="x1-298107r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;searching</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-298109r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;changesets</span>
<br class="fancyvrb" /><a 
 id="x1-298111r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;manifests</span>
<br class="fancyvrb" /><a 
 id="x1-298113r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;adding</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;changes</span>
<br class="fancyvrb" /><a 
 id="x1-298115r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;added</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;changesets</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;12</span><span 
class="pcrr7tn-">&#x00A0;changes</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;12</span><span 
class="pcrr7tn-">&#x00A0;files</span>
<br class="fancyvrb" /><a 
 id="x1-298117r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;(run</span><span 
class="pcrr7tn-">&#x00A0;'hg</span><span 
class="pcrr7tn-">&#x00A0;update'</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;get</span><span 
class="pcrr7tn-">&#x00A0;a</span><span 
class="pcrr7tn-">&#x00A0;working</span><span 
class="pcrr7tn-">&#x00A0;copy)</span>
<br class="fancyvrb" /><a 
 id="x1-298119r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qpush</span><span 
class="pcrb7t-">&#x00A0;-a</span>
<br class="fancyvrb" /><a 
 id="x1-298121r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;applying</span><span 
class="pcrr7tn-">&#x00A0;build-fix.patch</span>
<br class="fancyvrb" /><a 
 id="x1-298123r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Now</span><span 
class="pcrr7tn-">&#x00A0;at:</span><span 
class="pcrr7tn-">&#x00A0;build-fix.patch</span>
   </div>
<!--l. 973--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.14.2    </span> <a 
 id="x1-29900012.14.2"></a>Combining entire patches</h4>
<!--l. 976--><p class="noindent">MQ provides a command, <a 
 id="dx1-299001"></a><a 
 id="dx1-299002"></a>&#x201C;<span 
class="pcrr7tn-">hg qfold</span>&#x201D; that lets you combine entire patches. This &#x201C;folds&#x201D; the patches you name, in the order
you name them, into the topmost applied patch, and concatenates their descriptions onto the end of its description. The patches
that you fold must be unapplied before you fold them.
</p><!--l. 982--><p class="indent">   The order in which you fold patches matters. If your topmost applied patch is <span 
class="pcrr7tn-">foo</span>, and you <a 
 id="dx1-299003"></a><a 
 id="dx1-299004"></a>&#x201C;<span 
class="pcrr7tn-">hg qfold</span>&#x201D; <span 
class="pcrr7tn-">bar </span>and <span 
class="pcrr7tn-">quux</span>
into it, you will end up with a patch that has the same effect as if you applied first <span 
class="pcrr7tn-">foo</span>, then <span 
class="pcrr7tn-">bar</span>, followed by
<span 
class="pcrr7tn-">quux</span>.
</p><!--l. 988--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">12.14.3    </span> <a 
 id="x1-30000012.14.3"></a>Merging part of one patch into another</h4>
<!--l. 990--><p class="noindent">Merging <span 
class="ptmri7t-">part </span>of one patch into another is more difficult than combining entire patches.
</p><!--l. 993--><p class="indent">   If you want to move changes to entire files, you can use <a 
 id="dx1-300001"></a><span 
class="pcrr7tn-">filterdiff</span>&#x2019;s <a 
 id="dx1-300002"></a><span 
class="pcrr7tn-">-i </span>and <a 
 id="dx1-300003"></a><span 
class="pcrr7tn-">-x </span>options to choose the modifications to
snip out of one patch, concatenating its output onto the end of the patch you want to merge into. You usually won&#x2019;t need to
modify the patch you&#x2019;ve merged the changes from. Instead, MQ will report some rejected hunks when you <a 
 id="dx1-300004"></a><a 
 id="dx1-300005"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; it (from
the hunks you moved into the other patch), and you can simply <a 
 id="dx1-300006"></a><a 
 id="dx1-300007"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D; the patch to drop the duplicate
hunks.
</p><!--l. 1003--><p class="indent">   If you have a patch that has multiple hunks modifying a file, and you only want to move a few of those hunks, the job
becomes more messy, but you can still partly automate it. Use <a 
 id="dx1-300008"></a>&#x201C;<span 
class="pcrr7tn-">lsdiff -nvv</span>&#x201D; to print some metadata about the
patch.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-300010r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">lsdiff</span><span 
class="pcrb7t-">&#x00A0;-nvv</span><span 
class="pcrb7t-">&#x00A0;remove-redundant-null-checks.patch</span>
<br class="fancyvrb" /><a 
 id="x1-300012r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;22        File</span><span 
class="pcrr7tn-">&#x00A0;#1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        a/drivers/char/agp/sgi-agp.c</span>
<br class="fancyvrb" /><a 
 id="x1-300014r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        24        Hunk</span><span 
class="pcrr7tn-">&#x00A0;#1        static</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;__devinit</span><span 
class="pcrr7tn-">&#x00A0;agp_sgi_init(void)</span>
<br class="fancyvrb" /><a 
 id="x1-300016r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;37        File</span><span 
class="pcrr7tn-">&#x00A0;#2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        a/drivers/char/hvcs.c</span>
<br class="fancyvrb" /><a 
 id="x1-300018r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        39        Hunk</span><span 
class="pcrr7tn-">&#x00A0;#1        static</span><span 
class="pcrr7tn-">&#x00A0;struct</span><span 
class="pcrr7tn-">&#x00A0;tty_operations</span><span 
class="pcrr7tn-">&#x00A0;hvcs_ops</span><span 
class="pcrr7tn-">&#x00A0;=</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-300020r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        53        Hunk</span><span 
class="pcrr7tn-">&#x00A0;#2        static</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;hvcs_alloc_index_list(int</span><span 
class="pcrr7tn-">&#x00A0;n)</span>
<br class="fancyvrb" /><a 
 id="x1-300022r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;69        File</span><span 
class="pcrr7tn-">&#x00A0;#3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        a/drivers/message/fusion/mptfc.c</span>
<br class="fancyvrb" /><a 
 id="x1-300024r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        71        Hunk</span><span 
class="pcrr7tn-">&#x00A0;#1        mptfc_GetFcDevPage0(MPT_ADAPTER</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;ioc,</span><span 
class="pcrr7tn-">&#x00A0;in</span>
<br class="fancyvrb" /><a 
 id="x1-300026r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;85        File</span><span 
class="pcrr7tn-">&#x00A0;#4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        a/drivers/message/fusion/mptsas.c</span>
<br class="fancyvrb" /><a 
 id="x1-300028r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        87        Hunk</span><span 
class="pcrr7tn-">&#x00A0;#1        mptsas_probe_hba_phys(MPT_ADAPTER</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;ioc)</span>
<br class="fancyvrb" /><a 
 id="x1-300030r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;98        File</span><span 
class="pcrr7tn-">&#x00A0;#5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        a/drivers/net/fs_enet/fs_enet-mii.c</span>
<br class="fancyvrb" /><a 
 id="x1-300032r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        100        Hunk</span><span 
class="pcrr7tn-">&#x00A0;#1        static</span><span 
class="pcrr7tn-">&#x00A0;struct</span><span 
class="pcrr7tn-">&#x00A0;fs_enet_mii_bus</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;create_bu</span>
<br class="fancyvrb" /><a 
 id="x1-300034r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;111        File</span><span 
class="pcrr7tn-">&#x00A0;#6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        a/drivers/net/wireless/ipw2200.c</span>
<br class="fancyvrb" /><a 
 id="x1-300036r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        113        Hunk</span><span 
class="pcrr7tn-">&#x00A0;#1        static</span><span 
class="pcrr7tn-">&#x00A0;struct</span><span 
class="pcrr7tn-">&#x00A0;ipw_fw_error</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;ipw_alloc_er</span>
<br class="fancyvrb" /><a 
 id="x1-300038r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        126        Hunk</span><span 
class="pcrr7tn-">&#x00A0;#2        static</span><span 
class="pcrr7tn-">&#x00A0;ssize_t</span><span 
class="pcrr7tn-">&#x00A0;clear_error(struct</span><span 
class="pcrr7tn-">&#x00A0;device</span>
<br class="fancyvrb" /><a 
 id="x1-300040r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        140        Hunk</span><span 
class="pcrr7tn-">&#x00A0;#3        static</span><span 
class="pcrr7tn-">&#x00A0;void</span><span 
class="pcrr7tn-">&#x00A0;ipw_irq_tasklet(struct</span><span 
class="pcrr7tn-">&#x00A0;ipw_p</span>
<br class="fancyvrb" /><a 
 id="x1-300042r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        150        Hunk</span><span 
class="pcrr7tn-">&#x00A0;#4        static</span><span 
class="pcrr7tn-">&#x00A0;void</span><span 
class="pcrr7tn-">&#x00A0;ipw_pci_remove(struct</span><span 
class="pcrr7tn-">&#x00A0;pci_de</span>
<br class="fancyvrb" /><a 
 id="x1-300044r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;164        File</span><span 
class="pcrr7tn-">&#x00A0;#7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        a/drivers/scsi/libata-scsi.c</span>
<br class="fancyvrb" /><a 
 id="x1-300046r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        166        Hunk</span><span 
class="pcrr7tn-">&#x00A0;#1        int</span><span 
class="pcrr7tn-">&#x00A0;ata_cmd_ioctl(struct</span><span 
class="pcrr7tn-">&#x00A0;scsi_device</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;sc</span>
<br class="fancyvrb" /><a 
 id="x1-300048r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;178        File</span><span 
class="pcrr7tn-">&#x00A0;#8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        a/drivers/video/au1100fb.c</span>
<br class="fancyvrb" /><a 
 id="x1-300050r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;        180        Hunk</span><span 
class="pcrr7tn-">&#x00A0;#1        void</span><span 
class="pcrr7tn-">&#x00A0;__exit</span><span 
class="pcrr7tn-">&#x00A0;au1100fb_cleanup(void)</span>
   </div>
<!--l. 1009--><p class="indent">   This command prints three different kinds of number: </p>
     <ul><li><span class="dt">
     </span><span class="dd">(in the first column) a <span 
class="ptmri7t-">file number </span>to identify each file modified in the patch;
     </span><li><span class="dt">
     </span><span class="dd">(on the next line, indented) the line number within a modified file where a hunk starts; and
     </span><li><span class="dt">
     </span><span class="dd">(on the same line) a <span 
class="ptmri7t-">hunk number </span>to identify that hunk.</li></ul>
<!--l. 1018--><p class="indent">   You&#x2019;ll have to use some visual inspection, and reading of the patch, to identify the file and hunk numbers you&#x2019;ll want, but
you can then pass them to to <a 
 id="dx1-300051"></a><span 
class="pcrr7tn-">filterdiff</span>&#x2019;s <a 
 id="dx1-300052"></a><span 
class="pcrr7tn-">--files </span>and <a 
 id="dx1-300053"></a><span 
class="pcrr7tn-">--hunks </span>options, to select exactly the file and hunk you want to
extract.
</p><!--l. 1024--><p class="indent">   Once you have this hunk, you can concatenate it onto the end of your destination patch and continue with the remainder of
section&#x00A0;<a 
href="#x1-29900012.14.2">12.14.2<!--tex4ht:ref: sec:mq:combine --></a>.
</p><!--l. 1028--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">12.15    </span> <a 
 id="x1-30100012.15"></a>Differences between quilt and MQ</h3>
<!--l. 1030--><p class="noindent">If you are already familiar with quilt, MQ provides a similar command set. There are a few differences in the way that it
works.
</p><!--l. 1033--><p class="indent">   You will already have noticed that most quilt commands have MQ counterparts that simply begin with a &#x201C;<span 
class="pcrr7tn-">q</span>&#x201D;. The
exceptions are quilt&#x2019;s <span 
class="pcrr7tn-">add </span>and <span 
class="pcrr7tn-">remove </span>commands, the counterparts for which are the normal Mercurial <a 
 id="dx1-301001"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; and <a 
 id="dx1-301002"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">remove</span>&#x201D; commands. There is no MQ equivalent of the quilt <span 
class="pcrr7tn-">edit </span>command.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
</p>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;13</span><br /><a 
 id="x1-30200013"></a>Advanced uses of Mercurial Queues</h2>
<!--l. 4--><p class="noindent">While it&#x2019;s easy to pick up straightforward uses of Mercurial Queues, use of a little discipline and some of MQ&#x2019;s less frequently
used capabilities makes it possible to work in complicated development environments.
</p><!--l. 9--><p class="indent">   In this chapter, I will use as an example a technique I have used to manage the development of an Infiniband device driver
for the Linux kernel. The driver in question is large (at least as drivers go), with 25,000 lines of code spread across 35 source
files. It is maintained by a small team of developers.
</p><!--l. 15--><p class="indent">   While much of the material in this chapter is specific to Linux, the same principles apply to any code base for which you&#x2019;re
not the primary owner, and upon which you need to do a lot of development.
</p>
   <h3 class="sectionHead"><span class="titlemark">13.1    </span> <a 
 id="x1-30300013.1"></a>The problem of many targets</h3>
<!--l. 21--><p class="noindent">The Linux kernel changes rapidly, and has never been internally stable; developers frequently make drastic changes between
releases. This means that a version of the driver that works well with a particular released version of the kernel will not even
<span 
class="ptmri7t-">compile </span>correctly against, typically, any other version.
</p><!--l. 27--><p class="indent">   To maintain a driver, we have to keep a number of distinct versions of Linux in mind. </p>
     <ul><li><span class="dt">
     </span><span class="dd">One target is the main Linux kernel development tree. Maintenance of the code is in this case partly shared by
     other developers in the kernel community, who make &#x201C;drive-by&#x201D; modifications to the driver as they develop and
     refine kernel subsystems.
     </span><li><span class="dt">
     </span><span class="dd">We  also  maintain  a  number  of  &#x201C;backports&#x201D;  to  older  versions  of  the  Linux  kernel,  to  support  the  needs  of
     customers who are running older Linux distributions that do not incorporate our drivers. (To <span 
class="ptmri7t-">backport </span>a piece of
     code is to modify it to work in an older version of its target environment than the version it was developed for.)
     </span><li><span class="dt">
     </span><span class="dd">Finally,  we  make  software  releases  on  a  schedule  that  is  necessarily  not  aligned  with  those  used  by  Linux
     distributors and kernel developers, so that we can deliver new features to customers without forcing them to
     upgrade their entire kernels or distributions.</li></ul>
<!--l. 48--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">13.1.1    </span> <a 
 id="x1-30400013.1.1"></a>Tempting approaches that don&#x2019;t work well</h4>
<!--l. 50--><p class="noindent">There are two &#x201C;standard&#x201D; ways to maintain a piece of software that has to target many different environments.
</p><!--l. 53--><p class="indent">   The first is to maintain a number of branches, each intended for a single target. The trouble with this approach is that you
must maintain iron discipline in the flow of changes between repositories. A new feature or bug fix must start life in a &#x201C;pristine&#x201D;
repository, then percolate out to every backport repository. Backport changes are more limited in the branches they should
propagate to; a backport change that is applied to a branch where it doesn&#x2019;t belong will probably stop the driver from
compiling.
</p><!--l. 62--><p class="indent">   The second is to maintain a single source tree filled with conditional statements that turn chunks of code on or off
depending on the intended target. Because these &#x201C;ifdefs&#x201D; are not allowed in the Linux kernel tree, a manual or automatic
process must be followed to strip them out and yield a clean tree. A code base maintained in this fashion rapidly becomes a rat&#x2019;s
nest of conditional blocks that are difficult to understand and maintain.
</p><!--l. 70--><p class="indent">   Neither of these approaches is well suited to a situation where you don&#x2019;t &#x201C;own&#x201D; the canonical copy of a
source tree. In the case of a Linux driver that is distributed with the standard kernel, Linus&#x2019;s tree contains the
copy of the code that will be treated by the world as canonical. The upstream version of &#x201C;my&#x201D; driver can be
modified by people I don&#x2019;t know, without me even finding out about it until after the changes show up in Linus&#x2019;s
tree.
                                                                                         
                                                                                         
</p><!--l. 78--><p class="indent">   These approaches have the added weakness of making it difficult to generate well-formed patches to submit
upstream.
</p><!--l. 81--><p class="indent">   In principle, Mercurial Queues seems like a good candidate to manage a development scenario such as the above. While
this is indeed the case, MQ contains a few added features that make the job more pleasant.
</p><!--l. 87--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">13.2    </span> <a 
 id="x1-30500013.2"></a>Conditionally applying patches with guards</h3>
<!--l. 89--><p class="noindent">Perhaps the best way to maintain sanity with so many targets is to be able to choose specific patches to apply for a given
situation. MQ provides a feature called &#x201C;guards&#x201D; (which originates with quilt&#x2019;s <span 
class="pcrr7tn-">guards </span>command) that does just this. To start
off, let&#x2019;s create a simple repository for experimenting in.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-305002r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qinit</span>
<br class="fancyvrb" /><a 
 id="x1-305004r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qnew</span><span 
class="pcrb7t-">&#x00A0;hello.patch</span>
<br class="fancyvrb" /><a 
 id="x1-305006r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;hello</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;hello</span>
<br class="fancyvrb" /><a 
 id="x1-305008r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;hello</span>
<br class="fancyvrb" /><a 
 id="x1-305010r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qrefresh</span>
<br class="fancyvrb" /><a 
 id="x1-305012r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qnew</span><span 
class="pcrb7t-">&#x00A0;goodbye.patch</span>
<br class="fancyvrb" /><a 
 id="x1-305014r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;goodbye</span><span 
class="pcrb7t-">&#x00A0;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;goodbye</span>
<br class="fancyvrb" /><a 
 id="x1-305016r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;add</span><span 
class="pcrb7t-">&#x00A0;goodbye</span>
<br class="fancyvrb" /><a 
 id="x1-305018r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qrefresh</span>
   </div>
<!--l. 95--><p class="noindent">This gives us a tiny repository that contains two patches that don&#x2019;t have any dependencies on each other, because they touch
different files.
</p><!--l. 98--><p class="indent">   The idea behind conditional application is that you can &#x201C;tag&#x201D; a patch with a <span 
class="ptmri7t-">guard</span>, which is simply a text string of your
choosing, then tell MQ to select specific guards to use when applying patches. MQ will then either apply, or skip over, a
guarded patch, depending on the guards that you have selected.
</p><!--l. 104--><p class="indent">   A patch can have an arbitrary number of guards; each one is <span 
class="ptmri7t-">positive </span>(&#x201C;apply this patch if this guard is selected&#x201D;) or <span 
class="ptmri7t-">negative</span>
(&#x201C;skip this patch if this guard is selected&#x201D;). A patch with no guards is always applied.
</p><!--l. 109--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">13.3    </span> <a 
 id="x1-30600013.3"></a>Controlling the guards on a patch</h3>
<!--l. 111--><p class="noindent">The <a 
 id="dx1-306001"></a><a 
 id="dx1-306002"></a>&#x201C;<span 
class="pcrr7tn-">hg qguard</span>&#x201D; command lets you determine which guards should apply to a patch, or display the guards that are already in
effect. Without any arguments, it displays the guards on the current topmost patch.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-306004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qguard</span>
<br class="fancyvrb" /><a 
 id="x1-306006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;goodbye.patch:</span><span 
class="pcrr7tn-">&#x00A0;unguarded</span>
   </div>
<!--l. 116--><p class="noindent">To set a positive guard on a patch, prefix the name of the guard with a &#x201C;<span 
class="pcrr7tn-">+</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
                                                                                         
                                                                                         
<a 
 id="x1-306008r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qguard</span><span 
class="pcrb7t-">&#x00A0;+foo</span>
<br class="fancyvrb" /><a 
 id="x1-306010r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qguard</span>
<br class="fancyvrb" /><a 
 id="x1-306012r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;goodbye.patch:</span><span 
class="pcrr7tn-">&#x00A0;+foo</span>
   </div>
<!--l. 119--><p class="noindent">To set a negative guard on a patch, prefix the name of the guard with a &#x201C;<span 
class="pcrr7tn-">-</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-306014r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qguard</span><span 
class="pcrb7t-">&#x00A0;hello.patch</span><span 
class="pcrb7t-">&#x00A0;-quux</span>
<br class="fancyvrb" /><a 
 id="x1-306016r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qguard</span><span 
class="pcrb7t-">&#x00A0;hello.patch</span>
<br class="fancyvrb" /><a 
 id="x1-306018r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hello.patch:</span><span 
class="pcrr7tn-">&#x00A0;-quux</span>
   </div>
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:   </span>The &#x201C;<span 
class="pcrr7tn-">hg qguard</span>&#x201D; command <span 
class="ptmri7t-">sets </span>the guards on a patch; it doesn&#x2019;t <span 
class="ptmri7t-">modify</span>
them. What this means is that if you run &#x201C;<span 
class="pcrr7tn-">hg qguard +a +b</span>&#x201D; on a patch, then &#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">qguard +c</span>&#x201D; on the same patch, the <span 
class="ptmri7t-">only </span>guard that will be set on it afterwards is
<span 
class="pcrr7tn-">+c</span>.                                                                                                                              </div>
<!--l. 131--><p class="indent">   Mercurial stores guards in the <a 
 id="dx1-306023"></a><span 
class="pcrr7tn-">series </span>file; the form in which they are stored is easy both to understand and to edit by hand.
(In other words, you don&#x2019;t have to use the <a 
 id="dx1-306024"></a><a 
 id="dx1-306025"></a>&#x201C;<span 
class="pcrr7tn-">hg qguard</span>&#x201D; command if you don&#x2019;t want to; it&#x2019;s okay to simply edit the <a 
 id="dx1-306026"></a><span 
class="pcrr7tn-">series</span>
file.)
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-306028r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;.hg/patches/series</span>
<br class="fancyvrb" /><a 
 id="x1-306030r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hello.patch</span><span 
class="pcrr7tn-">&#x00A0;#-quux</span>
<br class="fancyvrb" /><a 
 id="x1-306032r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;goodbye.patch</span><span 
class="pcrr7tn-">&#x00A0;#+foo</span>
   </div>
<!--l. 138--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">13.4    </span> <a 
 id="x1-30700013.4"></a>Selecting the guards to use</h3>
<!--l. 140--><p class="noindent">The <a 
 id="dx1-307001"></a><a 
 id="dx1-307002"></a>&#x201C;<span 
class="pcrr7tn-">hg qselect</span>&#x201D; command determines which guards are active at a given time. The effect of this is to determine which
patches MQ will apply the next time you run <a 
 id="dx1-307003"></a><a 
 id="dx1-307004"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D;. It has no other effect; in particular, it doesn&#x2019;t do anything to patches
that are already applied.
</p><!--l. 146--><p class="indent">   With no arguments, the <a 
 id="dx1-307005"></a><a 
 id="dx1-307006"></a>&#x201C;<span 
class="pcrr7tn-">hg qselect</span>&#x201D; command lists the guards currently in effect, one per line of output. Each argument
is treated as the name of a guard to apply.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-307008r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qpop</span><span 
class="pcrb7t-">&#x00A0;-a</span>
<br class="fancyvrb" /><a 
 id="x1-307010r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Patch</span><span 
class="pcrr7tn-">&#x00A0;queue</span><span 
class="pcrr7tn-">&#x00A0;now</span><span 
class="pcrr7tn-">&#x00A0;empty</span>
<br class="fancyvrb" /><a 
 id="x1-307012r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qselect</span>
<br class="fancyvrb" /><a 
 id="x1-307014r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;no</span><span 
class="pcrr7tn-">&#x00A0;active</span><span 
class="pcrr7tn-">&#x00A0;guards</span>
<br class="fancyvrb" /><a 
 id="x1-307016r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qselect</span><span 
class="pcrb7t-">&#x00A0;foo</span>
<br class="fancyvrb" /><a 
 id="x1-307018r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;number</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;unguarded,</span><span 
class="pcrr7tn-">&#x00A0;unapplied</span><span 
class="pcrr7tn-">&#x00A0;patches</span><span 
class="pcrr7tn-">&#x00A0;has</span><span 
class="pcrr7tn-">&#x00A0;changed</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-307020r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qselect</span>
<br class="fancyvrb" /><a 
 id="x1-307022r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;foo</span>
   </div>
<!--l. 150--><p class="noindent">In case you&#x2019;re interested, the currently selected guards are stored in the <a 
 id="dx1-307023"></a><span 
class="pcrr7tn-">guards </span>file.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-307025r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">cat</span><span 
class="pcrb7t-">&#x00A0;.hg/patches/guards</span>
<br class="fancyvrb" /><a 
 id="x1-307027r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;foo</span>
   </div>
<!--l. 153--><p class="noindent">We can see the effect the selected guards have when we run <a 
 id="dx1-307028"></a><a 
 id="dx1-307029"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D;.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-307031r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qpush</span><span 
class="pcrb7t-">&#x00A0;-a</span>
<br class="fancyvrb" /><a 
 id="x1-307033r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;applying</span><span 
class="pcrr7tn-">&#x00A0;hello.patch</span>
<br class="fancyvrb" /><a 
 id="x1-307035r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;applying</span><span 
class="pcrr7tn-">&#x00A0;goodbye.patch</span>
<br class="fancyvrb" /><a 
 id="x1-307037r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Now</span><span 
class="pcrr7tn-">&#x00A0;at:</span><span 
class="pcrr7tn-">&#x00A0;goodbye.patch</span>
   </div>
<!--l. 157--><p class="indent">   A guard cannot start with a &#x201C;<span 
class="pcrr7tn-">+</span>&#x201D; or &#x201C;<span 
class="pcrr7tn-">-</span>&#x201D; character. The name of a guard must not contain white space, but most othter
characters are acceptable. If you try to use a guard with an invalid name, MQ will complain:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-307039r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qselect</span><span 
class="pcrb7t-">&#x00A0;+foo</span>
<br class="fancyvrb" /><a 
 id="x1-307041r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;guard</span><span 
class="pcrr7tn-">&#x00A0;'+foo'</span><span 
class="pcrr7tn-">&#x00A0;starts</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;invalid</span><span 
class="pcrr7tn-">&#x00A0;character:</span><span 
class="pcrr7tn-">&#x00A0;'+'</span>
   </div>
<!--l. 162--><p class="noindent">Changing the selected guards changes the patches that are applied.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-307043r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qselect</span><span 
class="pcrb7t-">&#x00A0;quux</span>
<br class="fancyvrb" /><a 
 id="x1-307045r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;number</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;guarded,</span><span 
class="pcrr7tn-">&#x00A0;applied</span><span 
class="pcrr7tn-">&#x00A0;patches</span><span 
class="pcrr7tn-">&#x00A0;has</span><span 
class="pcrr7tn-">&#x00A0;changed</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-307047r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qpop</span><span 
class="pcrb7t-">&#x00A0;-a</span>
<br class="fancyvrb" /><a 
 id="x1-307049r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Patch</span><span 
class="pcrr7tn-">&#x00A0;queue</span><span 
class="pcrr7tn-">&#x00A0;now</span><span 
class="pcrr7tn-">&#x00A0;empty</span>
<br class="fancyvrb" /><a 
 id="x1-307051r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qpush</span><span 
class="pcrb7t-">&#x00A0;-a</span>
<br class="fancyvrb" /><a 
 id="x1-307053r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;patch</span><span 
class="pcrr7tn-">&#x00A0;series</span><span 
class="pcrr7tn-">&#x00A0;fully</span><span 
class="pcrr7tn-">&#x00A0;applied</span>
   </div>
<!--l. 164--><p class="noindent">You can see in the example below that negative guards take precedence over positive guards.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-307055r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qselect</span><span 
class="pcrb7t-">&#x00A0;foo</span><span 
class="pcrb7t-">&#x00A0;bar</span>
<br class="fancyvrb" /><a 
 id="x1-307057r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;number</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;unguarded,</span><span 
class="pcrr7tn-">&#x00A0;unapplied</span><span 
class="pcrr7tn-">&#x00A0;patches</span><span 
class="pcrr7tn-">&#x00A0;has</span><span 
class="pcrr7tn-">&#x00A0;changed</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;0</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;2</span>
<br class="fancyvrb" /><a 
 id="x1-307059r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qpop</span><span 
class="pcrb7t-">&#x00A0;-a</span>
<br class="fancyvrb" /><a 
 id="x1-307061r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;abort:</span><span 
class="pcrr7tn-">&#x00A0;no</span><span 
class="pcrr7tn-">&#x00A0;patches</span><span 
class="pcrr7tn-">&#x00A0;applied</span>
<br class="fancyvrb" /><a 
 id="x1-307063r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;qpush</span><span 
class="pcrb7t-">&#x00A0;-a</span>
<br class="fancyvrb" /><a 
 id="x1-307065r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;applying</span><span 
class="pcrr7tn-">&#x00A0;hello.patch</span>
<br class="fancyvrb" /><a 
 id="x1-307067r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;applying</span><span 
class="pcrr7tn-">&#x00A0;goodbye.patch</span>
<br class="fancyvrb" /><a 
 id="x1-307069r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;Now</span><span 
class="pcrr7tn-">&#x00A0;at:</span><span 
class="pcrr7tn-">&#x00A0;goodbye.patch</span>
   </div>
                                                                                         
                                                                                         
<!--l. 168--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">13.5    </span> <a 
 id="x1-30800013.5"></a>MQ&#x2019;s rules for applying patches</h3>
<!--l. 170--><p class="noindent">The rules that MQ uses when deciding whether to apply a patch are as follows. </p>
     <ul><li><span class="dt">
     </span><span class="dd">A patch that has no guards is always applied.
     </span><li><span class="dt">
     </span><span class="dd">If the patch has any negative guard that matches any currently selected guard, the patch is skipped.
     </span><li><span class="dt">
     </span><span class="dd">If the patch has any positive guard that matches any currently selected guard, the patch is applied.
     </span><li><span class="dt">
     </span><span class="dd">If the patch has positive or negative guards, but none matches any currently selected guard, the patch is skipped.</li></ul>
<!--l. 182--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">13.6    </span> <a 
 id="x1-30900013.6"></a>Trimming the work environment</h3>
<!--l. 184--><p class="noindent">In working on the device driver I mentioned earlier, I don&#x2019;t apply the patches to a normal Linux kernel tree. Instead, I use a
repository that contains only a snapshot of the source files and headers that are relevant to Infiniband development. This
repository is&#x00A0;1% the size of a kernel repository, so it&#x2019;s easier to work with.
</p><!--l. 190--><p class="indent">   I then choose a &#x201C;base&#x201D; version on top of which the patches are applied. This is a snapshot of the Linux kernel tree as of a
revision of my choosing. When I take the snapshot, I record the changeset ID from the kernel repository in the commit
message. Since the snapshot preserves the &#x201C;shape&#x201D; and content of the relevant parts of the kernel tree, I can apply my patches
on top of either my tiny repository or a normal kernel tree.
</p><!--l. 198--><p class="indent">   Normally, the base tree atop which the patches apply should be a snapshot of a very recent upstream tree. This best
facilitates the development of patches that can easily be submitted upstream with few or no modifications.
</p><!--l. 203--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">13.7    </span> <a 
 id="x1-31000013.7"></a>Dividing up the <span 
class="pcrr7tn-">series </span>file</h3>
<!--l. 205--><p class="noindent">I categorise the patches in the <a 
 id="dx1-310001"></a><span 
class="pcrr7tn-">series </span>file into a number of logical groups. Each section of like patches begins with a block of
comments that describes the purpose of the patches that follow.
</p><!--l. 209--><p class="indent">   The sequence of patch groups that I maintain follows. The ordering of these groups is important; I&#x2019;ll describe why after I
introduce the groups. </p>
     <ul><li><span class="dt">
     </span><span class="dd">The &#x201C;accepted&#x201D; group. Patches that the development team has submitted to the maintainer of the Infiniband
     subsystem, and which he has accepted, but which are not present in the snapshot that the tiny repository is based
     on. These are &#x201C;read only&#x201D; patches, present only to transform the tree into a similar state as it is in the upstream
     maintainer&#x2019;s repository.
     </span><li><span class="dt">
     </span><span class="dd">The &#x201C;rework&#x201D; group. Patches that I have submitted, but that the upstream maintainer has requested modifications
     to before he will accept them.
                                                                                         
                                                                                         
     </span><li><span class="dt">
     </span><span class="dd">The &#x201C;pending&#x201D; group. Patches that I have not yet submitted to the upstream maintainer, but which we have
     finished  working  on.  These  will  be  &#x201C;read  only&#x201D;  for  a  while.  If  the  upstream  maintainer  accepts  them  upon
     submission, I&#x2019;ll move them to the end of the &#x201C;accepted&#x201D; group. If he requests that I modify any, I&#x2019;ll move them
     to the beginning of the &#x201C;rework&#x201D; group.
     </span><li><span class="dt">
     </span><span class="dd">The &#x201C;in progress&#x201D; group. Patches that are actively being developed, and should not be submitted anywhere yet.
     </span><li><span class="dt">
     </span><span class="dd">The &#x201C;backport&#x201D; group. Patches that adapt the source tree to older versions of the kernel tree.
     </span><li><span class="dt">
     </span><span class="dd">The &#x201C;do not ship&#x201D; group. Patches that for some reason should never be submitted upstream. For example, one
     such patch might change embedded driver identification strings to make it easier to distinguish, in the field,
     between an out-of-tree version of the driver and a version shipped by a distribution vendor.</li></ul>
<!--l. 239--><p class="indent">   Now to return to the reasons for ordering groups of patches in this way. We would like the lowest patches in the stack to be
as stable as possible, so that we will not need to rework higher patches due to changes in context. Putting patches that will never
be changed first in the <a 
 id="dx1-310002"></a><span 
class="pcrr7tn-">series </span>file serves this purpose.
</p><!--l. 245--><p class="indent">   We would also like the patches that we know we&#x2019;ll need to modify to be applied on top of a source tree
that resembles the upstream tree as closely as possible. This is why we keep accepted patches around for a
while.
</p><!--l. 250--><p class="indent">   The &#x201C;backport&#x201D; and &#x201C;do not ship&#x201D; patches float at the end of the <a 
 id="dx1-310003"></a><span 
class="pcrr7tn-">series </span>file. The backport patches must be applied on top
of all other patches, and the &#x201C;do not ship&#x201D; patches might as well stay out of harm&#x2019;s way.
</p><!--l. 255--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">13.8    </span> <a 
 id="x1-31100013.8"></a>Maintaining the patch series</h3>
<!--l. 257--><p class="noindent">In my work, I use a number of guards to control which patches are to be applied.
</p>
     <ul><li><span class="dt">
     </span><span class="dd">&#x201C;Accepted&#x201D; patches are guarded with <span 
class="pcrr7tn-">accepted</span>. I enable this guard most of the time. When I&#x2019;m applying the
     patches on top of a tree where the patches are already present, I can turn this patch off, and the patches that
     follow it will apply cleanly.
     </span><li><span class="dt">
     </span><span class="dd">Patches that are &#x201C;finished&#x201D;, but not yet submitted, have no guards. If I&#x2019;m applying the patch stack to a copy of
     the upstream tree, I don&#x2019;t need to enable any guards in order to get a reasonably safe source tree.
     </span><li><span class="dt">
     </span><span class="dd">Those patches that need reworking before being resubmitted are guarded with <span 
class="pcrr7tn-">rework</span>.
     </span><li><span class="dt">
     </span><span class="dd">For those patches that are still under development, I use <span 
class="pcrr7tn-">devel</span>.
     </span><li><span class="dt">
     </span><span class="dd">A backport patch may have several guards, one for each version of the kernel to which it applies. For example,
     a patch that backports a piece of code to&#x00A0;2.6.9 will have a&#x00A0;<span 
class="pcrr7tn-">2.6.9 </span>guard.</li></ul>
<!--l. 277--><p class="noindent">This variety of guards gives me considerable flexibility in qdetermining what kind of source tree I want to end up with. For most
situations, the selection of appropriate guards is automated during the build process, but I can manually tune the guards to use
for less common circumstances.
                                                                                         
                                                                                         
</p><!--l. 283--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">13.8.1    </span> <a 
 id="x1-31200013.8.1"></a>The art of writing backport patches</h4>
<!--l. 285--><p class="noindent">Using MQ, writing a backport patch is a simple process. All such a patch has to do is modify a piece of code that uses a kernel
feature not present in the older version of the kernel, so that the driver continues to work correctly under that older
version.
</p><!--l. 290--><p class="indent">   A useful goal when writing a good backport patch is to make your code look as if it was written for the older version of the
kernel you&#x2019;re targeting. The less obtrusive the patch, the easier it will be to understand and maintain. If you&#x2019;re
writing a collection of backport patches to avoid the &#x201C;rat&#x2019;s nest&#x201D; effect of lots of <span 
class="pcrr7tn-">#ifdef</span>s (hunks of source code
that are only used conditionally) in your code, don&#x2019;t introduce version-dependent <span 
class="pcrr7tn-">#ifdef</span>s into the patches.
Instead, write several patches, each of which makes unconditional changes, and control their application using
guards.
</p><!--l. 301--><p class="indent">   There are two reasons to divide backport patches into a distinct group, away from the &#x201C;regular&#x201D; patches whose effects they
modify. The first is that intermingling the two makes it more difficult to use a tool like the <a 
 id="dx1-312001"></a><span 
class="pcrr7tn-">patchbomb </span>extension to automate the
process of submitting the patches to an upstream maintainer. The second is that a backport patch could perturb the context in
which a subsequent regular patch is applied, making it impossible to apply the regular patch cleanly <span 
class="ptmri7t-">without </span>the earlier backport
patch already being applied.
</p><!--l. 311--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">13.9    </span> <a 
 id="x1-31300013.9"></a>Useful tips for developing with MQ</h3>
<!--l. 313--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">13.9.1    </span> <a 
 id="x1-31400013.9.1"></a>Organising patches in directories</h4>
<!--l. 315--><p class="noindent">If you&#x2019;re working on a substantial project with MQ, it&#x2019;s not difficult to accumulate a large number of patches. For example, I
have one patch repository that contains over 250 patches.
</p><!--l. 319--><p class="indent">   If you can group these patches into separate logical categories, you can if you like store them in different directories; MQ
has no problems with patch names that contain path separators.
</p><!--l. 323--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">13.9.2    </span> <a 
 id="x1-31500013.9.2"></a>Viewing the history of a patch</h4>
<!--l. 326--><p class="noindent">If you&#x2019;re developing a set of patches over a long time, it&#x2019;s a good idea to maintain them in a repository, as discussed in
section&#x00A0;<a 
href="#x1-29200012.11">12.11<!--tex4ht:ref: sec:mq:repo --></a>. If you do so, you&#x2019;ll quickly discover that using the <a 
 id="dx1-315001"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; command to look at the history of changes to a
patch is unworkable. This is in part because you&#x2019;re looking at the second derivative of the real code (a diff of a diff), but
also because MQ adds noise to the process by modifying time stamps and directory names when it updates a
patch.
</p><!--l. 335--><p class="indent">   However, you can use the <a 
 id="dx1-315002"></a><span 
class="pcrr7tn-">extdiff </span>extension, which is bundled with Mercurial, to turn a diff of two versions of a patch into
something readable. To do this, you will need a third-party package called <a 
 id="dx1-315003"></a><span 
class="pcrr7tn-">patchutils</span>&#x00A0;<span class="cite">[<span 
class="ptmb7t-">?</span>]</span>. This provides a command named
<a 
 id="dx1-315004"></a><span 
class="pcrr7tn-">interdiff</span>, which shows the differences between two diffs as a diff. Used on two versions of the same diff, it generates a diff
that represents the diff from the first to the second version.
</p><!--l. 344--><p class="indent">   You can enable the <a 
 id="dx1-315005"></a><span 
class="pcrr7tn-">extdiff </span>extension in the usual way, by adding a line to the <a 
 id="dx1-315006"></a><span 
class="pcrr7tn-">[extensions] </span>section of your
<a 
 id="dx1-315007"></a><a 
 id="dx1-315008"></a><span 
class="pcrr7tn-">hgrc</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
                                                                                         
                                                                                         
<a 
 id="x1-315010r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[extensions]</span>
<br class="fancyvrb" /><a 
 id="x1-315012r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;extdiff</span><span 
class="pcrr7tn-">&#x00A0;=</span>
   </div>
<!--l. 350--><p class="noindent">The <a 
 id="dx1-315013"></a><span 
class="pcrr7tn-">interdiff </span>command expects to be passed the names of two files, but the <a 
 id="dx1-315014"></a><span 
class="pcrr7tn-">extdiff </span>extension passes the program it runs a pair
of directories, each of which can contain an arbitrary number of files. We thus need a small program that will run <a 
 id="dx1-315015"></a><span 
class="pcrr7tn-">interdiff</span>
on each pair of files in these two directories. This program is available as <a 
 id="dx1-315016"></a><span 
class="pcrr7tn-">hg-interdiff </span>in the <span 
class="pcrr7tn-">examples </span>directory of the
source code repository that accompanies this book.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-315018r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#!/usr/bin/env</span><span 
class="pcrr7tn-">&#x00A0;python</span>
<br class="fancyvrb" /><a 
 id="x1-315020r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span>
<br class="fancyvrb" /><a 
 id="x1-315022r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;Adapter</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;using</span><span 
class="pcrr7tn-">&#x00A0;interdiff</span><span 
class="pcrr7tn-">&#x00A0;with</span><span 
class="pcrr7tn-">&#x00A0;mercurial's</span><span 
class="pcrr7tn-">&#x00A0;extdiff</span><span 
class="pcrr7tn-">&#x00A0;extension.</span>
<br class="fancyvrb" /><a 
 id="x1-315024r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span>
<br class="fancyvrb" /><a 
 id="x1-315026r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;Copyright</span><span 
class="pcrr7tn-">&#x00A0;2006</span><span 
class="pcrr7tn-">&#x00A0;Bryan</span><span 
class="pcrr7tn-">&#x00A0;O'Sullivan</span><span 
class="pcrr7tn-">&#x00A0;&#x003c;bos@serpentine.com&#x003e;</span>
<br class="fancyvrb" /><a 
 id="x1-315028r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span>
<br class="fancyvrb" /><a 
 id="x1-315030r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;This</span><span 
class="pcrr7tn-">&#x00A0;software</span><span 
class="pcrr7tn-">&#x00A0;may</span><span 
class="pcrr7tn-">&#x00A0;be</span><span 
class="pcrr7tn-">&#x00A0;used</span><span 
class="pcrr7tn-">&#x00A0;and</span><span 
class="pcrr7tn-">&#x00A0;distributed</span><span 
class="pcrr7tn-">&#x00A0;according</span><span 
class="pcrr7tn-">&#x00A0;to</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;terms</span><span 
class="pcrr7tn-">&#x00A0;of</span>
<br class="fancyvrb" /><a 
 id="x1-315032r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;GNU</span><span 
class="pcrr7tn-">&#x00A0;General</span><span 
class="pcrr7tn-">&#x00A0;Public</span><span 
class="pcrr7tn-">&#x00A0;License,</span><span 
class="pcrr7tn-">&#x00A0;incorporated</span><span 
class="pcrr7tn-">&#x00A0;herein</span><span 
class="pcrr7tn-">&#x00A0;by</span><span 
class="pcrr7tn-">&#x00A0;reference.</span>
<br class="fancyvrb" /><a 
 id="x1-315034r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-315036r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;import</span><span 
class="pcrr7tn-">&#x00A0;os,</span><span 
class="pcrr7tn-">&#x00A0;sys</span>
<br class="fancyvrb" /><a 
 id="x1-315038r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-315040r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;def</span><span 
class="pcrr7tn-">&#x00A0;walk(base):</span>
<br class="fancyvrb" /><a 
 id="x1-315042r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;yield</span><span 
class="pcrr7tn-">&#x00A0;all</span><span 
class="pcrr7tn-">&#x00A0;non-directories</span><span 
class="pcrr7tn-">&#x00A0;below</span><span 
class="pcrr7tn-">&#x00A0;the</span><span 
class="pcrr7tn-">&#x00A0;base</span><span 
class="pcrr7tn-">&#x00A0;path.</span>
<br class="fancyvrb" /><a 
 id="x1-315044r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;root,</span><span 
class="pcrr7tn-">&#x00A0;dirs,</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;os.walk(base):</span>
<br class="fancyvrb" /><a 
 id="x1-315046r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;f</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;files:</span>
<br class="fancyvrb" /><a 
 id="x1-315048r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;path</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;os.path.join(root,</span><span 
class="pcrr7tn-">&#x00A0;f)</span>
<br class="fancyvrb" /><a 
 id="x1-315050r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;yield</span><span 
class="pcrr7tn-">&#x00A0;path[len(base)+1:],</span><span 
class="pcrr7tn-">&#x00A0;path</span>
<br class="fancyvrb" /><a 
 id="x1-315052r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;else:</span>
<br class="fancyvrb" /><a 
 id="x1-315054r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;if</span><span 
class="pcrr7tn-">&#x00A0;os.path.isfile(base):</span>
<br class="fancyvrb" /><a 
 id="x1-315056r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;yield</span><span 
class="pcrr7tn-">&#x00A0;'',</span><span 
class="pcrr7tn-">&#x00A0;base</span>
<br class="fancyvrb" /><a 
 id="x1-315058r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-315060r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;create</span><span 
class="pcrr7tn-">&#x00A0;list</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;unique</span><span 
class="pcrr7tn-">&#x00A0;file</span><span 
class="pcrr7tn-">&#x00A0;names</span><span 
class="pcrr7tn-">&#x00A0;under</span><span 
class="pcrr7tn-">&#x00A0;both</span><span 
class="pcrr7tn-">&#x00A0;directories.</span>
<br class="fancyvrb" /><a 
 id="x1-315062r23"></a><span 
class="ptmr7t-x-x-50">23</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;dict(walk(sys.argv[1]))</span>
<br class="fancyvrb" /><a 
 id="x1-315064r24"></a><span 
class="ptmr7t-x-x-50">24</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;files.update(walk(sys.argv[2]))</span>
<br class="fancyvrb" /><a 
 id="x1-315066r25"></a><span 
class="ptmr7t-x-x-50">25</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;files.keys()</span>
<br class="fancyvrb" /><a 
 id="x1-315068r26"></a><span 
class="ptmr7t-x-x-50">26</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;files.sort()</span>
<br class="fancyvrb" /><a 
 id="x1-315070r27"></a><span 
class="ptmr7t-x-x-50">27</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-315072r28"></a><span 
class="ptmr7t-x-x-50">28</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;def</span><span 
class="pcrr7tn-">&#x00A0;name(base,</span><span 
class="pcrr7tn-">&#x00A0;f):</span>
<br class="fancyvrb" /><a 
 id="x1-315074r29"></a><span 
class="ptmr7t-x-x-50">29</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;if</span><span 
class="pcrr7tn-">&#x00A0;f:</span>
<br class="fancyvrb" /><a 
 id="x1-315076r30"></a><span 
class="ptmr7t-x-x-50">30</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;path</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;os.path.join(base,</span><span 
class="pcrr7tn-">&#x00A0;f)</span>
<br class="fancyvrb" /><a 
 id="x1-315078r31"></a><span 
class="ptmr7t-x-x-50">31</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;else:</span>
<br class="fancyvrb" /><a 
 id="x1-315080r32"></a><span 
class="ptmr7t-x-x-50">32</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;path</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;base</span>
<br class="fancyvrb" /><a 
 id="x1-315082r33"></a><span 
class="ptmr7t-x-x-50">33</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;#</span><span 
class="pcrr7tn-">&#x00A0;interdiff</span><span 
class="pcrr7tn-">&#x00A0;requires</span><span 
class="pcrr7tn-">&#x00A0;two</span><span 
class="pcrr7tn-">&#x00A0;files;</span><span 
class="pcrr7tn-">&#x00A0;use</span><span 
class="pcrr7tn-">&#x00A0;/dev/null</span><span 
class="pcrr7tn-">&#x00A0;if</span><span 
class="pcrr7tn-">&#x00A0;one</span><span 
class="pcrr7tn-">&#x00A0;is</span><span 
class="pcrr7tn-">&#x00A0;missing.</span>
<br class="fancyvrb" /><a 
 id="x1-315084r34"></a><span 
class="ptmr7t-x-x-50">34</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;if</span><span 
class="pcrr7tn-">&#x00A0;os.path.exists(path):</span>
<br class="fancyvrb" /><a 
 id="x1-315086r35"></a><span 
class="ptmr7t-x-x-50">35</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;return</span><span 
class="pcrr7tn-">&#x00A0;path</span>
<br class="fancyvrb" /><a 
 id="x1-315088r36"></a><span 
class="ptmr7t-x-x-50">36</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;return</span><span 
class="pcrr7tn-">&#x00A0;'/dev/null'</span>
<br class="fancyvrb" /><a 
 id="x1-315090r37"></a><span 
class="ptmr7t-x-x-50">37</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-315092r38"></a><span 
class="ptmr7t-x-x-50">38</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;ret</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x1-315094r39"></a><span 
class="ptmr7t-x-x-50">39</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-315096r40"></a><span 
class="ptmr7t-x-x-50">40</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;for</span><span 
class="pcrr7tn-">&#x00A0;f</span><span 
class="pcrr7tn-">&#x00A0;in</span><span 
class="pcrr7tn-">&#x00A0;files:</span>
<br class="fancyvrb" /><a 
 id="x1-315098r41"></a><span 
class="ptmr7t-x-x-50">41</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;if</span><span 
class="pcrr7tn-">&#x00A0;os.system('interdiff</span><span 
class="pcrr7tn-">&#x00A0;"%s"</span><span 
class="pcrr7tn-">&#x00A0;"%s"'</span><span 
class="pcrr7tn-">&#x00A0;%</span><span 
class="pcrr7tn-">&#x00A0;(name(sys.argv[1],</span><span 
class="pcrr7tn-">&#x00A0;f),</span>
<br class="fancyvrb" /><a 
 id="x1-315100r42"></a><span 
class="ptmr7t-x-x-50">42</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;name(sys.argv[2],</span><span 
class="pcrr7tn-">&#x00A0;f))):</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-315102r43"></a><span 
class="ptmr7t-x-x-50">43</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;ret</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x1-315104r44"></a><span 
class="ptmr7t-x-x-50">44</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span>
<br class="fancyvrb" /><a 
 id="x1-315106r45"></a><span 
class="ptmr7t-x-x-50">45</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;sys.exit(ret)</span>
   </div>
<!--l. 359--><p class="indent">   With the <a 
 id="dx1-315107"></a><span 
class="pcrr7tn-">hg-interdiff </span>program in your shell&#x2019;s search path, you can run it as follows, from inside an MQ patch
directory:
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-315109r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;extdiff</span><span 
class="pcrr7tn-">&#x00A0;-p</span><span 
class="pcrr7tn-">&#x00A0;hg-interdiff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;A:B</span><span 
class="pcrr7tn-">&#x00A0;my-change.patch</span>
   </div>
<!--l. 364--><p class="noindent">Since you&#x2019;ll probably want to use this long-winded command a lot, you can get <a 
 id="dx1-315110"></a><span 
class="pcrr7tn-">hgext </span>to make it available as a normal Mercurial
command, again by editing your <a 
 id="dx1-315111"></a><a 
 id="dx1-315112"></a><span 
class="pcrr7tn-">hgrc</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-315114r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[extdiff]</span>
<br class="fancyvrb" /><a 
 id="x1-315116r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cmd.interdiff</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;hg-interdiff</span>
   </div>
<!--l. 371--><p class="noindent">This directs <a 
 id="dx1-315117"></a><span 
class="pcrr7tn-">hgext </span>to make an <span 
class="pcrr7tn-">interdiff </span>command available, so you can now shorten the previous invocation of <a 
 id="dx1-315118"></a><a 
 id="dx1-315119"></a>&#x201C;<span 
class="pcrr7tn-">hg extdiff</span>&#x201D;
to something a little more wieldy.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-315121r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;interdiff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;A:B</span><span 
class="pcrr7tn-">&#x00A0;my-change.patch</span>
   </div>
</p>
   <div class="fbox"><span 
class="ptmb7t-">Note:   </span>The <span 
class="pcrr7tn-">interdiff </span>command works well only if the underlying files against
which versions of a patch are generated remain the same. If you create a patch,
modify the underlying files, and then regenerate the patch, <span 
class="pcrr7tn-">interdiff </span>may not
produce useful output.                                                                                                </div>
<!--l. 386--><p class="indent">   The <a 
 id="dx1-315124"></a><span 
class="pcrr7tn-">extdiff </span>extension is useful for more than merely improving the presentation of MQ&#x00A0;patches. To read more about it,
go to section&#x00A0;<a 
href="#x1-31800014.2">14.2<!--tex4ht:ref: sec:hgext:extdiff --></a>.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
</p>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;14</span><br /><a 
 id="x1-31600014"></a>Adding functionality with extensions</h2>
<!--l. 4--><p class="noindent">While the core of Mercurial is quite complete from a functionality standpoint, it&#x2019;s deliberately shorn of fancy
features. This approach of preserving simplicity keeps the software easy to deal with for both maintainers and
users.
</p><!--l. 9--><p class="indent">   However, Mercurial doesn&#x2019;t box you in with an inflexible command set: you can add features to it as <span 
class="ptmri7t-">extensions </span>(sometimes
known as <span 
class="ptmri7t-">plugins</span>). We&#x2019;ve already discussed a few of these extensions in earlier chapters. </p>
     <ul><li><span class="dt">
     </span><span class="dd">Section&#x00A0;<a 
href="#x1-970004.3">4.3<!--tex4ht:ref: sec:tour-merge:fetch --></a>  covers  the  <a 
 id="dx1-316001"></a><span 
class="pcrr7tn-">fetch </span>extension;  this  combines  pulling  new  changes  and  merging  them  with  local
     changes into a single command, <a 
 id="dx1-316002"></a><a 
 id="dx1-316003"></a>&#x201C;<span 
class="pcrr7tn-">hg fetch</span>&#x201D;.
     </span><li><span class="dt">
     </span><span class="dd">In chapter&#x00A0;<a 
href="#x1-19700010">10<!--tex4ht:ref: chap:hook --></a>, we covered several extensions that are useful for hook-related functionality: <a 
 id="dx1-316004"></a><span 
class="pcrr7tn-">acl </span>adds access
     control lists; <a 
 id="dx1-316005"></a><span 
class="pcrr7tn-">bugzilla </span>adds integration with the Bugzilla bug tracking system; and <a 
 id="dx1-316006"></a><span 
class="pcrr7tn-">notify </span>sends notification
     emails on new changes.
     </span><li><span class="dt">
     </span><span class="dd">The Mercurial Queues patch management extension is so invaluable that it merits two chapters and an appendix
     all to itself. Chapter&#x00A0;<a 
href="#x1-26700012">12<!--tex4ht:ref: chap:mq --></a> covers the basics; chapter&#x00A0;<a 
href="#x1-30200013">13<!--tex4ht:ref: chap:mq-collab --></a> discusses advanced topics; and appendix&#x00A0;<a 
href="#x1-344000B">B<!--tex4ht:ref: chap:mqref --></a> goes into
     detail on each command.</li></ul>
<!--l. 29--><p class="indent">   In this chapter, we&#x2019;ll cover some of the other extensions that are available for Mercurial, and briefly touch on some of the
machinery you&#x2019;ll need to know about if you want to write an extension of your own. </p>
     <ul><li><span class="dt">
     </span><span class="dd">In section&#x00A0;<a 
href="#x1-31700014.1">14.1<!--tex4ht:ref: sec:hgext:inotify --></a>, we&#x2019;ll discuss the possibility of <span 
class="ptmri7t-">huge </span>performance improvements using the <a 
 id="dx1-316007"></a><span 
class="pcrr7tn-">inotify </span>extension.</li></ul>
   <h3 class="sectionHead"><span class="titlemark">14.1    </span> <a 
 id="x1-31700014.1"></a>Improve performance with the <span 
class="pcrr7tn-">inotify </span>extension</h3>
<!--l. 42--><p class="noindent">Are you interested in having some of the most common Mercurial operations run as much as a hundred times faster? Read
on!
</p><!--l. 45--><p class="indent">   Mercurial has great performance under normal circumstances. For example, when you run the <a 
 id="dx1-317001"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; command,
Mercurial has to scan almost every directory and file in your repository so that it can display file status. Many
other Mercurial commands need to do the same work behind the scenes; for example, the <a 
 id="dx1-317002"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; command
uses the status machinery to avoid doing an expensive comparison operation on files that obviously haven&#x2019;t
changed.
</p><!--l. 53--><p class="indent">   Because obtaining file status is crucial to good performance, the authors of Mercurial have optimised this code to within an
inch of its life. However, there&#x2019;s no avoiding the fact that when you run <a 
 id="dx1-317003"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D;, Mercurial is going to have to perform at
least one expensive system call for each managed file to determine whether it&#x2019;s changed since the last time Mercurial checked.
For a sufficiently large repository, this can take a long time.
</p><!--l. 61--><p class="indent">   To put a number on the magnitude of this effect, I created a repository containing 150,000 managed files. I timed <a 
 id="dx1-317004"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">status</span>&#x201D; as taking ten seconds to run, even when <span 
class="ptmri7t-">none </span>of those files had been modified.
</p><!--l. 66--><p class="indent">   Many modern operating systems contain a file notification facility. If a program signs up to an appropriate service, the
operating system will notify it every time a file of interest is created, modified, or deleted. On Linux systems, the kernel
component that does this is called <span 
class="pcrr7tn-">inotify</span>.
</p><!--l. 72--><p class="indent">   Mercurial&#x2019;s <a 
 id="dx1-317005"></a><span 
class="pcrr7tn-">inotify </span>extension talks to the kernel&#x2019;s <span 
class="pcrr7tn-">inotify </span>component to optimise <a 
 id="dx1-317006"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; commands. The
extension has two components. A daemon sits in the background and receives notifications from the <span 
class="pcrr7tn-">inotify </span>subsystem. It also
listens for connections from a regular Mercurial command. The extension modifies Mercurial&#x2019;s behaviour so that instead of
scanning the filesystem, it queries the daemon. Since the daemon has perfect information about the state of the
repository, it can respond with a result instantaneously, avoiding the need to scan every directory and file in the
repository.
</p><!--l. 83--><p class="indent">   Recall the ten seconds that I measured plain Mercurial as taking to run <a 
 id="dx1-317007"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; on a 150,000 file repository. With the
<a 
 id="dx1-317008"></a><span 
class="pcrr7tn-">inotify </span>extension enabled, the time dropped to 0.1&#x00A0;seconds, a factor of <span 
class="ptmri7t-">one hundred </span>faster.
</p><!--l. 88--><p class="indent">   Before we continue, please pay attention to some caveats. </p>
                                                                                         
                                                                                         
     <ul><li><span class="dt">
     </span><span class="dd">The  <a 
 id="dx1-317009"></a><span 
class="pcrr7tn-">inotify </span>extension  is  Linux-specific.  Because  it  interfaces  directly  to  the  Linux  kernel&#x2019;s  <span 
class="pcrr7tn-">inotify</span>
     subsystem, it does not work on other operating systems.
     </span><li><span class="dt">
     </span><span class="dd">It should work on any Linux distribution that was released after early&#x00A0;2005. Older distributions are likely to
     have a kernel that lacks <span 
class="pcrr7tn-">inotify</span>, or a version of <span 
class="pcrr7tn-">glibc </span>that does not have the necessary interfacing support.
     </span><li><span class="dt">
     </span><span class="dd">Not all filesystems are suitable for use with the <a 
 id="dx1-317010"></a><span 
class="pcrr7tn-">inotify </span>extension. Network filesystems such as NFS are a
     non-starter, for example, particularly if you&#x2019;re running Mercurial on several systems, all mounting the same
     network  filesystem.  The  kernel&#x2019;s  <span 
class="pcrr7tn-">inotify </span>system  has  no  way  of  knowing  about  changes  made  on  another
     system. Most local filesystems (e.g.&#x00A0;ext3, XFS, ReiserFS) should work fine.</li></ul>
<!--l. 106--><p class="indent">   The <a 
 id="dx1-317011"></a><span 
class="pcrr7tn-">inotify </span>extension is not yet shipped with Mercurial as of May&#x00A0;2007, so it&#x2019;s a little more involved to set up than other
extensions. But the performance improvement is worth it!
</p><!--l. 110--><p class="indent">   The extension currently comes in two parts: a set of patches to the Mercurial source code, and a library of Python bindings
to the <span 
class="pcrr7tn-">inotify </span>subsystem.
<span class="fbox"><span 
class="ptmb7t-">Note:   </span>There  are  <span 
class="ptmri7t-">two  </span>Python  <span 
class="pcrr7tn-">inotify </span>binding  libraries.  One  of  them  is  called
<span 
class="pcrr7tn-">pyinotify</span>,  and  is  packaged  by  some  Linux  distributions  as  <span 
class="pcrr7tn-">python-inotify</span>.
This is <span 
class="ptmri7t-">not </span>the one you&#x2019;ll need, as it is too buggy and inefficient to be practical.  </span> To get going, it&#x2019;s best to already have a
functioning copy of Mercurial installed.
<span class="fbox"><span 
class="ptmb7t-">Note:   </span>If you follow the instructions below, you&#x2019;ll be <span 
class="ptmri7t-">replacing </span>and overwriting
any existing installation of Mercurial that you might already have, using the latest
&#x201C;bleeding edge&#x201D; Mercurial code. Don&#x2019;t say you weren&#x2019;t warned!              </span>
     </p><ol  class="enumerate1" >
     <li class="enumerate"><a 
 id="x1-317013x1"></a>Clone the Python <span 
class="pcrr7tn-">inotify </span>binding repository. Build and install it.
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-317015r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;clone</span><span 
class="pcrr7tn-">&#x00A0;http://hg.kublai.com/python/inotify</span>
<br class="fancyvrb" /><a 
 id="x1-317017r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cd</span><span 
class="pcrr7tn-">&#x00A0;inotify</span>
<br class="fancyvrb" /><a 
 id="x1-317019r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;python</span><span 
class="pcrr7tn-">&#x00A0;setup.py</span><span 
class="pcrr7tn-">&#x00A0;build</span><span 
class="pcrr7tn-">&#x00A0;--force</span>
<br class="fancyvrb" /><a 
 id="x1-317021r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;sudo</span><span 
class="pcrr7tn-">&#x00A0;python</span><span 
class="pcrr7tn-">&#x00A0;setup.py</span><span 
class="pcrr7tn-">&#x00A0;install</span><span 
class="pcrr7tn-">&#x00A0;--skip-build</span>
</div>
     </li>
     <li class="enumerate"><a 
 id="x1-317023x2"></a>Clone the <span 
class="pcrr7tn-">crew </span>Mercurial repository. Clone the <a 
 id="dx1-317024"></a><span 
class="pcrr7tn-">inotify </span>patch repository so that Mercurial Queues will be able to apply
     patches to your cope of the <span 
class="pcrr7tn-">crew </span>repository.
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-317026r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;clone</span><span 
class="pcrr7tn-">&#x00A0;http://hg.intevation.org/mercurial/crew</span>
<br class="fancyvrb" /><a 
 id="x1-317028r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;clone</span><span 
class="pcrr7tn-">&#x00A0;crew</span><span 
class="pcrr7tn-">&#x00A0;inotify</span>
<br class="fancyvrb" /><a 
 id="x1-317030r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;clone</span><span 
class="pcrr7tn-">&#x00A0;http://hg.kublai.com/mercurial/patches/inotify</span><span 
class="pcrr7tn-">&#x00A0;inotify/.hg/patches</span>
</div>
     </li>
     <li class="enumerate"><a 
 id="x1-317032x3"></a>Make sure that you have the Mercurial Queues extension, <a 
 id="dx1-317033"></a><span 
class="pcrr7tn-">mq</span>, enabled. If you&#x2019;ve never used MQ, read section&#x00A0;<a 
href="#x1-27400012.5">12.5<!--tex4ht:ref: sec:mq:start --></a> to get
     started quickly.
     </li>
     <li class="enumerate"><a 
 id="x1-317035x4"></a>Go into the <span 
class="pcrr7tn-">inotify </span>repo, and apply all of the <a 
 id="dx1-317036"></a><span 
class="pcrr7tn-">inotify </span>patches using the <a 
 id="dx1-317037"></a><a 
 id="dx1-317038"></a><span 
class="pcrr7tn-">-a </span>option to the <a 
 id="dx1-317039"></a><a 
 id="dx1-317040"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D;
     command.
                                                                                         
                                                                                         
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-317042r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cd</span><span 
class="pcrr7tn-">&#x00A0;inotify</span>
<br class="fancyvrb" /><a 
 id="x1-317044r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;qpush</span><span 
class="pcrr7tn-">&#x00A0;-a</span>
</div>
     <!--l. 154--><p class="noindent">If you get an error message from <a 
 id="dx1-317045"></a><a 
 id="dx1-317046"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D;, you should not continue. Instead, ask for help.
     </p></li>
     <li class="enumerate"><a 
 id="x1-317048x5"></a>Build and install the patched version of Mercurial.
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-317050r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;python</span><span 
class="pcrr7tn-">&#x00A0;setup.py</span><span 
class="pcrr7tn-">&#x00A0;build</span><span 
class="pcrr7tn-">&#x00A0;--force</span>
<br class="fancyvrb" /><a 
 id="x1-317052r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;sudo</span><span 
class="pcrr7tn-">&#x00A0;python</span><span 
class="pcrr7tn-">&#x00A0;setup.py</span><span 
class="pcrr7tn-">&#x00A0;install</span><span 
class="pcrr7tn-">&#x00A0;--skip-build</span>
</div>
     </li></ol>
<!--l. 162--><p class="noindent">Once you&#x2019;ve build a suitably patched version of Mercurial, all you need to do to enable the <a 
 id="dx1-317053"></a><span 
class="pcrr7tn-">inotify </span>extension is add an entry to
your <a 
 id="dx1-317054"></a><a 
 id="dx1-317055"></a><span 
class="pcrr7tn-">hgrc</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-317057r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[extensions]</span>
<br class="fancyvrb" /><a 
 id="x1-317059r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;inotify</span><span 
class="pcrr7tn-">&#x00A0;=</span>
   </div>
<!--l. 169--><p class="noindent">When the <a 
 id="dx1-317060"></a><span 
class="pcrr7tn-">inotify </span>extension is enabled, Mercurial will automatically and transparently start the status daemon the first time you
run a command that needs status in a repository. It runs one status daemon per repository.
</p><!--l. 174--><p class="indent">   The status daemon is started silently, and runs in the background. If you look at a list of running processes after you&#x2019;ve
enabled the <a 
 id="dx1-317061"></a><span 
class="pcrr7tn-">inotify </span>extension and run a few commands in different repositories, you&#x2019;ll thus see a few <span 
class="pcrr7tn-">hg </span>processes sitting
around, waiting for updates from the kernel and queries from Mercurial.
</p><!--l. 181--><p class="indent">   The first time you run a Mercurial command in a repository when you have the <a 
 id="dx1-317062"></a><span 
class="pcrr7tn-">inotify </span>extension enabled, it
will run with about the same performance as a normal Mercurial command. This is because the status daemon
needs to perform a normal status scan so that it has a baseline against which to apply later updates from the
kernel. However, <span 
class="ptmri7t-">every </span>subsequent command that does any kind of status check should be noticeably faster
on repositories of even fairly modest size. Better yet, the bigger your repository is, the greater a performance
advantage you&#x2019;ll see. The <a 
 id="dx1-317063"></a><span 
class="pcrr7tn-">inotify </span>daemon makes status operations almost instantaneous on repositories of all
sizes!
</p><!--l. 192--><p class="indent">   If you like, you can manually start a status daemon using the <a 
 id="dx1-317064"></a><a 
 id="dx1-317065"></a>&#x201C;<span 
class="pcrr7tn-">hg inserve</span>&#x201D; command. This gives you slightly finer control
over how the daemon ought to run. This command will of course only be available when the <a 
 id="dx1-317066"></a><span 
class="pcrr7tn-">inotify </span>extension is
enabled.
</p><!--l. 197--><p class="indent">   When you&#x2019;re using the <a 
 id="dx1-317067"></a><span 
class="pcrr7tn-">inotify </span>extension, you should notice <span 
class="ptmri7t-">no difference at all </span>in Mercurial&#x2019;s behaviour, with the sole
exception of status-related commands running a whole lot faster than they used to. You should specifically expect that
commands will not print different output; neither should they give different results. If either of these situations occurs, please
report a bug.
</p><!--l. 204--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">14.2    </span> <a 
 id="x1-31800014.2"></a>Flexible diff support with the <span 
class="pcrr7tn-">extdiff </span>extension</h3>
<!--l. 207--><p class="noindent">Mercurial&#x2019;s built-in <a 
 id="dx1-318001"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; command outputs plaintext unified diffs.
                                                                                         
                                                                                         
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-318003r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;diff</span>
<br class="fancyvrb" /><a 
 id="x1-318005r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;8e4e1048b925</span><span 
class="pcrr7tn-">&#x00A0;myfile</span>
<br class="fancyvrb" /><a 
 id="x1-318007r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/myfile        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:16</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-318009r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/myfile        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:16</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-318011r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-1,1</span><span 
class="pcrr7tn-">&#x00A0;+1,2</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;The</span><span 
class="pcrr7tn-">&#x00A0;first</span><span 
class="pcrr7tn-">&#x00A0;line.</span>
<br class="fancyvrb" /><a 
 id="x1-318013r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;The</span><span 
class="pcrr7tn-">&#x00A0;first</span><span 
class="pcrr7tn-">&#x00A0;line.</span>
<br class="fancyvrb" /><a 
 id="x1-318015r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+The</span><span 
class="pcrr7tn-">&#x00A0;second</span><span 
class="pcrr7tn-">&#x00A0;line.</span>
   </div>
<!--l. 210--><p class="noindent">If you would like to use an external tool to display modifications, you&#x2019;ll want to use the <a 
 id="dx1-318016"></a><span 
class="pcrr7tn-">extdiff </span>extension. This will let you use,
for example, a graphical diff tool.
</p><!--l. 214--><p class="indent">   The <a 
 id="dx1-318017"></a><span 
class="pcrr7tn-">extdiff </span>extension is bundled with Mercurial, so it&#x2019;s easy to set up. In the <a 
 id="dx1-318018"></a><span 
class="pcrr7tn-">[extensions] </span>section of your <a 
 id="dx1-318019"></a><a 
 id="dx1-318020"></a><span 
class="pcrr7tn-">hgrc</span>, simply
add a one-line entry to enable the extension.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-318022r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[extensions]</span>
<br class="fancyvrb" /><a 
 id="x1-318024r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;extdiff</span><span 
class="pcrr7tn-">&#x00A0;=</span>
   </div>
<!--l. 221--><p class="noindent">This introduces a command named <a 
 id="dx1-318025"></a><a 
 id="dx1-318026"></a>&#x201C;<span 
class="pcrr7tn-">hg extdiff</span>&#x201D;, which by default uses your system&#x2019;s <a 
 id="dx1-318027"></a><span 
class="pcrr7tn-">diff </span>command to generate a unified diff
in the same form as the built-in <a 
 id="dx1-318028"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; command.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-318030r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;extdiff</span>
<br class="fancyvrb" /><a 
 id="x1-318032r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;making</span><span 
class="pcrr7tn-">&#x00A0;snapshot</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;rev</span><span 
class="pcrr7tn-">&#x00A0;8e4e1048b925</span>
<br class="fancyvrb" /><a 
 id="x1-318034r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;making</span><span 
class="pcrr7tn-">&#x00A0;snapshot</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;working</span><span 
class="pcrr7tn-">&#x00A0;dir</span>
<br class="fancyvrb" /><a 
 id="x1-318036r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-Npru</span><span 
class="pcrr7tn-">&#x00A0;a.8e4e1048b925/myfile</span><span 
class="pcrr7tn-">&#x00A0;a/myfile</span>
<br class="fancyvrb" /><a 
 id="x1-318038r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a.8e4e1048b925/myfile        2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04:16.000000000</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-318040r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;a/myfile        2008-04-27</span><span 
class="pcrr7tn-">&#x00A0;00:04:16.000000000</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-318042r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-1</span><span 
class="pcrr7tn-">&#x00A0;+1,2</span><span 
class="pcrr7tn-">&#x00A0;@@</span>
<br class="fancyvrb" /><a 
 id="x1-318044r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;The</span><span 
class="pcrr7tn-">&#x00A0;first</span><span 
class="pcrr7tn-">&#x00A0;line.</span>
<br class="fancyvrb" /><a 
 id="x1-318046r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+The</span><span 
class="pcrr7tn-">&#x00A0;second</span><span 
class="pcrr7tn-">&#x00A0;line.</span>
   </div>
<!--l. 225--><p class="noindent">The result won&#x2019;t be exactly the same as with the built-in <a 
 id="dx1-318047"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; variations, because the output of <a 
 id="dx1-318048"></a><span 
class="pcrr7tn-">diff </span>varies from one system
to another, even when passed the same options.
</p><!--l. 229--><p class="indent">   As the &#x201C;<span 
class="pcrr7tn-">making snapshot</span>&#x201D; lines of output above imply, the <a 
 id="dx1-318049"></a><a 
 id="dx1-318050"></a>&#x201C;<span 
class="pcrr7tn-">hg extdiff</span>&#x201D; command works by creating two snapshots of
your source tree. The first snapshot is of the source revision; the second, of the target revision or working directory. The <a 
 id="dx1-318051"></a><a 
 id="dx1-318052"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">extdiff</span>&#x201D; command generates these snapshots in a temporary directory, passes the name of each directory to an external diff
viewer, then deletes the temporary directory. For efficiency, it only snapshots the directories and files that have changed
between the two revisions.
</p><!--l. 239--><p class="indent">   Snapshot directory names have the same base name as your repository. If your repository path is <span 
class="pcrr7tn-">/quux/bar/foo</span>, then <span 
class="pcrr7tn-">foo</span>
will be the name of each snapshot directory. Each snapshot directory name has its changeset ID appended, if appropriate. If a
snapshot is of revision <span 
class="pcrr7tn-">a631aca1083f</span>, the directory will be named <span 
class="pcrr7tn-">foo.a631aca1083f</span>. A snapshot of the working directory
won&#x2019;t have a changeset ID appended, so it would just be <span 
class="pcrr7tn-">foo </span>in this example. To see what this looks like in practice, look again
at the <a 
 id="dx1-318053"></a><a 
 id="dx1-318054"></a>&#x201C;<span 
class="pcrr7tn-">hg extdiff</span>&#x201D; example above. Notice that the diff has the snapshot directory names embedded in its
header.
</p><!--l. 250--><p class="indent">   The <a 
 id="dx1-318055"></a><a 
 id="dx1-318056"></a>&#x201C;<span 
class="pcrr7tn-">hg extdiff</span>&#x201D; command accepts two important options. The <a 
 id="dx1-318057"></a><a 
 id="dx1-318058"></a><span 
class="pcrr7tn-">-p </span>option lets you choose a program to view differences
with, instead of <a 
 id="dx1-318059"></a><span 
class="pcrr7tn-">diff</span>. With the <a 
 id="dx1-318060"></a><a 
 id="dx1-318061"></a><span 
class="pcrr7tn-">-o </span>option, you can change the options that <a 
 id="dx1-318062"></a><a 
 id="dx1-318063"></a>&#x201C;<span 
class="pcrr7tn-">hg extdiff</span>&#x201D; passes to the program (by default,
these options are &#x201C;<span 
class="pcrr7tn-">-Npru</span>&#x201D;, which only make sense if you&#x2019;re running <a 
 id="dx1-318064"></a><span 
class="pcrr7tn-">diff</span>). In other respects, the <a 
 id="dx1-318065"></a><a 
 id="dx1-318066"></a>&#x201C;<span 
class="pcrr7tn-">hg extdiff</span>&#x201D; command acts
                                                                                         
                                                                                         
similarly to the built-in <a 
 id="dx1-318067"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; command: you use the same option names, syntax, and arguments to specify the revisions
you want, the files you want, and so on.
</p><!--l. 262--><p class="indent">   As an example, here&#x2019;s how to run the normal system <a 
 id="dx1-318068"></a><span 
class="pcrr7tn-">diff </span>command, getting it to generate context diffs (using the <a 
 id="dx1-318069"></a><span 
class="pcrr7tn-">-c</span>
option) instead of unified diffs, and five lines of context instead of the default three (passing <span 
class="pcrr7tn-">5 </span>as the argument to the <a 
 id="dx1-318070"></a><span 
class="pcrr7tn-">-C</span>
option).
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-318072r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;extdiff</span><span 
class="pcrb7t-">&#x00A0;-o</span><span 
class="pcrb7t-">&#x00A0;-NprcC5</span>
<br class="fancyvrb" /><a 
 id="x1-318074r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;making</span><span 
class="pcrr7tn-">&#x00A0;snapshot</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;rev</span><span 
class="pcrr7tn-">&#x00A0;8e4e1048b925</span>
<br class="fancyvrb" /><a 
 id="x1-318076r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;making</span><span 
class="pcrr7tn-">&#x00A0;snapshot</span><span 
class="pcrr7tn-">&#x00A0;of</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;files</span><span 
class="pcrr7tn-">&#x00A0;from</span><span 
class="pcrr7tn-">&#x00A0;working</span><span 
class="pcrr7tn-">&#x00A0;dir</span>
<br class="fancyvrb" /><a 
 id="x1-318078r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-NprcC5</span><span 
class="pcrr7tn-">&#x00A0;a.8e4e1048b925/myfile</span><span 
class="pcrr7tn-">&#x00A0;a/myfile</span>
<br class="fancyvrb" /><a 
 id="x1-318080r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;&#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;a.8e4e1048b925/myfile        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:16</span><span 
class="pcrr7tn-">&#x00A0;2008</span>
<br class="fancyvrb" /><a 
 id="x1-318082r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/myfile        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:16</span><span 
class="pcrr7tn-">&#x00A0;2008</span>
<br class="fancyvrb" /><a 
 id="x1-318084r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;&#x22C6;&#x22C6;&#x22C6;&#x22C6;&#x22C6;&#x22C6;&#x22C6;&#x22C6;&#x22C6;&#x22C6;&#x22C6;&#x22C6;&#x22C6;</span>
<br class="fancyvrb" /><a 
 id="x1-318086r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;&#x22C6;</span><span 
class="pcrr7tn-">&#x00A0;1</span><span 
class="pcrr7tn-">&#x00A0;&#x22C6;&#x22C6;&#x22C6;&#x22C6;</span>
<br class="fancyvrb" /><a 
 id="x1-318088r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;1,2</span><span 
class="pcrr7tn-">&#x00A0;----</span>
<br class="fancyvrb" /><a 
 id="x1-318090r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;The</span><span 
class="pcrr7tn-">&#x00A0;first</span><span 
class="pcrr7tn-">&#x00A0;line.</span>
<br class="fancyvrb" /><a 
 id="x1-318092r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+</span><span 
class="pcrr7tn-">&#x00A0;The</span><span 
class="pcrr7tn-">&#x00A0;second</span><span 
class="pcrr7tn-">&#x00A0;line.</span>
   </div>
<!--l. 269--><p class="indent">   Launching a visual diff tool is just as easy. Here&#x2019;s how to launch the <a 
 id="dx1-318093"></a><span 
class="pcrr7tn-">kdiff3 </span>viewer.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-318095r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;extdiff</span><span 
class="pcrr7tn-">&#x00A0;-p</span><span 
class="pcrr7tn-">&#x00A0;kdiff3</span><span 
class="pcrr7tn-">&#x00A0;-o</span><span 
class="pcrr7tn-">&#x00A0;''</span>
   </div>
<!--l. 275--><p class="indent">   If your diff viewing command can&#x2019;t deal with directories, you can easily work around this with a little scripting. For an
example of such scripting in action with the <a 
 id="dx1-318096"></a><span 
class="pcrr7tn-">mq </span>extension and the <a 
 id="dx1-318097"></a><span 
class="pcrr7tn-">interdiff </span>command, see section&#x00A0;<a 
href="#x1-31500013.9.2">13.9.2<!--tex4ht:ref: mq-collab:tips:interdiff --></a>.
</p><!--l. 281--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">14.2.1    </span> <a 
 id="x1-31900014.2.1"></a>Defining command aliases</h4>
<!--l. 283--><p class="noindent">It can be cumbersome to remember the options to both the <a 
 id="dx1-319001"></a><a 
 id="dx1-319002"></a>&#x201C;<span 
class="pcrr7tn-">hg extdiff</span>&#x201D; command and the diff viewer you want to use, so
the <a 
 id="dx1-319003"></a><span 
class="pcrr7tn-">extdiff </span>extension lets you define <span 
class="ptmri7t-">new </span>commands that will invoke your diff viewer with exactly the right
options.
</p><!--l. 288--><p class="indent">   All you need to do is edit your <a 
 id="dx1-319004"></a><a 
 id="dx1-319005"></a><span 
class="pcrr7tn-">hgrc</span>, and add a section named <a 
 id="dx1-319006"></a><span 
class="pcrr7tn-">[extdiff]</span>. Inside this section, you can define multiple
commands. Here&#x2019;s how to add a <span 
class="pcrr7tn-">kdiff3 </span>command. Once you&#x2019;ve defined this, you can type &#x201C;<span 
class="pcrr7tn-">hg kdiff3</span>&#x201D; and the <a 
 id="dx1-319007"></a><span 
class="pcrr7tn-">extdiff</span>
extension will run <a 
 id="dx1-319008"></a><span 
class="pcrr7tn-">kdiff3 </span>for you.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-319010r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[extdiff]</span>
<br class="fancyvrb" /><a 
 id="x1-319012r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cmd.kdiff3</span><span 
class="pcrr7tn-">&#x00A0;=</span>
   </div>
<!--l. 297--><p class="noindent">If you leave the right hand side of the definition empty, as above, the <a 
 id="dx1-319013"></a><span 
class="pcrr7tn-">extdiff </span>extension uses the name of the command you
defined as the name of the external program to run. But these names don&#x2019;t have to be the same. Here, we define a command
named &#x201C;<span 
class="pcrr7tn-">hg wibble</span>&#x201D;, which runs <a 
 id="dx1-319014"></a><span 
class="pcrr7tn-">kdiff3</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
                                                                                         
                                                                                         
<a 
 id="x1-319016r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[extdiff]</span>
<br class="fancyvrb" /><a 
 id="x1-319018r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cmd.wibble</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;kdiff3</span>
   </div>
<!--l. 307--><p class="indent">   You can also specify the default options that you want to invoke your diff viewing program with. The prefix to use is
&#x201C;<span 
class="pcrr7tn-">opts.</span>&#x201D;, followed by the name of the command to which the options apply. This example defines a &#x201C;<span 
class="pcrr7tn-">hg vimdiff</span>&#x201D; command
that runs the <a 
 id="dx1-319019"></a><span 
class="pcrr7tn-">vim </span>editor&#x2019;s <span 
class="pcrr7tn-">DirDiff </span>extension.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-319021r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[extdiff]</span>
<br class="fancyvrb" /><a 
 id="x1-319023r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cmd.vimdiff</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;vim</span>
<br class="fancyvrb" /><a 
 id="x1-319025r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;opts.vimdiff</span><span 
class="pcrr7tn-">&#x00A0;=</span><span 
class="pcrr7tn-">&#x00A0;-f</span><span 
class="pcrr7tn-">&#x00A0;'+next'</span><span 
class="pcrr7tn-">&#x00A0;'+execute</span><span 
class="pcrr7tn-">&#x00A0;"DirDiff"</span><span 
class="pcrr7tn-">&#x00A0;argv(0)</span><span 
class="pcrr7tn-">&#x00A0;argv(1)'</span>
   </div>
<!--l. 318--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">14.3    </span> <a 
 id="x1-32000014.3"></a>Cherrypicking changes with the <span 
class="pcrr7tn-">transplant </span>extension</h3>
<!--l. 321--><p class="noindent">Need to have a long chat with Brendan about this.
</p><!--l. 323--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">14.4    </span> <a 
 id="x1-32100014.4"></a>Send changes via email with the <span 
class="pcrr7tn-">patchbomb </span>extension</h3>
<!--l. 326--><p class="noindent">Many projects have a culture of &#x201C;change review&#x201D;, in which people send their modifications to a mailing list for others to
read and comment on before they commit the final version to a shared repository. Some projects have people
who act as gatekeepers; they apply changes from other people to a repository to which those others don&#x2019;t have
access.
</p><!--l. 333--><p class="indent">   Mercurial makes it easy to send changes over email for review or application, via its <a 
 id="dx1-321001"></a><span 
class="pcrr7tn-">patchbomb </span>extension. The
extension is so namd because changes are formatted as patches, and it&#x2019;s usual to send one changeset per email
message. Sending a long series of changes by email is thus much like &#x201C;bombing&#x201D; the recipient&#x2019;s inbox, hence
&#x201C;patchbomb&#x201D;.
</p><!--l. 340--><p class="indent">   As usual, the basic configuration of the <a 
 id="dx1-321002"></a><span 
class="pcrr7tn-">patchbomb </span>extension takes just one or two lines in your <a 
 id="dx1-321003"></a><a 
 id="dx1-321004"></a><span 
class="pcrr7tn-">hgrc</span>.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-321006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;[extensions]</span>
<br class="fancyvrb" /><a 
 id="x1-321008r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;patchbomb</span><span 
class="pcrr7tn-">&#x00A0;=</span>
   </div>
<!--l. 346--><p class="noindent">Once you&#x2019;ve enabled the extension, you will have a new command available, named <a 
 id="dx1-321009"></a><a 
 id="dx1-321010"></a>&#x201C;<span 
class="pcrr7tn-">hg email</span>&#x201D;.
</p><!--l. 349--><p class="indent">   The safest and best way to invoke the <a 
 id="dx1-321011"></a><a 
 id="dx1-321012"></a>&#x201C;<span 
class="pcrr7tn-">hg email</span>&#x201D; command is to <span 
class="ptmri7t-">always </span>run it first with the <a 
 id="dx1-321013"></a><a 
 id="dx1-321014"></a><span 
class="pcrr7tn-">-n </span>option. This will show you
what the command <span 
class="ptmri7t-">would </span>send, without actually sending anything. Once you&#x2019;ve had a quick glance over the
changes and verified that you are sending the right ones, you can rerun the same command, with the <a 
 id="dx1-321015"></a><a 
 id="dx1-321016"></a><span 
class="pcrr7tn-">-n </span>option
removed.
</p><!--l. 357--><p class="indent">   The <a 
 id="dx1-321017"></a><a 
 id="dx1-321018"></a>&#x201C;<span 
class="pcrr7tn-">hg email</span>&#x201D; command accepts the same kind of revision syntax as every other Mercurial command. For example, this
command will send every revision between 7 and <span 
class="pcrr7tn-">tip</span>, inclusive.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-321020r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;email</span><span 
class="pcrr7tn-">&#x00A0;-n</span><span 
class="pcrr7tn-">&#x00A0;7:tip</span>
   </div>
                                                                                         
                                                                                         
<!--l. 364--><p class="noindent">You can also specify a <span 
class="ptmri7t-">repository </span>to compare with. If you provide a repository but no revisions, the <a 
 id="dx1-321021"></a><a 
 id="dx1-321022"></a>&#x201C;<span 
class="pcrr7tn-">hg email</span>&#x201D;
command will send all revisions in the local repository that are not present in the remote repository. If you
additionally specify revisions or a branch name (the latter using the <a 
 id="dx1-321023"></a><a 
 id="dx1-321024"></a><span 
class="pcrr7tn-">-b </span>option), this will constrain the revisions
sent.
</p><!--l. 372--><p class="indent">   It&#x2019;s perfectly safe to run the <a 
 id="dx1-321025"></a><a 
 id="dx1-321026"></a>&#x201C;<span 
class="pcrr7tn-">hg email</span>&#x201D; command without the names of the people you want to send to: if you do this, it
will just prompt you for those values interactively. (If you&#x2019;re using a Linux or Unix-like system, you should have enhanced
<span 
class="pcrr7tn-">readline</span>-style editing capabilities when entering those headers, too, which is useful.)
</p><!--l. 379--><p class="indent">   When you are sending just one revision, the <a 
 id="dx1-321027"></a><a 
 id="dx1-321028"></a>&#x201C;<span 
class="pcrr7tn-">hg email</span>&#x201D; command will by default use the first line of the changeset
description as the subject of the single email message it sends.
</p><!--l. 383--><p class="indent">   If you send multiple revisions, the <a 
 id="dx1-321029"></a><a 
 id="dx1-321030"></a>&#x201C;<span 
class="pcrr7tn-">hg email</span>&#x201D; command will usually send one message per changeset. It will preface the
series with an introductory message, in which you should describe the purpose of the series of changes you&#x2019;re
sending.
</p><!--l. 388--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">14.4.1    </span> <a 
 id="x1-32200014.4.1"></a>Changing the behaviour of patchbombs</h4>
<!--l. 390--><p class="noindent">Not every project has exactly the same conventions for sending changes in email; the <a 
 id="dx1-322001"></a><span 
class="pcrr7tn-">patchbomb </span>extension tries to
accommodate a number of variations through command line options. </p>
     <ul><li><span class="dt">
     </span><span class="dd">You can write a subject for the introductory message on the command line using the <a 
 id="dx1-322002"></a><a 
 id="dx1-322003"></a><span 
class="pcrr7tn-">-s </span>option. This takes one
     argument, the text of the subject to use.
     </span><li><span class="dt">
     </span><span class="dd">To change the email address from which the messages originate, use the <a 
 id="dx1-322004"></a><a 
 id="dx1-322005"></a><span 
class="pcrr7tn-">-f </span>option. This takes one argument, the
     email address to use.
     </span><li><span class="dt">
     </span><span class="dd">The default behaviour is to send unified diffs (see section&#x00A0;<a 
href="#x1-27300012.4">12.4<!--tex4ht:ref: sec:mq:patch --></a> for a description of the format), one per message.
     You can send a binary bundle instead with the <a 
 id="dx1-322006"></a><a 
 id="dx1-322007"></a><span 
class="pcrr7tn-">-b </span>option.
     </span><li><span class="dt">
     </span><span class="dd">Unified diffs are normally prefaced with a metadata header. You can omit this, and send unadorned diffs, with
     the <a 
 id="dx1-322008"></a><a 
 id="dx1-322009"></a><span 
class="pcrr7tn-">--plain </span>option.
     </span><li><span class="dt">
     </span><span class="dd">Diffs are normally sent &#x201C;inline&#x201D;, in the same body part as the description of a patch. This makes it easiest for the
     largest number of readers to quote and respond to parts of a diff, as some mail clients will only quote the first
     MIME body part in a message. If you&#x2019;d prefer to send the description and the diff in separate body parts, use the
     <a 
 id="dx1-322010"></a><a 
 id="dx1-322011"></a><span 
class="pcrr7tn-">-a </span>option.
     </span><li><span class="dt">
     </span><span class="dd">Instead of sending mail messages, you can write them to an <span 
class="pcrr7tn-">mbox</span>-format mail folder using the <a 
 id="dx1-322012"></a><a 
 id="dx1-322013"></a><span 
class="pcrr7tn-">-m </span>option. That
     option takes one argument, the name of the file to write to.
     </span><li><span class="dt">
     </span><span class="dd">If you would like to add a <a 
 id="dx1-322014"></a><span 
class="pcrr7tn-">diffstat</span>-format summary to each patch, and one to the introductory message, use
     the <a 
 id="dx1-322015"></a><a 
 id="dx1-322016"></a><span 
class="pcrr7tn-">-d </span>option. The <a 
 id="dx1-322017"></a><span 
class="pcrr7tn-">diffstat </span>command displays a table containing the name of each file patched, the number of
     lines affected, and a histogram showing how much each file is modified. This gives readers a qualitative glance
     at how complex a patch is.</li></ul>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<a 
 id="x1-322018r362"></a>
   <h2 class="appendixHead"><span class="titlemark">Appendix&#x00A0;A</span><br /><a 
 id="x1-323000A"></a>Command reference</h2>
   <h3 class="sectionHead"><span class="titlemark">A.1    </span> <a 
 id="x1-324000A.1"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D;&#x2014;add files at the next commit</h3>
<a 
 id="dx1-324001"></a>
<!--l. 5--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-325000A.1"></a><span 
class="pcrr7tn-">--include</span>, also <span 
class="pcrr7tn-">-I</span></h5>
<!--l. 6--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-326000A.1"></a><span 
class="pcrr7tn-">--exclude</span>, also <span 
class="pcrr7tn-">-X</span></h5>
<!--l. 7--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-327000A.1"></a><span 
class="pcrr7tn-">--dry-run</span>, also <span 
class="pcrr7tn-">-n</span></h5>
<!--l. 9--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">A.2    </span> <a 
 id="x1-328000A.2"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D;&#x2014;print changes in history or working directory</h3>
<a 
 id="dx1-328001"></a>
<!--l. 11--><p class="noindent">Show differences between revisions for the specified files or directories, using the unified diff format. For a description of the
unified diff format, see section&#x00A0;<a 
href="#x1-27300012.4">12.4<!--tex4ht:ref: sec:mq:patch --></a>.
</p><!--l. 15--><p class="indent">   By default, this command does not print diffs for files that Mercurial considers to contain binary data. To control this
behaviour, see the <a 
 id="dx1-328002"></a><span 
class="pcrr7tn-">-a </span>and <a 
 id="dx1-328003"></a><span 
class="pcrr7tn-">--git </span>options.
</p><!--l. 19--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">A.2.1    </span> <a 
 id="x1-329000A.2.1"></a>Options</h4>
<!--l. 21--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-330000A.2.1"></a><span 
class="pcrr7tn-">--nodates </span>option</h5>
<!--l. 23--><p class="noindent">Omit date and time information when printing diff headers.
</p><!--l. 25--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-331000A.2.1"></a><span 
class="pcrr7tn-">--ignore-blank-lines</span>, also <span 
class="pcrr7tn-">-B</span></h5>
<!--l. 27--><p class="noindent">Do not print changes that only insert or delete blank lines. A line that contains only whitespace is not considered
blank.
                                                                                         
                                                                                         
</p><!--l. 30--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-332000A.2.1"></a><span 
class="pcrr7tn-">--include</span>, also <span 
class="pcrr7tn-">-I</span></h5>
<!--l. 32--><p class="noindent">Include files and directories whose names match the given patterns.
</p><!--l. 34--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-333000A.2.1"></a><span 
class="pcrr7tn-">--exclude</span>, also <span 
class="pcrr7tn-">-X</span></h5>
<!--l. 36--><p class="noindent">Exclude files and directories whose names match the given patterns.
</p><!--l. 38--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-334000A.2.1"></a><span 
class="pcrr7tn-">--text</span>, also <span 
class="pcrr7tn-">-a</span></h5>
<!--l. 40--><p class="noindent">If this option is not specified, <a 
 id="dx1-334001"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; will refuse to print diffs for files that it detects as binary. Specifying <a 
 id="dx1-334002"></a><span 
class="pcrr7tn-">-a </span>forces <a 
 id="dx1-334003"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">diff</span>&#x201D; to treat all files as text, and generate diffs for all of them.
</p><!--l. 45--><p class="indent">   This option is useful for files that are &#x201C;mostly text&#x201D; but have a few embedded NUL characters. If you use it on files that
contain a lot of binary data, its output will be incomprehensible.
</p><!--l. 49--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-335000A.2.1"></a><span 
class="pcrr7tn-">--ignore-space-change</span>, also <span 
class="pcrr7tn-">-b</span></h5>
<!--l. 51--><p class="noindent">Do not print a line if the only change to that line is in the amount of white space it contains.
</p><!--l. 54--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-336000A.2.1"></a><span 
class="pcrr7tn-">--git</span>, also <span 
class="pcrr7tn-">-g</span></h5>
<!--l. 56--><p class="noindent">Print <a 
 id="dx1-336001"></a><span 
class="pcrr7tn-">git</span>-compatible diffs. XXX reference a format description.
</p><!--l. 59--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-337000A.2.1"></a><span 
class="pcrr7tn-">--show-function</span>, also <span 
class="pcrr7tn-">-p</span></h5>
<!--l. 61--><p class="noindent">Display the name of the enclosing function in a hunk header, using a simple heuristic. This functionality is enabled by default,
so the <a 
 id="dx1-337001"></a><span 
class="pcrr7tn-">-p </span>option has no effect unless you change the value of the <a 
 id="dx1-337002"></a><span 
class="pcrr7tn-">showfunc </span>config item, as in the following
example.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-337004r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'[diff]'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;$HGRC</span>
<br class="fancyvrb" /><a 
 id="x1-337006r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">echo</span><span 
class="pcrb7t-">&#x00A0;'showfunc</span><span 
class="pcrb7t-">&#x00A0;=</span><span 
class="pcrb7t-">&#x00A0;False'</span><span 
class="pcrb7t-">&#x00A0;&#x003e;&#x003e;</span><span 
class="pcrb7t-">&#x00A0;$HGRC</span>
<br class="fancyvrb" /><a 
 id="x1-337008r3"></a><span 
class="ptmr7t-x-x-50">3</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;diff</span>
<br class="fancyvrb" /><a 
 id="x1-337010r4"></a><span 
class="ptmr7t-x-x-50">4</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;f3f4fdc5ffe0</span><span 
class="pcrr7tn-">&#x00A0;myfile.c</span>
<br class="fancyvrb" /><a 
 id="x1-337012r5"></a><span 
class="ptmr7t-x-x-50">5</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/myfile.c        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:11</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-337014r6"></a><span 
class="ptmr7t-x-x-50">6</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/myfile.c        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:11</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-337016r7"></a><span 
class="ptmr7t-x-x-50">7</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-1,4</span><span 
class="pcrr7tn-">&#x00A0;+1,4</span><span 
class="pcrr7tn-">&#x00A0;@@</span>
<br class="fancyvrb" /><a 
 id="x1-337018r8"></a><span 
class="ptmr7t-x-x-50">8</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;myfunc()</span>
<br class="fancyvrb" /><a 
 id="x1-337020r9"></a><span 
class="ptmr7t-x-x-50">9</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span>
                                                                                         
                                                                                         
<br class="fancyvrb" /><a 
 id="x1-337022r10"></a><span 
class="ptmr7t-x-x-50">10</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;return</span><span 
class="pcrr7tn-">&#x00A0;1;</span>
<br class="fancyvrb" /><a 
 id="x1-337024r11"></a><span 
class="ptmr7t-x-x-50">11</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;return</span><span 
class="pcrr7tn-">&#x00A0;10;</span>
<br class="fancyvrb" /><a 
 id="x1-337026r12"></a><span 
class="ptmr7t-x-x-50">12</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">}</span>
<br class="fancyvrb" /><a 
 id="x1-337028r13"></a><span 
class="ptmr7t-x-x-50">13</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;$</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrb7t-">hg</span><span 
class="pcrb7t-">&#x00A0;diff</span><span 
class="pcrb7t-">&#x00A0;-p</span>
<br class="fancyvrb" /><a 
 id="x1-337030r14"></a><span 
class="ptmr7t-x-x-50">14</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;f3f4fdc5ffe0</span><span 
class="pcrr7tn-">&#x00A0;myfile.c</span>
<br class="fancyvrb" /><a 
 id="x1-337032r15"></a><span 
class="ptmr7t-x-x-50">15</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;---</span><span 
class="pcrr7tn-">&#x00A0;a/myfile.c        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:11</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-337034r16"></a><span 
class="ptmr7t-x-x-50">16</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+++</span><span 
class="pcrr7tn-">&#x00A0;b/myfile.c        Sun</span><span 
class="pcrr7tn-">&#x00A0;Apr</span><span 
class="pcrr7tn-">&#x00A0;27</span><span 
class="pcrr7tn-">&#x00A0;00:04:11</span><span 
class="pcrr7tn-">&#x00A0;2008</span><span 
class="pcrr7tn-">&#x00A0;+0000</span>
<br class="fancyvrb" /><a 
 id="x1-337036r17"></a><span 
class="ptmr7t-x-x-50">17</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;-1,4</span><span 
class="pcrr7tn-">&#x00A0;+1,4</span><span 
class="pcrr7tn-">&#x00A0;@@</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;myfunc()</span>
<br class="fancyvrb" /><a 
 id="x1-337038r18"></a><span 
class="ptmr7t-x-x-50">18</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;int</span><span 
class="pcrr7tn-">&#x00A0;myfunc()</span>
<br class="fancyvrb" /><a 
 id="x1-337040r19"></a><span 
class="ptmr7t-x-x-50">19</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">{</span>
<br class="fancyvrb" /><a 
 id="x1-337042r20"></a><span 
class="ptmr7t-x-x-50">20</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;-</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;return</span><span 
class="pcrr7tn-">&#x00A0;1;</span>
<br class="fancyvrb" /><a 
 id="x1-337044r21"></a><span 
class="ptmr7t-x-x-50">21</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;+</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;return</span><span 
class="pcrr7tn-">&#x00A0;10;</span>
<br class="fancyvrb" /><a 
 id="x1-337046r22"></a><span 
class="ptmr7t-x-x-50">22</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="cmsy-10">}</span>
   </div>
<!--l. 67--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-338000A.2.1"></a><span 
class="pcrr7tn-">--rev</span>, also <span 
class="pcrr7tn-">-r</span></h5>
<!--l. 69--><p class="noindent">Specify one or more revisions to compare. The <a 
 id="dx1-338001"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; command accepts up to two <a 
 id="dx1-338002"></a><span 
class="pcrr7tn-">-r </span>options to specify the revisions to
compare.
</p><!--l. 74--><p class="indent">
     </p><ol  class="enumerate1" >
     <li class="enumerate"><a 
 id="x1-338004x1"></a>Display the differences between the parent revision of the working directory and the working directory.
     </li>
     <li class="enumerate"><a 
 id="x1-338006x2"></a>Display the differences between the specified changeset and the working directory.
     </li>
     <li class="enumerate"><a 
 id="x1-338008x3"></a>Display the differences between the two specified changesets.</li></ol>
<!--l. 82--><p class="indent">   You can specify two revisions using either two <a 
 id="dx1-338009"></a><span 
class="pcrr7tn-">-r </span>options or revision range notation. For example, the two revision
specifications below are equivalent.
</p>
   <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-338011r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;10</span><span 
class="pcrr7tn-">&#x00A0;-r</span><span 
class="pcrr7tn-">&#x00A0;20</span>
<br class="fancyvrb" /><a 
 id="x1-338013r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;hg</span><span 
class="pcrr7tn-">&#x00A0;diff</span><span 
class="pcrr7tn-">&#x00A0;-r10:20</span>
   </div>
<!--l. 90--><p class="indent">   When you provide two revisions, Mercurial treats the order of those revisions as significant. Thus, <a 
 id="dx1-338014"></a>&#x201C;<span 
class="pcrr7tn-">hg diff -r10:20</span>&#x201D;
will produce a diff that will transform files from their contents as of revision&#x00A0;10 to their contents as of revision&#x00A0;20, while
<a 
 id="dx1-338015"></a>&#x201C;<span 
class="pcrr7tn-">hg diff -r20:10</span>&#x201D; means the opposite: the diff that will transform files from their revision&#x00A0;20 contents to
their revision&#x00A0;10 contents. You cannot reverse the ordering in this way if you are diffing against the working
directory.
</p><!--l. 99--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-339000A.2.1"></a><span 
class="pcrr7tn-">--ignore-all-space</span>, also <span 
class="pcrr7tn-">-w</span></h5>
                                                                                         
                                                                                         
<!--l. 101--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">A.3    </span> <a 
 id="x1-340000A.3"></a>&#x201C;<span 
class="pcrr7tn-">hg version</span>&#x201D;&#x2014;print version and copyright information</h3>
<a 
 id="dx1-340001"></a>
<!--l. 103--><p class="noindent">This command displays the version of Mercurial you are running, and its copyright license. There are four kinds of version
string that you may see. </p>
     <ul><li><span class="dt">
     </span><span class="dd">The string &#x201C;<span 
class="pcrr7tn-">unknown</span>&#x201D;. This version of Mercurial was not built in a Mercurial repository, and cannot determine
     its own version.
     </span><li><span class="dt">
     </span><span class="dd">A short numeric string, such as &#x201C;<span 
class="pcrr7tn-">1.1</span>&#x201D;. This is a build of a revision of Mercurial that was identified by a specific
     tag in the repository where it was built. (This doesn&#x2019;t necessarily mean that you&#x2019;re running an official release;
     someone else could have added that tag to any revision in the repository where they built Mercurial.)
     </span><li><span class="dt">
     </span><span class="dd">A hexadecimal string, such as &#x201C;<span 
class="pcrr7tn-">875489e31abe</span>&#x201D;. This is a build of the given revision of Mercurial.
     </span><li><span class="dt">
     </span><span class="dd">A hexadecimal string followed by a date, such as &#x201C;<span 
class="pcrr7tn-">875489e31abe+20070205</span>&#x201D;. This is a build of the given
     revision of Mercurial, where the build repository contained some local changes that had not been committed.</li></ul>
<!--l. 124--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">A.3.1    </span> <a 
 id="x1-341000A.3.1"></a>Tips and tricks</h4>
<!--l. 127--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-342000A.3.1"></a>Why do the results of &#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; and &#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; differ?</h5>
<!--l. 130--><p class="noindent">When you run the <a 
 id="dx1-342001"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; command, you&#x2019;ll see a list of files that Mercurial will record changes for the next time you
perform a commit. If you run the <a 
 id="dx1-342002"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; command, you may notice that it prints diffs for only a <span 
class="ptmri7t-">subset </span>of the files that <a 
 id="dx1-342003"></a>&#x201C;<span 
class="pcrr7tn-">hg</span>
<span 
class="pcrr7tn-">status</span>&#x201D; listed. There are two possible reasons for this.
</p><!--l. 136--><p class="indent">   The first is that <a 
 id="dx1-342004"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; prints some kinds of modifications that <a 
 id="dx1-342005"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; doesn&#x2019;t normally display. The <a 
 id="dx1-342006"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D;
command normally outputs unified diffs, which don&#x2019;t have the ability to represent some changes that Mercurial can track. Most
notably, traditional diffs can&#x2019;t represent a change in whether or not a file is executable, but Mercurial records this
information.
</p><!--l. 143--><p class="indent">   If you use the <a 
 id="dx1-342007"></a><span 
class="pcrr7tn-">--git </span>option to <a 
 id="dx1-342008"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D;, it will display <a 
 id="dx1-342009"></a><span 
class="pcrr7tn-">git</span>-compatible diffs that <span 
class="ptmri7t-">can </span>display this extra
information.
</p><!--l. 147--><p class="indent">   The second possible reason that <a 
 id="dx1-342010"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; might be printing diffs for a subset of the files displayed by <a 
 id="dx1-342011"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; is
that if you invoke it without any arguments, <a 
 id="dx1-342012"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; prints diffs against the first parent of the working directory. If you have
run <a 
 id="dx1-342013"></a>&#x201C;<span 
class="pcrr7tn-">hg merge</span>&#x201D; to merge two changesets, but you haven&#x2019;t yet committed the results of the merge, your working directory has
two parents (use <a 
 id="dx1-342014"></a>&#x201C;<span 
class="pcrr7tn-">hg parents</span>&#x201D; to see them). While <a 
 id="dx1-342015"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; prints modifications relative to <span 
class="ptmri7t-">both </span>parents after an
uncommitted merge, <a 
 id="dx1-342016"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D; still operates relative only to the first parent. You can get it to print diffs relative to
the second parent by specifying that parent with the <a 
 id="dx1-342017"></a><span 
class="pcrr7tn-">-r </span>option. There is no way to print diffs relative to both
parents.
                                                                                         
                                                                                         
</p><!--l. 160--><p class="noindent">
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-343000A.3.1"></a>Generating safe binary diffs</h5>
<!--l. 162--><p class="noindent">If you use the <a 
 id="dx1-343001"></a><span 
class="pcrr7tn-">-a </span>option to force Mercurial to print diffs of files that are either &#x201C;mostly text&#x201D; or contain lots of binary data,
those diffs cannot subsequently be applied by either Mercurial&#x2019;s <a 
 id="dx1-343002"></a>&#x201C;<span 
class="pcrr7tn-">hg import</span>&#x201D; command or the system&#x2019;s <a 
 id="dx1-343003"></a><span 
class="pcrr7tn-">patch</span>
command.
</p><!--l. 168--><p class="indent">   If you want to generate a diff of a binary file that is safe to use as input for <a 
 id="dx1-343004"></a>&#x201C;<span 
class="pcrr7tn-">hg import</span>&#x201D;, use the <a 
 id="dx1-343005"></a>&#x201C;<span 
class="pcrr7tn-">hg diff</span>&#x201D;&#x2013;git option
when you generate the patch. The system <a 
 id="dx1-343006"></a><span 
class="pcrr7tn-">patch </span>command cannot handle binary patches at all.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<a 
 id="x1-343007r362"></a>
</p>
   <h2 class="appendixHead"><span class="titlemark">Appendix&#x00A0;B</span><br /><a 
 id="x1-344000B"></a>Mercurial Queues reference</h2>
   <h3 class="sectionHead"><span class="titlemark">B.1    </span> <a 
 id="x1-345000B.1"></a>MQ command reference</h3>
<!--l. 7--><p class="noindent">For an overview of the commands provided by MQ, use the command <a 
 id="dx1-345001"></a>&#x201C;<span 
class="pcrr7tn-">hg help mq</span>&#x201D;.
</p><!--l. 10--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.1    </span> <a 
 id="x1-346000B.1.1"></a>&#x201C;<span 
class="pcrr7tn-">hg qapplied</span>&#x201D;&#x2014;print applied patches</h4>
<!--l. 12--><p class="noindent">The <a 
 id="dx1-346001"></a><a 
 id="dx1-346002"></a>&#x201C;<span 
class="pcrr7tn-">hg qapplied</span>&#x201D; command prints the current stack of applied patches. Patches are printed in oldest-to-newest order, so the
last patch in the list is the &#x201C;top&#x201D; patch.
</p><!--l. 16--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.2    </span> <a 
 id="x1-347000B.1.2"></a>&#x201C;<span 
class="pcrr7tn-">hg qcommit</span>&#x201D;&#x2014;commit changes in the queue repository</h4>
<!--l. 18--><p class="noindent">The <a 
 id="dx1-347001"></a><a 
 id="dx1-347002"></a>&#x201C;<span 
class="pcrr7tn-">hg qcommit</span>&#x201D; command commits any outstanding changes in the <a 
 id="dx1-347003"></a><span 
class="pcrr7tn-">.hg/patches </span>repository. This command only works if
the <a 
 id="dx1-347004"></a><span 
class="pcrr7tn-">.hg/patches </span>directory is a repository, i.e.&#x00A0;you created the directory using <a 
 id="dx1-347005"></a>&#x201C;<span 
class="pcrr7tn-">hg qinit</span> <a 
 id="dx1-347006"></a><a 
 id="dx1-347007"></a><span 
class="pcrr7tn-">-c</span>&#x201D; or ran <a 
 id="dx1-347008"></a>&#x201C;<span 
class="pcrr7tn-">hg init</span>&#x201D; in the
directory after running <a 
 id="dx1-347009"></a><a 
 id="dx1-347010"></a>&#x201C;<span 
class="pcrr7tn-">hg qinit</span>&#x201D;.
</p><!--l. 24--><p class="indent">   This command is shorthand for <a 
 id="dx1-347011"></a>&#x201C;<span 
class="pcrr7tn-">hg commit --cwd .hg/patches</span>&#x201D;.
</p><!--l. 27--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.3    </span> <a 
 id="x1-348000B.1.3"></a>&#x201C;<span 
class="pcrr7tn-">hg qdelete</span>&#x201D;&#x2014;delete a patch from the <span 
class="pcrr7tn-">series </span>file</h4>
<!--l. 29--><p class="noindent">The <a 
 id="dx1-348001"></a><a 
 id="dx1-348002"></a>&#x201C;<span 
class="pcrr7tn-">hg qdelete</span>&#x201D; command removes the entry for a patch from the <a 
 id="dx1-348003"></a><span 
class="pcrr7tn-">series </span>file in the <a 
 id="dx1-348004"></a><span 
class="pcrr7tn-">.hg/patches </span>directory. It does not pop
the patch if the patch is already applied. By default, it does not delete the patch file; use the <a 
 id="dx1-348005"></a><a 
 id="dx1-348006"></a><span 
class="pcrr7tn-">-f </span>option to do
that.
</p><!--l. 35--><p class="indent">   Options: </p>
     <ul><li><span class="dt">
  <a 
 id="dx1-348007"></a><a 
 id="dx1-348008"></a><span 
class="pcrr7tn-">-f</span> </span><span class="dd">Delete the patch file.</li></ul>
<!--l. 40--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.4    </span> <a 
 id="x1-349000B.1.4"></a>&#x201C;<span 
class="pcrr7tn-">hg qdiff</span>&#x201D;&#x2014;print a diff of the topmost applied patch</h4>
<!--l. 42--><p class="noindent">The <a 
 id="dx1-349001"></a><a 
 id="dx1-349002"></a>&#x201C;<span 
class="pcrr7tn-">hg qdiff</span>&#x201D; command prints a diff of the topmost applied patch. It is equivalent to <a 
 id="dx1-349003"></a>&#x201C;<span 
class="pcrr7tn-">hg diff -r-2:-1</span>&#x201D;.
</p><!--l. 45--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.5    </span> <a 
 id="x1-350000B.1.5"></a>&#x201C;<span 
class="pcrr7tn-">hg qfold</span>&#x201D;&#x2014;merge (&#x201C;fold&#x201D;) several patches into one</h4>
<!--l. 47--><p class="noindent">The <a 
 id="dx1-350001"></a><a 
 id="dx1-350002"></a>&#x201C;<span 
class="pcrr7tn-">hg qfold</span>&#x201D; command merges multiple patches into the topmost applied patch, so that the topmost applied patch makes
the union of all of the changes in the patches in question.
</p><!--l. 51--><p class="indent">   The patches to fold must not be applied; <a 
 id="dx1-350003"></a><a 
 id="dx1-350004"></a>&#x201C;<span 
class="pcrr7tn-">hg qfold</span>&#x201D; will exit with an error if any is. The order in which patches are
folded is significant; <a 
 id="dx1-350005"></a>&#x201C;<span 
class="pcrr7tn-">hg qfold a b</span>&#x201D; means &#x201C;apply the current topmost patch, followed by <span 
class="pcrr7tn-">a</span>, followed by
<span 
class="pcrr7tn-">b</span>&#x201D;.
                                                                                         
                                                                                         
</p><!--l. 56--><p class="indent">   The comments from the folded patches are appended to the comments of the destination patch, with each block of
comments separated by three asterisk (&#x201C;<span 
class="pcrr7tn-">&#x22C6;</span>&#x201D;) characters. Use the <a 
 id="dx1-350006"></a><a 
 id="dx1-350007"></a><span 
class="pcrr7tn-">-e </span>option to edit the commit message for the combined
patch/changeset after the folding has completed.
</p><!--l. 62--><p class="indent">   Options: </p>
     <ul><li><span class="dt">
  <a 
 id="dx1-350008"></a><a 
 id="dx1-350009"></a><span 
class="pcrr7tn-">-e</span> </span><span class="dd">Edit the commit message and patch description for the newly folded patch.
     </span><li><span class="dt">
  <a 
 id="dx1-350010"></a><a 
 id="dx1-350011"></a><span 
class="pcrr7tn-">-l</span> </span><span class="dd">Use the contents of the given file as the new commit message and patch description for the folded patch.
     </span><li><span class="dt">
  <a 
 id="dx1-350012"></a><a 
 id="dx1-350013"></a><span 
class="pcrr7tn-">-m</span> </span><span class="dd">Use the given text as the new commit message and patch description for the folded patch.</li></ul>
<!--l. 72--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.6    </span> <a 
 id="x1-351000B.1.6"></a>&#x201C;<span 
class="pcrr7tn-">hg qheader</span>&#x201D;&#x2014;display the header/description of a patch</h4>
<!--l. 74--><p class="noindent">The <a 
 id="dx1-351001"></a><a 
 id="dx1-351002"></a>&#x201C;<span 
class="pcrr7tn-">hg qheader</span>&#x201D; command prints the header, or description, of a patch. By default, it prints the header of the topmost applied
patch. Given an argument, it prints the header of the named patch.
</p><!--l. 78--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.7    </span> <a 
 id="x1-352000B.1.7"></a>&#x201C;<span 
class="pcrr7tn-">hg qimport</span>&#x201D;&#x2014;import a third-party patch into the queue</h4>
<!--l. 80--><p class="noindent">The <a 
 id="dx1-352001"></a><a 
 id="dx1-352002"></a>&#x201C;<span 
class="pcrr7tn-">hg qimport</span>&#x201D; command adds an entry for an external patch to the <a 
 id="dx1-352003"></a><span 
class="pcrr7tn-">series </span>file, and copies the patch into the
<a 
 id="dx1-352004"></a><span 
class="pcrr7tn-">.hg/patches </span>directory. It adds the entry immediately after the topmost applied patch, but does not push the
patch.
</p><!--l. 85--><p class="indent">   If the <a 
 id="dx1-352005"></a><span 
class="pcrr7tn-">.hg/patches </span>directory is a repository, <a 
 id="dx1-352006"></a><a 
 id="dx1-352007"></a>&#x201C;<span 
class="pcrr7tn-">hg qimport</span>&#x201D; automatically does an <a 
 id="dx1-352008"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D; of the imported
patch.
</p><!--l. 89--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.8    </span> <a 
 id="x1-353000B.1.8"></a>&#x201C;<span 
class="pcrr7tn-">hg qinit</span>&#x201D;&#x2014;prepare a repository to work with MQ</h4>
<!--l. 91--><p class="noindent">The <a 
 id="dx1-353001"></a><a 
 id="dx1-353002"></a>&#x201C;<span 
class="pcrr7tn-">hg qinit</span>&#x201D; command prepares a repository to work with MQ. It creates a directory called <a 
 id="dx1-353003"></a><span 
class="pcrr7tn-">.hg/patches</span>.
</p><!--l. 94--><p class="indent">   Options: </p>
     <ul><li><span class="dt">
  <a 
 id="dx1-353004"></a><a 
 id="dx1-353005"></a><span 
class="pcrr7tn-">-c</span> </span><span class="dd">Create <a 
 id="dx1-353006"></a><span 
class="pcrr7tn-">.hg/patches </span>as a repository in its own right. Also creates a <a 
 id="dx1-353007"></a><span 
class="pcrr7tn-">.hgignore </span>file that will ignore the <a 
 id="dx1-353008"></a><span 
class="pcrr7tn-">status</span>
     file.</li></ul>
<!--l. 101--><p class="indent">   When the <a 
 id="dx1-353009"></a><span 
class="pcrr7tn-">.hg/patches </span>directory is a repository, the <a 
 id="dx1-353010"></a><a 
 id="dx1-353011"></a>&#x201C;<span 
class="pcrr7tn-">hg qimport</span>&#x201D; and <a 
 id="dx1-353012"></a><a 
 id="dx1-353013"></a>&#x201C;<span 
class="pcrr7tn-">hg qnew</span>&#x201D; commands automatically <a 
 id="dx1-353014"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D;
new patches.
</p><!--l. 105--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.9    </span> <a 
 id="x1-354000B.1.9"></a>&#x201C;<span 
class="pcrr7tn-">hg qnew</span>&#x201D;&#x2014;create a new patch</h4>
<!--l. 107--><p class="noindent">The <a 
 id="dx1-354001"></a><a 
 id="dx1-354002"></a>&#x201C;<span 
class="pcrr7tn-">hg qnew</span>&#x201D; command creates a new patch. It takes one mandatory argument, the name to use for the patch file. The newly
created patch is created empty by default. It is added to the <a 
 id="dx1-354003"></a><span 
class="pcrr7tn-">series </span>file after the current topmost applied patch, and is
immediately pushed on top of that patch.
                                                                                         
                                                                                         
</p><!--l. 113--><p class="indent">   If <a 
 id="dx1-354004"></a><a 
 id="dx1-354005"></a>&#x201C;<span 
class="pcrr7tn-">hg qnew</span>&#x201D; finds modified files in the working directory, it will refuse to create a new patch unless the <a 
 id="dx1-354006"></a><a 
 id="dx1-354007"></a><span 
class="pcrr7tn-">-f </span>option is used
(see below). This behaviour allows you to <a 
 id="dx1-354008"></a><a 
 id="dx1-354009"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D; your topmost applied patch before you apply a new patch on top of
it.
</p><!--l. 118--><p class="indent">   Options: </p>
     <ul><li><span class="dt">
  <a 
 id="dx1-354010"></a><a 
 id="dx1-354011"></a><span 
class="pcrr7tn-">-f</span> </span><span class="dd">Create a new patch if the contents of the working directory are modified. Any outstanding modifications are
     added to the newly created patch, so after this command completes, the working directory will no longer be
     modified.
     </span><li><span class="dt">
  <a 
 id="dx1-354012"></a><a 
 id="dx1-354013"></a><span 
class="pcrr7tn-">-m</span> </span><span class="dd">Use the given text as the commit message. This text will be stored at the beginning of the patch file, before the
     patch data.</li></ul>
<!--l. 129--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.10    </span> <a 
 id="x1-355000B.1.10"></a>&#x201C;<span 
class="pcrr7tn-">hg qnext</span>&#x201D;&#x2014;print the name of the next patch</h4>
<!--l. 131--><p class="noindent">The <a 
 id="dx1-355001"></a><a 
 id="dx1-355002"></a>&#x201C;<span 
class="pcrr7tn-">hg qnext</span>&#x201D; command prints the name name of the next patch in the <a 
 id="dx1-355003"></a><span 
class="pcrr7tn-">series </span>file after the topmost applied patch. This
patch will become the topmost applied patch if you run <a 
 id="dx1-355004"></a><a 
 id="dx1-355005"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D;.
</p><!--l. 135--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.11    </span> <a 
 id="x1-356000B.1.11"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D;&#x2014;pop patches off the stack</h4>
<!--l. 137--><p class="noindent">The <a 
 id="dx1-356001"></a><a 
 id="dx1-356002"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; command removes applied patches from the top of the stack of applied patches. By default, it removes only one
patch.
</p><!--l. 140--><p class="indent">   This command removes the changesets that represent the popped patches from the repository, and updates the working
directory to undo the effects of the patches.
</p><!--l. 144--><p class="indent">   This command takes an optional argument, which it uses as the name or index of the patch to pop to. If given a name, it
will pop patches until the named patch is the topmost applied patch. If given a number, <a 
 id="dx1-356003"></a><a 
 id="dx1-356004"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; treats the
number as an index into the entries in the series file, counting from zero (empty lines and lines containing only
comments do not count). It pops patches until the patch identified by the given index is the topmost applied
patch.
</p><!--l. 152--><p class="indent">   The <a 
 id="dx1-356005"></a><a 
 id="dx1-356006"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; command does not read or write patches or the <a 
 id="dx1-356007"></a><span 
class="pcrr7tn-">series </span>file. It is thus safe to <a 
 id="dx1-356008"></a><a 
 id="dx1-356009"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; a patch that you
have removed from the <a 
 id="dx1-356010"></a><span 
class="pcrr7tn-">series </span>file, or a patch that you have renamed or deleted entirely. In the latter two cases, use the name
of the patch as it was when you applied it.
</p><!--l. 158--><p class="indent">   By default, the <a 
 id="dx1-356011"></a><a 
 id="dx1-356012"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; command will not pop any patches if the working directory has been modified. You can override
this behaviour using the <a 
 id="dx1-356013"></a><a 
 id="dx1-356014"></a><span 
class="pcrr7tn-">-f </span>option, which reverts all modifications in the working directory.
</p><!--l. 163--><p class="indent">   Options: </p>
     <ul><li><span class="dt">
  <a 
 id="dx1-356015"></a><a 
 id="dx1-356016"></a><span 
class="pcrr7tn-">-a</span> </span><span class="dd">Pop all applied patches. This returns the repository to its state before you applied any patches.
     </span><li><span class="dt">
  <a 
 id="dx1-356017"></a><a 
 id="dx1-356018"></a><span 
class="pcrr7tn-">-f</span> </span><span class="dd">Forcibly revert any modifications to the working directory when popping.
     </span><li><span class="dt">
  <a 
 id="dx1-356019"></a><a 
 id="dx1-356020"></a><span 
class="pcrr7tn-">-n</span> </span><span class="dd">Pop a patch from the named queue.</li></ul>
<!--l. 172--><p class="indent">   The <a 
 id="dx1-356021"></a><a 
 id="dx1-356022"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; command removes one line from the end of the <a 
 id="dx1-356023"></a><span 
class="pcrr7tn-">status </span>file for each patch that it pops.
                                                                                         
                                                                                         
</p><!--l. 175--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.12    </span> <a 
 id="x1-357000B.1.12"></a>&#x201C;<span 
class="pcrr7tn-">hg qprev</span>&#x201D;&#x2014;print the name of the previous patch</h4>
<!--l. 177--><p class="noindent">The <a 
 id="dx1-357001"></a><a 
 id="dx1-357002"></a>&#x201C;<span 
class="pcrr7tn-">hg qprev</span>&#x201D; command prints the name of the patch in the <a 
 id="dx1-357003"></a><span 
class="pcrr7tn-">series </span>file that comes before the topmost applied patch. This
will become the topmost applied patch if you run <a 
 id="dx1-357004"></a><a 
 id="dx1-357005"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D;.
</p><!--l. 181--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.13    </span> <a 
 id="x1-358000B.1.13"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D;&#x2014;push patches onto the stack</h4>
<!--l. 184--><p class="noindent">The <a 
 id="dx1-358001"></a><a 
 id="dx1-358002"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; command adds patches onto the applied stack. By default, it adds only one patch.
</p><!--l. 187--><p class="indent">   This command creates a new changeset to represent each applied patch, and updates the working directory to apply the
effects of the patches.
</p><!--l. 190--><p class="indent">   The default data used when creating a changeset are as follows: </p>
     <ul><li><span class="dt">
     </span><span class="dd">The commit date and time zone are the current date and time zone. Because these data are used to compute the
     identity of a changeset, this means that if you <a 
 id="dx1-358003"></a><a 
 id="dx1-358004"></a>&#x201C;<span 
class="pcrr7tn-">hg qpop</span>&#x201D; a patch and <a 
 id="dx1-358005"></a><a 
 id="dx1-358006"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; it again, the changeset that
     you push will have a different identity than the changeset you popped.
     </span><li><span class="dt">
     </span><span class="dd">The author is the same as the default used by the <a 
 id="dx1-358007"></a>&#x201C;<span 
class="pcrr7tn-">hg commit</span>&#x201D; command.
     </span><li><span class="dt">
     </span><span class="dd">The commit message is any text from the patch file that comes before the first diff header. If there is no such
     text, a default commit message is used that identifies the name of the patch.</li></ul>
<!--l. 203--><p class="noindent">If a patch contains a Mercurial patch header (XXX add link), the information in the patch header overrides these
defaults.
</p><!--l. 206--><p class="indent">   Options: </p>
     <ul><li><span class="dt">
  <a 
 id="dx1-358008"></a><a 
 id="dx1-358009"></a><span 
class="pcrr7tn-">-a</span> </span><span class="dd">Push all unapplied patches from the <a 
 id="dx1-358010"></a><span 
class="pcrr7tn-">series </span>file until there are none left to push.
     </span><li><span class="dt">
  <a 
 id="dx1-358011"></a><a 
 id="dx1-358012"></a><span 
class="pcrr7tn-">-l</span> </span><span class="dd">Add the name of the patch to the end of the commit message.
     </span><li><span class="dt">
  <a 
 id="dx1-358013"></a><a 
 id="dx1-358014"></a><span 
class="pcrr7tn-">-m</span> </span><span class="dd">If a patch fails to apply cleanly, use the entry for the patch in another saved queue to compute the parameters
     for a three-way merge, and perform a three-way merge using the normal Mercurial merge machinery. Use the
     resolution of the merge as the new patch content.
     </span><li><span class="dt">
  <a 
 id="dx1-358015"></a><a 
 id="dx1-358016"></a><span 
class="pcrr7tn-">-n</span> </span><span class="dd">Use the named queue if merging while pushing.</li></ul>
<!--l. 220--><p class="indent">   The <a 
 id="dx1-358017"></a><a 
 id="dx1-358018"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; command reads, but does not modify, the <a 
 id="dx1-358019"></a><span 
class="pcrr7tn-">series </span>file. It appends one line to the <a 
 id="dx1-358020"></a>&#x201C;<span 
class="pcrr7tn-">hg status</span>&#x201D; file for each
patch that it pushes.
</p><!--l. 224--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.14    </span> <a 
 id="x1-359000B.1.14"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D;&#x2014;update the topmost applied patch</h4>
<!--l. 226--><p class="noindent">The <a 
 id="dx1-359001"></a><a 
 id="dx1-359002"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D; command updates the topmost applied patch. It modifies the patch, removes the old changeset that
represented the patch, and creates a new changeset to represent the modified patch.
</p><!--l. 230--><p class="indent">   The <a 
 id="dx1-359003"></a><a 
 id="dx1-359004"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D; command looks for the following modifications: </p>
                                                                                         
                                                                                         
     <ul><li><span class="dt">
     </span><span class="dd">Changes to the commit message, i.e.&#x00A0;the text before the first diff header in the patch file, are reflected in the new
     changeset that represents the patch.
     </span><li><span class="dt">
     </span><span class="dd">Modifications to tracked files in the working directory are added to the patch.
     </span><li><span class="dt">
     </span><span class="dd">Changes to the files tracked using <a 
 id="dx1-359005"></a>&#x201C;<span 
class="pcrr7tn-">hg add</span>&#x201D;, <a 
 id="dx1-359006"></a>&#x201C;<span 
class="pcrr7tn-">hg copy</span>&#x201D;, <a 
 id="dx1-359007"></a>&#x201C;<span 
class="pcrr7tn-">hg remove</span>&#x201D;, or <a 
 id="dx1-359008"></a>&#x201C;<span 
class="pcrr7tn-">hg rename</span>&#x201D;. Added files and copy
     and rename destinations are added to the patch, while removed files and rename sources are removed.</li></ul>
<!--l. 243--><p class="indent">   Even if <a 
 id="dx1-359009"></a><a 
 id="dx1-359010"></a>&#x201C;<span 
class="pcrr7tn-">hg qrefresh</span>&#x201D; detects no changes, it still recreates the changeset that represents the patch. This causes the identity
of the changeset to differ from the previous changeset that identified the patch.
</p><!--l. 248--><p class="indent">   Options: </p>
     <ul><li><span class="dt">
  <a 
 id="dx1-359011"></a><a 
 id="dx1-359012"></a><span 
class="pcrr7tn-">-e</span> </span><span class="dd">Modify the commit and patch description, using the preferred text editor.
     </span><li><span class="dt">
  <a 
 id="dx1-359013"></a><a 
 id="dx1-359014"></a><span 
class="pcrr7tn-">-m</span> </span><span class="dd">Modify the commit message and patch description, using the given text.
     </span><li><span class="dt">
  <a 
 id="dx1-359015"></a><a 
 id="dx1-359016"></a><span 
class="pcrr7tn-">-l</span> </span><span class="dd">Modify the commit message and patch description, using text from the given file.</li></ul>
<!--l. 258--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.15    </span> <a 
 id="x1-360000B.1.15"></a>&#x201C;<span 
class="pcrr7tn-">hg qrename</span>&#x201D;&#x2014;rename a patch</h4>
<!--l. 260--><p class="noindent">The <a 
 id="dx1-360001"></a><a 
 id="dx1-360002"></a>&#x201C;<span 
class="pcrr7tn-">hg qrename</span>&#x201D; command renames a patch, and changes the entry for the patch in the <a 
 id="dx1-360003"></a><span 
class="pcrr7tn-">series </span>file.
</p><!--l. 263--><p class="indent">   With a single argument, <a 
 id="dx1-360004"></a><a 
 id="dx1-360005"></a>&#x201C;<span 
class="pcrr7tn-">hg qrename</span>&#x201D; renames the topmost applied patch. With two arguments, it renames its first
argument to its second.
</p><!--l. 267--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.16    </span> <a 
 id="x1-361000B.1.16"></a>&#x201C;<span 
class="pcrr7tn-">hg qrestore</span>&#x201D;&#x2014;restore saved queue state</h4>
<!--l. 269--><p class="noindent">XXX No idea what this does.
</p><!--l. 271--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.17    </span> <a 
 id="x1-362000B.1.17"></a>&#x201C;<span 
class="pcrr7tn-">hg qsave</span>&#x201D;&#x2014;save current queue state</h4>
<!--l. 273--><p class="noindent">XXX Likewise.
</p><!--l. 275--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.18    </span> <a 
 id="x1-363000B.1.18"></a>&#x201C;<span 
class="pcrr7tn-">hg qseries</span>&#x201D;&#x2014;print the entire patch series</h4>
<!--l. 277--><p class="noindent">The <a 
 id="dx1-363001"></a><a 
 id="dx1-363002"></a>&#x201C;<span 
class="pcrr7tn-">hg qseries</span>&#x201D; command prints the entire patch series from the <a 
 id="dx1-363003"></a><span 
class="pcrr7tn-">series </span>file. It prints only patch names, not empty lines or
comments. It prints in order from first to be applied to last.
                                                                                         
                                                                                         
</p><!--l. 281--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.19    </span> <a 
 id="x1-364000B.1.19"></a>&#x201C;<span 
class="pcrr7tn-">hg qtop</span>&#x201D;&#x2014;print the name of the current patch</h4>
<!--l. 283--><p class="noindent">The <a 
 id="dx1-364001"></a><a 
 id="dx1-364002"></a>&#x201C;<span 
class="pcrr7tn-">hg qtop</span>&#x201D; prints the name of the topmost currently applied patch.
</p><!--l. 286--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.20    </span> <a 
 id="x1-365000B.1.20"></a>&#x201C;<span 
class="pcrr7tn-">hg qunapplied</span>&#x201D;&#x2014;print patches not yet applied</h4>
<!--l. 288--><p class="noindent">The <a 
 id="dx1-365001"></a><a 
 id="dx1-365002"></a>&#x201C;<span 
class="pcrr7tn-">hg qunapplied</span>&#x201D; command prints the names of patches from the <a 
 id="dx1-365003"></a><span 
class="pcrr7tn-">series </span>file that are not yet applied. It prints them in
order from the next patch that will be pushed to the last.
</p><!--l. 292--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.21    </span> <a 
 id="x1-366000B.1.21"></a>&#x201C;<span 
class="pcrr7tn-">hg qversion</span>&#x201D;</h4>
<!--l. 294--><p class="noindent">The <a 
 id="dx1-366001"></a><a 
 id="dx1-366002"></a>&#x201C;<span 
class="pcrr7tn-">hg qversion</span>&#x201D; command prints the version of MQ that is in use.
</p><!--l. 296--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1.22    </span> <a 
 id="x1-367000B.1.22"></a>&#x201C;<span 
class="pcrr7tn-">hg strip</span>&#x201D;&#x2014;remove a revision and descendants</h4>
<!--l. 298--><p class="noindent">The <a 
 id="dx1-367001"></a>&#x201C;<span 
class="pcrr7tn-">hg strip</span>&#x201D; command removes a revision, and all of its descendants, from the repository. It undoes the effects of the
removed revisions from the repository, and updates the working directory to the first parent of the removed
revision.
</p><!--l. 303--><p class="indent">   The <a 
 id="dx1-367002"></a>&#x201C;<span 
class="pcrr7tn-">hg strip</span>&#x201D; command saves a backup of the removed changesets in a bundle, so that they can be reapplied if removed
in error.
</p><!--l. 306--><p class="indent">   Options: </p>
     <ul><li><span class="dt">
  <a 
 id="dx1-367003"></a><span 
class="pcrr7tn-">-b</span> </span><span class="dd">Save unrelated changesets that are intermixed with the stripped changesets in the backup bundle.
     </span><li><span class="dt">
  <a 
 id="dx1-367004"></a><span 
class="pcrr7tn-">-f</span> </span><span class="dd">If a branch has multiple heads, remove all heads. XXX This should be renamed, and use <span 
class="pcrr7tn-">-f </span>to strip revs when
     there are pending changes.
     </span><li><span class="dt">
  <a 
 id="dx1-367005"></a><span 
class="pcrr7tn-">-n</span> </span><span class="dd">Do not save a backup bundle.</li></ul>
<!--l. 316--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">B.2    </span> <a 
 id="x1-368000B.2"></a>MQ file reference</h3>
<!--l. 318--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.2.1    </span> <a 
 id="x1-369000B.2.1"></a>The <span 
class="pcrr7tn-">series </span>file</h4>
<!--l. 320--><p class="noindent">The <a 
 id="dx1-369001"></a><span 
class="pcrr7tn-">series </span>file contains a list of the names of all patches that MQ can apply. It is represented as a list of names, with one name
saved per line. Leading and trailing white space in each line are ignored.
                                                                                         
                                                                                         
</p><!--l. 325--><p class="indent">   Lines may contain comments. A comment begins with the &#x201C;<span 
class="pcrr7tn-">#</span>&#x201D; character, and extends to the end of the line. Empty lines,
and lines that contain only comments, are ignored.
</p><!--l. 329--><p class="indent">   You will often need to edit the <a 
 id="dx1-369002"></a><span 
class="pcrr7tn-">series </span>file by hand, hence the support for comments and empty lines noted above. For
example, you can comment out a patch temporarily, and <a 
 id="dx1-369003"></a><a 
 id="dx1-369004"></a>&#x201C;<span 
class="pcrr7tn-">hg qpush</span>&#x201D; will skip over that patch when applying
patches. You can also change the order in which patches are applied by reordering their entries in the <a 
 id="dx1-369005"></a><span 
class="pcrr7tn-">series</span>
file.
</p><!--l. 336--><p class="indent">   Placing the <a 
 id="dx1-369006"></a><span 
class="pcrr7tn-">series </span>file under revision control is also supported; it is a good idea to place all of the patches that it refers to
under revision control, as well. If you create a patch directory using the <a 
 id="dx1-369007"></a><a 
 id="dx1-369008"></a><span 
class="pcrr7tn-">-c </span>option to <a 
 id="dx1-369009"></a><a 
 id="dx1-369010"></a>&#x201C;<span 
class="pcrr7tn-">hg qinit</span>&#x201D;, this will be done for you
automatically.
</p><!--l. 342--><p class="noindent">
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.2.2    </span> <a 
 id="x1-370000B.2.2"></a>The <span 
class="pcrr7tn-">status </span>file</h4>
<!--l. 344--><p class="noindent">The <a 
 id="dx1-370001"></a><span 
class="pcrr7tn-">status </span>file contains the names and changeset hashes of all patches that MQ currently has applied. Unlike the <a 
 id="dx1-370002"></a><span 
class="pcrr7tn-">series </span>file,
this file is not intended for editing. You should not place this file under revision control, or modify it in any way. It is used by
MQ strictly for internal book-keeping.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<a 
 id="x1-370003r362"></a>
</p>
   <h2 class="appendixHead"><span class="titlemark">Appendix&#x00A0;C</span><br /><a 
 id="x1-371000C"></a>Making of this book</h2>
   <h3 class="sectionHead"><span class="titlemark">C.1    </span> <a 
 id="x1-372000C.1"></a>Where to download the book source</h3>
<!--l. 7--><p class="noindent">If you are using a Unix-like system that has a sufficiently recent version of Python (2.3&#x00A0;or newer) available, it is easy to install
Mercurial from source.
     </p><ol  class="enumerate1" >
     <li class="enumerate"><a 
 id="x1-372002x1"></a>Download a recent source tarball from   <a 
href="http://www.selenic.com/mercurial/download" class="url" ><span 
class="pcrr7tn-">http://www.selenic.com/mercurial/download</span></a>.
     </li>
     <li class="enumerate"><a 
 id="x1-372004x2"></a>Unpack the tarball:
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-372006r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;gzip</span><span 
class="pcrr7tn-">&#x00A0;-dc</span><span 
class="pcrr7tn-">&#x00A0;mercurial-</span><span 
class="pcrro7t-">version</span><span 
class="pcrr7tn-">.tar.gz</span><span 
class="pcrr7tn-">&#x00A0;|</span><span 
class="pcrr7tn-">&#x00A0;tar</span><span 
class="pcrr7tn-">&#x00A0;xf</span><span 
class="pcrr7tn-">&#x00A0;-</span>
</div>
     </li>
     <li class="enumerate"><a 
 id="x1-372008x3"></a>Go into the source directory and run the installer script. This will build Mercurial and install it in your home
     directory.
     <div class="fancyvrb" id="fancyvrb">
<a 
 id="x1-372010r1"></a><span 
class="ptmr7t-x-x-50">1</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;cd</span><span 
class="pcrr7tn-">&#x00A0;mercurial-</span><span 
class="pcrro7t-">version</span>
<br class="fancyvrb" /><a 
 id="x1-372012r2"></a><span 
class="ptmr7t-x-x-50">2</span><span 
class="pcrr7tn-">&#x00A0;</span><span 
class="pcrr7tn-">&#x00A0;python</span><span 
class="pcrr7tn-">&#x00A0;setup.py</span><span 
class="pcrr7tn-">&#x00A0;install</span><span 
class="pcrr7tn-">&#x00A0;--force</span><span 
class="pcrr7tn-">&#x00A0;--home=$HOME</span>
</div>
     </li></ol>
<!--l. 24--><p class="noindent">Once the install finishes, Mercurial will be in the <span 
class="pcrr7tn-">bin </span>subdirectory of your home directory. Don&#x2019;t forget to make sure that this
directory is present in your shell&#x2019;s search path.
</p><!--l. 28--><p class="indent">   You will probably need to set the <a 
 id="dx1-372013"></a><a 
 id="dx1-372014"></a><span 
class="pcrr7tn-">PYTHONPATH </span>environment variable so that the Mercurial executable can find the rest of the
Mercurial packages. For example, on my laptop, I have set it to <span 
class="pcrr7tn-">/home/bos/lib/python</span>. The exact path that you will need to
use depends on how Python was built for your system, but should be easy to figure out. If you&#x2019;re uncertain, look through
the output of the installer script above, and see where the contents of the <span 
class="pcrr7tn-">mercurial </span>directory were installed
to.
</p><!--l. 37--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">C.2    </span> <a 
 id="x1-373000C.2"></a>On Windows</h3>
<!--l. 39--><p class="noindent">Building and installing Mercurial on Windows requires a variety of tools, a fair amount of technical knowledge, and
considerable patience. I very much <span 
class="ptmri7t-">do not recommend </span>this route if you are a &#x201C;casual user&#x201D;. Unless you intend to hack on
Mercurial, I strongly suggest that you use a binary package instead.
</p><!--l. 45--><p class="indent">   If you are intent on building Mercurial from source on Windows, follow the &#x201C;hard way&#x201D; directions on the Mercurial wiki at
<a 
href="http://www.selenic.com/mercurial/wiki/index.cgi/WindowsInstall" class="url" ><span 
class="pcrr7tn-">http://www.selenic.com/mercurial/wiki/index.cgi/WindowsInstall</span></a>, and expect the process to involve a lot of fiddly
work.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<a 
 id="x1-373001r362"></a>
</p>
   <h2 class="appendixHead"><span class="titlemark">Appendix&#x00A0;D</span><br /><a 
 id="x1-374000D"></a>Open Publication License</h2>
<!--l. 4--><p class="noindent">Version 1.0, 8 June 1999
</p>
   <h3 class="sectionHead"><span class="titlemark">D.1    </span> <a 
 id="x1-375000D.1"></a>Requirements on both unmodified and modified versions</h3>
<!--l. 8--><p class="noindent">The Open Publication works may be reproduced and distributed in whole or in part, in any medium physical or electronic,
provided that the terms of this license are adhered to, and that this license or an incorporation of it by reference (with any
options elected by the author(s) and/or publisher) is displayed in the reproduction.
</p><!--l. 14--><p class="indent">   Proper form for an incorporation by reference is as follows:
</p><!--l. 16--><p class="indent">
     </p><div class="quote">
     <!--l. 17--><p class="noindent">Copyright (c) <span 
class="ptmri7t-">year </span>by <span 
class="ptmri7t-">author&#x2019;s name or designee</span>. This material may be distributed only subject to the
     terms and conditions set forth in the Open Publication License, v<span 
class="ptmri7t-">x.y </span>or later (the latest version is presently
     available at   <a 
href="http://www.opencontent.org/openpub/" class="url" ><span 
class="pcrr7tn-">http://www.opencontent.org/openpub/</span></a>).</p></div>
<!--l. 24--><p class="indent">   The reference must be immediately followed with any options elected by the author(s) and/or publisher of the document
(see section&#x00A0;<a 
href="#x1-380000D.6">D.6<!--tex4ht:ref: sec:opl:options --></a>).
</p><!--l. 28--><p class="indent">   Commercial redistribution of Open Publication-licensed material is permitted.
</p><!--l. 31--><p class="indent">   Any publication in standard (paper) book form shall require the citation of the original publisher and author. The
publisher and author&#x2019;s names shall appear on all outer surfaces of the book. On all outer surfaces of the book the
original publisher&#x2019;s name shall be as large as the title of the work and cited as possessive with respect to the
title.
</p><!--l. 38--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">D.2    </span> <a 
 id="x1-376000D.2"></a>Copyright</h3>
<!--l. 40--><p class="noindent">The copyright to each Open Publication is owned by its author(s) or designee.
</p><!--l. 43--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">D.3    </span> <a 
 id="x1-377000D.3"></a>Scope of license</h3>
<!--l. 45--><p class="noindent">The following license terms apply to all Open Publication works, unless otherwise explicitly stated in the document.
</p><!--l. 48--><p class="indent">   Mere aggregation of Open Publication works or a portion of an Open Publication work with other works or programs on the
same media shall not cause this license to apply to those other works. The aggregate work shall contain a notice specifying the
inclusion of the Open Publication material and appropriate copyright notice.
</p><!--l. 54--><p class="indent">   <span 
class="ptmb7t-">Severability</span>. If any part of this license is found to be unenforceable in any jurisdiction, the remaining portions of the
license remain in force.
</p><!--l. 58--><p class="indent">   <span 
class="ptmb7t-">No warranty</span>. Open Publication works are licensed and provided &#x201C;as is&#x201D; without warranty of any kind, express or implied,
including, but not limited to, the implied warranties of merchantability and fitness for a particular purpose or a warranty of
non-infringement.
                                                                                         
                                                                                         
</p><!--l. 63--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">D.4    </span> <a 
 id="x1-378000D.4"></a>Requirements on modified works</h3>
<!--l. 65--><p class="noindent">All modified versions of documents covered by this license, including translations, anthologies, compilations and partial
documents, must meet the following requirements:
</p><!--l. 70--><p class="indent">
     </p><ol  class="enumerate1" >
     <li class="enumerate"><a 
 id="x1-378002x1"></a>The modified version must be labeled as such.
     </li>
     <li class="enumerate"><a 
 id="x1-378004x2"></a>The person making the modifications must be identified and the modifications dated.
     </li>
     <li class="enumerate"><a 
 id="x1-378006x3"></a>Acknowledgement  of  the  original  author  and  publisher  if  applicable  must  be  retained  according  to  normal
     academic citation practices.
     </li>
     <li class="enumerate"><a 
 id="x1-378008x4"></a>The location of the original unmodified document must be identified.
     </li>
     <li class="enumerate"><a 
 id="x1-378010x5"></a>The original author&#x2019;s (or authors&#x2019;) name(s) may not be used to assert or imply endorsement of the resulting
     document without the original author&#x2019;s (or authors&#x2019;) permission.</li></ol>
<!--l. 83--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">D.5    </span> <a 
 id="x1-379000D.5"></a>Good-practice recommendations</h3>
<!--l. 85--><p class="noindent">In addition to the requirements of this license, it is requested from and strongly recommended of redistributors
that:
</p><!--l. 89--><p class="indent">
     </p><ol  class="enumerate1" >
     <li class="enumerate"><a 
 id="x1-379002x1"></a>If you are distributing Open Publication works on hardcopy or CD-ROM, you provide email notification to the
     authors of your intent to redistribute at least thirty days before your manuscript or media freeze, to give the
     authors time to provide updated documents. This notification should describe modifications, if any, made to the
     document.
     </li>
     <li class="enumerate"><a 
 id="x1-379004x2"></a>All substantive modifications (including deletions) be either clearly marked up in the document or else described
     in an attachment to the document.
     </li>
     <li class="enumerate"><a 
 id="x1-379006x3"></a>Finally, while it is not mandatory under this license, it is considered good form to offer a free copy of any
     hardcopy and CD-ROM expression of an Open Publication-licensed work to its author(s).</li></ol>
<!--l. 103--><p class="noindent">
</p>
   <h3 class="sectionHead"><span class="titlemark">D.6    </span> <a 
 id="x1-380000D.6"></a>License options</h3>
<!--l. 106--><p class="noindent">The author(s) and/or publisher of an Open Publication-licensed document may elect certain options by appending language to
the reference to or copy of the license. These options are considered part of the license instance and must be included with the
license (or its incorporation by reference) in derived works.
</p><!--l. 112--><p class="indent">
                                                                                         
                                                                                         
  </p><ol  class="enumerate1" >
  <li class="enumerate"><a 
 id="x1-380002x1"></a>To  prohibit  distribution  of  substantively  modified  versions  without  the  explicit  permission  of  the  author(s).
  &#x201C;Substantive modification&#x201D; is defined as a change to the semantic content of the document, and excludes mere
  changes in format or typographical corrections.
  <!--l. 119--><p class="noindent">To accomplish this, add the phrase &#x201C;Distribution of substantively modified versions of this document is prohibited
  without the explicit permission of the copyright holder.&#x201D; to the license reference or copy.
  </p></li>
  <li class="enumerate"><a 
 id="x1-380004x2"></a>To prohibit any publication of this work or derivative works in whole or in part in standard (paper) book form for
  commercial purposes is prohibited unless prior permission is obtained from the copyright holder.
  <!--l. 129--><p class="noindent">To accomplish this, add the phrase &#x201C;Distribution of the work or derivative of the work in any standard (paper) book
  form is prohibited unless prior permission is obtained from the copyright holder.&#x201D; to the license reference or copy.</p></li></ol>
                                                                                         
                                                                                         
<a 
 id="Q1-1-427"></a>
<a 
 id="Q1-1-428"></a>
    
</body></html> 

                                                                                         


